const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/chunk-v5-1760919263206-VtuBIVrN.js","assets/chunk-v5-1760919263206-Bwv2P4Tq.js","assets/chunk-v5-1760919263206-DzTHeiPn.js","assets/chunk-v5-1760919263206-DdHQ3Cw9.js","assets/chunk-v5-1760919263206-CM46xNno.js","assets/chunk-v5-1760919263206-67jeV4qK.js","assets/chunk-v5-1760919263206-kZ2zMg4k.js","assets/chunk-v5-1760919263206-Cc1ffIZR.js","assets/chunk-v5-1760919263206-CFy_YwuF.js","assets/chunk-v5-1760919263206-DvtGGhMw.js","assets/chunk-v5-1760919263206-EFMG49ed.js","assets/chunk-v5-1760919263206-ULPfkQwc.js","assets/asset-v5-1760919263206-Bq-DyqPN.css"])))=>i.map(i=>d[i]);
import{j as e,m as t,A as _}from"./chunk-v5-1760919263206-Bwv2P4Tq.js";import{a as le,r as i,R as D,B as ce,d as de,e as ue,f as I,N as Y}from"./chunk-v5-1760919263206-DzTHeiPn.js";import{_ as B,a as he}from"./chunk-v5-1760919263206-CM46xNno.js";import{u as te,i as A,a as me,q as xe}from"./chunk-v5-1760919263206-VtuBIVrN.js";import{u as pe}from"./chunk-v5-1760919263206-Cc1ffIZR.js";import{u as ge,s as X}from"./chunk-v5-1760919263206-DdHQ3Cw9.js";import"./chunk-v5-1760919263206-67jeV4qK.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const d of a)if(d.type==="childList")for(const c of d.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function o(a){const d={};return a.integrity&&(d.integrity=a.integrity),a.referrerPolicy&&(d.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?d.credentials="include":a.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function r(a){if(a.ep)return;a.ep=!0;const d=o(a);fetch(a.href,d)}})();var ie,ae=le;ie=ae.createRoot,ae.hydrateRoot;const ye=i.createContext();function fe({children:m}){const n=pe();return e.jsx(ye.Provider,{value:n,children:m})}const be=i.createContext(),je=({children:m})=>{const n=ge(),[o,r]=i.useState(!0),[a,d]=i.useState(null);i.useEffect(()=>(o?n.start(a):n.stop(),()=>{n.stop()}),[o,a]);const c={autoSync:n,globalSyncEnabled:o,setGlobalSyncEnabled:r,syncInterval:a,setSyncInterval:d,isAutoSyncRunning:n.isRunning,isSyncInProgress:n.syncInProgress,lastSyncTime:n.lastSyncTime,nextSyncTime:n.nextSyncTime,startAutoSync:n.start,stopAutoSync:n.stop,syncNow:n.syncNow,getLastSyncText:()=>{if(!n.lastSyncTime)return"Nikad";const l=Date.now()-n.lastSyncTime,g=Math.floor(l/(1e3*60)),p=Math.floor(l%(1e3*60)/1e3);return g>0?`prije ${g}min ${p}s`:`prije ${p}s`},getNextSyncText:()=>{if(!n.nextSyncTime||!n.isRunning)return"Iskljuƒçen";const f=Date.now(),l=n.nextSyncTime-f;if(l<=0)return"Uskoro";const g=Math.floor(l/(1e3*60)),p=Math.floor(l%(1e3*60)/1e3);return g>0?`za ${g}min ${p}s`:`za ${p}s`}};return e.jsx(be.Provider,{value:c,children:m})},ve={confirm:"Potvrdi",enterTuraOrPin:"Unesi turu ili PIN",selectLanguage:"Odaberi jezik",enterTuraAndSelectLanguage:"Unesi turu i odaberi jezik",welcome:"Dobrodo≈°li!",setupMessage:"Molimo podes–∏—Ç–µ aplikaciju prije kori≈°ƒáenja.",tourNumber:"Broj ture",tourPlaceholder:"Unesite va≈° broj ture (npr. 8610)",appLanguage:"Jezik aplikacije",finishSetup:"Zavr≈°i pode≈°avanje",setupInfoMessage:"Ove podatke mo≈æete promijeniti kasnije u pode≈°avanjima aplikacije.",unknownTour:"Nepoznat broj ture. Molimo kontaktirajte administratora."},we={confirm:"Confirm",enterTuraOrPin:"Enter route or PIN",selectLanguage:"Select language",enterTuraAndSelectLanguage:"Enter route and select language",welcome:"Welcome!",setupMessage:"Please configure the application before use.",tourNumber:"Route number",tourPlaceholder:"Enter your route number (e.g. 8610)",appLanguage:"Application language",finishSetup:"Finish setup",setupInfoMessage:"You can change these settings later in application settings.",unknownTour:"Unknown route number. Please contact administrator."},ke={confirm:"Best√§tigen",enterTuraOrPin:"Route oder PIN eingeben",selectLanguage:"Sprache w√§hlen",enterTuraAndSelectLanguage:"Route eingeben und Sprache w√§hlen",welcome:"Willkommen!",setupMessage:"Bitte konfigurieren Sie die Anwendung vor der Nutzung.",tourNumber:"Routennummer",tourPlaceholder:"Geben Sie Ihre Routennummer ein (z.B. 8610)",appLanguage:"Anwendungssprache",finishSetup:"Setup abschlie√üen",setupInfoMessage:"Sie k√∂nnen diese Einstellungen sp√§ter in den Anwendungseinstellungen √§ndern.",unknownTour:"Unbekannte Routennummer. Bitte kontaktieren Sie den Administrator."},Ne={confirm:"Potrdi",enterTuraOrPin:"Vnesi turo ali PIN",selectLanguage:"Izberi jezik",enterTuraAndSelectLanguage:"Vnesi turo in izberi jezik",welcome:"Dobrodo≈°li!",setupMessage:"Prosimo, konfigurirajte aplikacijo pred uporabo.",tourNumber:"≈†tevilka ture",tourPlaceholder:"Vnesite svojo ≈°tevilko ture (npr. 8610)",appLanguage:"Jezik aplikacije",finishSetup:"Zakljuƒçi nastavitev",setupInfoMessage:"Te nastavitve lahko pozneje spremenite v nastavitvah aplikacije.",unknownTour:"Neznana ≈°tevilka ture. Prosimo, kontaktirajte administratorja."},U={ba:ve,en:we,de:ke,si:Ne},Se=i.createContext(),Pe="ba",ee={getItem:m=>window.localStorage.getItem(m),setItem:(m,n)=>window.localStorage.setItem(m,n)},Ce=({children:m})=>{const n=ee.getItem("APP_LANG")||Pe,[o,r]=i.useState(n),[a,d]=i.useState(U[n]),[c,f]=i.useState(!1);i.useEffect(()=>{(()=>{const b=ee.getItem("APP_LANG");b&&U[b]&&b!==o&&(r(b),d(U[b]))})()},[o]);const p={language:o,translations:a,isLoading:c,changeLanguage:S=>{U[S]&&(r(S),d(U[S]),ee.setItem("APP_LANG",S))},t:(S,b)=>{const z=S.split(".");let j=a;for(const u of z)if(j&&j[u]!==void 0)j=j[u];else return b||S;return j}};return e.jsx(Se.Provider,{value:p,children:m})};function $e({onDriverSelected:m,loading:n}){const[o,r]=i.useState(""),[a,d]=i.useState(null),[c,f]=i.useState(!1),[l,g]=i.useState(!1),[p,S]=i.useState("medium"),[b,z]=i.useState(!1),[j,u]=i.useState(!1),[k,x]=i.useState(!1),[s,v]=i.useState(!1);i.useEffect(()=>{const N=window.matchMedia("(prefers-color-scheme: dark)");g(N.matches);const P=R=>g(R.matches);return N.addEventListener("change",P),()=>N.removeEventListener("change",P)},[]),i.useEffect(()=>{const N=P=>{P.key==="Escape"&&(r(""),d(null))};return window.addEventListener("keydown",N),()=>window.removeEventListener("keydown",N)},[]);const L=()=>{navigator.vibrate&&navigator.vibrate(50)},F=N=>{if(N.preventDefault(),!o.trim()){d("Molimo unesite va≈°u turu"),v(!0),L(),setTimeout(()=>v(!1),500);return}if(o.trim().length<3){d("Tura mora imati najmanje 3 karaktera"),v(!0),L(),setTimeout(()=>v(!1),500);return}d(null),x(!0),L(),j&&localStorage.setItem("rememberedTura",o.trim().toUpperCase()),setTimeout(()=>{m(o.trim().toUpperCase())},800)},T=N=>{const P=N.target.value;r(P),P&&P.length<3?d("Tura mora imati najmanje 3 karaktera"):d(null)},W={small:"text-sm",medium:"text-base",large:"text-lg"},H=l?"bg-gradient-to-br from-gray-900 to-blue-900 text-white":"bg-gradient-to-br from-gray-50 to-blue-50 text-gray-800",E=l?"bg-gray-800/90 backdrop-blur-lg border border-gray-700/50":"bg-white/90 backdrop-blur-lg border border-white/50",V=l?"bg-gray-700/50 border-gray-600 text-white placeholder-gray-400 focus:ring-blue-400":"bg-white/80 border-gray-300 text-gray-800 placeholder-gray-500 focus:ring-blue-400",O=l?"bg-blue-700 hover:bg-blue-600 disabled:bg-gray-700":"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-300";return e.jsxs("div",{className:`min-h-screen flex items-center justify-center relative overflow-hidden ${H} ${W[p]} ${b?"contrast-150":""}`,children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[[...Array(20)].map((N,P)=>e.jsx(t.div,{className:`absolute w-2 h-2 rounded-full ${l?"bg-blue-400/20":"bg-blue-300/30"}`,initial:{x:Math.random()*window.innerWidth,y:Math.random()*window.innerHeight},animate:{x:Math.random()*window.innerWidth,y:Math.random()*window.innerHeight},transition:{duration:Math.random()*10+20,repeat:1/0,repeatType:"reverse"}},P)),[...Array(8)].map((N,P)=>e.jsx(t.div,{className:`absolute opacity-20 ${l?"bg-gradient-to-r from-blue-600 to-purple-600":"bg-gradient-to-r from-blue-400 to-cyan-400"}`,style:{width:Math.random()*100+50,height:Math.random()*100+50,borderRadius:Math.random()*50+25,left:Math.random()*100+"%",top:Math.random()*100+"%"},animate:{rotate:360,scale:[1,1.2,1]},transition:{duration:Math.random()*20+30,repeat:1/0}},`shape-${P}`))]}),e.jsxs("div",{className:"absolute top-4 right-4 flex gap-2",children:[e.jsx(t.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>g(!l),className:`w-10 h-10 rounded-full ${E} flex items-center justify-center`,title:"Toggle Dark Mode",children:l?"‚òÄÔ∏è":"üåô"}),e.jsx(t.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>S(p==="small"?"medium":p==="medium"?"large":"small"),className:`w-10 h-10 rounded-full ${E} flex items-center justify-center text-sm`,title:"Font Size",children:"Aa"}),e.jsx(t.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>z(!b),className:`w-10 h-10 rounded-full ${E} flex items-center justify-center`,title:"High Contrast",children:"‚ö´"})]}),e.jsxs(t.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0,...s&&{x:[0,-10,10,-10,10,0],transition:{duration:.5}}},className:`w-full max-w-md ${E} rounded-2xl shadow-2xl p-8 flex flex-col gap-8 relative z-10`,children:[e.jsx(_,{children:k&&e.jsx(t.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 pointer-events-none",children:[...Array(15)].map((N,P)=>e.jsx(t.div,{className:"absolute w-2 h-2 bg-green-500 rounded",initial:{x:"50%",y:"50%",scale:0},animate:{x:Math.random()*300-150,y:Math.random()*300-150,scale:1,rotate:Math.random()*360},transition:{duration:.8,delay:P*.05}},P))})}),e.jsxs(t.div,{className:"flex flex-col items-center gap-2",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{delay:.2},children:[e.jsx(t.div,{className:`w-20 h-20 rounded-full flex items-center justify-center mb-2 ${l?"bg-gradient-to-br from-blue-600 to-purple-600":"bg-gradient-to-br from-blue-500 to-cyan-500"}`,animate:{boxShadow:["0 0 20px rgba(59, 130, 246, 0.3)","0 0 30px rgba(59, 130, 246, 0.5)","0 0 20px rgba(59, 130, 246, 0.3)"]},transition:{duration:2,repeat:1/0},children:e.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"text-white",children:[e.jsx(t.path,{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1.5,delay:.5}}),e.jsx(t.circle,{cx:"12",cy:"7",r:"4",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1.5,delay:.8}})]})}),e.jsx(t.h1,{className:`text-2xl font-bold ${l?"text-white":"text-gray-800"}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},children:"Dobrodo≈°li!"}),e.jsx(t.p,{className:`text-center ${l?"text-gray-300":"text-gray-600"}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},children:"Molimo unesite va≈°u turu za pristup aplikaciji"})]}),e.jsxs(t.form,{onSubmit:F,className:"flex flex-col gap-4",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8},children:[e.jsxs("div",{className:"relative",children:[e.jsx(t.input,{type:"text",id:"tura",value:o,onChange:T,onFocus:()=>f(!0),onBlur:()=>f(!1),placeholder:" ",maxLength:"10",disabled:n,autoFocus:!0,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 text-lg peer transition-all duration-300 ${V}`,animate:{scale:c?1.02:1,boxShadow:c?"0 0 20px rgba(59, 130, 246, 0.3)":"0 0 0px rgba(59, 130, 246, 0)"}}),e.jsx(t.label,{htmlFor:"tura",className:`absolute left-4 transition-all duration-300 pointer-events-none ${l?"text-gray-400":"text-gray-500"} ${c||o?"-top-2 text-xs bg-inherit px-2 font-medium":"top-3 text-base"}`,animate:{color:c?"#3b82f6":l?"#9ca3af":"#6b7280"},children:"Va≈°a tura"}),e.jsx(t.span,{className:`absolute right-3 top-1/2 -translate-y-1/2 ${c?"text-blue-400":l?"text-gray-500":"text-gray-400"}`,animate:{rotate:c?360:0,scale:c?1.1:1},transition:{duration:.3},children:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"8.5",cy:"7",r:"4"}),e.jsx("path",{d:"m20 8 2 2-2 2"}),e.jsx("path",{d:"m16 12-2-2 2-2"})]})}),o&&!a&&e.jsx(t.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},className:"absolute right-12 top-1/2 -translate-y-1/2",children:e.jsx("div",{className:"flex gap-1",children:[0,1,2].map(N=>e.jsx(t.div,{className:"w-1 h-1 bg-green-500 rounded-full",animate:{scale:[1,1.5,1],opacity:[.3,1,.3]},transition:{duration:1,repeat:1/0,delay:N*.2}},N))})})]}),e.jsx(_,{children:a&&e.jsxs(t.div,{initial:{opacity:0,height:0,scale:.8},animate:{opacity:1,height:"auto",scale:1},exit:{opacity:0,height:0,scale:.8},className:`flex items-center gap-2 border rounded-lg px-3 py-2 ${l?"bg-red-900/20 border-red-800 text-red-400":"bg-red-50 border-red-200 text-red-700"}`,children:[e.jsxs(t.svg,{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"text-red-500",animate:{rotate:[0,10,-10,0]},transition:{duration:.5},children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),e.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),e.jsx("span",{children:a})]})}),e.jsxs(t.label,{className:"flex items-center gap-2 text-sm cursor-pointer",whileHover:{scale:1.02},children:[e.jsx("input",{type:"checkbox",checked:j,onChange:N=>u(N.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:l?"text-gray-300":"text-gray-600",children:"Zapamti ovaj ureƒëaj"})]}),e.jsxs(t.button,{type:"submit",className:`relative overflow-hidden w-full flex items-center justify-center gap-2 font-semibold py-3 rounded-lg shadow transition-all duration-300 ${O}`,disabled:n||!o.trim(),whileHover:{scale:1.02},whileTap:{scale:.98},animate:s?{x:[0,-10,10,-10,10,0]}:{},children:[e.jsx(t.div,{className:"absolute inset-0 bg-white/20 rounded-full pointer-events-none",initial:{scale:0,opacity:1},animate:{scale:4,opacity:0},transition:{duration:.6}}),n?e.jsxs(e.Fragment,{children:[e.jsx(t.span,{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}}),"Provjeravam..."]}):k?e.jsxs(e.Fragment,{children:[e.jsxs(t.svg,{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:500,damping:30},children:[e.jsx("path",{d:"m9 12 2 2 4-4"}),e.jsx("circle",{cx:"12",cy:"12",r:"10"})]}),"Uspje≈°no!"]}):e.jsxs(e.Fragment,{children:[e.jsx(t.svg,{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",whileHover:{x:5},transition:{type:"spring",stiffness:400,damping:30},children:e.jsx("path",{d:"m9 18 6-6-6-6"})}),"Nastavi"]})]})]}),e.jsxs(t.div,{className:"flex flex-col items-center gap-2 mt-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1.2},children:[e.jsx(t.div,{className:`w-12 h-12 rounded-full flex items-center justify-center ${l?"bg-gradient-to-br from-gray-700 to-gray-600":"bg-gradient-to-br from-gray-100 to-gray-200"}`,animate:{rotate:[0,5,-5,0]},transition:{duration:3,repeat:1/0,ease:"easeInOut"},children:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:l?"text-gray-300":"text-gray-500",children:[e.jsx(t.path,{d:"M18 20V10",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1,delay:1.5}}),e.jsx(t.path,{d:"M12 20V4",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1,delay:1.7}}),e.jsx(t.path,{d:"M6 20v-6",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1,delay:1.9}})]})}),e.jsx(t.p,{className:`text-sm ${l?"text-gray-400":"text-gray-500"}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:1.4},children:"B&D Evidencija ‚Ä¢ Aplikacija za evidenciju vo≈ænji"}),e.jsx(t.div,{className:`px-3 py-1 rounded-full text-xs font-semibold ${l?"bg-blue-800/50 text-blue-300":"bg-blue-100 text-blue-600"}`,initial:{scale:0},animate:{scale:1},transition:{delay:1.6,type:"spring",stiffness:500,damping:30},whileHover:{scale:1.1},children:"v5.0.0"})]})]})]})}function ze({driver:m,onContinue:n,onLogin:o,onBack:r,loading:a}){const[d,c]=i.useState(""),[f,l]=i.useState(!1),[g,p]=i.useState(null),[S,b]=i.useState(!1),[z,j]=i.useState(!1),[u,k]=i.useState(!1),[x,s]=i.useState("medium"),[v,L]=i.useState(!1),[F,T]=i.useState(!1),[W,H]=i.useState(!1);i.useEffect(()=>{const C=window.matchMedia("(prefers-color-scheme: dark)");k(C.matches);const y=J=>k(J.matches);return C.addEventListener("change",y),()=>C.removeEventListener("change",y)},[]),i.useEffect(()=>{const C=y=>{y.key==="Escape"&&(c(""),p(null))};return window.addEventListener("keydown",C),()=>window.removeEventListener("keydown",C)},[]);const E=()=>{navigator.vibrate&&navigator.vibrate(50)},V=C=>{if(C.preventDefault(),!d.trim()){p("Molimo unesite lozinku"),H(!0),E(),setTimeout(()=>H(!1),500);return}p(null),T(!0),E(),setTimeout(()=>{o(m.tura,d,f)},800)},O=C=>{const y=C.target.value;c(y),y&&y.length<4?p("Lozinka mora imati najmanje 4 karaktera"):p(null)},N={small:"text-sm",medium:"text-base",large:"text-lg"},P=u?"bg-gradient-to-br from-gray-900 to-blue-900 text-white":"bg-gradient-to-br from-gray-50 to-blue-50 text-gray-800",R=u?"bg-gray-800/90 backdrop-blur-lg border border-gray-700/50":"bg-white/90 backdrop-blur-lg border border-white/50",G=u?"bg-gray-700/50 border-gray-600 text-white placeholder-gray-400 focus:ring-blue-400":"bg-white/80 border-gray-300 text-gray-800 placeholder-gray-500 focus:ring-blue-400",$=u?"bg-blue-700 hover:bg-blue-600 disabled:bg-gray-700":"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-300";return e.jsxs("div",{className:`min-h-screen flex items-center justify-center relative overflow-hidden ${P} ${N[x]} ${v?"contrast-150":""}`,children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[[...Array(15)].map((C,y)=>e.jsx(t.div,{className:`absolute w-2 h-2 rounded-full ${u?"bg-blue-400/20":"bg-blue-300/30"}`,initial:{x:Math.random()*window.innerWidth,y:Math.random()*window.innerHeight},animate:{x:Math.random()*window.innerWidth,y:Math.random()*window.innerHeight},transition:{duration:Math.random()*10+20,repeat:1/0,repeatType:"reverse"}},y)),[...Array(6)].map((C,y)=>e.jsx(t.div,{className:`absolute opacity-20 ${u?"bg-gradient-to-r from-blue-600 to-purple-600":"bg-gradient-to-r from-blue-400 to-cyan-400"}`,style:{width:Math.random()*80+40,height:Math.random()*80+40,borderRadius:Math.random()*40+20,left:Math.random()*100+"%",top:Math.random()*100+"%"},animate:{rotate:360,scale:[1,1.1,1]},transition:{duration:Math.random()*15+25,repeat:1/0}},`shape-${y}`))]}),e.jsxs("div",{className:"absolute top-4 right-4 flex gap-2",children:[e.jsx(t.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>k(!u),className:`w-10 h-10 rounded-full ${R} flex items-center justify-center`,title:"Toggle Dark Mode",children:u?"‚òÄÔ∏è":"üåô"}),e.jsx(t.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>s(x==="small"?"medium":x==="medium"?"large":"small"),className:`w-10 h-10 rounded-full ${R} flex items-center justify-center text-sm`,title:"Font Size",children:"Aa"}),e.jsx(t.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>L(!v),className:`w-10 h-10 rounded-full ${R} flex items-center justify-center`,title:"High Contrast",children:"‚ö´"})]}),e.jsxs(t.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0,...W&&{x:[0,-10,10,-10,10,0],transition:{duration:.5}}},className:`w-full max-w-lg ${R} rounded-2xl shadow-2xl p-8 flex flex-col gap-6 relative z-10`,children:[e.jsx(_,{children:F&&e.jsx(t.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 pointer-events-none",children:[...Array(12)].map((C,y)=>e.jsx(t.div,{className:"absolute w-2 h-2 bg-green-500 rounded",initial:{x:"50%",y:"50%",scale:0},animate:{x:Math.random()*250-125,y:Math.random()*250-125,scale:1,rotate:Math.random()*360},transition:{duration:.8,delay:y*.05}},y))})}),e.jsxs(t.div,{className:"flex flex-col items-center gap-3",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{delay:.2},children:[e.jsx(t.div,{className:`w-16 h-16 rounded-full flex items-center justify-center mb-2 ${u?"bg-gradient-to-br from-green-600 to-blue-600":"bg-gradient-to-br from-green-500 to-blue-500"}`,animate:{boxShadow:["0 0 20px rgba(34, 197, 94, 0.3)","0 0 30px rgba(34, 197, 94, 0.5)","0 0 20px rgba(34, 197, 94, 0.3)"]},transition:{duration:2,repeat:1/0},children:e.jsxs(t.svg,{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"text-white",initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:500,damping:30,delay:.3},children:[e.jsx(t.path,{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1.5,delay:.5}}),e.jsx(t.circle,{cx:"12",cy:"7",r:"4",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1.5,delay:.8}})]})}),e.jsx(t.h1,{className:`text-2xl font-bold ${u?"text-white":"text-gray-800"}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},children:"Vozaƒç pronaƒëen"}),e.jsx(t.p,{className:`text-center ${u?"text-gray-300":"text-gray-600"}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},children:"Uspje≈°no smo identificirali va≈° profil"})]}),e.jsx(t.div,{className:`${R} rounded-xl p-4 shadow-lg`,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.8},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(t.h2,{className:`text-xl font-bold ${u?"text-white":"text-gray-800"}`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:1},children:m.ime}),e.jsxs("div",{className:"flex flex-col gap-2 mt-3",children:[e.jsxs(t.div,{className:"flex items-center gap-2",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:1.2},children:[e.jsx("span",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${u?"bg-blue-700/50":"bg-blue-100"}`,children:e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:u?"text-blue-300":"text-blue-600",children:[e.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"8.5",cy:"7",r:"4"}),e.jsx("path",{d:"m20 8 2 2-2 2"}),e.jsx("path",{d:"m16 12-2-2 2-2"})]})}),e.jsxs("span",{className:`font-medium ${u?"text-gray-200":"text-gray-700"}`,children:["Tura: ",m.tura]})]}),e.jsxs(t.div,{className:"flex items-center gap-2",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:1.4},children:[e.jsx("span",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${u?"bg-purple-700/50":"bg-purple-100"}`,children:e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:u?"text-purple-300":"text-purple-600",children:[e.jsx("path",{d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"}),e.jsx("path",{d:"m19.4 15-1.1-2.3c-.4-.8-1.2-1.3-2.1-1.3H7.8c-.9 0-1.7.5-2.1 1.3L4.6 15"}),e.jsx("path",{d:"M12 8v7"})]})}),e.jsx("span",{className:`font-medium ${u?"text-gray-200":"text-gray-700"}`,children:m.role==="admin"?"Administrator":"Vozaƒç"})]})]})]}),e.jsx(t.div,{className:"flex flex-col items-center",initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},transition:{delay:1.6},children:m.hasPassword?e.jsxs("div",{className:`flex items-center gap-2 px-3 py-2 rounded-lg ${u?"bg-green-800/50 text-green-300":"bg-green-100 text-green-700"}`,children:[e.jsxs(t.svg,{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",animate:{scale:[1,1.1,1]},transition:{duration:2,repeat:1/0},children:[e.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),e.jsx("circle",{cx:"12",cy:"16",r:"1"}),e.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),e.jsx("span",{className:"text-sm font-medium",children:"Veƒá imate lozinku"})]}):e.jsxs("div",{className:`flex items-center gap-2 px-3 py-2 rounded-lg ${u?"bg-orange-800/50 text-orange-300":"bg-orange-100 text-orange-700"}`,children:[e.jsxs(t.svg,{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",animate:{scale:[1,1.1,1]},transition:{duration:2,repeat:1/0},children:[e.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),e.jsx("path",{d:"M7 11V7a5 5 0 0 1 9.9-1"})]}),e.jsx("span",{className:"text-sm font-medium",children:"Potrebno je postaviti lozinku"})]})})]})}),m.hasPassword?e.jsxs(t.form,{onSubmit:V,className:"flex flex-col gap-4",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1.8},children:[e.jsxs("div",{className:"relative",children:[e.jsx(t.input,{type:S?"text":"password",id:"password",value:d,onChange:O,onFocus:()=>j(!0),onBlur:()=>j(!1),placeholder:" ",disabled:a,autoFocus:!0,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 text-lg peer transition-all duration-300 ${G}`,animate:{scale:z?1.02:1,boxShadow:z?"0 0 20px rgba(59, 130, 246, 0.3)":"0 0 0px rgba(59, 130, 246, 0)"}}),e.jsx(t.label,{htmlFor:"password",className:`absolute left-4 transition-all duration-300 pointer-events-none ${u?"text-gray-400":"text-gray-500"} ${z||d?"-top-2 text-xs bg-inherit px-2 font-medium":"top-3 text-base"}`,animate:{color:z?"#3b82f6":u?"#9ca3af":"#6b7280"},children:"Lozinka"}),e.jsx(t.button,{type:"button",className:`absolute right-3 top-1/2 -translate-y-1/2 p-1 rounded ${u?"text-gray-400 hover:text-gray-200":"text-gray-500 hover:text-gray-700"}`,onClick:()=>b(!S),disabled:a,whileHover:{scale:1.1},whileTap:{scale:.9},children:e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:S?e.jsxs(e.Fragment,{children:[e.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"}),e.jsx("path",{d:"m1 1 22 22"})]}):e.jsxs(e.Fragment,{children:[e.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),e.jsx("circle",{cx:"12",cy:"12",r:"3"})]})})}),d&&!g&&e.jsx(t.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},className:"absolute right-12 top-1/2 -translate-y-1/2",children:e.jsx("div",{className:"flex gap-1",children:[0,1,2].map(C=>e.jsx(t.div,{className:"w-1 h-1 bg-green-500 rounded-full",animate:{scale:[1,1.5,1],opacity:[.3,1,.3]},transition:{duration:1,repeat:1/0,delay:C*.2}},C))})})]}),e.jsx(_,{children:g&&e.jsxs(t.div,{initial:{opacity:0,height:0,scale:.8},animate:{opacity:1,height:"auto",scale:1},exit:{opacity:0,height:0,scale:.8},className:`flex items-center gap-2 border rounded-lg px-3 py-2 ${u?"bg-red-900/20 border-red-800 text-red-400":"bg-red-50 border-red-200 text-red-700"}`,children:[e.jsxs(t.svg,{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"text-red-500",animate:{rotate:[0,10,-10,0]},transition:{duration:.5},children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),e.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),e.jsx("span",{children:g})]})}),e.jsxs(t.label,{className:"flex items-center gap-2 text-sm cursor-pointer",whileHover:{scale:1.02},children:[e.jsx("input",{type:"checkbox",checked:f,onChange:C=>l(C.target.checked),disabled:a,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:u?"text-gray-300":"text-gray-600",children:"Zapamti me"})]}),e.jsxs("div",{className:"flex gap-3 mt-4",children:[e.jsxs(t.button,{type:"button",className:`flex-1 flex items-center justify-center gap-2 font-semibold py-3 rounded-lg border transition-all duration-300 ${u?"border-gray-600 text-gray-300 hover:bg-gray-700/50":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,onClick:r,disabled:a,whileHover:{scale:1.02},whileTap:{scale:.98},children:[e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"m15 18-6-6 6-6"})}),"Nazad"]}),e.jsxs(t.button,{type:"submit",className:`flex-2 relative overflow-hidden flex items-center justify-center gap-2 font-semibold py-3 rounded-lg shadow transition-all duration-300 ${$}`,disabled:a||!d.trim(),whileHover:{scale:1.02},whileTap:{scale:.98},animate:W?{x:[0,-10,10,-10,10,0]}:{},children:[e.jsx(t.div,{className:"absolute inset-0 bg-white/20 rounded-full pointer-events-none",initial:{scale:0,opacity:1},animate:{scale:4,opacity:0},transition:{duration:.6}}),a?e.jsxs(e.Fragment,{children:[e.jsx(t.span,{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}}),"Prijavljivam..."]}):F?e.jsxs(e.Fragment,{children:[e.jsxs(t.svg,{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:500,damping:30},children:[e.jsx("path",{d:"m9 12 2 2 4-4"}),e.jsx("circle",{cx:"12",cy:"12",r:"10"})]}),"Uspje≈°no!"]}):e.jsxs(e.Fragment,{children:[e.jsx(t.svg,{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",whileHover:{x:5},transition:{type:"spring",stiffness:400,damping:30},children:e.jsx("path",{d:"m9 18 6-6-6-6"})}),"Prijavite se"]})]})]})]}):e.jsxs(t.div,{className:"flex gap-3 mt-4",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1.8},children:[e.jsxs(t.button,{type:"button",className:`flex-1 flex items-center justify-center gap-2 font-semibold py-3 rounded-lg border transition-all duration-300 ${u?"border-gray-600 text-gray-300 hover:bg-gray-700/50":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,onClick:r,disabled:a,whileHover:{scale:1.02},whileTap:{scale:.98},children:[e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"m15 18-6-6 6-6"})}),"Nazad"]}),e.jsxs(t.button,{type:"button",className:`flex-2 relative overflow-hidden flex items-center justify-center gap-2 font-semibold py-3 rounded-lg shadow transition-all duration-300 ${$}`,onClick:n,disabled:a,whileHover:{scale:1.02},whileTap:{scale:.98},children:[e.jsx(t.div,{className:"absolute inset-0 bg-white/20 rounded-full pointer-events-none",initial:{scale:0,opacity:1},animate:{scale:4,opacity:0},transition:{duration:.6}}),a?e.jsxs(e.Fragment,{children:[e.jsx(t.span,{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}}),"Molim saƒçekajte..."]}):e.jsxs(e.Fragment,{children:[e.jsxs(t.svg,{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",whileHover:{x:5},transition:{type:"spring",stiffness:400,damping:30},children:[e.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),e.jsx("path",{d:"M7 11V7a5 5 0 0 1 9.9-1"})]}),"Postavite lozinku"]})]})]}),e.jsxs(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:2},children:[e.jsx(t.div,{className:`w-10 h-10 rounded-full flex items-center justify-center ${u?"bg-gradient-to-br from-gray-700 to-gray-600":"bg-gradient-to-br from-gray-100 to-gray-200"}`,animate:{rotate:[0,5,-5,0]},transition:{duration:3,repeat:1/0,ease:"easeInOut"},children:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:u?"text-gray-300":"text-gray-500",children:[e.jsx(t.rect,{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1,delay:2.2}}),e.jsx(t.circle,{cx:"12",cy:"16",r:"1",initial:{scale:0},animate:{scale:1},transition:{duration:.5,delay:2.4}}),e.jsx(t.path,{d:"M7 11V7a5 5 0 0 1 10 0v4",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1,delay:2}})]})}),e.jsx(t.p,{className:`text-sm text-center ${u?"text-gray-400":"text-gray-500"}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:2.2},children:"Provjerite da li su podaci ispravni prije nastavka"})]})]})]})}function Me({driver:m,onPasswordSet:n,onBack:o,loading:r}){const[a,d]=i.useState(""),[c,f]=i.useState(""),[l,g]=i.useState(!1),[p,S]=i.useState(!1),[b,z]=i.useState(!0),[j,u]=i.useState(""),[k,x]=i.useState(""),[s,v]=i.useState(()=>localStorage.getItem("theme")==="dark"||!localStorage.getItem("theme")&&window.matchMedia("(prefers-color-scheme: dark)").matches),[L,F]=i.useState(()=>localStorage.getItem("fontSize")||"medium"),[T,W]=i.useState(()=>localStorage.getItem("highContrast")==="true"),[H,E]=i.useState(!1),[V,O]=i.useState([]),[N,P]=i.useState(!1),[R,G]=i.useState([]),[$,C]=i.useState({score:0,feedback:"Unesite lozinku"}),y={background:s?"bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900":"bg-gradient-to-br from-purple-50 via-white to-pink-50",container:s?"bg-gray-800/40 backdrop-blur-xl border-gray-700/50":"bg-white/40 backdrop-blur-xl border-white/50",card:s?"bg-gray-800/60 backdrop-blur-xl border-gray-700/50":"bg-white/60 backdrop-blur-xl border-white/60",input:s?"bg-gray-800/60 border-gray-600 text-white placeholder-gray-400 focus:border-purple-500 focus:bg-gray-800/80":"bg-white/60 border-gray-200 text-gray-900 placeholder-gray-500 focus:border-purple-500 focus:bg-white/80",text:s?"text-gray-100":"text-gray-900"},J=`${y.container} ${L==="small"?"text-sm":L==="large"?"text-lg":"text-base"} ${T?"contrast-125":""}`,Q=`${y.card} ${T?"shadow-2xl":"shadow-xl"}`,q=`${y.input} ${T?"shadow-inner border-2":"border"}`,re=h=>{if(!h)return{score:0,feedback:"Unesite lozinku"};let w=0,M="";h.length>=8&&w++,h.length>=12&&w++,/[a-z]/.test(h)&&w++,/[A-Z]/.test(h)&&w++,/[0-9]/.test(h)&&w++,/[^a-zA-Z0-9]/.test(h)&&w++;const K=Math.min(Math.max(Math.floor(w/1.5),1),4);switch(K){case 1:M="Slaba lozinka";break;case 2:M="Umjereno jaka lozinka";break;case 3:M="Jaka lozinka";break;case 4:M="Vrlo jaka lozinka";break;default:M="Unesite lozinku"}return{score:K,feedback:M}};i.useEffect(()=>{(()=>{const w=Array.from({length:20},(M,K)=>({id:K,x:Math.random()*100,y:Math.random()*100,size:Math.random()*4+1,duration:Math.random()*20+10,delay:Math.random()*5,opacity:Math.random()*.5+.1}));O(w)})()},[]),i.useEffect(()=>{C(re(a))},[a]),i.useEffect(()=>{localStorage.setItem("theme",s?"dark":"light"),document.documentElement.classList.toggle("dark",s)},[s]),i.useEffect(()=>{localStorage.setItem("fontSize",L)},[L]),i.useEffect(()=>{localStorage.setItem("highContrast",T.toString())},[T]),i.useEffect(()=>{const h=w=>{w.ctrlKey&&w.key==="d"&&(w.preventDefault(),v(!s)),w.ctrlKey&&w.key==="="&&(w.preventDefault(),F(M=>M==="small"?"medium":"large")),w.ctrlKey&&w.key==="-"&&(w.preventDefault(),F(M=>M==="large"?"medium":"small")),w.key==="Escape"&&E(!1)};return window.addEventListener("keydown",h),()=>window.removeEventListener("keydown",h)},[s]);const ne=()=>{const h=Array.from({length:50},(w,M)=>({id:M,x:Math.random()*100,y:-10,rotation:Math.random()*360,scale:Math.random()*.8+.4,color:["#8b5cf6","#ec4899","#06b6d4","#10b981","#f59e0b"][Math.floor(Math.random()*5)]}));G(h),setTimeout(()=>G([]),3e3)},Z=()=>{navigator.vibrate&&navigator.vibrate(50)},oe=async h=>{if(h.preventDefault(),!a.trim()||!c.trim()){u("Molimo unesite oba polja"),Z();return}if(a!==c){u("Lozinke se ne poklapaju"),Z();return}if($.score<2){u("Lozinka mora biti jaƒça"),Z();return}u(""),P(!0),ne();try{await n(a,b)}catch(w){u(w.message||"Gre≈°ka pri postavljanju lozinke"),P(!1),Z()}};return e.jsxs("div",{className:`min-h-screen relative overflow-hidden ${y.background}`,children:[e.jsx("div",{className:"absolute inset-0 overflow-hidden",children:V.map(h=>e.jsx(t.div,{className:`absolute w-2 h-2 rounded-full ${s?"bg-purple-400/20":"bg-purple-500/10"}`,style:{left:`${h.x}%`,top:`${h.y}%`,width:`${h.size}px`,height:`${h.size}px`},animate:{y:[0,-30,0],opacity:[h.opacity,h.opacity*1.5,h.opacity],scale:[1,1.2,1]},transition:{duration:h.duration,delay:h.delay,repeat:1/0,ease:"easeInOut"}},h.id))}),e.jsx(_,{children:R.map(h=>e.jsx(t.div,{className:"absolute w-3 h-3 rounded-sm",style:{left:`${h.x}%`,backgroundColor:h.color,rotate:h.rotation,scale:h.scale},initial:{y:-50},animate:{y:window.innerHeight+100,rotate:h.rotation+360*2,opacity:[1,1,0]},transition:{duration:3,ease:"easeIn"},exit:{opacity:0}},h.id))}),e.jsx(_,{children:H&&e.jsx(t.div,{className:"fixed top-4 right-4 z-50",initial:{opacity:0,x:20,scale:.9},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:20,scale:.9},children:e.jsxs("div",{className:`${Q} p-4 rounded-2xl border shadow-2xl min-w-[200px]`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:`font-semibold ${y.text}`,children:"Postavke"}),e.jsx("button",{onClick:()=>E(!1),className:`p-1 rounded-lg transition-colors ${s?"hover:bg-gray-700":"hover:bg-gray-100"}`,children:e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:y.text,children:[e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s,onChange:h=>v(h.target.checked),className:"rounded"}),e.jsx("span",{className:`text-sm ${y.text}`,children:"Tamna tema"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:T,onChange:h=>W(h.target.checked),className:"rounded"}),e.jsx("span",{className:`text-sm ${y.text}`,children:"Visoki kontrast"})]}),e.jsxs("div",{children:[e.jsx("label",{className:`text-sm ${y.text} block mb-1`,children:"Veliƒçina fonta"}),e.jsxs("select",{value:L,onChange:h=>F(h.target.value),className:`w-full p-1 rounded text-sm ${q}`,children:[e.jsx("option",{value:"small",children:"Mala"}),e.jsx("option",{value:"medium",children:"Srednja"}),e.jsx("option",{value:"large",children:"Velika"})]})]})]}),e.jsx("div",{className:`mt-3 pt-3 border-t ${s?"border-gray-700":"border-gray-200"}`,children:e.jsxs("p",{className:`text-xs ${s?"text-gray-400":"text-gray-500"}`,children:["Ctrl+D: Tamna tema",e.jsx("br",{}),"Ctrl++/-: Veliƒçina fonta"]})})]})})}),e.jsx(t.button,{onClick:()=>E(!H),className:`fixed top-4 right-4 z-40 p-3 rounded-full ${Q} border shadow-lg transition-all duration-300 ${s?"hover:bg-gray-700":"hover:bg-gray-50"}`,whileHover:{scale:1.05},whileTap:{scale:.95},initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},transition:{delay:.5},children:e.jsxs(t.svg,{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:y.text,animate:{rotate:H?180:0},transition:{duration:.3},children:[e.jsx("circle",{cx:"12",cy:"12",r:"3"}),e.jsx("path",{d:"m12 1 1.7 1.7"}),e.jsx("path",{d:"m12 23-1.7-1.7"}),e.jsx("path",{d:"m5.6 5.6 1.4 1.4"}),e.jsx("path",{d:"m18.4 18.4-1.4-1.4"}),e.jsx("path",{d:"m1 12 1.7-1.7"}),e.jsx("path",{d:"m23 12-1.7 1.7"}),e.jsx("path",{d:"m5.6 18.4 1.4-1.4"}),e.jsx("path",{d:"m18.4 5.6-1.4 1.4"})]})}),e.jsx("div",{className:"relative z-10 min-h-screen flex items-center justify-center p-4",children:e.jsxs(t.div,{className:`w-full max-w-md ${J} rounded-3xl border p-8 shadow-2xl space-y-8`,initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},transition:{duration:.5},children:[e.jsxs(t.div,{className:"flex flex-col items-center gap-3",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{delay:.2},children:[e.jsx(t.div,{className:`w-16 h-16 rounded-full flex items-center justify-center mb-2 ${s?"bg-gradient-to-br from-purple-600 to-pink-600":"bg-gradient-to-br from-purple-500 to-pink-500"}`,animate:{boxShadow:["0 0 20px rgba(168, 85, 247, 0.3)","0 0 30px rgba(168, 85, 247, 0.5)","0 0 20px rgba(168, 85, 247, 0.3)"]},transition:{duration:2,repeat:1/0},children:e.jsxs(t.svg,{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"text-white",initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:500,damping:30,delay:.3},children:[e.jsx(t.rect,{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1.5,delay:.5}}),e.jsx(t.circle,{cx:"12",cy:"16",r:"1",initial:{scale:0},animate:{scale:1},transition:{duration:.5,delay:1}}),e.jsx(t.path,{d:"M7 11V7a5 5 0 0 1 10 0v4",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1.5,delay:.8}})]})}),e.jsx(t.h1,{className:`text-2xl font-bold ${s?"text-white":"text-gray-800"}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},children:"Postavite lozinku"}),e.jsx(t.p,{className:`text-center ${s?"text-gray-300":"text-gray-600"}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},children:"Ovo je va≈° prvi put. Molimo postavite lozinku za buduƒái pristup."})]}),e.jsx(t.div,{className:`${Q} rounded-xl p-4 shadow-lg`,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.8},children:e.jsxs("div",{className:"flex items-center justify-center gap-6",children:[e.jsxs(t.div,{className:"flex items-center gap-2",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:1},children:[e.jsx("span",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${s?"bg-purple-700/50":"bg-purple-100"}`,children:e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:s?"text-purple-300":"text-purple-600",children:[e.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),e.jsxs("span",{className:`font-medium ${s?"text-gray-200":"text-gray-700"}`,children:[e.jsx("strong",{children:"Vozaƒç:"})," ",m.ime]})]}),e.jsxs(t.div,{className:"flex items-center gap-2",initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:1.2},children:[e.jsx("span",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${s?"bg-blue-700/50":"bg-blue-100"}`,children:e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:s?"text-blue-300":"text-blue-600",children:[e.jsx("circle",{cx:"12",cy:"12",r:"3"}),e.jsx("path",{d:"M12 1v6m0 6v6"})]})}),e.jsxs("span",{className:`font-medium ${s?"text-gray-200":"text-gray-700"}`,children:[e.jsx("strong",{children:"Tura:"})," ",m.tura]})]})]})}),e.jsxs(t.form,{onSubmit:oe,className:"flex flex-col gap-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1.4},children:[e.jsxs(t.div,{className:"relative",animate:j?{x:[-10,10,-10,10,0]}:{},transition:{type:"spring",stiffness:500,damping:30},children:[e.jsxs("div",{className:"relative",children:[e.jsx(t.input,{type:l?"text":"password",value:a,onChange:h=>d(h.target.value),className:`w-full px-4 pt-6 pb-2 border-2 rounded-xl transition-all duration-300 ${q} peer ${j?"border-red-500 bg-red-50/50":a?"border-purple-500 bg-purple-50/20":""}`,placeholder:" ",onFocus:()=>x("password"),onBlur:()=>x(""),initial:{opacity:0},animate:{opacity:1},transition:{delay:1.6},disabled:r,autoFocus:!0}),e.jsx(t.label,{className:`absolute left-4 transition-all duration-300 pointer-events-none ${a||k==="password"?`text-xs top-2 ${s?"text-purple-400":"text-purple-600"}`:`text-base top-4 ${s?"text-gray-400":"text-gray-500"}`}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:1.8},children:"Lozinka"}),e.jsx(_,{children:a&&e.jsx(t.button,{type:"button",onClick:()=>g(!l),className:`absolute right-3 top-1/2 -translate-y-1/2 p-2 rounded-lg transition-colors ${s?"text-gray-400 hover:text-white hover:bg-gray-700":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},exit:{opacity:0,scale:0},whileHover:{scale:1.1},whileTap:{scale:.9},disabled:r,children:l?e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"}),e.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}):e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),e.jsx("circle",{cx:"12",cy:"12",r:"3"})]})})})]}),e.jsx(_,{children:a&&e.jsxs(t.div,{className:"mt-3 space-y-2",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:[e.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4].map(h=>e.jsx(t.div,{className:`h-1 rounded-full flex-1 ${h<=$.score?$.score===1?"bg-red-500":$.score===2?"bg-orange-500":$.score===3?"bg-yellow-500":"bg-green-500":s?"bg-gray-700":"bg-gray-200"}`,initial:{scaleX:0},animate:{scaleX:h<=$.score?1:0},transition:{delay:h*.1}},h))}),e.jsx(t.p,{className:`text-sm ${$.score===1?"text-red-500":$.score===2?"text-orange-500":$.score===3?"text-yellow-500":"text-green-500"}`,initial:{opacity:0},animate:{opacity:1},children:$.feedback})]})})]}),e.jsxs(t.div,{className:"relative",animate:j?{x:[-10,10,-10,10,0]}:{},transition:{type:"spring",stiffness:500,damping:30},children:[e.jsxs("div",{className:"relative",children:[e.jsx(t.input,{type:p?"text":"password",value:c,onChange:h=>f(h.target.value),className:`w-full px-4 pt-6 pb-2 border-2 rounded-xl transition-all duration-300 ${q} peer ${j?"border-red-500 bg-red-50/50":c?"border-purple-500 bg-purple-50/20":""}`,placeholder:" ",onFocus:()=>x("confirmPassword"),onBlur:()=>x(""),initial:{opacity:0},animate:{opacity:1},transition:{delay:2},disabled:r}),e.jsx(t.label,{className:`absolute left-4 transition-all duration-300 pointer-events-none ${c||k==="confirmPassword"?`text-xs top-2 ${s?"text-purple-400":"text-purple-600"}`:`text-base top-4 ${s?"text-gray-400":"text-gray-500"}`}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:2.2},children:"Potvrdite lozinku"}),e.jsx(_,{children:c&&e.jsx(t.button,{type:"button",onClick:()=>S(!p),className:`absolute right-3 top-1/2 -translate-y-1/2 p-2 rounded-lg transition-colors ${s?"text-gray-400 hover:text-white hover:bg-gray-700":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},exit:{opacity:0,scale:0},whileHover:{scale:1.1},whileTap:{scale:.9},disabled:r,children:p?e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"}),e.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}):e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),e.jsx("circle",{cx:"12",cy:"12",r:"3"})]})})})]}),e.jsx(_,{children:c&&e.jsxs(t.div,{className:`mt-2 flex items-center gap-2 text-sm ${a===c?"text-green-500":"text-red-500"}`,initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},children:[a===c?e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("polyline",{points:"20,6 9,17 4,12"})}):e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),e.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),a===c?"Lozinke se poklapaju":"Lozinke se ne poklapaju"]})})]}),e.jsx(_,{children:j&&e.jsxs(t.div,{className:`p-4 rounded-xl flex items-center gap-3 ${s?"bg-red-900/30 border border-red-800 text-red-300":"bg-red-50 border border-red-200 text-red-700"}`,initial:{opacity:0,scale:.95,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-10},children:[e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),e.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),j]})}),e.jsx(_,{children:N&&e.jsxs(t.div,{className:`p-4 rounded-xl flex items-center gap-3 ${s?"bg-green-900/30 border border-green-800 text-green-300":"bg-green-50 border border-green-200 text-green-700"}`,initial:{opacity:0,scale:.95,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-10},children:[e.jsx(t.svg,{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:500,damping:30},children:e.jsx("polyline",{points:"20,6 9,17 4,12"})}),"Lozinka je uspje≈°no postavljena! Ulogujemo vas..."]})}),e.jsx(t.div,{className:"flex items-center gap-3",initial:{opacity:0},animate:{opacity:1},transition:{delay:2.4},children:e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"checkbox",checked:b,onChange:h=>z(h.target.checked),disabled:r,className:"sr-only"}),e.jsx(t.div,{className:`w-6 h-6 rounded-lg border-2 flex items-center justify-center transition-all duration-300 ${b?s?"bg-purple-600 border-purple-600":"bg-purple-500 border-purple-500":s?"border-gray-600 bg-gray-700":"border-gray-300 bg-white"} ${r?"opacity-50 cursor-not-allowed":"group-hover:border-purple-400"}`,whileHover:r?{}:{scale:1.05},whileTap:r?{}:{scale:.95},children:e.jsx(_,{children:b&&e.jsx(t.svg,{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"3",initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0},transition:{type:"spring",stiffness:500,damping:30},children:e.jsx("polyline",{points:"20,6 9,17 4,12"})})})})]}),e.jsx("span",{className:`font-medium ${s?"text-gray-200":"text-gray-700"} ${r?"opacity-50":""}`,children:"Zapamti me"})]})}),e.jsxs(t.div,{className:"flex gap-4 mt-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:2.6},children:[e.jsxs(t.button,{type:"button",onClick:o,disabled:r,className:`flex-1 px-6 py-3 rounded-xl font-medium transition-all duration-300 flex items-center justify-center gap-2 ${s?"bg-gray-700 text-gray-200 hover:bg-gray-600 border border-gray-600":"bg-gray-100 text-gray-700 hover:bg-gray-200 border border-gray-200"} ${r?"opacity-50 cursor-not-allowed":"hover:shadow-lg"}`,whileHover:r?{}:{scale:1.02},whileTap:r?{}:{scale:.98},children:[e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"m15 18-6-6 6-6"})}),"Nazad"]}),e.jsx(t.button,{type:"submit",disabled:r||!a.trim()||!c.trim()||a!==c||$.score<2,className:`flex-1 px-6 py-3 rounded-xl font-medium transition-all duration-300 flex items-center justify-center gap-2 ${r||!a.trim()||!c.trim()||a!==c||$.score<2?s?"bg-gray-700 text-gray-500 cursor-not-allowed":"bg-gray-200 text-gray-400 cursor-not-allowed":s?"bg-gradient-to-r from-purple-600 to-pink-600 text-white hover:from-purple-700 hover:to-pink-700":"bg-gradient-to-r from-purple-500 to-pink-500 text-white hover:from-purple-600 hover:to-pink-600"} hover:shadow-lg`,whileHover:!r&&a.trim()&&c.trim()&&a===c&&$.score>=2?{scale:1.02}:{},whileTap:!r&&a.trim()&&c.trim()&&a===c&&$.score>=2?{scale:.98}:{},children:r?e.jsxs(e.Fragment,{children:[e.jsx(t.div,{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}}),"Postavljam i ulogujem..."]}):e.jsxs(e.Fragment,{children:[e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"}),e.jsx("polyline",{points:"10,17 15,12 10,7"}),e.jsx("line",{x1:"15",y1:"12",x2:"3",y2:"12"})]}),"Postavi lozinku i uloguj se"]})})]})]}),e.jsx(t.div,{className:"text-center",initial:{opacity:0},animate:{opacity:1},transition:{delay:2.8},children:e.jsx("p",{className:`text-sm ${s?"text-gray-400":"text-gray-500"}`,children:"Lozinka ƒáe biti automatski saƒçuvana i ulogovani ƒáete se odmah."})})]})})]})}function _e({onLogin:m,loading:n,onBack:o}){const[r,a]=i.useState(""),[d,c]=i.useState(""),[f,l]=i.useState(null),g=p=>{if(p.preventDefault(),!r.trim()){l("Molimo unesite va≈°u turu");return}if(!d.trim()){l("Molimo unesite lozinku");return}l(null),m(r.trim().toUpperCase(),d)};return e.jsx("div",{className:"login-screen",children:e.jsxs("div",{className:"login-container",children:[e.jsxs("div",{className:"login-header",children:[e.jsx("h1",{children:"Prijava"}),e.jsx("p",{children:"Unesite va≈°u turu i lozinku za pristup aplikaciji."})]}),e.jsxs("form",{onSubmit:g,className:"login-form",children:[e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"tura",children:"Tura:"}),e.jsx("input",{type:"text",id:"tura",value:r,onChange:p=>a(p.target.value),placeholder:"npr. 8610",maxLength:"10",disabled:n,autoFocus:!0})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"password",children:"Lozinka:"}),e.jsx("input",{type:"password",id:"password",value:d,onChange:p=>c(p.target.value),placeholder:"Va≈°a lozinka",disabled:n})]}),f&&e.jsx("div",{className:"error-message",children:f}),e.jsx("button",{type:"submit",className:"login-btn",disabled:n||!r.trim()||!d.trim(),children:n?"Prijavljivam...":"Prijavite se"})]}),e.jsx("div",{className:"login-footer",children:e.jsx("button",{type:"button",className:"back-btn",onClick:o,disabled:n,children:"‚Üê Nazad"})})]})})}function Le({onAuthSuccess:m}){const[n,o]=i.useState("init"),[r,a]=i.useState(null),{loading:d,checkDriverExists:c,setInitialPassword:f,login:l}=te(),g=async u=>{try{const k=await c(u);a(k),o("confirm")}catch(k){console.error("Driver check failed:",k)}},p=()=>{r.hasPassword?o("login"):o("setup")},S=async(u,k=!1)=>{var x;try{await f(r.id,u);const s=await l(r.tura,u);console.log("[AuthFlowManager] Login user:",s),k&&localStorage.setItem("bde_remember_me","true"),s!=null&&s.name&&(localStorage.setItem("DRIVER_NAME",s.name),(x=window.__USER_CONTEXT__)!=null&&x.refreshStatus&&window.__USER_CONTEXT__.refreshStatus()),m(s)}catch(s){console.error("Password setup failed:",s)}},b=async(u,k,x=!1)=>{var s;try{const v=await l(u,k);console.log("[AuthFlowManager] Login user:",v),x&&localStorage.setItem("bde_remember_me","true"),v!=null&&v.ime&&(localStorage.setItem("DRIVER_NAME",v.ime),(s=window.__USER_CONTEXT__)!=null&&s.refreshStatus&&window.__USER_CONTEXT__.refreshStatus()),m(v)}catch(v){console.error("Login failed:",v)}},z=()=>{o("init"),a(null)},j=()=>{o("confirm")};return n==="init"?e.jsx($e,{onDriverSelected:g,loading:d}):n==="confirm"?e.jsx(ze,{driver:r,onContinue:p,onLogin:b,onBack:z,loading:d}):n==="setup"?e.jsx(Me,{driver:r,onPasswordSet:S,onBack:j,loading:d}):n==="login"?e.jsx(_e,{onLogin:b,loading:d,onBack:j}):null}const Ee=({onClose:m,onSubmit:n})=>{const[o,r]=i.useState({oldPassword:"",newPassword:"",confirmPassword:""}),[a,d]=i.useState({old:!1,new:!1,confirm:!1}),[c,f]=i.useState({}),[l,g]=i.useState(!1),p=x=>{if(!x)return null;let s=0;return x.length>=8&&s++,/[A-Z]/.test(x)&&s++,/[a-z]/.test(x)&&s++,/[0-9]/.test(x)&&s++,/[^A-Za-z0-9]/.test(x)&&s++,s<3?{level:"weak",text:"üî¥ Slaba lozinka"}:s<4?{level:"medium",text:"üü° Srednja lozinka"}:{level:"strong",text:"üü¢ Jaka lozinka"}},S=()=>{const x={};return o.oldPassword||(x.oldPassword="Stara lozinka je obavezna"),o.newPassword?o.newPassword.length<6&&(x.newPassword="Nova lozinka mora imati najmanje 6 karaktera"):x.newPassword="Nova lozinka je obavezna",o.confirmPassword?o.newPassword!==o.confirmPassword&&(x.confirmPassword="Lozinke se ne poklapaju"):x.confirmPassword="Potvrda lozinke je obavezna",o.oldPassword===o.newPassword&&(x.newPassword="Nova lozinka mora biti razliƒçita od stare"),f(x),Object.keys(x).length===0},b=(x,s)=>{r(v=>({...v,[x]:s})),c[x]&&f(v=>({...v,[x]:null}))},z=x=>{d(s=>({...s,[x]:!s[x]}))},j=async x=>{if(x.preventDefault(),!!S()){g(!0);try{await n(o),m()}catch(s){f({submit:s.message||"Gre≈°ka pri promeni lozinke"})}finally{g(!1)}}},u=o.oldPassword&&o.newPassword&&o.confirmPassword&&o.newPassword===o.confirmPassword&&o.newPassword.length>=6&&o.oldPassword!==o.newPassword,k=p(o.newPassword);return e.jsxs("form",{className:styles.modalForm,onSubmit:j,children:[e.jsxs("div",{className:styles.formHeader,children:[e.jsx("h2",{className:styles.formTitle,children:"üîê Promena lozinke"}),e.jsx("p",{className:styles.formSubtitle,children:"Unesite staru lozinku i defini≈°ite novu sigurnu lozinku"})]}),e.jsxs("div",{className:styles.inputGroup,children:[e.jsx("label",{className:styles.inputLabel,htmlFor:"oldPassword",children:"Trenutna lozinka"}),e.jsxs("div",{className:styles.inputWrapper,children:[e.jsx("input",{id:"oldPassword",type:a.old?"text":"password",value:o.oldPassword,onChange:x=>b("oldPassword",x.target.value),placeholder:"Unesite trenutnu lozinku",className:styles.passwordInput,autoComplete:"current-password"}),e.jsx("button",{type:"button",className:styles.toggleButton,onClick:()=>z("old"),"aria-label":"Prika≈æi/sakrij lozinku",children:a.old?"üëÅÔ∏è":"üôà"})]}),c.oldPassword&&e.jsxs("div",{className:`${styles.validationMessage} ${styles.validationError}`,children:["‚ùå ",c.oldPassword]})]}),e.jsxs("div",{className:styles.inputGroup,children:[e.jsx("label",{className:styles.inputLabel,htmlFor:"newPassword",children:"Nova lozinka"}),e.jsxs("div",{className:styles.inputWrapper,children:[e.jsx("input",{id:"newPassword",type:a.new?"text":"password",value:o.newPassword,onChange:x=>b("newPassword",x.target.value),placeholder:"Unesite novu lozinku",className:styles.passwordInput,autoComplete:"new-password"}),e.jsx("button",{type:"button",className:styles.toggleButton,onClick:()=>z("new"),"aria-label":"Prika≈æi/sakrij lozinku",children:a.new?"üëÅÔ∏è":"üôà"})]}),k&&e.jsx("div",{className:`${styles.strengthIndicator} ${styles[`strength${k.level.charAt(0).toUpperCase()+k.level.slice(1)}`]}`,children:k.text}),c.newPassword&&e.jsxs("div",{className:`${styles.validationMessage} ${styles.validationError}`,children:["‚ùå ",c.newPassword]})]}),e.jsxs("div",{className:styles.inputGroup,children:[e.jsx("label",{className:styles.inputLabel,htmlFor:"confirmPassword",children:"Potvrdite novu lozinku"}),e.jsxs("div",{className:styles.inputWrapper,children:[e.jsx("input",{id:"confirmPassword",type:a.confirm?"text":"password",value:o.confirmPassword,onChange:x=>b("confirmPassword",x.target.value),placeholder:"Ponovite novu lozinku",className:styles.passwordInput,autoComplete:"new-password"}),e.jsx("button",{type:"button",className:styles.toggleButton,onClick:()=>z("confirm"),"aria-label":"Prika≈æi/sakrij lozinku",children:a.confirm?"üëÅÔ∏è":"üôà"})]}),o.confirmPassword&&o.newPassword===o.confirmPassword&&e.jsx("div",{className:`${styles.validationMessage} ${styles.validationSuccess}`,children:"‚úÖ Lozinke se poklapaju"}),c.confirmPassword&&e.jsxs("div",{className:`${styles.validationMessage} ${styles.validationError}`,children:["‚ùå ",c.confirmPassword]})]}),e.jsxs("div",{className:styles.securityTips,children:[e.jsx("h4",{children:"üí° Saveti za sigurnu lozinku:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Najmanje 8 karaktera"}),e.jsx("li",{children:"Kombinacija velikih i malih slova"}),e.jsx("li",{children:"Brojevi i specijalni karakteri (!@#$%)"}),e.jsx("li",{children:"Izbegavajte liƒçne podatke"})]})]}),c.submit&&e.jsxs("div",{className:`${styles.validationMessage} ${styles.validationError}`,children:["‚ùå ",c.submit]}),e.jsxs("div",{className:styles.modalActions,children:[e.jsx("button",{type:"button",className:styles.cancelBtn,onClick:m,disabled:l,children:"‚ùå Otka≈æi"}),e.jsx("button",{type:"submit",className:styles.submitBtn,disabled:!u||l,children:l?"üîÑ Menjam...":"üîê Promeni lozinku"})]})]})};class Te{constructor(){this.channels=[],this.isActive=!1}start(){if(this.isActive)return;console.log("üîÑ Starting realtime service...");const n=X.channel("realtime_extra_rides").on("postgres_changes",{event:"*",schema:"public",table:"extra_rides_pending"},a=>{console.log("üöó Extra rides update:",a.eventType),A.extraRides()}).subscribe(),o=X.channel("realtime_deliveries").on("postgres_changes",{event:"*",schema:"public",table:"deliveries"},a=>{console.log("üì¶ Deliveries update:",a.eventType),A.deliveries(),A.driverStats()}).subscribe(),r=X.channel("realtime_drivers").on("postgres_changes",{event:"*",schema:"public",table:"drivers"},a=>{console.log("üë§ Drivers update:",a.eventType),A.drivers()}).subscribe();this.channels=[n,o,r],this.isActive=!0,console.log("‚úÖ Realtime service started - listening for changes")}stop(){this.isActive&&(console.log("üõë Stopping realtime service..."),this.channels.forEach(n=>{X.removeChannel(n)}),this.channels=[],this.isActive=!1,console.log("‚úÖ Realtime service stopped"))}triggerDataChange(n){switch(console.log(`üîÑ Manual trigger for ${n}`),n){case"extraRides":A.extraRides(),A.driverStats();break;case"deliveries":A.deliveries(),A.driverStats();break;case"drivers":A.drivers();break;default:A.all()}}}const se=new Te,Ie=D.lazy(()=>B(()=>import("./chunk-v5-1760919263206-VtuBIVrN.js").then(m=>m.H),__vite__mapDeps([0,1,2,3,4,5]))),Ae=D.lazy(()=>B(()=>import("./chunk-v5-1760919263206-VtuBIVrN.js").then(m=>m.D),__vite__mapDeps([0,1,2,3,4,5]))),De=D.lazy(()=>B(()=>import("./chunk-v5-1760919263206-VtuBIVrN.js").then(m=>m.c),__vite__mapDeps([0,1,2,3,4,5]))),Re=D.lazy(()=>B(()=>import("./chunk-v5-1760919263206-kZ2zMg4k.js"),__vite__mapDeps([6,1,2,7,3,4,5,0]))),Be=D.lazy(()=>B(()=>import("./chunk-v5-1760919263206-Cc1ffIZR.js").then(m=>m.A),__vite__mapDeps([7,1,2,3,4,5,0]))),Fe=D.lazy(()=>B(()=>import("./chunk-v5-1760919263206-CFy_YwuF.js"),__vite__mapDeps([8,1,2,3,4,0,5]))),He=D.lazy(()=>B(()=>import("./chunk-v5-1760919263206-DvtGGhMw.js"),__vite__mapDeps([9,1,2,3,4]))),We=D.lazy(()=>B(()=>import("./chunk-v5-1760919263206-VtuBIVrN.js").then(m=>m.S),__vite__mapDeps([0,1,2,3,4,5]))),Ve=D.lazy(()=>B(()=>import("./chunk-v5-1760919263206-EFMG49ed.js"),__vite__mapDeps([10,1,2,11,12])));function Oe({onLogout:m}){const[n,o]=i.useState(!1),{currentUser:r,changePassword:a}=te(),d=de(),c=d.pathname==="/"||d.pathname==="",f=async(l,g)=>{await a(l,g)};return i.useEffect(()=>{if(r)return console.log("üöÄ Starting realtime service for user:",r.name),se.start(),()=>{console.log("üõë Stopping realtime service"),se.stop()}},[r]),r?e.jsxs("div",{className:"min-h-screen bg-background text-foreground",children:[e.jsx("main",{className:`app-main${c?" home-fullbleed":""}`,children:e.jsx(D.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}),e.jsx("p",{className:"text-gray-600",children:"Uƒçitava se..."})]})}),children:e.jsxs(ue,{children:[e.jsx(I,{path:"/",element:e.jsx(Ie,{})}),e.jsx(I,{path:"/statistika",element:e.jsx(We,{})}),e.jsx(I,{path:"/navigacija",element:e.jsx(Ve,{})}),e.jsx(I,{path:"/deliveries",element:e.jsx(Ae,{})}),e.jsx(I,{path:"/drivers",element:e.jsx(De,{})}),e.jsx(I,{path:"/extra-rides",element:e.jsx(Re,{})}),e.jsx(I,{path:"/admin",element:(r==null?void 0:r.role)==="admin"?e.jsx(Be,{}):e.jsx(Y,{to:"/"})}),e.jsx(I,{path:"/payroll-list",element:(r==null?void 0:r.role)!=="admin"?e.jsx(Fe,{user:r}):e.jsx(Y,{to:"/"})}),e.jsx(I,{path:"/about",element:e.jsx(He,{})}),e.jsx(I,{path:"*",element:e.jsx(Y,{to:"/"})})]})})}),n&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Ee,{user:r,onClose:()=>o(!1),onChangePassword:async l=>{await f(l.oldPassword,l.newPassword),o(!1)}})})]}):e.jsx("div",{children:"Loading..."})}function Ue(){const{currentUser:m,isAuthenticated:n}=te(),[o,r]=i.useState(!1),[a,d]=i.useState(!1),c=l=>{var g;r(!0),d(!1),l!=null&&l.name&&(localStorage.setItem("DRIVER_NAME",l.name),(g=window.__USER_CONTEXT__)!=null&&g.refreshStatus&&window.__USER_CONTEXT__.refreshStatus(),console.log("[App] DRIVER_NAME postavljen:",l.name))},f=()=>{d(!0),r(!1)};return i.useEffect(()=>{!m&&!n&&r(!1),m&&n&&d(!1)},[m,n]),i.useEffect(()=>{const l=g=>{console.log("Global logout event received",g.detail);try{localStorage.removeItem("bde_current_user")}catch{}try{localStorage.removeItem("bde_login_time")}catch{}f()};return window.addEventListener("bde:logout",l),()=>window.removeEventListener("bde:logout",l)},[]),e.jsx(ce,{basename:"/bde-evidencija",children:e.jsx(Ce,{children:e.jsx(me,{children:e.jsx(fe,{children:e.jsx(je,{children:e.jsx("div",{className:"app",children:(n||o)&&!a?e.jsx(Oe,{onLogout:f}):e.jsx(Le,{onAuthSuccess:c})})})})})})})}console.log("üöÄ BDEVidencija v5.0.0 - ULTRA NUCLEAR FORCE UPDATE - 20251007");console.log("üì± PWA Cache Status: FORCED REFRESH");"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("controllerchange",function(){window.location.reload()});ie(document.getElementById("root")).render(e.jsx(he,{client:xe,children:e.jsx(Ue,{})}));export{se as r};

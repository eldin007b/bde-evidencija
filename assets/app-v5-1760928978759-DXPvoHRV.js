const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/chunk-v5-1760928978759-6CXRxduX.js","assets/chunk-v5-1760928978759-BVLivFZE.js","assets/chunk-v5-1760928978759-DzTHeiPn.js","assets/chunk-v5-1760928978759-Bv_z3hoR.js","assets/chunk-v5-1760928978759-CFK5FL40.js","assets/chunk-v5-1760928978759-67jeV4qK.js","assets/chunk-v5-1760928978759-qiU663mw.js","assets/chunk-v5-1760928978759-BZmwhmgh.js","assets/chunk-v5-1760928978759-BPpsJgZe.js","assets/chunk-v5-1760928978759-jwlmVBC-.js","assets/chunk-v5-1760928978759-zeZs0-km.js","assets/chunk-v5-1760928978759-BsE84rb5.js","assets/asset-v5-1760928978759-Bq-DyqPN.css"])))=>i.map(i=>d[i]);
import{j as e,m as s,A as $}from"./chunk-v5-1760928978759-BVLivFZE.js";import{a as de,r,R,B as ue,d as he,e as pe,f as T,N as te}from"./chunk-v5-1760928978759-DzTHeiPn.js";import{_ as F,a as me}from"./chunk-v5-1760928978759-CFK5FL40.js";import{u as ae,i as B,a as ge,q as xe}from"./chunk-v5-1760928978759-6CXRxduX.js";import{u as ye}from"./chunk-v5-1760928978759-BZmwhmgh.js";import{u as fe,s as Y}from"./chunk-v5-1760928978759-Bv_z3hoR.js";import"./chunk-v5-1760928978759-67jeV4qK.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const d of a)if(d.type==="childList")for(const l of d.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function i(a){const d={};return a.integrity&&(d.integrity=a.integrity),a.referrerPolicy&&(d.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?d.credentials="include":a.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function n(a){if(a.ep)return;a.ep=!0;const d=i(a);fetch(a.href,d)}})();var ne,ie=de;ne=ie.createRoot,ie.hydrateRoot;const be=r.createContext();function ve({children:u}){const t=ye();return e.jsx(be.Provider,{value:t,children:u})}const je=r.createContext(),we=({children:u})=>{const t=fe(),[i,n]=r.useState(!0),[a,d]=r.useState(null);r.useEffect(()=>(i?t.start(a):t.stop(),()=>{t.stop()}),[i,a]);const l={autoSync:t,globalSyncEnabled:i,setGlobalSyncEnabled:n,syncInterval:a,setSyncInterval:d,isAutoSyncRunning:t.isRunning,isSyncInProgress:t.syncInProgress,lastSyncTime:t.lastSyncTime,nextSyncTime:t.nextSyncTime,startAutoSync:t.start,stopAutoSync:t.stop,syncNow:t.syncNow,getLastSyncText:()=>{if(!t.lastSyncTime)return"Nikad";const c=Date.now()-t.lastSyncTime,g=Math.floor(c/(1e3*60)),x=Math.floor(c%(1e3*60)/1e3);return g>0?`prije ${g}min ${x}s`:`prije ${x}s`},getNextSyncText:()=>{if(!t.nextSyncTime||!t.isRunning)return"Iskljuƒçen";const f=Date.now(),c=t.nextSyncTime-f;if(c<=0)return"Uskoro";const g=Math.floor(c/(1e3*60)),x=Math.floor(c%(1e3*60)/1e3);return g>0?`za ${g}min ${x}s`:`za ${x}s`}};return e.jsx(je.Provider,{value:l,children:u})},ke={confirm:"Potvrdi",enterTuraOrPin:"Unesi turu ili PIN",selectLanguage:"Odaberi jezik",enterTuraAndSelectLanguage:"Unesi turu i odaberi jezik",welcome:"Dobrodo≈°li!",setupMessage:"Molimo podes–∏—Ç–µ aplikaciju prije kori≈°ƒáenja.",tourNumber:"Broj ture",tourPlaceholder:"Unesite va≈° broj ture (npr. 8610)",appLanguage:"Jezik aplikacije",finishSetup:"Zavr≈°i pode≈°avanje",setupInfoMessage:"Ove podatke mo≈æete promijeniti kasnije u pode≈°avanjima aplikacije.",unknownTour:"Nepoznat broj ture. Molimo kontaktirajte administratora."},Ne={confirm:"Confirm",enterTuraOrPin:"Enter route or PIN",selectLanguage:"Select language",enterTuraAndSelectLanguage:"Enter route and select language",welcome:"Welcome!",setupMessage:"Please configure the application before use.",tourNumber:"Route number",tourPlaceholder:"Enter your route number (e.g. 8610)",appLanguage:"Application language",finishSetup:"Finish setup",setupInfoMessage:"You can change these settings later in application settings.",unknownTour:"Unknown route number. Please contact administrator."},Se={confirm:"Best√§tigen",enterTuraOrPin:"Route oder PIN eingeben",selectLanguage:"Sprache w√§hlen",enterTuraAndSelectLanguage:"Route eingeben und Sprache w√§hlen",welcome:"Willkommen!",setupMessage:"Bitte konfigurieren Sie die Anwendung vor der Nutzung.",tourNumber:"Routennummer",tourPlaceholder:"Geben Sie Ihre Routennummer ein (z.B. 8610)",appLanguage:"Anwendungssprache",finishSetup:"Setup abschlie√üen",setupInfoMessage:"Sie k√∂nnen diese Einstellungen sp√§ter in den Anwendungseinstellungen √§ndern.",unknownTour:"Unbekannte Routennummer. Bitte kontaktieren Sie den Administrator."},Pe={confirm:"Potrdi",enterTuraOrPin:"Vnesi turo ali PIN",selectLanguage:"Izberi jezik",enterTuraAndSelectLanguage:"Vnesi turo in izberi jezik",welcome:"Dobrodo≈°li!",setupMessage:"Prosimo, konfigurirajte aplikacijo pred uporabo.",tourNumber:"≈†tevilka ture",tourPlaceholder:"Vnesite svojo ≈°tevilko ture (npr. 8610)",appLanguage:"Jezik aplikacije",finishSetup:"Zakljuƒçi nastavitev",setupInfoMessage:"Te nastavitve lahko pozneje spremenite v nastavitvah aplikacije.",unknownTour:"Neznana ≈°tevilka ture. Prosimo, kontaktirajte administratorja."},q={ba:ke,en:Ne,de:Se,si:Pe},_e=r.createContext(),Ie="ba",se={getItem:u=>window.localStorage.getItem(u),setItem:(u,t)=>window.localStorage.setItem(u,t)},Ce=({children:u})=>{const t=se.getItem("APP_LANG")||Ie,[i,n]=r.useState(t),[a,d]=r.useState(q[t]),[l,f]=r.useState(!1);r.useEffect(()=>{(()=>{const v=se.getItem("APP_LANG");v&&q[v]&&v!==i&&(n(v),d(q[v]))})()},[i]);const x={language:i,translations:a,isLoading:l,changeLanguage:w=>{q[w]&&(n(w),d(q[w]),se.setItem("APP_LANG",w))},t:(w,v)=>{const C=w.split(".");let b=a;for(const h of C)if(b&&b[h]!==void 0)b=b[h];else return v||w;return b}};return e.jsx(_e.Provider,{value:x,children:u})};function Ae({onDriverSelected:u,loading:t}){const[i,n]=r.useState(""),[a,d]=r.useState(null),[l,f]=r.useState(!1),[c,g]=r.useState(!1),[x,w]=r.useState("medium"),[v,C]=r.useState(!1),[b,h]=r.useState(!1),[k,p]=r.useState(!1),[o,N]=r.useState(!1);r.useEffect(()=>{const P=window.matchMedia("(prefers-color-scheme: dark)");g(P.matches);const _=D=>g(D.matches);return P.addEventListener("change",_),()=>P.removeEventListener("change",_)},[]),r.useEffect(()=>{const P=_=>{_.key==="Escape"&&(n(""),d(null))};return window.addEventListener("keydown",P),()=>window.removeEventListener("keydown",P)},[]);const W=()=>{navigator.vibrate&&navigator.vibrate(50)},H=P=>{if(P.preventDefault(),!i.trim()){d("Molimo unesite va≈°u turu"),N(!0),W(),setTimeout(()=>N(!1),500);return}if(i.trim().length<3){d("Tura mora imati najmanje 3 karaktera"),N(!0),W(),setTimeout(()=>N(!1),500);return}d(null),p(!0),W(),b&&localStorage.setItem("rememberedTura",i.trim().toUpperCase()),setTimeout(()=>{u(i.trim().toUpperCase())},800)},E=P=>{const _=P.target.value;n(_),_&&_.length<3?d("Tura mora imati najmanje 3 karaktera"):d(null)},U={small:"text-sm",medium:"text-base",large:"text-lg"},O=c?"bg-gradient-to-br from-gray-900 to-blue-900 text-white":"bg-gradient-to-br from-gray-50 to-blue-50 text-gray-800",z=c?"bg-gray-800/90 backdrop-blur-lg border border-gray-700/50":"bg-white/90 backdrop-blur-lg border border-white/50",V=c?"bg-gray-700/50 border-gray-600 text-white placeholder-gray-400 focus:ring-blue-400":"bg-white/80 border-gray-300 text-gray-800 placeholder-gray-500 focus:ring-blue-400",G=c?"bg-blue-700 hover:bg-blue-600 disabled:bg-gray-700":"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-300";return e.jsxs("div",{className:`min-h-screen flex items-center justify-center relative overflow-hidden ${O} ${U[x]} ${v?"contrast-150":""}`,children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[[...Array(20)].map((P,_)=>e.jsx(s.div,{className:`absolute w-2 h-2 rounded-full ${c?"bg-blue-400/20":"bg-blue-300/30"}`,initial:{x:Math.random()*window.innerWidth,y:Math.random()*window.innerHeight},animate:{x:Math.random()*window.innerWidth,y:Math.random()*window.innerHeight},transition:{duration:Math.random()*10+20,repeat:1/0,repeatType:"reverse"}},_)),[...Array(8)].map((P,_)=>e.jsx(s.div,{className:`absolute opacity-20 ${c?"bg-gradient-to-r from-blue-600 to-purple-600":"bg-gradient-to-r from-blue-400 to-cyan-400"}`,style:{width:Math.random()*100+50,height:Math.random()*100+50,borderRadius:Math.random()*50+25,left:Math.random()*100+"%",top:Math.random()*100+"%"},animate:{rotate:360,scale:[1,1.2,1]},transition:{duration:Math.random()*20+30,repeat:1/0}},`shape-${_}`))]}),e.jsxs("div",{className:"absolute top-4 right-4 flex gap-2",children:[e.jsx(s.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>g(!c),className:`w-10 h-10 rounded-full ${z} flex items-center justify-center`,title:"Toggle Dark Mode",children:c?"‚òÄÔ∏è":"üåô"}),e.jsx(s.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>w(x==="small"?"medium":x==="medium"?"large":"small"),className:`w-10 h-10 rounded-full ${z} flex items-center justify-center text-sm`,title:"Font Size",children:"Aa"}),e.jsx(s.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>C(!v),className:`w-10 h-10 rounded-full ${z} flex items-center justify-center`,title:"High Contrast",children:"‚ö´"})]}),e.jsxs(s.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0,...o&&{x:[0,-10,10,-10,10,0],transition:{duration:.5}}},className:`w-full max-w-md ${z} rounded-2xl shadow-2xl p-8 flex flex-col gap-8 relative z-10`,children:[e.jsx($,{children:k&&e.jsx(s.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 pointer-events-none",children:[...Array(15)].map((P,_)=>e.jsx(s.div,{className:"absolute w-2 h-2 bg-green-500 rounded",initial:{x:"50%",y:"50%",scale:0},animate:{x:Math.random()*300-150,y:Math.random()*300-150,scale:1,rotate:Math.random()*360},transition:{duration:.8,delay:_*.05}},_))})}),e.jsxs(s.div,{className:"flex flex-col items-center gap-2",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{delay:.2},children:[e.jsx(s.div,{className:`w-20 h-20 rounded-full flex items-center justify-center mb-2 ${c?"bg-gradient-to-br from-blue-600 to-purple-600":"bg-gradient-to-br from-blue-500 to-cyan-500"}`,animate:{boxShadow:["0 0 20px rgba(59, 130, 246, 0.3)","0 0 30px rgba(59, 130, 246, 0.5)","0 0 20px rgba(59, 130, 246, 0.3)"]},transition:{duration:2,repeat:1/0},children:e.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"text-white",children:[e.jsx(s.path,{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1.5,delay:.5}}),e.jsx(s.circle,{cx:"12",cy:"7",r:"4",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1.5,delay:.8}})]})}),e.jsx(s.h1,{className:`text-2xl font-bold ${c?"text-white":"text-gray-800"}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},children:"Dobrodo≈°li!"}),e.jsx(s.p,{className:`text-center ${c?"text-gray-300":"text-gray-600"}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},children:"Molimo unesite va≈°u turu za pristup aplikaciji"})]}),e.jsxs(s.form,{onSubmit:H,className:"flex flex-col gap-4",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8},children:[e.jsxs("div",{className:"relative",children:[e.jsx(s.input,{type:"text",id:"tura",value:i,onChange:E,onFocus:()=>f(!0),onBlur:()=>f(!1),placeholder:" ",maxLength:"10",disabled:t,autoFocus:!0,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 text-lg peer transition-all duration-300 ${V}`,animate:{scale:l?1.02:1,boxShadow:l?"0 0 20px rgba(59, 130, 246, 0.3)":"0 0 0px rgba(59, 130, 246, 0)"}}),e.jsx(s.label,{htmlFor:"tura",className:`absolute left-4 transition-all duration-300 pointer-events-none ${c?"text-gray-400":"text-gray-500"} ${l||i?"-top-2 text-xs bg-inherit px-2 font-medium":"top-3 text-base"}`,animate:{color:l?"#3b82f6":c?"#9ca3af":"#6b7280"},children:"Va≈°a tura"}),e.jsx(s.span,{className:`absolute right-3 top-1/2 -translate-y-1/2 ${l?"text-blue-400":c?"text-gray-500":"text-gray-400"}`,animate:{rotate:l?360:0,scale:l?1.1:1},transition:{duration:.3},children:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"8.5",cy:"7",r:"4"}),e.jsx("path",{d:"m20 8 2 2-2 2"}),e.jsx("path",{d:"m16 12-2-2 2-2"})]})}),i&&!a&&e.jsx(s.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},className:"absolute right-12 top-1/2 -translate-y-1/2",children:e.jsx("div",{className:"flex gap-1",children:[0,1,2].map(P=>e.jsx(s.div,{className:"w-1 h-1 bg-green-500 rounded-full",animate:{scale:[1,1.5,1],opacity:[.3,1,.3]},transition:{duration:1,repeat:1/0,delay:P*.2}},P))})})]}),e.jsx($,{children:a&&e.jsxs(s.div,{initial:{opacity:0,height:0,scale:.8},animate:{opacity:1,height:"auto",scale:1},exit:{opacity:0,height:0,scale:.8},className:`flex items-center gap-2 border rounded-lg px-3 py-2 ${c?"bg-red-900/20 border-red-800 text-red-400":"bg-red-50 border-red-200 text-red-700"}`,children:[e.jsxs(s.svg,{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"text-red-500",animate:{rotate:[0,10,-10,0]},transition:{duration:.5},children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),e.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),e.jsx("span",{children:a})]})}),e.jsxs(s.label,{className:"flex items-center gap-2 text-sm cursor-pointer",whileHover:{scale:1.02},children:[e.jsx("input",{type:"checkbox",checked:b,onChange:P=>h(P.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:c?"text-gray-300":"text-gray-600",children:"Zapamti ovaj ureƒëaj"})]}),e.jsxs(s.button,{type:"submit",className:`relative overflow-hidden w-full flex items-center justify-center gap-2 font-semibold py-3 rounded-lg shadow transition-all duration-300 ${G}`,disabled:t||!i.trim(),whileHover:{scale:1.02},whileTap:{scale:.98},animate:o?{x:[0,-10,10,-10,10,0]}:{},children:[e.jsx(s.div,{className:"absolute inset-0 bg-white/20 rounded-full pointer-events-none",initial:{scale:0,opacity:1},animate:{scale:4,opacity:0},transition:{duration:.6}}),t?e.jsxs(e.Fragment,{children:[e.jsx(s.span,{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}}),"Provjeravam..."]}):k?e.jsxs(e.Fragment,{children:[e.jsxs(s.svg,{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:500,damping:30},children:[e.jsx("path",{d:"m9 12 2 2 4-4"}),e.jsx("circle",{cx:"12",cy:"12",r:"10"})]}),"Uspje≈°no!"]}):e.jsxs(e.Fragment,{children:[e.jsx(s.svg,{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",whileHover:{x:5},transition:{type:"spring",stiffness:400,damping:30},children:e.jsx("path",{d:"m9 18 6-6-6-6"})}),"Nastavi"]})]})]}),e.jsxs(s.div,{className:"flex flex-col items-center gap-2 mt-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1.2},children:[e.jsx(s.div,{className:`w-12 h-12 rounded-full flex items-center justify-center ${c?"bg-gradient-to-br from-gray-700 to-gray-600":"bg-gradient-to-br from-gray-100 to-gray-200"}`,animate:{rotate:[0,5,-5,0]},transition:{duration:3,repeat:1/0,ease:"easeInOut"},children:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:c?"text-gray-300":"text-gray-500",children:[e.jsx(s.path,{d:"M18 20V10",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1,delay:1.5}}),e.jsx(s.path,{d:"M12 20V4",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1,delay:1.7}}),e.jsx(s.path,{d:"M6 20v-6",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1,delay:1.9}})]})}),e.jsx(s.p,{className:`text-sm ${c?"text-gray-400":"text-gray-500"}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:1.4},children:"B&D Evidencija ‚Ä¢ Aplikacija za evidenciju vo≈ænji"}),e.jsx(s.div,{className:`px-3 py-1 rounded-full text-xs font-semibold ${c?"bg-blue-800/50 text-blue-300":"bg-blue-100 text-blue-600"}`,initial:{scale:0},animate:{scale:1},transition:{delay:1.6,type:"spring",stiffness:500,damping:30},whileHover:{scale:1.1},children:"v5.0.0"})]})]})]})}function Me({driver:u,onContinue:t,onLogin:i,onBack:n,loading:a}){const[d,l]=r.useState(""),[f,c]=r.useState(!1),[g,x]=r.useState(null),[w,v]=r.useState(!1),[C,b]=r.useState(!1),[h,k]=r.useState(!1),[p,o]=r.useState("medium"),[N,W]=r.useState(!1),[H,E]=r.useState(!1),[U,O]=r.useState(!1);r.useEffect(()=>{const I=window.matchMedia("(prefers-color-scheme: dark)");k(I.matches);const j=J=>k(J.matches);return I.addEventListener("change",j),()=>I.removeEventListener("change",j)},[]),r.useEffect(()=>{const I=j=>{j.key==="Escape"&&(l(""),x(null))};return window.addEventListener("keydown",I),()=>window.removeEventListener("keydown",I)},[]);const z=()=>{navigator.vibrate&&navigator.vibrate(50)},V=I=>{if(I.preventDefault(),!d.trim()){x("Molimo unesite lozinku"),O(!0),z(),setTimeout(()=>O(!1),500);return}x(null),E(!0),z(),setTimeout(()=>{i(u.tura,d,f)},800)},G=I=>{const j=I.target.value;l(j),j&&j.length<4?x("Lozinka mora imati najmanje 4 karaktera"):x(null)},P={small:"text-sm",medium:"text-base",large:"text-lg"},_=h?"bg-gradient-to-br from-gray-900 to-blue-900 text-white":"bg-gradient-to-br from-gray-50 to-blue-50 text-gray-800",D=h?"bg-gray-800/90 backdrop-blur-lg border border-gray-700/50":"bg-white/90 backdrop-blur-lg border border-white/50",K=h?"bg-gray-700/50 border-gray-600 text-white placeholder-gray-400 focus:ring-blue-400":"bg-white/80 border-gray-300 text-gray-800 placeholder-gray-500 focus:ring-blue-400",A=h?"bg-blue-700 hover:bg-blue-600 disabled:bg-gray-700":"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-300";return e.jsxs("div",{className:`min-h-screen flex items-center justify-center relative overflow-hidden ${_} ${P[p]} ${N?"contrast-150":""}`,children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[[...Array(15)].map((I,j)=>e.jsx(s.div,{className:`absolute w-2 h-2 rounded-full ${h?"bg-blue-400/20":"bg-blue-300/30"}`,initial:{x:Math.random()*window.innerWidth,y:Math.random()*window.innerHeight},animate:{x:Math.random()*window.innerWidth,y:Math.random()*window.innerHeight},transition:{duration:Math.random()*10+20,repeat:1/0,repeatType:"reverse"}},j)),[...Array(6)].map((I,j)=>e.jsx(s.div,{className:`absolute opacity-20 ${h?"bg-gradient-to-r from-blue-600 to-purple-600":"bg-gradient-to-r from-blue-400 to-cyan-400"}`,style:{width:Math.random()*80+40,height:Math.random()*80+40,borderRadius:Math.random()*40+20,left:Math.random()*100+"%",top:Math.random()*100+"%"},animate:{rotate:360,scale:[1,1.1,1]},transition:{duration:Math.random()*15+25,repeat:1/0}},`shape-${j}`))]}),e.jsxs("div",{className:"absolute top-4 right-4 flex gap-2",children:[e.jsx(s.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>k(!h),className:`w-10 h-10 rounded-full ${D} flex items-center justify-center`,title:"Toggle Dark Mode",children:h?"‚òÄÔ∏è":"üåô"}),e.jsx(s.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>o(p==="small"?"medium":p==="medium"?"large":"small"),className:`w-10 h-10 rounded-full ${D} flex items-center justify-center text-sm`,title:"Font Size",children:"Aa"}),e.jsx(s.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>W(!N),className:`w-10 h-10 rounded-full ${D} flex items-center justify-center`,title:"High Contrast",children:"‚ö´"})]}),e.jsxs(s.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0,...U&&{x:[0,-10,10,-10,10,0],transition:{duration:.5}}},className:`w-full max-w-lg ${D} rounded-2xl shadow-2xl p-8 flex flex-col gap-6 relative z-10`,children:[e.jsx($,{children:H&&e.jsx(s.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 pointer-events-none",children:[...Array(12)].map((I,j)=>e.jsx(s.div,{className:"absolute w-2 h-2 bg-green-500 rounded",initial:{x:"50%",y:"50%",scale:0},animate:{x:Math.random()*250-125,y:Math.random()*250-125,scale:1,rotate:Math.random()*360},transition:{duration:.8,delay:j*.05}},j))})}),e.jsxs(s.div,{className:"flex flex-col items-center gap-3",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{delay:.2},children:[e.jsx(s.div,{className:`w-16 h-16 rounded-full flex items-center justify-center mb-2 ${h?"bg-gradient-to-br from-green-600 to-blue-600":"bg-gradient-to-br from-green-500 to-blue-500"}`,animate:{boxShadow:["0 0 20px rgba(34, 197, 94, 0.3)","0 0 30px rgba(34, 197, 94, 0.5)","0 0 20px rgba(34, 197, 94, 0.3)"]},transition:{duration:2,repeat:1/0},children:e.jsxs(s.svg,{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"text-white",initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:500,damping:30,delay:.3},children:[e.jsx(s.path,{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1.5,delay:.5}}),e.jsx(s.circle,{cx:"12",cy:"7",r:"4",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1.5,delay:.8}})]})}),e.jsx(s.h1,{className:`text-2xl font-bold ${h?"text-white":"text-gray-800"}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},children:"Vozaƒç pronaƒëen"}),e.jsx(s.p,{className:`text-center ${h?"text-gray-300":"text-gray-600"}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},children:"Uspje≈°no smo identificirali va≈° profil"})]}),e.jsx(s.div,{className:`${D} rounded-xl p-4 shadow-lg`,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.8},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(s.h2,{className:`text-xl font-bold ${h?"text-white":"text-gray-800"}`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:1},children:u.ime}),e.jsxs("div",{className:"flex flex-col gap-2 mt-3",children:[e.jsxs(s.div,{className:"flex items-center gap-2",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:1.2},children:[e.jsx("span",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${h?"bg-blue-700/50":"bg-blue-100"}`,children:e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:h?"text-blue-300":"text-blue-600",children:[e.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"8.5",cy:"7",r:"4"}),e.jsx("path",{d:"m20 8 2 2-2 2"}),e.jsx("path",{d:"m16 12-2-2 2-2"})]})}),e.jsxs("span",{className:`font-medium ${h?"text-gray-200":"text-gray-700"}`,children:["Tura: ",u.tura]})]}),e.jsxs(s.div,{className:"flex items-center gap-2",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:1.4},children:[e.jsx("span",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${h?"bg-purple-700/50":"bg-purple-100"}`,children:e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:h?"text-purple-300":"text-purple-600",children:[e.jsx("path",{d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"}),e.jsx("path",{d:"m19.4 15-1.1-2.3c-.4-.8-1.2-1.3-2.1-1.3H7.8c-.9 0-1.7.5-2.1 1.3L4.6 15"}),e.jsx("path",{d:"M12 8v7"})]})}),e.jsx("span",{className:`font-medium ${h?"text-gray-200":"text-gray-700"}`,children:u.role==="admin"?"Administrator":"Vozaƒç"})]})]})]}),e.jsx(s.div,{className:"flex flex-col items-center",initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},transition:{delay:1.6},children:u.hasPassword?e.jsxs("div",{className:`flex items-center gap-2 px-3 py-2 rounded-lg ${h?"bg-green-800/50 text-green-300":"bg-green-100 text-green-700"}`,children:[e.jsxs(s.svg,{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",animate:{scale:[1,1.1,1]},transition:{duration:2,repeat:1/0},children:[e.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),e.jsx("circle",{cx:"12",cy:"16",r:"1"}),e.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),e.jsx("span",{className:"text-sm font-medium",children:"Veƒá imate lozinku"})]}):e.jsxs("div",{className:`flex items-center gap-2 px-3 py-2 rounded-lg ${h?"bg-orange-800/50 text-orange-300":"bg-orange-100 text-orange-700"}`,children:[e.jsxs(s.svg,{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",animate:{scale:[1,1.1,1]},transition:{duration:2,repeat:1/0},children:[e.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),e.jsx("path",{d:"M7 11V7a5 5 0 0 1 9.9-1"})]}),e.jsx("span",{className:"text-sm font-medium",children:"Potrebno je postaviti lozinku"})]})})]})}),u.hasPassword?e.jsxs(s.form,{onSubmit:V,className:"flex flex-col gap-4",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1.8},children:[e.jsxs("div",{className:"relative",children:[e.jsx(s.input,{type:w?"text":"password",id:"password",value:d,onChange:G,onFocus:()=>b(!0),onBlur:()=>b(!1),placeholder:" ",disabled:a,autoFocus:!0,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 text-lg peer transition-all duration-300 ${K}`,animate:{scale:C?1.02:1,boxShadow:C?"0 0 20px rgba(59, 130, 246, 0.3)":"0 0 0px rgba(59, 130, 246, 0)"}}),e.jsx(s.label,{htmlFor:"password",className:`absolute left-4 transition-all duration-300 pointer-events-none ${h?"text-gray-400":"text-gray-500"} ${C||d?"-top-2 text-xs bg-inherit px-2 font-medium":"top-3 text-base"}`,animate:{color:C?"#3b82f6":h?"#9ca3af":"#6b7280"},children:"Lozinka"}),e.jsx(s.button,{type:"button",className:`absolute right-3 top-1/2 -translate-y-1/2 p-1 rounded ${h?"text-gray-400 hover:text-gray-200":"text-gray-500 hover:text-gray-700"}`,onClick:()=>v(!w),disabled:a,whileHover:{scale:1.1},whileTap:{scale:.9},children:e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:w?e.jsxs(e.Fragment,{children:[e.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"}),e.jsx("path",{d:"m1 1 22 22"})]}):e.jsxs(e.Fragment,{children:[e.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),e.jsx("circle",{cx:"12",cy:"12",r:"3"})]})})}),d&&!g&&e.jsx(s.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},className:"absolute right-12 top-1/2 -translate-y-1/2",children:e.jsx("div",{className:"flex gap-1",children:[0,1,2].map(I=>e.jsx(s.div,{className:"w-1 h-1 bg-green-500 rounded-full",animate:{scale:[1,1.5,1],opacity:[.3,1,.3]},transition:{duration:1,repeat:1/0,delay:I*.2}},I))})})]}),e.jsx($,{children:g&&e.jsxs(s.div,{initial:{opacity:0,height:0,scale:.8},animate:{opacity:1,height:"auto",scale:1},exit:{opacity:0,height:0,scale:.8},className:`flex items-center gap-2 border rounded-lg px-3 py-2 ${h?"bg-red-900/20 border-red-800 text-red-400":"bg-red-50 border-red-200 text-red-700"}`,children:[e.jsxs(s.svg,{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"text-red-500",animate:{rotate:[0,10,-10,0]},transition:{duration:.5},children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),e.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),e.jsx("span",{children:g})]})}),e.jsxs(s.label,{className:"flex items-center gap-2 text-sm cursor-pointer",whileHover:{scale:1.02},children:[e.jsx("input",{type:"checkbox",checked:f,onChange:I=>c(I.target.checked),disabled:a,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:h?"text-gray-300":"text-gray-600",children:"Zapamti me"})]}),e.jsxs("div",{className:"flex gap-3 mt-4",children:[e.jsxs(s.button,{type:"button",className:`flex-1 flex items-center justify-center gap-2 font-semibold py-3 rounded-lg border transition-all duration-300 ${h?"border-gray-600 text-gray-300 hover:bg-gray-700/50":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,onClick:n,disabled:a,whileHover:{scale:1.02},whileTap:{scale:.98},children:[e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"m15 18-6-6 6-6"})}),"Nazad"]}),e.jsxs(s.button,{type:"submit",className:`flex-2 relative overflow-hidden flex items-center justify-center gap-2 font-semibold py-3 rounded-lg shadow transition-all duration-300 ${A}`,disabled:a||!d.trim(),whileHover:{scale:1.02},whileTap:{scale:.98},animate:U?{x:[0,-10,10,-10,10,0]}:{},children:[e.jsx(s.div,{className:"absolute inset-0 bg-white/20 rounded-full pointer-events-none",initial:{scale:0,opacity:1},animate:{scale:4,opacity:0},transition:{duration:.6}}),a?e.jsxs(e.Fragment,{children:[e.jsx(s.span,{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}}),"Prijavljivam..."]}):H?e.jsxs(e.Fragment,{children:[e.jsxs(s.svg,{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:500,damping:30},children:[e.jsx("path",{d:"m9 12 2 2 4-4"}),e.jsx("circle",{cx:"12",cy:"12",r:"10"})]}),"Uspje≈°no!"]}):e.jsxs(e.Fragment,{children:[e.jsx(s.svg,{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",whileHover:{x:5},transition:{type:"spring",stiffness:400,damping:30},children:e.jsx("path",{d:"m9 18 6-6-6-6"})}),"Prijavite se"]})]})]})]}):e.jsxs(s.div,{className:"flex gap-3 mt-4",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1.8},children:[e.jsxs(s.button,{type:"button",className:`flex-1 flex items-center justify-center gap-2 font-semibold py-3 rounded-lg border transition-all duration-300 ${h?"border-gray-600 text-gray-300 hover:bg-gray-700/50":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,onClick:n,disabled:a,whileHover:{scale:1.02},whileTap:{scale:.98},children:[e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"m15 18-6-6 6-6"})}),"Nazad"]}),e.jsxs(s.button,{type:"button",className:`flex-2 relative overflow-hidden flex items-center justify-center gap-2 font-semibold py-3 rounded-lg shadow transition-all duration-300 ${A}`,onClick:t,disabled:a,whileHover:{scale:1.02},whileTap:{scale:.98},children:[e.jsx(s.div,{className:"absolute inset-0 bg-white/20 rounded-full pointer-events-none",initial:{scale:0,opacity:1},animate:{scale:4,opacity:0},transition:{duration:.6}}),a?e.jsxs(e.Fragment,{children:[e.jsx(s.span,{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}}),"Molim saƒçekajte..."]}):e.jsxs(e.Fragment,{children:[e.jsxs(s.svg,{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",whileHover:{x:5},transition:{type:"spring",stiffness:400,damping:30},children:[e.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),e.jsx("path",{d:"M7 11V7a5 5 0 0 1 9.9-1"})]}),"Postavite lozinku"]})]})]}),e.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:2},children:[e.jsx(s.div,{className:`w-10 h-10 rounded-full flex items-center justify-center ${h?"bg-gradient-to-br from-gray-700 to-gray-600":"bg-gradient-to-br from-gray-100 to-gray-200"}`,animate:{rotate:[0,5,-5,0]},transition:{duration:3,repeat:1/0,ease:"easeInOut"},children:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:h?"text-gray-300":"text-gray-500",children:[e.jsx(s.rect,{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1,delay:2.2}}),e.jsx(s.circle,{cx:"12",cy:"16",r:"1",initial:{scale:0},animate:{scale:1},transition:{duration:.5,delay:2.4}}),e.jsx(s.path,{d:"M7 11V7a5 5 0 0 1 10 0v4",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1,delay:2}})]})}),e.jsx(s.p,{className:`text-sm text-center ${h?"text-gray-400":"text-gray-500"}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:2.2},children:"Provjerite da li su podaci ispravni prije nastavka"})]})]})]})}function $e({driver:u,onPasswordSet:t,onBack:i,loading:n}){const[a,d]=r.useState(""),[l,f]=r.useState(""),[c,g]=r.useState(!1),[x,w]=r.useState(!1),[v,C]=r.useState(!0),[b,h]=r.useState(""),[k,p]=r.useState(""),[o,N]=r.useState(()=>localStorage.getItem("theme")==="dark"||!localStorage.getItem("theme")&&window.matchMedia("(prefers-color-scheme: dark)").matches),[W,H]=r.useState(()=>localStorage.getItem("fontSize")||"medium"),[E,U]=r.useState(()=>localStorage.getItem("highContrast")==="true"),[O,z]=r.useState(!1),[V,G]=r.useState([]),[P,_]=r.useState(!1),[D,K]=r.useState([]),[A,I]=r.useState({score:0,feedback:"Unesite lozinku"}),j={background:o?"bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900":"bg-gradient-to-br from-purple-50 via-white to-pink-50",container:o?"bg-gray-800/40 backdrop-blur-xl border-gray-700/50":"bg-white/40 backdrop-blur-xl border-white/50",card:o?"bg-gray-800/60 backdrop-blur-xl border-gray-700/50":"bg-white/60 backdrop-blur-xl border-white/60",input:o?"bg-gray-800/60 border-gray-600 text-white placeholder-gray-400 focus:border-purple-500 focus:bg-gray-800/80":"bg-white/60 border-gray-200 text-gray-900 placeholder-gray-500 focus:border-purple-500 focus:bg-white/80",text:o?"text-gray-100":"text-gray-900"},J=`${j.container} ${W==="small"?"text-sm":W==="large"?"text-lg":"text-base"} ${E?"contrast-125":""}`,Q=`${j.card} ${E?"shadow-2xl":"shadow-xl"}`,ee=`${j.input} ${E?"shadow-inner border-2":"border"}`,oe=m=>{if(!m)return{score:0,feedback:"Unesite lozinku"};let S=0,M="";m.length>=8&&S++,m.length>=12&&S++,/[a-z]/.test(m)&&S++,/[A-Z]/.test(m)&&S++,/[0-9]/.test(m)&&S++,/[^a-zA-Z0-9]/.test(m)&&S++;const X=Math.min(Math.max(Math.floor(S/1.5),1),4);switch(X){case 1:M="Slaba lozinka";break;case 2:M="Umjereno jaka lozinka";break;case 3:M="Jaka lozinka";break;case 4:M="Vrlo jaka lozinka";break;default:M="Unesite lozinku"}return{score:X,feedback:M}};r.useEffect(()=>{(()=>{const S=Array.from({length:20},(M,X)=>({id:X,x:Math.random()*100,y:Math.random()*100,size:Math.random()*4+1,duration:Math.random()*20+10,delay:Math.random()*5,opacity:Math.random()*.5+.1}));G(S)})()},[]),r.useEffect(()=>{I(oe(a))},[a]),r.useEffect(()=>{localStorage.setItem("theme",o?"dark":"light"),document.documentElement.classList.toggle("dark",o)},[o]),r.useEffect(()=>{localStorage.setItem("fontSize",W)},[W]),r.useEffect(()=>{localStorage.setItem("highContrast",E.toString())},[E]),r.useEffect(()=>{const m=S=>{S.ctrlKey&&S.key==="d"&&(S.preventDefault(),N(!o)),S.ctrlKey&&S.key==="="&&(S.preventDefault(),H(M=>M==="small"?"medium":"large")),S.ctrlKey&&S.key==="-"&&(S.preventDefault(),H(M=>M==="large"?"medium":"small")),S.key==="Escape"&&z(!1)};return window.addEventListener("keydown",m),()=>window.removeEventListener("keydown",m)},[o]);const le=()=>{const m=Array.from({length:50},(S,M)=>({id:M,x:Math.random()*100,y:-10,rotation:Math.random()*360,scale:Math.random()*.8+.4,color:["#8b5cf6","#ec4899","#06b6d4","#10b981","#f59e0b"][Math.floor(Math.random()*5)]}));K(m),setTimeout(()=>K([]),3e3)},Z=()=>{navigator.vibrate&&navigator.vibrate(50)},ce=async m=>{if(m.preventDefault(),!a.trim()||!l.trim()){h("Molimo unesite oba polja"),Z();return}if(a!==l){h("Lozinke se ne poklapaju"),Z();return}if(A.score<2){h("Lozinka mora biti jaƒça"),Z();return}h(""),_(!0),le();try{await t(a,v)}catch(S){h(S.message||"Gre≈°ka pri postavljanju lozinke"),_(!1),Z()}};return e.jsxs("div",{className:`min-h-screen relative overflow-hidden ${j.background}`,children:[e.jsx("div",{className:"absolute inset-0 overflow-hidden",children:V.map(m=>e.jsx(s.div,{className:`absolute w-2 h-2 rounded-full ${o?"bg-purple-400/20":"bg-purple-500/10"}`,style:{left:`${m.x}%`,top:`${m.y}%`,width:`${m.size}px`,height:`${m.size}px`},animate:{y:[0,-30,0],opacity:[m.opacity,m.opacity*1.5,m.opacity],scale:[1,1.2,1]},transition:{duration:m.duration,delay:m.delay,repeat:1/0,ease:"easeInOut"}},m.id))}),e.jsx($,{children:D.map(m=>e.jsx(s.div,{className:"absolute w-3 h-3 rounded-sm",style:{left:`${m.x}%`,backgroundColor:m.color,rotate:m.rotation,scale:m.scale},initial:{y:-50},animate:{y:window.innerHeight+100,rotate:m.rotation+360*2,opacity:[1,1,0]},transition:{duration:3,ease:"easeIn"},exit:{opacity:0}},m.id))}),e.jsx($,{children:O&&e.jsx(s.div,{className:"fixed top-4 right-4 z-50",initial:{opacity:0,x:20,scale:.9},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:20,scale:.9},children:e.jsxs("div",{className:`${Q} p-4 rounded-2xl border shadow-2xl min-w-[200px]`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:`font-semibold ${j.text}`,children:"Postavke"}),e.jsx("button",{onClick:()=>z(!1),className:`p-1 rounded-lg transition-colors ${o?"hover:bg-gray-700":"hover:bg-gray-100"}`,children:e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:j.text,children:[e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:o,onChange:m=>N(m.target.checked),className:"rounded"}),e.jsx("span",{className:`text-sm ${j.text}`,children:"Tamna tema"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:E,onChange:m=>U(m.target.checked),className:"rounded"}),e.jsx("span",{className:`text-sm ${j.text}`,children:"Visoki kontrast"})]}),e.jsxs("div",{children:[e.jsx("label",{className:`text-sm ${j.text} block mb-1`,children:"Veliƒçina fonta"}),e.jsxs("select",{value:W,onChange:m=>H(m.target.value),className:`w-full p-1 rounded text-sm ${ee}`,children:[e.jsx("option",{value:"small",children:"Mala"}),e.jsx("option",{value:"medium",children:"Srednja"}),e.jsx("option",{value:"large",children:"Velika"})]})]})]}),e.jsx("div",{className:`mt-3 pt-3 border-t ${o?"border-gray-700":"border-gray-200"}`,children:e.jsxs("p",{className:`text-xs ${o?"text-gray-400":"text-gray-500"}`,children:["Ctrl+D: Tamna tema",e.jsx("br",{}),"Ctrl++/-: Veliƒçina fonta"]})})]})})}),e.jsx(s.button,{onClick:()=>z(!O),className:`fixed top-4 right-4 z-40 p-3 rounded-full ${Q} border shadow-lg transition-all duration-300 ${o?"hover:bg-gray-700":"hover:bg-gray-50"}`,whileHover:{scale:1.05},whileTap:{scale:.95},initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},transition:{delay:.5},children:e.jsxs(s.svg,{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:j.text,animate:{rotate:O?180:0},transition:{duration:.3},children:[e.jsx("circle",{cx:"12",cy:"12",r:"3"}),e.jsx("path",{d:"m12 1 1.7 1.7"}),e.jsx("path",{d:"m12 23-1.7-1.7"}),e.jsx("path",{d:"m5.6 5.6 1.4 1.4"}),e.jsx("path",{d:"m18.4 18.4-1.4-1.4"}),e.jsx("path",{d:"m1 12 1.7-1.7"}),e.jsx("path",{d:"m23 12-1.7 1.7"}),e.jsx("path",{d:"m5.6 18.4 1.4-1.4"}),e.jsx("path",{d:"m18.4 5.6-1.4 1.4"})]})}),e.jsx("div",{className:"relative z-10 min-h-screen flex items-center justify-center p-4",children:e.jsxs(s.div,{className:`w-full max-w-md ${J} rounded-3xl border p-8 shadow-2xl space-y-8`,initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},transition:{duration:.5},children:[e.jsxs(s.div,{className:"flex flex-col items-center gap-3",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{delay:.2},children:[e.jsx(s.div,{className:`w-16 h-16 rounded-full flex items-center justify-center mb-2 ${o?"bg-gradient-to-br from-purple-600 to-pink-600":"bg-gradient-to-br from-purple-500 to-pink-500"}`,animate:{boxShadow:["0 0 20px rgba(168, 85, 247, 0.3)","0 0 30px rgba(168, 85, 247, 0.5)","0 0 20px rgba(168, 85, 247, 0.3)"]},transition:{duration:2,repeat:1/0},children:e.jsxs(s.svg,{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"text-white",initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:500,damping:30,delay:.3},children:[e.jsx(s.rect,{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1.5,delay:.5}}),e.jsx(s.circle,{cx:"12",cy:"16",r:"1",initial:{scale:0},animate:{scale:1},transition:{duration:.5,delay:1}}),e.jsx(s.path,{d:"M7 11V7a5 5 0 0 1 10 0v4",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1.5,delay:.8}})]})}),e.jsx(s.h1,{className:`text-2xl font-bold ${o?"text-white":"text-gray-800"}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},children:"Postavite lozinku"}),e.jsx(s.p,{className:`text-center ${o?"text-gray-300":"text-gray-600"}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},children:"Ovo je va≈° prvi put. Molimo postavite lozinku za buduƒái pristup."})]}),e.jsx(s.div,{className:`${Q} rounded-xl p-4 shadow-lg`,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.8},children:e.jsxs("div",{className:"flex items-center justify-center gap-6",children:[e.jsxs(s.div,{className:"flex items-center gap-2",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:1},children:[e.jsx("span",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${o?"bg-purple-700/50":"bg-purple-100"}`,children:e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:o?"text-purple-300":"text-purple-600",children:[e.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),e.jsxs("span",{className:`font-medium ${o?"text-gray-200":"text-gray-700"}`,children:[e.jsx("strong",{children:"Vozaƒç:"})," ",u.ime]})]}),e.jsxs(s.div,{className:"flex items-center gap-2",initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:1.2},children:[e.jsx("span",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${o?"bg-blue-700/50":"bg-blue-100"}`,children:e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:o?"text-blue-300":"text-blue-600",children:[e.jsx("circle",{cx:"12",cy:"12",r:"3"}),e.jsx("path",{d:"M12 1v6m0 6v6"})]})}),e.jsxs("span",{className:`font-medium ${o?"text-gray-200":"text-gray-700"}`,children:[e.jsx("strong",{children:"Tura:"})," ",u.tura]})]})]})}),e.jsxs(s.form,{onSubmit:ce,className:"flex flex-col gap-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1.4},children:[e.jsxs(s.div,{className:"relative",animate:b?{x:[-10,10,-10,10,0]}:{},transition:{type:"spring",stiffness:500,damping:30},children:[e.jsxs("div",{className:"relative",children:[e.jsx(s.input,{type:c?"text":"password",value:a,onChange:m=>d(m.target.value),className:`w-full px-4 pt-6 pb-2 border-2 rounded-xl transition-all duration-300 ${ee} peer ${b?"border-red-500 bg-red-50/50":a?"border-purple-500 bg-purple-50/20":""}`,placeholder:" ",onFocus:()=>p("password"),onBlur:()=>p(""),initial:{opacity:0},animate:{opacity:1},transition:{delay:1.6},disabled:n,autoFocus:!0}),e.jsx(s.label,{className:`absolute left-4 transition-all duration-300 pointer-events-none ${a||k==="password"?`text-xs top-2 ${o?"text-purple-400":"text-purple-600"}`:`text-base top-4 ${o?"text-gray-400":"text-gray-500"}`}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:1.8},children:"Lozinka"}),e.jsx($,{children:a&&e.jsx(s.button,{type:"button",onClick:()=>g(!c),className:`absolute right-3 top-1/2 -translate-y-1/2 p-2 rounded-lg transition-colors ${o?"text-gray-400 hover:text-white hover:bg-gray-700":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},exit:{opacity:0,scale:0},whileHover:{scale:1.1},whileTap:{scale:.9},disabled:n,children:c?e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"}),e.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}):e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),e.jsx("circle",{cx:"12",cy:"12",r:"3"})]})})})]}),e.jsx($,{children:a&&e.jsxs(s.div,{className:"mt-3 space-y-2",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:[e.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4].map(m=>e.jsx(s.div,{className:`h-1 rounded-full flex-1 ${m<=A.score?A.score===1?"bg-red-500":A.score===2?"bg-orange-500":A.score===3?"bg-yellow-500":"bg-green-500":o?"bg-gray-700":"bg-gray-200"}`,initial:{scaleX:0},animate:{scaleX:m<=A.score?1:0},transition:{delay:m*.1}},m))}),e.jsx(s.p,{className:`text-sm ${A.score===1?"text-red-500":A.score===2?"text-orange-500":A.score===3?"text-yellow-500":"text-green-500"}`,initial:{opacity:0},animate:{opacity:1},children:A.feedback})]})})]}),e.jsxs(s.div,{className:"relative",animate:b?{x:[-10,10,-10,10,0]}:{},transition:{type:"spring",stiffness:500,damping:30},children:[e.jsxs("div",{className:"relative",children:[e.jsx(s.input,{type:x?"text":"password",value:l,onChange:m=>f(m.target.value),className:`w-full px-4 pt-6 pb-2 border-2 rounded-xl transition-all duration-300 ${ee} peer ${b?"border-red-500 bg-red-50/50":l?"border-purple-500 bg-purple-50/20":""}`,placeholder:" ",onFocus:()=>p("confirmPassword"),onBlur:()=>p(""),initial:{opacity:0},animate:{opacity:1},transition:{delay:2},disabled:n}),e.jsx(s.label,{className:`absolute left-4 transition-all duration-300 pointer-events-none ${l||k==="confirmPassword"?`text-xs top-2 ${o?"text-purple-400":"text-purple-600"}`:`text-base top-4 ${o?"text-gray-400":"text-gray-500"}`}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:2.2},children:"Potvrdite lozinku"}),e.jsx($,{children:l&&e.jsx(s.button,{type:"button",onClick:()=>w(!x),className:`absolute right-3 top-1/2 -translate-y-1/2 p-2 rounded-lg transition-colors ${o?"text-gray-400 hover:text-white hover:bg-gray-700":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},exit:{opacity:0,scale:0},whileHover:{scale:1.1},whileTap:{scale:.9},disabled:n,children:x?e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"}),e.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}):e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),e.jsx("circle",{cx:"12",cy:"12",r:"3"})]})})})]}),e.jsx($,{children:l&&e.jsxs(s.div,{className:`mt-2 flex items-center gap-2 text-sm ${a===l?"text-green-500":"text-red-500"}`,initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},children:[a===l?e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("polyline",{points:"20,6 9,17 4,12"})}):e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),e.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),a===l?"Lozinke se poklapaju":"Lozinke se ne poklapaju"]})})]}),e.jsx($,{children:b&&e.jsxs(s.div,{className:`p-4 rounded-xl flex items-center gap-3 ${o?"bg-red-900/30 border border-red-800 text-red-300":"bg-red-50 border border-red-200 text-red-700"}`,initial:{opacity:0,scale:.95,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-10},children:[e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),e.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),b]})}),e.jsx($,{children:P&&e.jsxs(s.div,{className:`p-4 rounded-xl flex items-center gap-3 ${o?"bg-green-900/30 border border-green-800 text-green-300":"bg-green-50 border border-green-200 text-green-700"}`,initial:{opacity:0,scale:.95,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-10},children:[e.jsx(s.svg,{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:500,damping:30},children:e.jsx("polyline",{points:"20,6 9,17 4,12"})}),"Lozinka je uspje≈°no postavljena! Ulogujemo vas..."]})}),e.jsx(s.div,{className:"flex items-center gap-3",initial:{opacity:0},animate:{opacity:1},transition:{delay:2.4},children:e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"checkbox",checked:v,onChange:m=>C(m.target.checked),disabled:n,className:"sr-only"}),e.jsx(s.div,{className:`w-6 h-6 rounded-lg border-2 flex items-center justify-center transition-all duration-300 ${v?o?"bg-purple-600 border-purple-600":"bg-purple-500 border-purple-500":o?"border-gray-600 bg-gray-700":"border-gray-300 bg-white"} ${n?"opacity-50 cursor-not-allowed":"group-hover:border-purple-400"}`,whileHover:n?{}:{scale:1.05},whileTap:n?{}:{scale:.95},children:e.jsx($,{children:v&&e.jsx(s.svg,{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"3",initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0},transition:{type:"spring",stiffness:500,damping:30},children:e.jsx("polyline",{points:"20,6 9,17 4,12"})})})})]}),e.jsx("span",{className:`font-medium ${o?"text-gray-200":"text-gray-700"} ${n?"opacity-50":""}`,children:"Zapamti me"})]})}),e.jsxs(s.div,{className:"flex gap-4 mt-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:2.6},children:[e.jsxs(s.button,{type:"button",onClick:i,disabled:n,className:`flex-1 px-6 py-3 rounded-xl font-medium transition-all duration-300 flex items-center justify-center gap-2 ${o?"bg-gray-700 text-gray-200 hover:bg-gray-600 border border-gray-600":"bg-gray-100 text-gray-700 hover:bg-gray-200 border border-gray-200"} ${n?"opacity-50 cursor-not-allowed":"hover:shadow-lg"}`,whileHover:n?{}:{scale:1.02},whileTap:n?{}:{scale:.98},children:[e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"m15 18-6-6 6-6"})}),"Nazad"]}),e.jsx(s.button,{type:"submit",disabled:n||!a.trim()||!l.trim()||a!==l||A.score<2,className:`flex-1 px-6 py-3 rounded-xl font-medium transition-all duration-300 flex items-center justify-center gap-2 ${n||!a.trim()||!l.trim()||a!==l||A.score<2?o?"bg-gray-700 text-gray-500 cursor-not-allowed":"bg-gray-200 text-gray-400 cursor-not-allowed":o?"bg-gradient-to-r from-purple-600 to-pink-600 text-white hover:from-purple-700 hover:to-pink-700":"bg-gradient-to-r from-purple-500 to-pink-500 text-white hover:from-purple-600 hover:to-pink-600"} hover:shadow-lg`,whileHover:!n&&a.trim()&&l.trim()&&a===l&&A.score>=2?{scale:1.02}:{},whileTap:!n&&a.trim()&&l.trim()&&a===l&&A.score>=2?{scale:.98}:{},children:n?e.jsxs(e.Fragment,{children:[e.jsx(s.div,{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}}),"Postavljam i ulogujem..."]}):e.jsxs(e.Fragment,{children:[e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"}),e.jsx("polyline",{points:"10,17 15,12 10,7"}),e.jsx("line",{x1:"15",y1:"12",x2:"3",y2:"12"})]}),"Postavi lozinku i uloguj se"]})})]})]}),e.jsx(s.div,{className:"text-center",initial:{opacity:0},animate:{opacity:1},transition:{delay:2.8},children:e.jsx("p",{className:`text-sm ${o?"text-gray-400":"text-gray-500"}`,children:"Lozinka ƒáe biti automatski saƒçuvana i ulogovani ƒáete se odmah."})})]})})]})}function Le({onLogin:u,loading:t,onBack:i}){const[n,a]=r.useState(""),[d,l]=r.useState(""),[f,c]=r.useState(null),g=x=>{if(x.preventDefault(),!n.trim()){c("Molimo unesite va≈°u turu");return}if(!d.trim()){c("Molimo unesite lozinku");return}c(null),u(n.trim().toUpperCase(),d)};return e.jsx("div",{className:"login-screen",children:e.jsxs("div",{className:"login-container",children:[e.jsxs("div",{className:"login-header",children:[e.jsx("h1",{children:"Prijava"}),e.jsx("p",{children:"Unesite va≈°u turu i lozinku za pristup aplikaciji."})]}),e.jsxs("form",{onSubmit:g,className:"login-form",children:[e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"tura",children:"Tura:"}),e.jsx("input",{type:"text",id:"tura",value:n,onChange:x=>a(x.target.value),placeholder:"npr. 8610",maxLength:"10",disabled:t,autoFocus:!0})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"password",children:"Lozinka:"}),e.jsx("input",{type:"password",id:"password",value:d,onChange:x=>l(x.target.value),placeholder:"Va≈°a lozinka",disabled:t})]}),f&&e.jsx("div",{className:"error-message",children:f}),e.jsx("button",{type:"submit",className:"login-btn",disabled:t||!n.trim()||!d.trim(),children:t?"Prijavljivam...":"Prijavite se"})]}),e.jsx("div",{className:"login-footer",children:e.jsx("button",{type:"button",className:"back-btn",onClick:i,disabled:t,children:"‚Üê Nazad"})})]})})}function We({onAuthSuccess:u}){const[t,i]=r.useState("init"),[n,a]=r.useState(null),{loading:d,checkDriverExists:l,setInitialPassword:f,login:c}=ae(),g=async h=>{try{const k=await l(h);a(k),i("confirm")}catch(k){console.error("Driver check failed:",k)}},x=()=>{n.hasPassword?i("login"):i("setup")},w=async(h,k=!1)=>{var p;try{await f(n.id,h);const o=await c(n.tura,h);console.log("[AuthFlowManager] Login user:",o),k&&localStorage.setItem("bde_remember_me","true"),o!=null&&o.name&&(localStorage.setItem("DRIVER_NAME",o.name),(p=window.__USER_CONTEXT__)!=null&&p.refreshStatus&&window.__USER_CONTEXT__.refreshStatus()),u(o)}catch(o){console.error("Password setup failed:",o)}},v=async(h,k,p=!1)=>{var o;try{const N=await c(h,k);console.log("[AuthFlowManager] Login user:",N),p&&localStorage.setItem("bde_remember_me","true"),N!=null&&N.ime&&(localStorage.setItem("DRIVER_NAME",N.ime),(o=window.__USER_CONTEXT__)!=null&&o.refreshStatus&&window.__USER_CONTEXT__.refreshStatus()),u(N)}catch(N){console.error("Login failed:",N)}},C=()=>{i("init"),a(null)},b=()=>{i("confirm")};return t==="init"?e.jsx(Ae,{onDriverSelected:g,loading:d}):t==="confirm"?e.jsx(Me,{driver:n,onContinue:x,onLogin:v,onBack:C,loading:d}):t==="setup"?e.jsx($e,{driver:n,onPasswordSet:w,onBack:b,loading:d}):t==="login"?e.jsx(Le,{onLogin:v,loading:d,onBack:b}):null}const ze=({onClose:u,onSubmit:t})=>{const[i,n]=r.useState({oldPassword:"",newPassword:"",confirmPassword:""}),[a,d]=r.useState({old:!1,new:!1,confirm:!1}),[l,f]=r.useState({}),[c,g]=r.useState(!1),x=p=>{if(!p)return null;let o=0;return p.length>=8&&o++,/[A-Z]/.test(p)&&o++,/[a-z]/.test(p)&&o++,/[0-9]/.test(p)&&o++,/[^A-Za-z0-9]/.test(p)&&o++,o<3?{level:"weak",text:"üî¥ Slaba lozinka"}:o<4?{level:"medium",text:"üü° Srednja lozinka"}:{level:"strong",text:"üü¢ Jaka lozinka"}},w=()=>{const p={};return i.oldPassword||(p.oldPassword="Stara lozinka je obavezna"),i.newPassword?i.newPassword.length<6&&(p.newPassword="Nova lozinka mora imati najmanje 6 karaktera"):p.newPassword="Nova lozinka je obavezna",i.confirmPassword?i.newPassword!==i.confirmPassword&&(p.confirmPassword="Lozinke se ne poklapaju"):p.confirmPassword="Potvrda lozinke je obavezna",i.oldPassword===i.newPassword&&(p.newPassword="Nova lozinka mora biti razliƒçita od stare"),f(p),Object.keys(p).length===0},v=(p,o)=>{n(N=>({...N,[p]:o})),l[p]&&f(N=>({...N,[p]:null}))},C=p=>{d(o=>({...o,[p]:!o[p]}))},b=async p=>{if(p.preventDefault(),!!w()){g(!0);try{await t(i),u()}catch(o){f({submit:o.message||"Gre≈°ka pri promeni lozinke"})}finally{g(!1)}}},h=i.oldPassword&&i.newPassword&&i.confirmPassword&&i.newPassword===i.confirmPassword&&i.newPassword.length>=6&&i.oldPassword!==i.newPassword,k=x(i.newPassword);return e.jsxs("form",{className:styles.modalForm,onSubmit:b,children:[e.jsxs("div",{className:styles.formHeader,children:[e.jsx("h2",{className:styles.formTitle,children:"üîê Promena lozinke"}),e.jsx("p",{className:styles.formSubtitle,children:"Unesite staru lozinku i defini≈°ite novu sigurnu lozinku"})]}),e.jsxs("div",{className:styles.inputGroup,children:[e.jsx("label",{className:styles.inputLabel,htmlFor:"oldPassword",children:"Trenutna lozinka"}),e.jsxs("div",{className:styles.inputWrapper,children:[e.jsx("input",{id:"oldPassword",type:a.old?"text":"password",value:i.oldPassword,onChange:p=>v("oldPassword",p.target.value),placeholder:"Unesite trenutnu lozinku",className:styles.passwordInput,autoComplete:"current-password"}),e.jsx("button",{type:"button",className:styles.toggleButton,onClick:()=>C("old"),"aria-label":"Prika≈æi/sakrij lozinku",children:a.old?"üëÅÔ∏è":"üôà"})]}),l.oldPassword&&e.jsxs("div",{className:`${styles.validationMessage} ${styles.validationError}`,children:["‚ùå ",l.oldPassword]})]}),e.jsxs("div",{className:styles.inputGroup,children:[e.jsx("label",{className:styles.inputLabel,htmlFor:"newPassword",children:"Nova lozinka"}),e.jsxs("div",{className:styles.inputWrapper,children:[e.jsx("input",{id:"newPassword",type:a.new?"text":"password",value:i.newPassword,onChange:p=>v("newPassword",p.target.value),placeholder:"Unesite novu lozinku",className:styles.passwordInput,autoComplete:"new-password"}),e.jsx("button",{type:"button",className:styles.toggleButton,onClick:()=>C("new"),"aria-label":"Prika≈æi/sakrij lozinku",children:a.new?"üëÅÔ∏è":"üôà"})]}),k&&e.jsx("div",{className:`${styles.strengthIndicator} ${styles[`strength${k.level.charAt(0).toUpperCase()+k.level.slice(1)}`]}`,children:k.text}),l.newPassword&&e.jsxs("div",{className:`${styles.validationMessage} ${styles.validationError}`,children:["‚ùå ",l.newPassword]})]}),e.jsxs("div",{className:styles.inputGroup,children:[e.jsx("label",{className:styles.inputLabel,htmlFor:"confirmPassword",children:"Potvrdite novu lozinku"}),e.jsxs("div",{className:styles.inputWrapper,children:[e.jsx("input",{id:"confirmPassword",type:a.confirm?"text":"password",value:i.confirmPassword,onChange:p=>v("confirmPassword",p.target.value),placeholder:"Ponovite novu lozinku",className:styles.passwordInput,autoComplete:"new-password"}),e.jsx("button",{type:"button",className:styles.toggleButton,onClick:()=>C("confirm"),"aria-label":"Prika≈æi/sakrij lozinku",children:a.confirm?"üëÅÔ∏è":"üôà"})]}),i.confirmPassword&&i.newPassword===i.confirmPassword&&e.jsx("div",{className:`${styles.validationMessage} ${styles.validationSuccess}`,children:"‚úÖ Lozinke se poklapaju"}),l.confirmPassword&&e.jsxs("div",{className:`${styles.validationMessage} ${styles.validationError}`,children:["‚ùå ",l.confirmPassword]})]}),e.jsxs("div",{className:styles.securityTips,children:[e.jsx("h4",{children:"üí° Saveti za sigurnu lozinku:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Najmanje 8 karaktera"}),e.jsx("li",{children:"Kombinacija velikih i malih slova"}),e.jsx("li",{children:"Brojevi i specijalni karakteri (!@#$%)"}),e.jsx("li",{children:"Izbegavajte liƒçne podatke"})]})]}),l.submit&&e.jsxs("div",{className:`${styles.validationMessage} ${styles.validationError}`,children:["‚ùå ",l.submit]}),e.jsxs("div",{className:styles.modalActions,children:[e.jsx("button",{type:"button",className:styles.cancelBtn,onClick:u,disabled:c,children:"‚ùå Otka≈æi"}),e.jsx("button",{type:"submit",className:styles.submitBtn,disabled:!h||c,children:c?"üîÑ Menjam...":"üîê Promeni lozinku"})]})]})};class Ee{constructor(){this.channels=[],this.isActive=!1}start(){if(this.isActive)return;console.log("üîÑ Starting realtime service...");const t=Y.channel("realtime_extra_rides").on("postgres_changes",{event:"*",schema:"public",table:"extra_rides_pending"},a=>{console.log("üöó Extra rides update:",a.eventType),B.extraRides()}).subscribe(),i=Y.channel("realtime_deliveries").on("postgres_changes",{event:"*",schema:"public",table:"deliveries"},a=>{console.log("üì¶ Deliveries update:",a.eventType),B.deliveries(),B.driverStats()}).subscribe(),n=Y.channel("realtime_drivers").on("postgres_changes",{event:"*",schema:"public",table:"drivers"},a=>{console.log("üë§ Drivers update:",a.eventType),B.drivers()}).subscribe();this.channels=[t,i,n],this.isActive=!0,console.log("‚úÖ Realtime service started - listening for changes")}stop(){this.isActive&&(console.log("üõë Stopping realtime service..."),this.channels.forEach(t=>{Y.removeChannel(t)}),this.channels=[],this.isActive=!1,console.log("‚úÖ Realtime service stopped"))}triggerDataChange(t){switch(console.log(`üîÑ Manual trigger for ${t}`),t){case"extraRides":B.extraRides(),B.driverStats();break;case"deliveries":B.deliveries(),B.driverStats();break;case"drivers":B.drivers();break;default:B.all()}}}const re=new Ee;class Te{constructor(){this.deferredPrompt=null,this.isInstalled=!1,this.isStandalone=!1,this.serviceWorkerRegistration=null,this.listeners=new Set,this.syncInProgress=!1,this.checkInstallStatus(),this.setupInstallPrompt(),this.registerServiceWorker(),this.setupServiceWorkerMessages(),console.log("üöÄ [PWA] Service inicijalizovan")}checkInstallStatus(){this.isStandalone=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone||document.referrer.includes("android-app://"),this.isInstalled=this.isStandalone,console.log("üöÄ [PWA] Install status:",{isInstalled:this.isInstalled,isStandalone:this.isStandalone})}setupInstallPrompt(){window.addEventListener("beforeinstallprompt",t=>{console.log("üöÄ [PWA] Install prompt available"),t.preventDefault(),this.deferredPrompt=t,this.notifyListeners({type:"install_available",canInstall:!0})}),window.addEventListener("appinstalled",t=>{console.log("üöÄ [PWA] App installed successfully"),this.isInstalled=!0,this.deferredPrompt=null,this.notifyListeners({type:"app_installed",isInstalled:!0}),this.trackInstallation()}),this.checkIOSInstall()}checkIOSInstall(){const t=/iPad|iPhone|iPod/.test(navigator.userAgent),i=window.navigator.standalone;t&&!i&&this.notifyListeners({type:"ios_install_available",platform:"iOS"})}async registerServiceWorker(){if("serviceWorker"in navigator)try{const t=await navigator.serviceWorker.register("/sw.js",{scope:"/"});return this.serviceWorkerRegistration=t,console.log("üöÄ [PWA] Service Worker registered:",t.scope),t.addEventListener("updatefound",()=>{console.log("üöÄ [PWA] Service Worker update found");const i=t.installing;i.addEventListener("statechange",()=>{i.state==="installed"&&navigator.serviceWorker.controller&&(console.log("üöÄ [PWA] New Service Worker available"),this.notifyListeners({type:"update_available",registration:t}))})}),this.setupBackgroundSync(),t}catch(t){throw console.error("üöÄ [PWA] Service Worker registration failed:",t),t}else console.warn("üöÄ [PWA] Service Workers not supported")}setupServiceWorkerMessages(){"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",t=>{switch(console.log("üöÄ [PWA] Message from Service Worker:",t.data),t.data.type){case"SYNC_STARTED":this.syncInProgress=!0,this.notifyListeners({type:"sync_started"});break;case"SYNC_COMPLETED":this.syncInProgress=!1,this.notifyListeners({type:"sync_completed"});break;case"SYNC_FAILED":this.syncInProgress=!1,this.notifyListeners({type:"sync_failed",error:t.data.error});break}})}setupBackgroundSync(){"sync"in window.ServiceWorkerRegistration.prototype?(console.log("üöÄ [PWA] Background Sync supported"),this.scheduleBackgroundSync()):console.warn("üöÄ [PWA] Background Sync not supported")}async scheduleBackgroundSync(){if(this.serviceWorkerRegistration&&"sync"in window.ServiceWorkerRegistration.prototype)try{await this.serviceWorkerRegistration.sync.register("background-sync-data"),console.log("üöÄ [PWA] Background sync scheduled")}catch(t){console.error("üöÄ [PWA] Background sync scheduling failed:",t)}}async showInstallPrompt(){if(!this.deferredPrompt)return console.warn("üöÄ [PWA] Install prompt not available"),!1;try{this.deferredPrompt.prompt();const{outcome:t}=await this.deferredPrompt.userChoice;return console.log("üöÄ [PWA] Install prompt result:",t),t==="accepted"?this.notifyListeners({type:"install_accepted"}):this.notifyListeners({type:"install_dismissed"}),this.deferredPrompt=null,t==="accepted"}catch(t){return console.error("üöÄ [PWA] Install prompt error:",t),!1}}canInstall(){return!this.isInstalled&&this.deferredPrompt!==null}shouldShowIOSInstructions(){const t=/iPad|iPhone|iPod/.test(navigator.userAgent),i=window.navigator.standalone;return t&&!i}async updateServiceWorker(){if(this.serviceWorkerRegistration)try{return await this.serviceWorkerRegistration.update(),console.log("üöÄ [PWA] Service Worker update triggered"),this.serviceWorkerRegistration.waiting&&this.serviceWorkerRegistration.waiting.postMessage({type:"SKIP_WAITING"}),!0}catch(t){return console.error("üöÄ [PWA] Service Worker update failed:",t),!1}return!1}async clearCache(){if(this.serviceWorkerRegistration)try{return this.serviceWorkerRegistration.active&&this.serviceWorkerRegistration.active.postMessage({type:"CLEAR_CACHE"}),console.log("üöÄ [PWA] Cache clear requested"),!0}catch(t){return console.error("üöÄ [PWA] Cache clear failed:",t),!1}return!1}getInstallInfo(){return{isInstalled:this.isInstalled,isStandalone:this.isStandalone,canInstall:this.canInstall(),shouldShowIOSInstructions:this.shouldShowIOSInstructions(),serviceWorkerSupported:"serviceWorker"in navigator,syncSupported:"sync"in window.ServiceWorkerRegistration.prototype,notificationSupported:"Notification"in window}}async requestNotificationPermission(){if("Notification"in window)try{const t=await Notification.requestPermission();return console.log("üöÄ [PWA] Notification permission:",t),this.notifyListeners({type:"notification_permission",permission:t}),t==="granted"}catch(t){return console.error("üöÄ [PWA] Notification permission request failed:",t),!1}return!1}async setupPushNotifications(){if(!this.serviceWorkerRegistration)return console.warn("üöÄ [PWA] Service Worker not available for push notifications"),!1;try{if(!("PushManager"in window))return console.warn("üöÄ [PWA] Push notifications not supported"),!1;if(!await this.requestNotificationPermission())return console.warn("üöÄ [PWA] Notification permission denied"),!1;const i=await this.serviceWorkerRegistration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:this.urlBase64ToUint8Array("YOUR_VAPID_PUBLIC_KEY")});return console.log("üöÄ [PWA] Push subscription created:",i),this.notifyListeners({type:"push_subscribed",subscription:i}),i}catch(t){return console.error("üöÄ [PWA] Push notification setup failed:",t),!1}}urlBase64ToUint8Array(t){const i="=".repeat((4-t.length%4)%4),n=(t+i).replace(/-/g,"+").replace(/_/g,"/"),a=window.atob(n),d=new Uint8Array(a.length);for(let l=0;l<a.length;++l)d[l]=a.charCodeAt(l);return d}trackInstallation(){try{typeof gtag<"u"&&gtag("event","app_install",{event_category:"PWA",event_label:"BDE Evidencija"}),localStorage.setItem("bde_app_installed",new Date().toISOString()),console.log("üöÄ [PWA] Installation tracked")}catch(t){console.error("üöÄ [PWA] Installation tracking failed:",t)}}async checkForUpdates(){if(this.serviceWorkerRegistration)try{return await this.serviceWorkerRegistration.update(),console.log("üöÄ [PWA] Update check completed"),!0}catch(t){return console.error("üöÄ [PWA] Update check failed:",t),!1}return!1}getPWACapabilities(){return{serviceWorker:"serviceWorker"in navigator,backgroundSync:"sync"in window.ServiceWorkerRegistration.prototype,pushNotifications:"PushManager"in window,notifications:"Notification"in window,installPrompt:"beforeinstallprompt"in window,periodicSync:"periodicSync"in window.ServiceWorkerRegistration.prototype,webShare:"share"in navigator,geolocation:"geolocation"in navigator,battery:"getBattery"in navigator,vibration:"vibrate"in navigator}}addListener(t){return this.listeners.add(t),()=>this.listeners.delete(t)}removeListener(t){this.listeners.delete(t)}notifyListeners(t){this.listeners.forEach(i=>{try{i(t)}catch(n){console.error("üöÄ [PWA] Listener error:",n)}})}destroy(){this.listeners.clear(),console.log("üöÄ [PWA] Service destroyed")}}const L=new Te;function Be(){const[u,t]=r.useState(L.getInstallInfo()),[i,n]=r.useState(L.getPWACapabilities()),[a,d]=r.useState(!1),[l,f]=r.useState(!1);return r.useEffect(()=>{const b=k=>{switch(k.type){case"install_available":t(p=>({...p,canInstall:!0}));break;case"app_installed":t(p=>({...p,isInstalled:!0,canInstall:!1}));break;case"update_available":d(!0);break;case"sync_started":f(!0);break;case"sync_completed":case"sync_failed":f(!1);break}},h=L.addListener(b);return t(L.getInstallInfo()),n(L.getPWACapabilities()),h},[]),{installInfo:u,capabilities:i,updateAvailable:a,syncInProgress:l,showInstallPrompt:async()=>await L.showInstallPrompt(),updateApp:async()=>{const b=await L.updateServiceWorker();return b&&(d(!1),setTimeout(()=>window.location.reload(),1e3)),b},clearCache:async()=>await L.clearCache(),requestNotifications:async()=>await L.requestNotificationPermission(),setupPushNotifications:async()=>await L.setupPushNotifications(),checkForUpdates:async()=>await L.checkForUpdates(),service:L}}const Re="_overlay_175pr_3",De="_prompt_175pr_19",Fe="_header_175pr_33",He="_icon_175pr_40",Oe="_title_175pr_45",Ue="_closeBtn_175pr_62",Ve="_benefits_175pr_79",Ge="_benefit_175pr_79",qe="_benefitIcon_175pr_94",Ke="_actions_175pr_98",Ze="_installBtn_175pr_104",Xe="_laterBtn_175pr_131",Ye="_spinner_175pr_147",Je="_iosInstructions_175pr_157",Qe="_instructionHeader_175pr_161",et="_iosIcon_175pr_165",tt="_instructionSteps_175pr_177",st="_step_175pr_184",at="_stepNumber_175pr_194",it="_shareIcon_175pr_208",rt="_addIcon_175pr_209",nt="_dismissBtn_175pr_214",y={overlay:Re,prompt:De,header:Fe,icon:He,title:Oe,closeBtn:Ue,benefits:Ve,benefit:Ge,benefitIcon:qe,actions:Ke,installBtn:Ze,laterBtn:Xe,spinner:Ye,iosInstructions:Je,instructionHeader:Qe,iosIcon:et,instructionSteps:tt,step:st,stepNumber:at,shareIcon:it,addIcon:rt,dismissBtn:nt},ot=()=>{const{installInfo:u,showInstallPrompt:t}=Be(),[i,n]=r.useState(!1),[a,d]=r.useState(!1),[l,f]=r.useState(!1);r.useEffect(()=>{if(sessionStorage.getItem("pwa_install_dismissed")){d(!0);return}if(u.canInstall&&!u.isInstalled&&!a){const v=setTimeout(()=>{n(!0)},3e3);return()=>clearTimeout(v)}},[u.canInstall,u.isInstalled,a]);const c=async()=>{f(!0);try{await t()?n(!1):g()}catch(w){console.error("Install error:",w)}finally{f(!1)}},g=()=>{n(!1),d(!0),sessionStorage.setItem("pwa_install_dismissed","true")},x=()=>e.jsxs("div",{className:y.iosInstructions,children:[e.jsxs("div",{className:y.instructionHeader,children:[e.jsx("div",{className:y.iosIcon,children:"üì±"}),e.jsx("h3",{children:"Dodaj na poƒçetni ekran"})]}),e.jsxs("div",{className:y.instructionSteps,children:[e.jsxs("div",{className:y.step,children:[e.jsx("span",{className:y.stepNumber,children:"1"}),e.jsx("span",{children:"Pritisni dugme za Share"}),e.jsx("div",{className:y.shareIcon,children:"üì§"})]}),e.jsxs("div",{className:y.step,children:[e.jsx("span",{className:y.stepNumber,children:"2"}),e.jsx("span",{children:'Odaberi "Add to Home Screen"'}),e.jsx("div",{className:y.addIcon,children:"‚ûï"})]}),e.jsxs("div",{className:y.step,children:[e.jsx("span",{className:y.stepNumber,children:"3"}),e.jsx("span",{children:'Pritisni "Add"'})]})]}),e.jsx("button",{className:y.dismissBtn,onClick:g,children:"Razumem"})]});return i&&!a?e.jsx("div",{className:y.overlay,children:e.jsx("div",{className:y.prompt,children:u.shouldShowIOSInstructions?e.jsx(x,{}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:y.header,children:[e.jsx("div",{className:y.icon,children:"üöÄ"}),e.jsxs("div",{className:y.title,children:[e.jsx("h3",{children:"Instaliraj BDE Evidenciju"}),e.jsx("p",{children:"Br≈æi pristup i bolje performanse"})]}),e.jsx("button",{className:y.closeBtn,onClick:g,children:"‚úï"})]}),e.jsxs("div",{className:y.benefits,children:[e.jsxs("div",{className:y.benefit,children:[e.jsx("span",{className:y.benefitIcon,children:"‚ö°"}),e.jsx("span",{children:"Br≈æe uƒçitavanje"})]}),e.jsxs("div",{className:y.benefit,children:[e.jsx("span",{className:y.benefitIcon,children:"üì±"}),e.jsx("span",{children:"Radi offline"})]}),e.jsxs("div",{className:y.benefit,children:[e.jsx("span",{className:y.benefitIcon,children:"üîî"}),e.jsx("span",{children:"Push notifikacije"})]}),e.jsxs("div",{className:y.benefit,children:[e.jsx("span",{className:y.benefitIcon,children:"üè†"}),e.jsx("span",{children:"Poƒçetni ekran"})]})]}),e.jsxs("div",{className:y.actions,children:[e.jsx("button",{className:y.installBtn,onClick:c,disabled:l,children:l?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:y.spinner}),"Instaliranje..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"üì•"}),"Instaliraj aplikaciju"]})}),e.jsx("button",{className:y.laterBtn,onClick:g,children:"Mo≈æda kasnije"})]})]})})}):null},lt=R.lazy(()=>F(()=>import("./chunk-v5-1760928978759-6CXRxduX.js").then(u=>u.H),__vite__mapDeps([0,1,2,3,4,5]))),ct=R.lazy(()=>F(()=>import("./chunk-v5-1760928978759-6CXRxduX.js").then(u=>u.D),__vite__mapDeps([0,1,2,3,4,5]))),dt=R.lazy(()=>F(()=>import("./chunk-v5-1760928978759-6CXRxduX.js").then(u=>u.c),__vite__mapDeps([0,1,2,3,4,5]))),ut=R.lazy(()=>F(()=>import("./chunk-v5-1760928978759-qiU663mw.js"),__vite__mapDeps([6,1,2,7,3,4,5,0]))),ht=R.lazy(()=>F(()=>import("./chunk-v5-1760928978759-BZmwhmgh.js").then(u=>u.A),__vite__mapDeps([7,1,2,3,4,5,0]))),pt=R.lazy(()=>F(()=>import("./chunk-v5-1760928978759-BPpsJgZe.js"),__vite__mapDeps([8,1,2,3,4,0,5]))),mt=R.lazy(()=>F(()=>import("./chunk-v5-1760928978759-jwlmVBC-.js"),__vite__mapDeps([9,1,2,3,4]))),gt=R.lazy(()=>F(()=>import("./chunk-v5-1760928978759-6CXRxduX.js").then(u=>u.S),__vite__mapDeps([0,1,2,3,4,5]))),xt=R.lazy(()=>F(()=>import("./chunk-v5-1760928978759-zeZs0-km.js"),__vite__mapDeps([10,1,2,11,12])));function yt({onLogout:u}){const[t,i]=r.useState(!1),{currentUser:n,changePassword:a}=ae(),d=he(),l=d.pathname==="/"||d.pathname==="",f=async(c,g)=>{await a(c,g)};return r.useEffect(()=>{if(n)return console.log("üöÄ Starting realtime service for user:",n.name),re.start(),()=>{console.log("üõë Stopping realtime service"),re.stop()}},[n]),n?e.jsxs("div",{className:"min-h-screen bg-background text-foreground",children:[e.jsx("main",{className:`app-main${l?" home-fullbleed":""}`,children:e.jsx(R.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}),e.jsx("p",{className:"text-gray-600",children:"Uƒçitava se..."})]})}),children:e.jsxs(pe,{children:[e.jsx(T,{path:"/",element:e.jsx(lt,{})}),e.jsx(T,{path:"/statistika",element:e.jsx(gt,{})}),e.jsx(T,{path:"/navigacija",element:e.jsx(xt,{})}),e.jsx(T,{path:"/deliveries",element:e.jsx(ct,{})}),e.jsx(T,{path:"/drivers",element:e.jsx(dt,{})}),e.jsx(T,{path:"/extra-rides",element:e.jsx(ut,{})}),e.jsx(T,{path:"/admin",element:(n==null?void 0:n.role)==="admin"?e.jsx(ht,{}):e.jsx(te,{to:"/"})}),e.jsx(T,{path:"/payroll-list",element:(n==null?void 0:n.role)!=="admin"?e.jsx(pt,{user:n}):e.jsx(te,{to:"/"})}),e.jsx(T,{path:"/about",element:e.jsx(mt,{})}),e.jsx(T,{path:"*",element:e.jsx(te,{to:"/"})})]})})}),t&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(ze,{user:n,onClose:()=>i(!1),onChangePassword:async c=>{await f(c.oldPassword,c.newPassword),i(!1)}})})]}):e.jsx("div",{children:"Loading..."})}function ft(){const{currentUser:u,isAuthenticated:t}=ae(),[i,n]=r.useState(!1),[a,d]=r.useState(!1),l=c=>{var g;n(!0),d(!1),c!=null&&c.name&&(localStorage.setItem("DRIVER_NAME",c.name),(g=window.__USER_CONTEXT__)!=null&&g.refreshStatus&&window.__USER_CONTEXT__.refreshStatus(),console.log("[App] DRIVER_NAME postavljen:",c.name))},f=()=>{d(!0),n(!1)};return r.useEffect(()=>{!u&&!t&&n(!1),u&&t&&d(!1)},[u,t]),r.useEffect(()=>{const c=g=>{console.log("Global logout event received",g.detail);try{localStorage.removeItem("bde_current_user")}catch{}try{localStorage.removeItem("bde_login_time")}catch{}f()};return window.addEventListener("bde:logout",c),()=>window.removeEventListener("bde:logout",c)},[]),e.jsx(ue,{basename:"/bde-evidencija",children:e.jsx(Ce,{children:e.jsx(ge,{children:e.jsx(ve,{children:e.jsx(we,{children:e.jsxs("div",{className:"app",children:[(t||i)&&!a?e.jsx(yt,{onLogout:f}):e.jsx(We,{onAuthSuccess:l}),e.jsx(ot,{})]})})})})})})}console.log("üöÄ BDEVidencija v5.0.0 - ULTRA NUCLEAR FORCE UPDATE - 20251007");console.log("üì± PWA Cache Status: FORCED REFRESH");"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("controllerchange",function(){window.location.reload()});ne(document.getElementById("root")).render(e.jsx(me,{client:xe,children:e.jsx(ft,{})}));export{re as r};

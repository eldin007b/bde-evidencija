const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/chunk-v5-1764802892030-Dp0vVT2v.js","assets/chunk-v5-1764802892030-jbLQRSDA.js","assets/chunk-v5-1764802892030-DzTHeiPn.js","assets/chunk-v5-1764802892030-B9ZkT-FW.js","assets/chunk-v5-1764802892030-BG1SDadW.js","assets/chunk-v5-1764802892030-67jeV4qK.js","assets/chunk-v5-1764802892030-BaxKJJL-.js","assets/chunk-v5-1764802892030-CWMhAGPr.js","assets/chunk-v5-1764802892030-DoMnzAVu.js","assets/chunk-v5-1764802892030-BAl6N9Fc.js","assets/chunk-v5-1764802892030-CTBUGFsV.js","assets/chunk-v5-1764802892030-DyrV8QmU.js","assets/asset-v5-1764802892030-Bq-DyqPN.css"])))=>i.map(i=>d[i]);
var je=Object.defineProperty;var we=(d,t,a)=>t in d?je(d,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):d[t]=a;var ue=(d,t,a)=>we(d,typeof t!="symbol"?t+"":t,a);import{j as e,m as s,i as ke,U as pe,k as me,l as ge,f as Ne,o as Se,g as Pe,P as _e,p as xe,c as Ie,A as U,R as Ce,w as $e,a1 as Ae,Y as ze}from"./chunk-v5-1764802892030-BG1SDadW.js";import{a as Ee,r as n,u as We,R as O,B as Me,d as Le,e as Te,f as Y,N as ce}from"./chunk-v5-1764802892030-DzTHeiPn.js";import{_ as q,a as De}from"./chunk-v5-1764802892030-B9ZkT-FW.js";import{a as Re,b as Be,c as Fe,d as He,e as Oe,S as Ue,u as he,i as K,f as Ve,q as Ge}from"./chunk-v5-1764802892030-Dp0vVT2v.js";import{u as Ye,g as Ke}from"./chunk-v5-1764802892030-CWMhAGPr.js";import{u as qe,s as oe}from"./chunk-v5-1764802892030-jbLQRSDA.js";import{f as Xe}from"./chunk-v5-1764802892030-67jeV4qK.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const p of i)if(p.type==="childList")for(const u of p.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function a(i){const p={};return i.integrity&&(p.integrity=i.integrity),i.referrerPolicy&&(p.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?p.credentials="include":i.crossOrigin==="anonymous"?p.credentials="omit":p.credentials="same-origin",p}function r(i){if(i.ep)return;i.ep=!0;const p=a(i);fetch(i.href,p)}})();var be,ye=Ee;be=ye.createRoot,ye.hydrateRoot;const Ze=n.createContext();function Je({children:d}){const t=Ye();return e.jsx(Ze.Provider,{value:t,children:d})}const Qe=n.createContext(),et=({children:d})=>{const t=qe(),[a,r]=n.useState(!0),[i,p]=n.useState(null);n.useEffect(()=>(a?t.start(i):t.stop(),()=>{t.stop()}),[a,i]);const u={autoSync:t,globalSyncEnabled:a,setGlobalSyncEnabled:r,syncInterval:i,setSyncInterval:p,isAutoSyncRunning:t.isRunning,isSyncInProgress:t.syncInProgress,lastSyncTime:t.lastSyncTime,nextSyncTime:t.nextSyncTime,startAutoSync:t.start,stopAutoSync:t.stop,syncNow:t.syncNow,getLastSyncText:()=>{if(!t.lastSyncTime)return"Nikad";const x=Date.now()-t.lastSyncTime,f=Math.floor(x/(1e3*60)),v=Math.floor(x%(1e3*60)/1e3);return f>0?`prije ${f}min ${v}s`:`prije ${v}s`},getNextSyncText:()=>{if(!t.nextSyncTime||!t.isRunning)return"Iskljuƒçen";const o=Date.now(),x=t.nextSyncTime-o;if(x<=0)return"Uskoro";const f=Math.floor(x/(1e3*60)),v=Math.floor(x%(1e3*60)/1e3);return f>0?`za ${f}min ${v}s`:`za ${v}s`}};return e.jsx(Qe.Provider,{value:u,children:d})},tt={confirm:"Potvrdi",enterTuraOrPin:"Unesi turu ili PIN",selectLanguage:"Odaberi jezik",enterTuraAndSelectLanguage:"Unesi turu i odaberi jezik",welcome:"Dobrodo≈°li!",setupMessage:"Molimo podes–∏—Ç–µ aplikaciju prije kori≈°ƒáenja.",tourNumber:"Broj ture",tourPlaceholder:"Unesite va≈° broj ture (npr. 8610)",appLanguage:"Jezik aplikacije",finishSetup:"Zavr≈°i pode≈°avanje",setupInfoMessage:"Ove podatke mo≈æete promijeniti kasnije u pode≈°avanjima aplikacije.",unknownTour:"Nepoznat broj ture. Molimo kontaktirajte administratora."},st={confirm:"Confirm",enterTuraOrPin:"Enter route or PIN",selectLanguage:"Select language",enterTuraAndSelectLanguage:"Enter route and select language",welcome:"Welcome!",setupMessage:"Please configure the application before use.",tourNumber:"Route number",tourPlaceholder:"Enter your route number (e.g. 8610)",appLanguage:"Application language",finishSetup:"Finish setup",setupInfoMessage:"You can change these settings later in application settings.",unknownTour:"Unknown route number. Please contact administrator."},at={confirm:"Best√§tigen",enterTuraOrPin:"Route oder PIN eingeben",selectLanguage:"Sprache w√§hlen",enterTuraAndSelectLanguage:"Route eingeben und Sprache w√§hlen",welcome:"Willkommen!",setupMessage:"Bitte konfigurieren Sie die Anwendung vor der Nutzung.",tourNumber:"Routennummer",tourPlaceholder:"Geben Sie Ihre Routennummer ein (z.B. 8610)",appLanguage:"Anwendungssprache",finishSetup:"Setup abschlie√üen",setupInfoMessage:"Sie k√∂nnen diese Einstellungen sp√§ter in den Anwendungseinstellungen √§ndern.",unknownTour:"Unbekannte Routennummer. Bitte kontaktieren Sie den Administrator."},rt={confirm:"Potrdi",enterTuraOrPin:"Vnesi turo ali PIN",selectLanguage:"Izberi jezik",enterTuraAndSelectLanguage:"Vnesi turo in izberi jezik",welcome:"Dobrodo≈°li!",setupMessage:"Prosimo, konfigurirajte aplikacijo pred uporabo.",tourNumber:"≈†tevilka ture",tourPlaceholder:"Vnesite svojo ≈°tevilko ture (npr. 8610)",appLanguage:"Jezik aplikacije",finishSetup:"Zakljuƒçi nastavitev",setupInfoMessage:"Te nastavitve lahko pozneje spremenite v nastavitvah aplikacije.",unknownTour:"Neznana ≈°tevilka ture. Prosimo, kontaktirajte administratorja."},ie={ba:tt,en:st,de:at,si:rt},it=n.createContext(),nt="ba",de={getItem:d=>window.localStorage.getItem(d),setItem:(d,t)=>window.localStorage.setItem(d,t)},ot=({children:d})=>{const t=de.getItem("APP_LANG")||nt,[a,r]=n.useState(t),[i,p]=n.useState(ie[t]),[u,o]=n.useState(!1);n.useEffect(()=>{(()=>{const _=de.getItem("APP_LANG");_&&ie[_]&&_!==a&&(r(_),p(ie[_]))})()},[a]);const v={language:a,translations:i,isLoading:u,changeLanguage:P=>{ie[P]&&(r(P),p(ie[P]),de.setItem("APP_LANG",P))},t:(P,_)=>{const $=P.split(".");let I=i;for(const m of $)if(I&&I[m]!==void 0)I=I[m];else return _||P;return I}};return e.jsx(it.Provider,{value:v,children:d})},lt=new Date().getFullYear(),fe=["Januar","Februar","Mart","April","Maj","Juni","Juli","August","Septembar","Oktobar","Novembar","Decembar"],ct={"2025-11-07-8620":!0,"2025-11-10-8620":!0,"2025-11-17-8640":!0,"2025-11-25-8640":!0};function dt(){var ee;const d=We(),[t,a]=n.useState(lt),[r,i]=n.useState(new Date().getMonth()),[p,u]=n.useState(0),[o,x]=n.useState("night"),[f,v]=n.useState(new Date),P={default:{background:"from-blue-50 via-white to-purple-50"},sunrise:{background:"from-orange-100 via-pink-100 to-yellow-100"},afternoon:{background:"from-blue-100 via-cyan-100 to-sky-100"},evening:{background:"from-purple-100 via-pink-100 to-indigo-100"},night:{background:"from-slate-900 via-blue-900 to-indigo-900"}},_=()=>`bg-gradient-to-br ${(P[o]||P.night).background}`;n.useEffect(()=>{x("night")},[]),n.useEffect(()=>{const h=setInterval(()=>v(new Date),6e4);return()=>clearInterval(h)},[]);const[$,I]=n.useState(!0);n.useEffect(()=>{const h=setInterval(()=>{I(j=>!j)},400);return()=>clearInterval(h)},[]);const{driverName:m}=Re(),{data:b=[],isLoading:g}=Be(),{data:l=[]}=Fe(t),A=()=>{r===0?(i(11),a(t-1)):i(r-1)},L=()=>{r===11?(i(0),a(t+1)):i(r+1)},B=()=>{u(h=>h===0?b.length-1:h-1)},V=()=>{u(h=>h===b.length-1?0:h+1)};n.useEffect(()=>{if(b.length>0){const h=m?b.findIndex(j=>j.ime===m):b.findIndex(j=>j.aktivan);h>=0&&u(h)}},[b,m]);const X=((ee=b[p])==null?void 0:ee.ime)||"",T=b[p],{data:G=[],isLoading:te}=He(T==null?void 0:T.tura,t,r,{enabled:!!T}),se=te||g,Z=Oe(t,r,l.map(h=>h.date)),D=n.useMemo(()=>{if(!G.length)return[];const h=y=>{if(!y)return 0;const c=y.toString().replace("%","").replace(",",".").trim();return parseFloat(c)||0},j=[...G],w={};j.forEach(y=>{const c=`${y.date}-${y.tura}`;w[c]||(w[c]=0),w[c]+=y.produktivitaet_stops||0}),Object.keys(ct).forEach(y=>{const[c,k]=y.split("-"),z=`${c}-${k}`,E=w[z]||0;if(E<=0)return;w[z]=0;const ae=`${c}-8610`;w[ae]||(w[ae]=0),w[ae]+=E});const F=j.map(y=>{const c=`${y.date}-${y.tura}`,k=w[c]??y.produktivitaet_stops;return{...y,produktivitaet_stops:k}}),R={};return F.forEach(y=>{const c=new Date(y.date),k=c.getMonth();if(c.getFullYear()!==t||k!==r)return;const E=y.date;R[E]||(R[E]={date:E,stops:0,packages:0,pickupPackages:0,complaints:0,totalTime:0,realPercentage:h(y.zustellung_proc),undelivered:parseInt(y.zustellung_nedostavljeno)||0,pickupPercentage:h(y.pickup_proc),pickupUndelivered:parseInt(y.pickup_nedostavljeno)||0,firstComplaints:parseInt(y.probleme_prva)||0,secondComplaints:parseInt(y.probleme_druga)||0,stopsPerHourRaw:y.produktivitaet_stops_pro_std||"0"}),R[E].stops+=y.produktivitaet_stops||0,R[E].packages+=y.zustellung_paketi||0,R[E].pickupPackages+=parseInt(y.pickup_paketi)||0,R[E].complaints+=parseInt(y.probleme_druga)||0;const ne=(y.produktivitaet_dauer||"0:00").split(":"),le=(parseInt(ne[0])||0)*60+(parseInt(ne[1])||0);R[E].totalTime+=le}),Object.values(R).map(y=>{const c=y.realPercentage>0?y.realPercentage:y.stops>0?y.packages/y.stops*100:0;return{...y,percentage:c,stopsPerHour:y.totalTime>0?y.stops/(y.totalTime/60):0}}).sort((y,c)=>new Date(y.date).getTime()-new Date(c.date).getTime())},[G,t,r]),W=n.useMemo(()=>{const h=Z.length,j=D.filter(J=>J.stops>0).length,w=D.reduce((J,re)=>J+re.stops,0),F=D.reduce((J,re)=>J+re.packages,0),R=j>0?w/j:0,y=j>0?F/j:0,c=new Date,k=c.getFullYear(),z=c.getMonth();let E=0;if(t===k&&r===z){const J=c.getDate();E=Z.filter(re=>new Date(re).getDate()<=J).length}else t<k||t===k&&r<z?E=h:E=0;const ne=((T==null?void 0:T.target_per_day)||0)*h,le=w-ne;return{totalWorkdays:h,passedWorkdays:E,daysWithData:j,avgPackagesPerDay:Math.round(y),avgStopsPerDay:Math.round(R),totalStops:w,totalPackages:F,difference:le}},[Z,D,T,t,r]),Q=h=>h.toLocaleTimeString("bs-BA",{hour:"2-digit",minute:"2-digit",hour12:!1}),M=h=>h.toLocaleDateString("bs-BA",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),C=o==="night"?"#4ade80":"#15803d",S=o==="night"?"#fb7185":"#dc2626";return e.jsxs("div",{className:`min-h-screen ${_()} ${o==="night"?"text-white":"text-gray-800"}`,children:[e.jsx(Ue,{}),e.jsx(s.header,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:`${o==="night"?"bg-gray-800/40 border-gray-700/50":"bg-white/60 border-gray-200/50"} backdrop-blur-xl border-b sticky top-0 z-50`,children:e.jsx("div",{className:"max-w-7xl mx-auto px-3 sm:px-6 lg:px-8 py-3 md:py-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(s.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>d("/"),className:`p-2 rounded-xl ${o==="night"?"bg-gray-700/50 hover:bg-gray-600/50 text-gray-300":"bg-gray-100/50 hover:bg-gray-200/50 text-gray-600"} transition-all duration-200`,children:e.jsx(ke,{className:"w-6 h-6"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{className:`w-8 h-8 ${o==="night"?"text-blue-400":"text-blue-600"}`}),e.jsx("h1",{className:`text-2xl md:text-3xl font-bold ${o==="night"?"text-white":"text-gray-800"}`,children:"Vozaƒçi Statistike"})]})]})})}),e.jsxs("main",{className:"max-w-7xl mx-auto px-3 sm:px-6 lg:px-8 py-4 md:py-8",children:[e.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:`mb-6 p-4 md:p-6 rounded-2xl ${o==="night"?"bg-gray-800/40 border-gray-700/50":"bg-white/60 border-gray-200/30"} border backdrop-blur-xl`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx(s.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:A,className:`p-2 rounded-lg ${o==="night"?"bg-gray-700/50 hover:bg-gray-600/50":"bg-gray-100/50 hover:bg-gray-200/50"} transition-all`,children:e.jsx(me,{className:"w-5 h-5"})}),e.jsxs("div",{className:"text-center",children:[e.jsxs("h2",{className:`text-2xl font-bold ${o==="night"?"text-white":"text-gray-800"}`,children:[fe[r]," ",t]}),e.jsxs("p",{className:`text-sm ${o==="night"?"text-gray-400":"text-gray-600"} mt-1`,children:[Q(f)," ‚Ä¢ ",M(f)]})]}),e.jsx(s.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:L,className:`p-2 rounded-lg ${o==="night"?"bg-gray-700/50 hover:bg-gray-600/50":"bg-gray-100/50 hover:bg-gray-200/50"} transition-all`,children:e.jsx(ge,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex items-center justify-between mt-6 mb-6",children:[e.jsx(s.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:B,className:`p-2 rounded-lg ${o==="night"?"bg-gray-700/50 hover:bg-gray-600/50":"bg-gray-100/50 hover:bg-gray-200/50"} transition-all`,children:e.jsx(me,{className:"w-5 h-5"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:`text-xl font-bold ${o==="night"?"text-white":"text-gray-800"}`,children:X||"Nema vozaƒça"}),e.jsx("p",{className:`text-sm ${o==="night"?"text-gray-400":"text-gray-600"} mt-1`,children:b.length>0?`${p+1} / ${b.length}`:"0 / 0"})]}),e.jsx(s.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:V,className:`p-2 rounded-lg ${o==="night"?"bg-gray-700/50 hover:bg-gray-600/50":"bg-gray-100/50 hover:bg-gray-200/50"} transition-all`,children:e.jsx(ge,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs(s.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.2},className:`p-4 rounded-xl ${o==="night"?"bg-gray-700/30":"bg-gray-50/50"} backdrop-blur-sm flex items-center gap-3`,children:[e.jsx(Ne,{className:`w-6 h-6 ${o==="night"?"text-blue-400":"text-blue-600"}`}),e.jsxs("div",{children:[e.jsxs("div",{className:`text-2xl font-bold ${o==="night"?"text-white":"text-gray-800"}`,children:[W.passedWorkdays,"/",W.totalWorkdays]}),e.jsx("div",{className:`text-sm ${o==="night"?"text-gray-400":"text-gray-600"}`,children:"Radni dani"})]})]}),e.jsxs(s.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.3},className:`p-4 rounded-xl ${o==="night"?"bg-gray-700/30":"bg-gray-50/50"} backdrop-blur-sm flex items-center gap-3`,children:[e.jsx(pe,{className:`w-6 h-6 ${o==="night"?"text-green-400":"text-green-600"}`}),e.jsxs("div",{children:[e.jsx("div",{className:`text-2xl font-bold ${o==="night"?"text-white":"text-gray-800"}`,children:X||"‚Äî"}),e.jsx("div",{className:`text-sm ${o==="night"?"text-gray-400":"text-gray-600"}`,children:"Vozaƒç"})]})]}),e.jsxs(s.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.4},className:`p-4 rounded-xl ${o==="night"?"bg-gray-700/30":"bg-gray-50/50"} backdrop-blur-sm flex items-center gap-3`,children:[e.jsx(Se,{className:`w-6 h-6 ${o==="night"?"text-purple-400":"text-purple-600"}`}),e.jsxs("div",{children:[e.jsx("div",{className:`text-2xl font-bold ${o==="night"?"text-white":"text-gray-800"}`,children:W.totalStops}),e.jsx("div",{className:`text-sm ${o==="night"?"text-gray-400":"text-gray-600"}`,children:"Ukupno stopova"})]})]}),e.jsxs(s.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.5},className:`p-4 rounded-xl ${o==="night"?"bg-gray-700/30":"bg-gray-50/50"} backdrop-blur-sm flex items-center gap-3`,children:[e.jsx(Pe,{className:`w-6 h-6 ${W.difference>=0?o==="night"?"text-green-400":"text-green-600":o==="night"?"text-red-400":"text-red-600"}`}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-2xl font-bold",style:{color:W.difference>=0?C:S},children:[W.difference>0?"+":"",W.difference]}),e.jsx("div",{className:`text-sm ${o==="night"?"text-gray-400":"text-gray-600"}`,children:"Bilans"})]})]})]})]}),e.jsx(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.7},className:`rounded-2xl overflow-hidden ${o==="night"?"bg-gray-800/40 border-gray-700/50":"bg-white/60 border-gray-200/30"} border backdrop-blur-xl`,children:se?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx("div",{className:`w-8 h-8 border-2 rounded-full animate-spin ${o==="night"?"border-gray-600 border-t-white":"border-gray-300 border-t-blue-600"}`}),e.jsx("p",{className:`text-sm mt-4 ${o==="night"?"text-gray-400":"text-gray-600"}`,children:"Uƒçitavanje..."})]}):D.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(_e,{className:`w-12 h-12 mb-4 ${o==="night"?"text-gray-600":"text-gray-400"}`}),e.jsxs("p",{className:`text-lg font-medium mb-2 ${o==="night"?"text-white":"text-gray-900"}`,children:["Nema podataka za ",fe[r]," ",t]}),e.jsx("p",{className:`text-sm ${o==="night"?"text-gray-400":"text-gray-600"}`,children:"Odaberite vozaƒça iz liste da vidite statistiku"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full min-w-full",children:[e.jsx("thead",{className:`${o==="night"?"bg-gray-700/50 text-gray-300":"bg-gray-50 text-gray-700"}`,children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Datum"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Stopovi"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Paketi"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Pickup"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Reklamacije"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Vreme (h)"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Efikasnost"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Stop/h"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:[D.map((h,j)=>{const w=new Date(h.date),F=(T==null?void 0:T.target_per_day)||0,R=h.stops>=F;return e.jsxs(s.tr,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.8+j*.05},className:`transition-colors ${o==="night"?"hover:bg-gray-700/30":"hover:bg-gray-50"}`,children:[e.jsx("td",{className:"px-4 py-3 text-sm whitespace-nowrap font-medium",children:Xe(w,"dd.MM.")}),e.jsx("td",{className:"px-4 py-3 text-sm whitespace-nowrap",style:{color:R?C:S,fontWeight:"700"},children:h.stops||"‚Äì"}),e.jsx("td",{className:"px-4 py-3 text-sm whitespace-nowrap",children:h.packages||"‚Äì"}),e.jsx("td",{className:"px-4 py-3 text-sm whitespace-nowrap",children:h.pickupPackages||"‚Äì"}),e.jsxs("td",{className:"px-4 py-3 text-sm whitespace-nowrap",style:h.secondComplaints>0?{backgroundColor:$?"#ffffff":"#f44336",color:$?"#f44336":"#ffffff",fontWeight:"900",textAlign:"center",transition:"all 0.3s",outline:$?"2px solid #f44336":"none",outlineOffset:"-2px",borderRadius:"4px"}:{},children:[h.secondComplaints>0&&e.jsxs("div",{className:"flex items-center gap-1 justify-center",children:[e.jsx(xe,{className:"w-4 h-4"}),h.secondComplaints]}),h.secondComplaints===0&&"‚Äì"]}),e.jsx("td",{className:"px-4 py-3 text-sm whitespace-nowrap",children:h.totalTime?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ie,{className:"w-4 h-4"}),`${(h.totalTime/60).toFixed(1)}h`]}):"‚Äì"}),e.jsx("td",{className:"px-4 py-3 text-sm whitespace-nowrap",style:{color:h.percentage>=98?C:S,fontWeight:"600"},children:h.percentage?`${h.percentage.toFixed(1)}%`:"‚Äì"}),e.jsx("td",{className:"px-4 py-3 text-sm whitespace-nowrap",children:h.stopsPerHour?h.stopsPerHour.toFixed(1):"‚Äì"})]},j)}),e.jsxs(s.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1.2},className:`${o==="night"?"bg-gray-700/70 font-bold":"bg-gray-50 font-bold"}`,children:[e.jsx("td",{className:"px-4 py-3 text-sm whitespace-nowrap",children:e.jsx("strong",{children:"Ukupno"})}),e.jsx("td",{className:"px-4 py-3 text-sm whitespace-nowrap",style:{color:W.difference>=0?C:S,fontWeight:"900"},children:e.jsxs("strong",{children:[W.totalStops," (",W.difference>0?"+":"",W.difference,")"]})}),e.jsx("td",{className:"px-4 py-3 text-sm whitespace-nowrap",children:e.jsx("strong",{children:W.totalPackages})}),e.jsx("td",{className:"px-4 py-3 text-sm whitespace-nowrap",children:e.jsx("strong",{children:D.reduce((h,j)=>h+(j.pickupPackages||0),0)})}),e.jsx("td",{className:"px-4 py-3 text-sm whitespace-nowrap",style:D.reduce((j,w)=>j+(w.secondComplaints||0),0)>0?{backgroundColor:$?"#ffffff":"#f44336",color:$?"#f44336":"#ffffff",fontWeight:"900",transition:"all 0.3s",borderRadius:"4px",outline:$?"2px solid #f44336":"none",textAlign:"center"}:{color:C,fontWeight:"700"},children:e.jsx("strong",{children:(()=>{const h=D.reduce((j,w)=>j+(w.secondComplaints||0),0);return h>0?e.jsxs("div",{className:"flex items-center gap-1 justify-center",children:[e.jsx(xe,{className:"w-4 h-4"}),h]}):h})()})}),e.jsx("td",{className:"px-4 py-3 text-sm whitespace-nowrap",children:e.jsx("strong",{children:(()=>{const h=D.reduce((j,w)=>j+(w.totalTime||0),0);return h?`${(h/60).toFixed(1)}h`:"‚Äì"})()})}),e.jsx("td",{className:"px-4 py-3 text-sm whitespace-nowrap",children:e.jsx("strong",{children:(()=>{const h=D.filter(w=>w.percentage&&w.percentage>0),j=h.length>0?h.reduce((w,F)=>w+F.percentage,0)/h.length:0;return j>0?`${j.toFixed(1)}%`:"‚Äì"})()})}),e.jsx("td",{className:"px-4 py-3 text-sm whitespace-nowrap",children:e.jsx("strong",{children:(()=>{const h=D.filter(w=>w.stopsPerHour&&w.stopsPerHour>0),j=h.length>0?(h.reduce((w,F)=>w+F.stopsPerHour,0)/h.length).toFixed(1):"‚Äì";return j!=="NaN"?j:"‚Äì"})()})})]})]})]})})})]})]})}function ht({driver:d,onContinue:t,onLogin:a,onBack:r,loading:i}){const[p,u]=n.useState(""),[o,x]=n.useState(!1),[f,v]=n.useState(null),[P,_]=n.useState(!1),[$,I]=n.useState(!1),[m,b]=n.useState(!1),[g,l]=n.useState("medium"),[A,L]=n.useState(!1),[B,V]=n.useState(!1),[X,T]=n.useState(!1);n.useEffect(()=>{const C=window.matchMedia("(prefers-color-scheme: dark)");b(C.matches);const S=ee=>b(ee.matches);return C.addEventListener("change",S),()=>C.removeEventListener("change",S)},[]),n.useEffect(()=>{const C=S=>{S.key==="Escape"&&(u(""),v(null))};return window.addEventListener("keydown",C),()=>window.removeEventListener("keydown",C)},[]);const G=()=>{navigator.vibrate&&navigator.vibrate(50)},te=C=>{if(C.preventDefault(),!p.trim()){v("Molimo unesite lozinku"),T(!0),G(),setTimeout(()=>T(!1),500);return}v(null),V(!0),G(),setTimeout(()=>{a(d.tura,p,o)},800)},se=C=>{const S=C.target.value;u(S),S&&S.length<4?v("Lozinka mora imati najmanje 4 karaktera"):v(null)},Z={small:"text-sm",medium:"text-base",large:"text-lg"},D=m?"bg-gradient-to-br from-gray-900 to-blue-900 text-white":"bg-gradient-to-br from-gray-50 to-blue-50 text-gray-800",W=m?"bg-gray-800/90 backdrop-blur-lg border border-gray-700/50":"bg-white/90 backdrop-blur-lg border border-white/50",Q=m?"bg-gray-700/50 border-gray-600 text-white placeholder-gray-400 focus:ring-blue-400":"bg-white/80 border-gray-300 text-gray-800 placeholder-gray-500 focus:ring-blue-400",M=m?"bg-blue-700 hover:bg-blue-600 disabled:bg-gray-700":"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-300";return e.jsxs("div",{className:`min-h-screen flex items-center justify-center relative overflow-hidden ${D} ${Z[g]} ${A?"contrast-150":""}`,children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[[...Array(15)].map((C,S)=>e.jsx(s.div,{className:`absolute w-2 h-2 rounded-full ${m?"bg-blue-400/20":"bg-blue-300/30"}`,initial:{x:Math.random()*window.innerWidth,y:Math.random()*window.innerHeight},animate:{x:Math.random()*window.innerWidth,y:Math.random()*window.innerHeight},transition:{duration:Math.random()*10+20,repeat:1/0,repeatType:"reverse"}},S)),[...Array(6)].map((C,S)=>e.jsx(s.div,{className:`absolute opacity-20 ${m?"bg-gradient-to-r from-blue-600 to-purple-600":"bg-gradient-to-r from-blue-400 to-cyan-400"}`,style:{width:Math.random()*80+40,height:Math.random()*80+40,borderRadius:Math.random()*40+20,left:Math.random()*100+"%",top:Math.random()*100+"%"},animate:{rotate:360,scale:[1,1.1,1]},transition:{duration:Math.random()*15+25,repeat:1/0}},`shape-${S}`))]}),e.jsxs("div",{className:"absolute top-4 right-4 flex gap-2",children:[e.jsx(s.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>b(!m),className:`w-10 h-10 rounded-full ${W} flex items-center justify-center`,title:"Toggle Dark Mode",children:m?"‚òÄÔ∏è":"üåô"}),e.jsx(s.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>l(g==="small"?"medium":g==="medium"?"large":"small"),className:`w-10 h-10 rounded-full ${W} flex items-center justify-center text-sm`,title:"Font Size",children:"Aa"}),e.jsx(s.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>L(!A),className:`w-10 h-10 rounded-full ${W} flex items-center justify-center`,title:"High Contrast",children:"‚ö´"})]}),e.jsxs(s.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0,...X&&{x:[0,-10,10,-10,10,0],transition:{duration:.5}}},className:`w-full max-w-lg ${W} rounded-2xl shadow-2xl p-8 flex flex-col gap-6 relative z-10`,children:[e.jsx(U,{children:B&&e.jsx(s.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 pointer-events-none",children:[...Array(12)].map((C,S)=>e.jsx(s.div,{className:"absolute w-2 h-2 bg-green-500 rounded",initial:{x:"50%",y:"50%",scale:0},animate:{x:Math.random()*250-125,y:Math.random()*250-125,scale:1,rotate:Math.random()*360},transition:{duration:.8,delay:S*.05}},S))})}),e.jsxs(s.div,{className:"flex flex-col items-center gap-3",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{delay:.2},children:[e.jsx(s.div,{className:`w-16 h-16 rounded-full flex items-center justify-center mb-2 ${m?"bg-gradient-to-br from-green-600 to-blue-600":"bg-gradient-to-br from-green-500 to-blue-500"}`,animate:{boxShadow:["0 0 20px rgba(34, 197, 94, 0.3)","0 0 30px rgba(34, 197, 94, 0.5)","0 0 20px rgba(34, 197, 94, 0.3)"]},transition:{duration:2,repeat:1/0},children:e.jsxs(s.svg,{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"text-white",initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:500,damping:30,delay:.3},children:[e.jsx(s.path,{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1.5,delay:.5}}),e.jsx(s.circle,{cx:"12",cy:"7",r:"4",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1.5,delay:.8}})]})}),e.jsx(s.h1,{className:`text-2xl font-bold ${m?"text-white":"text-gray-800"}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},children:"Vozaƒç pronaƒëen"}),e.jsx(s.p,{className:`text-center ${m?"text-gray-300":"text-gray-600"}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},children:"Uspje≈°no smo identificirali va≈° profil"})]}),e.jsx(s.div,{className:`${W} rounded-xl p-4 shadow-lg`,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.8},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(s.h2,{className:`text-xl font-bold ${m?"text-white":"text-gray-800"}`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:1},children:d.ime}),e.jsxs("div",{className:"flex flex-col gap-2 mt-3",children:[e.jsxs(s.div,{className:"flex items-center gap-2",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:1.2},children:[e.jsx("span",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${m?"bg-blue-700/50":"bg-blue-100"}`,children:e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:m?"text-blue-300":"text-blue-600",children:[e.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"8.5",cy:"7",r:"4"}),e.jsx("path",{d:"m20 8 2 2-2 2"}),e.jsx("path",{d:"m16 12-2-2 2-2"})]})}),e.jsxs("span",{className:`font-medium ${m?"text-gray-200":"text-gray-700"}`,children:["Tura: ",d.tura]})]}),e.jsxs(s.div,{className:"flex items-center gap-2",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:1.4},children:[e.jsx("span",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${m?"bg-purple-700/50":"bg-purple-100"}`,children:e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:m?"text-purple-300":"text-purple-600",children:[e.jsx("path",{d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"}),e.jsx("path",{d:"m19.4 15-1.1-2.3c-.4-.8-1.2-1.3-2.1-1.3H7.8c-.9 0-1.7.5-2.1 1.3L4.6 15"}),e.jsx("path",{d:"M12 8v7"})]})}),e.jsx("span",{className:`font-medium ${m?"text-gray-200":"text-gray-700"}`,children:d.role==="admin"?"Administrator":"Vozaƒç"})]})]})]}),e.jsx(s.div,{className:"flex flex-col items-center",initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},transition:{delay:1.6},children:d.hasPassword?e.jsxs("div",{className:`flex items-center gap-2 px-3 py-2 rounded-lg ${m?"bg-green-800/50 text-green-300":"bg-green-100 text-green-700"}`,children:[e.jsxs(s.svg,{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",animate:{scale:[1,1.1,1]},transition:{duration:2,repeat:1/0},children:[e.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),e.jsx("circle",{cx:"12",cy:"16",r:"1"}),e.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),e.jsx("span",{className:"text-sm font-medium",children:"Veƒá imate lozinku"})]}):e.jsxs("div",{className:`flex items-center gap-2 px-3 py-2 rounded-lg ${m?"bg-orange-800/50 text-orange-300":"bg-orange-100 text-orange-700"}`,children:[e.jsxs(s.svg,{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",animate:{scale:[1,1.1,1]},transition:{duration:2,repeat:1/0},children:[e.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),e.jsx("path",{d:"M7 11V7a5 5 0 0 1 9.9-1"})]}),e.jsx("span",{className:"text-sm font-medium",children:"Potrebno je postaviti lozinku"})]})})]})}),d.hasPassword?e.jsxs(s.form,{onSubmit:te,className:"flex flex-col gap-4",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1.8},children:[e.jsxs("div",{className:"relative",children:[e.jsx(s.input,{type:P?"text":"password",id:"password",value:p,onChange:se,onFocus:()=>I(!0),onBlur:()=>I(!1),placeholder:" ",disabled:i,autoFocus:!0,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 text-lg peer transition-all duration-300 ${Q}`,animate:{scale:$?1.02:1,boxShadow:$?"0 0 20px rgba(59, 130, 246, 0.3)":"0 0 0px rgba(59, 130, 246, 0)"}}),e.jsx(s.label,{htmlFor:"password",className:`absolute left-4 transition-all duration-300 pointer-events-none ${m?"text-gray-400":"text-gray-500"} ${$||p?"-top-2 text-xs bg-inherit px-2 font-medium":"top-3 text-base"}`,animate:{color:$?"#3b82f6":m?"#9ca3af":"#6b7280"},children:"Lozinka"}),e.jsx(s.button,{type:"button",className:`absolute right-3 top-1/2 -translate-y-1/2 p-1 rounded ${m?"text-gray-400 hover:text-gray-200":"text-gray-500 hover:text-gray-700"}`,onClick:()=>_(!P),disabled:i,whileHover:{scale:1.1},whileTap:{scale:.9},children:e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:P?e.jsxs(e.Fragment,{children:[e.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"}),e.jsx("path",{d:"m1 1 22 22"})]}):e.jsxs(e.Fragment,{children:[e.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),e.jsx("circle",{cx:"12",cy:"12",r:"3"})]})})}),p&&!f&&e.jsx(s.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},className:"absolute right-12 top-1/2 -translate-y-1/2",children:e.jsx("div",{className:"flex gap-1",children:[0,1,2].map(C=>e.jsx(s.div,{className:"w-1 h-1 bg-green-500 rounded-full",animate:{scale:[1,1.5,1],opacity:[.3,1,.3]},transition:{duration:1,repeat:1/0,delay:C*.2}},C))})})]}),e.jsx(U,{children:f&&e.jsxs(s.div,{initial:{opacity:0,height:0,scale:.8},animate:{opacity:1,height:"auto",scale:1},exit:{opacity:0,height:0,scale:.8},className:`flex items-center gap-2 border rounded-lg px-3 py-2 ${m?"bg-red-900/20 border-red-800 text-red-400":"bg-red-50 border-red-200 text-red-700"}`,children:[e.jsxs(s.svg,{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"text-red-500",animate:{rotate:[0,10,-10,0]},transition:{duration:.5},children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),e.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),e.jsx("span",{children:f})]})}),e.jsxs(s.label,{className:"flex items-center gap-2 text-sm cursor-pointer",whileHover:{scale:1.02},children:[e.jsx("input",{type:"checkbox",checked:o,onChange:C=>x(C.target.checked),disabled:i,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:m?"text-gray-300":"text-gray-600",children:"Zapamti me"})]}),e.jsxs("div",{className:"flex gap-3 mt-4",children:[e.jsxs(s.button,{type:"button",className:`flex-1 flex items-center justify-center gap-2 font-semibold py-3 rounded-lg border transition-all duration-300 ${m?"border-gray-600 text-gray-300 hover:bg-gray-700/50":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,onClick:r,disabled:i,whileHover:{scale:1.02},whileTap:{scale:.98},children:[e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"m15 18-6-6 6-6"})}),"Nazad"]}),e.jsxs(s.button,{type:"submit",className:`flex-2 relative overflow-hidden flex items-center justify-center gap-2 font-semibold py-3 rounded-lg shadow transition-all duration-300 ${M}`,disabled:i||!p.trim(),whileHover:{scale:1.02},whileTap:{scale:.98},animate:X?{x:[0,-10,10,-10,10,0]}:{},children:[e.jsx(s.div,{className:"absolute inset-0 bg-white/20 rounded-full pointer-events-none",initial:{scale:0,opacity:1},animate:{scale:4,opacity:0},transition:{duration:.6}}),i?e.jsxs(e.Fragment,{children:[e.jsx(s.span,{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}}),"Prijavljivam..."]}):B?e.jsxs(e.Fragment,{children:[e.jsxs(s.svg,{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:500,damping:30},children:[e.jsx("path",{d:"m9 12 2 2 4-4"}),e.jsx("circle",{cx:"12",cy:"12",r:"10"})]}),"Uspje≈°no!"]}):e.jsxs(e.Fragment,{children:[e.jsx(s.svg,{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",whileHover:{x:5},transition:{type:"spring",stiffness:400,damping:30},children:e.jsx("path",{d:"m9 18 6-6-6-6"})}),"Prijavite se"]})]})]})]}):e.jsxs(s.div,{className:"flex gap-3 mt-4",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1.8},children:[e.jsxs(s.button,{type:"button",className:`flex-1 flex items-center justify-center gap-2 font-semibold py-3 rounded-lg border transition-all duration-300 ${m?"border-gray-600 text-gray-300 hover:bg-gray-700/50":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,onClick:r,disabled:i,whileHover:{scale:1.02},whileTap:{scale:.98},children:[e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"m15 18-6-6 6-6"})}),"Nazad"]}),e.jsxs(s.button,{type:"button",className:`flex-2 relative overflow-hidden flex items-center justify-center gap-2 font-semibold py-3 rounded-lg shadow transition-all duration-300 ${M}`,onClick:t,disabled:i,whileHover:{scale:1.02},whileTap:{scale:.98},children:[e.jsx(s.div,{className:"absolute inset-0 bg-white/20 rounded-full pointer-events-none",initial:{scale:0,opacity:1},animate:{scale:4,opacity:0},transition:{duration:.6}}),i?e.jsxs(e.Fragment,{children:[e.jsx(s.span,{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}}),"Molim saƒçekajte..."]}):e.jsxs(e.Fragment,{children:[e.jsxs(s.svg,{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",whileHover:{x:5},transition:{type:"spring",stiffness:400,damping:30},children:[e.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),e.jsx("path",{d:"M7 11V7a5 5 0 0 1 9.9-1"})]}),"Postavite lozinku"]})]})]}),e.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:2},children:[e.jsx(s.div,{className:`w-10 h-10 rounded-full flex items-center justify-center ${m?"bg-gradient-to-br from-gray-700 to-gray-600":"bg-gradient-to-br from-gray-100 to-gray-200"}`,animate:{rotate:[0,5,-5,0]},transition:{duration:3,repeat:1/0,ease:"easeInOut"},children:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:m?"text-gray-300":"text-gray-500",children:[e.jsx(s.rect,{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1,delay:2.2}}),e.jsx(s.circle,{cx:"12",cy:"16",r:"1",initial:{scale:0},animate:{scale:1},transition:{duration:.5,delay:2.4}}),e.jsx(s.path,{d:"M7 11V7a5 5 0 0 1 10 0v4",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1,delay:2}})]})}),e.jsx(s.p,{className:`text-sm text-center ${m?"text-gray-400":"text-gray-500"}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:2.2},children:"Provjerite da li su podaci ispravni prije nastavka"})]})]})]})}function ut({driver:d,onPasswordSet:t,onBack:a,loading:r}){const[i,p]=n.useState(""),[u,o]=n.useState(""),[x,f]=n.useState(!1),[v,P]=n.useState(!1),[_,$]=n.useState(!0),[I,m]=n.useState(""),[b,g]=n.useState(""),[l,A]=n.useState(()=>localStorage.getItem("theme")==="dark"||!localStorage.getItem("theme")&&window.matchMedia("(prefers-color-scheme: dark)").matches),[L,B]=n.useState(()=>localStorage.getItem("fontSize")||"medium"),[V,X]=n.useState(()=>localStorage.getItem("highContrast")==="true"),[T,G]=n.useState(!1),[te,se]=n.useState([]),[Z,D]=n.useState(!1),[W,Q]=n.useState([]),[M,C]=n.useState({score:0,feedback:"Unesite lozinku"}),S={background:l?"bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900":"bg-gradient-to-br from-purple-50 via-white to-pink-50",container:l?"bg-gray-800/40 backdrop-blur-xl border-gray-700/50":"bg-white/40 backdrop-blur-xl border-white/50",card:l?"bg-gray-800/60 backdrop-blur-xl border-gray-700/50":"bg-white/60 backdrop-blur-xl border-white/60",input:l?"bg-gray-800/60 border-gray-600 text-white placeholder-gray-400 focus:border-purple-500 focus:bg-gray-800/80":"bg-white/60 border-gray-200 text-gray-900 placeholder-gray-500 focus:border-purple-500 focus:bg-white/80",text:l?"text-gray-100":"text-gray-900"},ee=`${S.container} ${L==="small"?"text-sm":L==="large"?"text-lg":"text-base"} ${V?"contrast-125":""}`,h=`${S.card} ${V?"shadow-2xl":"shadow-xl"}`,j=`${S.input} ${V?"shadow-inner border-2":"border"}`,w=c=>{if(!c)return{score:0,feedback:"Unesite lozinku"};let k=0,z="";c.length>=8&&k++,c.length>=12&&k++,/[a-z]/.test(c)&&k++,/[A-Z]/.test(c)&&k++,/[0-9]/.test(c)&&k++,/[^a-zA-Z0-9]/.test(c)&&k++;const E=Math.min(Math.max(Math.floor(k/1.5),1),4);switch(E){case 1:z="Slaba lozinka";break;case 2:z="Umjereno jaka lozinka";break;case 3:z="Jaka lozinka";break;case 4:z="Vrlo jaka lozinka";break;default:z="Unesite lozinku"}return{score:E,feedback:z}};n.useEffect(()=>{(()=>{const k=Array.from({length:20},(z,E)=>({id:E,x:Math.random()*100,y:Math.random()*100,size:Math.random()*4+1,duration:Math.random()*20+10,delay:Math.random()*5,opacity:Math.random()*.5+.1}));se(k)})()},[]),n.useEffect(()=>{C(w(i))},[i]),n.useEffect(()=>{localStorage.setItem("theme",l?"dark":"light"),document.documentElement.classList.toggle("dark",l)},[l]),n.useEffect(()=>{localStorage.setItem("fontSize",L)},[L]),n.useEffect(()=>{localStorage.setItem("highContrast",V.toString())},[V]),n.useEffect(()=>{const c=k=>{k.ctrlKey&&k.key==="d"&&(k.preventDefault(),A(!l)),k.ctrlKey&&k.key==="="&&(k.preventDefault(),B(z=>z==="small"?"medium":"large")),k.ctrlKey&&k.key==="-"&&(k.preventDefault(),B(z=>z==="large"?"medium":"small")),k.key==="Escape"&&G(!1)};return window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[l]);const F=()=>{const c=Array.from({length:50},(k,z)=>({id:z,x:Math.random()*100,y:-10,rotation:Math.random()*360,scale:Math.random()*.8+.4,color:["#8b5cf6","#ec4899","#06b6d4","#10b981","#f59e0b"][Math.floor(Math.random()*5)]}));Q(c),setTimeout(()=>Q([]),3e3)},R=()=>{navigator.vibrate&&navigator.vibrate(50)},y=async c=>{if(c.preventDefault(),!i.trim()||!u.trim()){m("Molimo unesite oba polja"),R();return}if(i!==u){m("Lozinke se ne poklapaju"),R();return}if(M.score<2){m("Lozinka mora biti jaƒça"),R();return}m(""),D(!0),F();try{await t(i,_)}catch(k){m(k.message||"Gre≈°ka pri postavljanju lozinke"),D(!1),R()}};return e.jsxs("div",{className:`min-h-screen relative overflow-hidden ${S.background}`,children:[e.jsx("div",{className:"absolute inset-0 overflow-hidden",children:te.map(c=>e.jsx(s.div,{className:`absolute w-2 h-2 rounded-full ${l?"bg-purple-400/20":"bg-purple-500/10"}`,style:{left:`${c.x}%`,top:`${c.y}%`,width:`${c.size}px`,height:`${c.size}px`},animate:{y:[0,-30,0],opacity:[c.opacity,c.opacity*1.5,c.opacity],scale:[1,1.2,1]},transition:{duration:c.duration,delay:c.delay,repeat:1/0,ease:"easeInOut"}},c.id))}),e.jsx(U,{children:W.map(c=>e.jsx(s.div,{className:"absolute w-3 h-3 rounded-sm",style:{left:`${c.x}%`,backgroundColor:c.color,rotate:c.rotation,scale:c.scale},initial:{y:-50},animate:{y:window.innerHeight+100,rotate:c.rotation+360*2,opacity:[1,1,0]},transition:{duration:3,ease:"easeIn"},exit:{opacity:0}},c.id))}),e.jsx(U,{children:T&&e.jsx(s.div,{className:"fixed top-4 right-4 z-50",initial:{opacity:0,x:20,scale:.9},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:20,scale:.9},children:e.jsxs("div",{className:`${h} p-4 rounded-2xl border shadow-2xl min-w-[200px]`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:`font-semibold ${S.text}`,children:"Postavke"}),e.jsx("button",{onClick:()=>G(!1),className:`p-1 rounded-lg transition-colors ${l?"hover:bg-gray-700":"hover:bg-gray-100"}`,children:e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:S.text,children:[e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:l,onChange:c=>A(c.target.checked),className:"rounded"}),e.jsx("span",{className:`text-sm ${S.text}`,children:"Tamna tema"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:V,onChange:c=>X(c.target.checked),className:"rounded"}),e.jsx("span",{className:`text-sm ${S.text}`,children:"Visoki kontrast"})]}),e.jsxs("div",{children:[e.jsx("label",{className:`text-sm ${S.text} block mb-1`,children:"Veliƒçina fonta"}),e.jsxs("select",{value:L,onChange:c=>B(c.target.value),className:`w-full p-1 rounded text-sm ${j}`,children:[e.jsx("option",{value:"small",children:"Mala"}),e.jsx("option",{value:"medium",children:"Srednja"}),e.jsx("option",{value:"large",children:"Velika"})]})]})]}),e.jsx("div",{className:`mt-3 pt-3 border-t ${l?"border-gray-700":"border-gray-200"}`,children:e.jsxs("p",{className:`text-xs ${l?"text-gray-400":"text-gray-500"}`,children:["Ctrl+D: Tamna tema",e.jsx("br",{}),"Ctrl++/-: Veliƒçina fonta"]})})]})})}),e.jsx(s.button,{onClick:()=>G(!T),className:`fixed top-4 right-4 z-40 p-3 rounded-full ${h} border shadow-lg transition-all duration-300 ${l?"hover:bg-gray-700":"hover:bg-gray-50"}`,whileHover:{scale:1.05},whileTap:{scale:.95},initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},transition:{delay:.5},children:e.jsxs(s.svg,{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:S.text,animate:{rotate:T?180:0},transition:{duration:.3},children:[e.jsx("circle",{cx:"12",cy:"12",r:"3"}),e.jsx("path",{d:"m12 1 1.7 1.7"}),e.jsx("path",{d:"m12 23-1.7-1.7"}),e.jsx("path",{d:"m5.6 5.6 1.4 1.4"}),e.jsx("path",{d:"m18.4 18.4-1.4-1.4"}),e.jsx("path",{d:"m1 12 1.7-1.7"}),e.jsx("path",{d:"m23 12-1.7 1.7"}),e.jsx("path",{d:"m5.6 18.4 1.4-1.4"}),e.jsx("path",{d:"m18.4 5.6-1.4 1.4"})]})}),e.jsx("div",{className:"relative z-10 min-h-screen flex items-center justify-center p-4",children:e.jsxs(s.div,{className:`w-full max-w-md ${ee} rounded-3xl border p-8 shadow-2xl space-y-8`,initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},transition:{duration:.5},children:[e.jsxs(s.div,{className:"flex flex-col items-center gap-3",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{delay:.2},children:[e.jsx(s.div,{className:`w-16 h-16 rounded-full flex items-center justify-center mb-2 ${l?"bg-gradient-to-br from-purple-600 to-pink-600":"bg-gradient-to-br from-purple-500 to-pink-500"}`,animate:{boxShadow:["0 0 20px rgba(168, 85, 247, 0.3)","0 0 30px rgba(168, 85, 247, 0.5)","0 0 20px rgba(168, 85, 247, 0.3)"]},transition:{duration:2,repeat:1/0},children:e.jsxs(s.svg,{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"text-white",initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:500,damping:30,delay:.3},children:[e.jsx(s.rect,{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1.5,delay:.5}}),e.jsx(s.circle,{cx:"12",cy:"16",r:"1",initial:{scale:0},animate:{scale:1},transition:{duration:.5,delay:1}}),e.jsx(s.path,{d:"M7 11V7a5 5 0 0 1 10 0v4",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1.5,delay:.8}})]})}),e.jsx(s.h1,{className:`text-2xl font-bold ${l?"text-white":"text-gray-800"}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},children:"Postavite lozinku"}),e.jsx(s.p,{className:`text-center ${l?"text-gray-300":"text-gray-600"}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},children:"Ovo je va≈° prvi put. Molimo postavite lozinku za buduƒái pristup."})]}),e.jsx(s.div,{className:`${h} rounded-xl p-4 shadow-lg`,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.8},children:e.jsxs("div",{className:"flex items-center justify-center gap-6",children:[e.jsxs(s.div,{className:"flex items-center gap-2",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:1},children:[e.jsx("span",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${l?"bg-purple-700/50":"bg-purple-100"}`,children:e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:l?"text-purple-300":"text-purple-600",children:[e.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),e.jsxs("span",{className:`font-medium ${l?"text-gray-200":"text-gray-700"}`,children:[e.jsx("strong",{children:"Vozaƒç:"})," ",d.ime]})]}),e.jsxs(s.div,{className:"flex items-center gap-2",initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:1.2},children:[e.jsx("span",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${l?"bg-blue-700/50":"bg-blue-100"}`,children:e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:l?"text-blue-300":"text-blue-600",children:[e.jsx("circle",{cx:"12",cy:"12",r:"3"}),e.jsx("path",{d:"M12 1v6m0 6v6"})]})}),e.jsxs("span",{className:`font-medium ${l?"text-gray-200":"text-gray-700"}`,children:[e.jsx("strong",{children:"Tura:"})," ",d.tura]})]})]})}),e.jsxs(s.form,{onSubmit:y,className:"flex flex-col gap-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1.4},children:[e.jsxs(s.div,{className:"relative",animate:I?{x:[-10,10,-10,10,0]}:{},transition:{type:"spring",stiffness:500,damping:30},children:[e.jsxs("div",{className:"relative",children:[e.jsx(s.input,{type:x?"text":"password",value:i,onChange:c=>p(c.target.value),className:`w-full px-4 pt-6 pb-2 border-2 rounded-xl transition-all duration-300 ${j} peer ${I?"border-red-500 bg-red-50/50":i?"border-purple-500 bg-purple-50/20":""}`,placeholder:" ",onFocus:()=>g("password"),onBlur:()=>g(""),initial:{opacity:0},animate:{opacity:1},transition:{delay:1.6},disabled:r,autoFocus:!0}),e.jsx(s.label,{className:`absolute left-4 transition-all duration-300 pointer-events-none ${i||b==="password"?`text-xs top-2 ${l?"text-purple-400":"text-purple-600"}`:`text-base top-4 ${l?"text-gray-400":"text-gray-500"}`}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:1.8},children:"Lozinka"}),e.jsx(U,{children:i&&e.jsx(s.button,{type:"button",onClick:()=>f(!x),className:`absolute right-3 top-1/2 -translate-y-1/2 p-2 rounded-lg transition-colors ${l?"text-gray-400 hover:text-white hover:bg-gray-700":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},exit:{opacity:0,scale:0},whileHover:{scale:1.1},whileTap:{scale:.9},disabled:r,children:x?e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"}),e.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}):e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),e.jsx("circle",{cx:"12",cy:"12",r:"3"})]})})})]}),e.jsx(U,{children:i&&e.jsxs(s.div,{className:"mt-3 space-y-2",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:[e.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4].map(c=>e.jsx(s.div,{className:`h-1 rounded-full flex-1 ${c<=M.score?M.score===1?"bg-red-500":M.score===2?"bg-orange-500":M.score===3?"bg-yellow-500":"bg-green-500":l?"bg-gray-700":"bg-gray-200"}`,initial:{scaleX:0},animate:{scaleX:c<=M.score?1:0},transition:{delay:c*.1}},c))}),e.jsx(s.p,{className:`text-sm ${M.score===1?"text-red-500":M.score===2?"text-orange-500":M.score===3?"text-yellow-500":"text-green-500"}`,initial:{opacity:0},animate:{opacity:1},children:M.feedback})]})})]}),e.jsxs(s.div,{className:"relative",animate:I?{x:[-10,10,-10,10,0]}:{},transition:{type:"spring",stiffness:500,damping:30},children:[e.jsxs("div",{className:"relative",children:[e.jsx(s.input,{type:v?"text":"password",value:u,onChange:c=>o(c.target.value),className:`w-full px-4 pt-6 pb-2 border-2 rounded-xl transition-all duration-300 ${j} peer ${I?"border-red-500 bg-red-50/50":u?"border-purple-500 bg-purple-50/20":""}`,placeholder:" ",onFocus:()=>g("confirmPassword"),onBlur:()=>g(""),initial:{opacity:0},animate:{opacity:1},transition:{delay:2},disabled:r}),e.jsx(s.label,{className:`absolute left-4 transition-all duration-300 pointer-events-none ${u||b==="confirmPassword"?`text-xs top-2 ${l?"text-purple-400":"text-purple-600"}`:`text-base top-4 ${l?"text-gray-400":"text-gray-500"}`}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:2.2},children:"Potvrdite lozinku"}),e.jsx(U,{children:u&&e.jsx(s.button,{type:"button",onClick:()=>P(!v),className:`absolute right-3 top-1/2 -translate-y-1/2 p-2 rounded-lg transition-colors ${l?"text-gray-400 hover:text-white hover:bg-gray-700":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},exit:{opacity:0,scale:0},whileHover:{scale:1.1},whileTap:{scale:.9},disabled:r,children:v?e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"}),e.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}):e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),e.jsx("circle",{cx:"12",cy:"12",r:"3"})]})})})]}),e.jsx(U,{children:u&&e.jsxs(s.div,{className:`mt-2 flex items-center gap-2 text-sm ${i===u?"text-green-500":"text-red-500"}`,initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},children:[i===u?e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("polyline",{points:"20,6 9,17 4,12"})}):e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),e.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),i===u?"Lozinke se poklapaju":"Lozinke se ne poklapaju"]})})]}),e.jsx(U,{children:I&&e.jsxs(s.div,{className:`p-4 rounded-xl flex items-center gap-3 ${l?"bg-red-900/30 border border-red-800 text-red-300":"bg-red-50 border border-red-200 text-red-700"}`,initial:{opacity:0,scale:.95,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-10},children:[e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),e.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),I]})}),e.jsx(U,{children:Z&&e.jsxs(s.div,{className:`p-4 rounded-xl flex items-center gap-3 ${l?"bg-green-900/30 border border-green-800 text-green-300":"bg-green-50 border border-green-200 text-green-700"}`,initial:{opacity:0,scale:.95,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-10},children:[e.jsx(s.svg,{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:500,damping:30},children:e.jsx("polyline",{points:"20,6 9,17 4,12"})}),"Lozinka je uspje≈°no postavljena! Ulogujemo vas..."]})}),e.jsx(s.div,{className:"flex items-center gap-3",initial:{opacity:0},animate:{opacity:1},transition:{delay:2.4},children:e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"checkbox",checked:_,onChange:c=>$(c.target.checked),disabled:r,className:"sr-only"}),e.jsx(s.div,{className:`w-6 h-6 rounded-lg border-2 flex items-center justify-center transition-all duration-300 ${_?l?"bg-purple-600 border-purple-600":"bg-purple-500 border-purple-500":l?"border-gray-600 bg-gray-700":"border-gray-300 bg-white"} ${r?"opacity-50 cursor-not-allowed":"group-hover:border-purple-400"}`,whileHover:r?{}:{scale:1.05},whileTap:r?{}:{scale:.95},children:e.jsx(U,{children:_&&e.jsx(s.svg,{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"3",initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0},transition:{type:"spring",stiffness:500,damping:30},children:e.jsx("polyline",{points:"20,6 9,17 4,12"})})})})]}),e.jsx("span",{className:`font-medium ${l?"text-gray-200":"text-gray-700"} ${r?"opacity-50":""}`,children:"Zapamti me"})]})}),e.jsxs(s.div,{className:"flex gap-4 mt-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:2.6},children:[e.jsxs(s.button,{type:"button",onClick:a,disabled:r,className:`flex-1 px-6 py-3 rounded-xl font-medium transition-all duration-300 flex items-center justify-center gap-2 ${l?"bg-gray-700 text-gray-200 hover:bg-gray-600 border border-gray-600":"bg-gray-100 text-gray-700 hover:bg-gray-200 border border-gray-200"} ${r?"opacity-50 cursor-not-allowed":"hover:shadow-lg"}`,whileHover:r?{}:{scale:1.02},whileTap:r?{}:{scale:.98},children:[e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"m15 18-6-6 6-6"})}),"Nazad"]}),e.jsx(s.button,{type:"submit",disabled:r||!i.trim()||!u.trim()||i!==u||M.score<2,className:`flex-1 px-6 py-3 rounded-xl font-medium transition-all duration-300 flex items-center justify-center gap-2 ${r||!i.trim()||!u.trim()||i!==u||M.score<2?l?"bg-gray-700 text-gray-500 cursor-not-allowed":"bg-gray-200 text-gray-400 cursor-not-allowed":l?"bg-gradient-to-r from-purple-600 to-pink-600 text-white hover:from-purple-700 hover:to-pink-700":"bg-gradient-to-r from-purple-500 to-pink-500 text-white hover:from-purple-600 hover:to-pink-600"} hover:shadow-lg`,whileHover:!r&&i.trim()&&u.trim()&&i===u&&M.score>=2?{scale:1.02}:{},whileTap:!r&&i.trim()&&u.trim()&&i===u&&M.score>=2?{scale:.98}:{},children:r?e.jsxs(e.Fragment,{children:[e.jsx(s.div,{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}}),"Postavljam i ulogujem..."]}):e.jsxs(e.Fragment,{children:[e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"}),e.jsx("polyline",{points:"10,17 15,12 10,7"}),e.jsx("line",{x1:"15",y1:"12",x2:"3",y2:"12"})]}),"Postavi lozinku i uloguj se"]})})]})]}),e.jsx(s.div,{className:"text-center",initial:{opacity:0},animate:{opacity:1},transition:{delay:2.8},children:e.jsx("p",{className:`text-sm ${l?"text-gray-400":"text-gray-500"}`,children:"Lozinka ƒáe biti automatski saƒçuvana i ulogovani ƒáete se odmah."})})]})})]})}function pt({onLogin:d,loading:t,onBack:a}){const[r,i]=n.useState(""),[p,u]=n.useState(""),[o,x]=n.useState(null),f=v=>{if(v.preventDefault(),!r.trim()){x("Molimo unesite va≈°u turu");return}if(!p.trim()){x("Molimo unesite lozinku");return}x(null),d(r.trim().toUpperCase(),p)};return e.jsx("div",{className:"login-screen",children:e.jsxs("div",{className:"login-container",children:[e.jsxs("div",{className:"login-header",children:[e.jsx("h1",{children:"Prijava"}),e.jsx("p",{children:"Unesite va≈°u turu i lozinku za pristup aplikaciji."})]}),e.jsxs("form",{onSubmit:f,className:"login-form",children:[e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"tura",children:"Tura:"}),e.jsx("input",{type:"text",id:"tura",value:r,onChange:v=>i(v.target.value),placeholder:"npr. 8610",maxLength:"10",disabled:t,autoFocus:!0})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"password",children:"Lozinka:"}),e.jsx("input",{type:"password",id:"password",value:p,onChange:v=>u(v.target.value),placeholder:"Va≈°a lozinka",disabled:t})]}),o&&e.jsx("div",{className:"error-message",children:o}),e.jsx("button",{type:"submit",className:"login-btn",disabled:t||!r.trim()||!p.trim(),children:t?"Prijavljivam...":"Prijavite se"})]}),e.jsx("div",{className:"login-footer",children:e.jsx("button",{type:"button",className:"back-btn",onClick:a,disabled:t,children:"‚Üê Nazad"})})]})})}function mt({onAuthSuccess:d}){const[t,a]=n.useState("init"),[r,i]=n.useState(null),{loading:p,checkDriverExists:u,setInitialPassword:o,login:x}=he(),f=async m=>{try{const b=await u(m);i(b),a("confirm")}catch(b){console.error("Driver check failed:",b)}},v=()=>{r.hasPassword?a("login"):a("setup")},P=async(m,b=!1)=>{var g;try{await o(r.id,m);const l=await x(r.tura,m);console.log("[AuthFlowManager] Login user:",l),b&&localStorage.setItem("bde_remember_me","true"),l!=null&&l.name&&(localStorage.setItem("DRIVER_NAME",l.name),(g=window.__USER_CONTEXT__)!=null&&g.refreshStatus&&window.__USER_CONTEXT__.refreshStatus()),d(l)}catch(l){console.error("Password setup failed:",l)}},_=async(m,b,g=!1)=>{var l;try{const A=await x(m,b);console.log("[AuthFlowManager] Login user:",A),g&&localStorage.setItem("bde_remember_me","true"),A!=null&&A.ime&&(localStorage.setItem("DRIVER_NAME",A.ime),(l=window.__USER_CONTEXT__)!=null&&l.refreshStatus&&window.__USER_CONTEXT__.refreshStatus()),d(A)}catch(A){console.error("Login failed:",A)}},$=()=>{a("init"),i(null)},I=()=>{a("confirm")};return t==="init"?e.jsx(dt,{onDriverSelected:f,loading:p}):t==="confirm"?e.jsx(ht,{driver:r,onContinue:v,onLogin:_,onBack:$,loading:p}):t==="setup"?e.jsx(ut,{driver:r,onPasswordSet:P,onBack:I,loading:p}):t==="login"?e.jsx(pt,{onLogin:_,loading:p,onBack:I}):null}const gt=({onClose:d,onSubmit:t})=>{const[a,r]=n.useState({oldPassword:"",newPassword:"",confirmPassword:""}),[i,p]=n.useState({old:!1,new:!1,confirm:!1}),[u,o]=n.useState({}),[x,f]=n.useState(!1),v=g=>{if(!g)return null;let l=0;return g.length>=8&&l++,/[A-Z]/.test(g)&&l++,/[a-z]/.test(g)&&l++,/[0-9]/.test(g)&&l++,/[^A-Za-z0-9]/.test(g)&&l++,l<3?{level:"weak",text:"üî¥ Slaba lozinka"}:l<4?{level:"medium",text:"üü° Srednja lozinka"}:{level:"strong",text:"üü¢ Jaka lozinka"}},P=()=>{const g={};return a.oldPassword||(g.oldPassword="Stara lozinka je obavezna"),a.newPassword?a.newPassword.length<6&&(g.newPassword="Nova lozinka mora imati najmanje 6 karaktera"):g.newPassword="Nova lozinka je obavezna",a.confirmPassword?a.newPassword!==a.confirmPassword&&(g.confirmPassword="Lozinke se ne poklapaju"):g.confirmPassword="Potvrda lozinke je obavezna",a.oldPassword===a.newPassword&&(g.newPassword="Nova lozinka mora biti razliƒçita od stare"),o(g),Object.keys(g).length===0},_=(g,l)=>{r(A=>({...A,[g]:l})),u[g]&&o(A=>({...A,[g]:null}))},$=g=>{p(l=>({...l,[g]:!l[g]}))},I=async g=>{if(g.preventDefault(),!!P()){f(!0);try{await t(a),d()}catch(l){o({submit:l.message||"Gre≈°ka pri promeni lozinke"})}finally{f(!1)}}},m=a.oldPassword&&a.newPassword&&a.confirmPassword&&a.newPassword===a.confirmPassword&&a.newPassword.length>=6&&a.oldPassword!==a.newPassword,b=v(a.newPassword);return e.jsxs("form",{className:styles.modalForm,onSubmit:I,children:[e.jsxs("div",{className:styles.formHeader,children:[e.jsx("h2",{className:styles.formTitle,children:"üîê Promena lozinke"}),e.jsx("p",{className:styles.formSubtitle,children:"Unesite staru lozinku i defini≈°ite novu sigurnu lozinku"})]}),e.jsxs("div",{className:styles.inputGroup,children:[e.jsx("label",{className:styles.inputLabel,htmlFor:"oldPassword",children:"Trenutna lozinka"}),e.jsxs("div",{className:styles.inputWrapper,children:[e.jsx("input",{id:"oldPassword",type:i.old?"text":"password",value:a.oldPassword,onChange:g=>_("oldPassword",g.target.value),placeholder:"Unesite trenutnu lozinku",className:styles.passwordInput,autoComplete:"current-password"}),e.jsx("button",{type:"button",className:styles.toggleButton,onClick:()=>$("old"),"aria-label":"Prika≈æi/sakrij lozinku",children:i.old?"üëÅÔ∏è":"üôà"})]}),u.oldPassword&&e.jsxs("div",{className:`${styles.validationMessage} ${styles.validationError}`,children:["‚ùå ",u.oldPassword]})]}),e.jsxs("div",{className:styles.inputGroup,children:[e.jsx("label",{className:styles.inputLabel,htmlFor:"newPassword",children:"Nova lozinka"}),e.jsxs("div",{className:styles.inputWrapper,children:[e.jsx("input",{id:"newPassword",type:i.new?"text":"password",value:a.newPassword,onChange:g=>_("newPassword",g.target.value),placeholder:"Unesite novu lozinku",className:styles.passwordInput,autoComplete:"new-password"}),e.jsx("button",{type:"button",className:styles.toggleButton,onClick:()=>$("new"),"aria-label":"Prika≈æi/sakrij lozinku",children:i.new?"üëÅÔ∏è":"üôà"})]}),b&&e.jsx("div",{className:`${styles.strengthIndicator} ${styles[`strength${b.level.charAt(0).toUpperCase()+b.level.slice(1)}`]}`,children:b.text}),u.newPassword&&e.jsxs("div",{className:`${styles.validationMessage} ${styles.validationError}`,children:["‚ùå ",u.newPassword]})]}),e.jsxs("div",{className:styles.inputGroup,children:[e.jsx("label",{className:styles.inputLabel,htmlFor:"confirmPassword",children:"Potvrdite novu lozinku"}),e.jsxs("div",{className:styles.inputWrapper,children:[e.jsx("input",{id:"confirmPassword",type:i.confirm?"text":"password",value:a.confirmPassword,onChange:g=>_("confirmPassword",g.target.value),placeholder:"Ponovite novu lozinku",className:styles.passwordInput,autoComplete:"new-password"}),e.jsx("button",{type:"button",className:styles.toggleButton,onClick:()=>$("confirm"),"aria-label":"Prika≈æi/sakrij lozinku",children:i.confirm?"üëÅÔ∏è":"üôà"})]}),a.confirmPassword&&a.newPassword===a.confirmPassword&&e.jsx("div",{className:`${styles.validationMessage} ${styles.validationSuccess}`,children:"‚úÖ Lozinke se poklapaju"}),u.confirmPassword&&e.jsxs("div",{className:`${styles.validationMessage} ${styles.validationError}`,children:["‚ùå ",u.confirmPassword]})]}),e.jsxs("div",{className:styles.securityTips,children:[e.jsx("h4",{children:"üí° Saveti za sigurnu lozinku:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Najmanje 8 karaktera"}),e.jsx("li",{children:"Kombinacija velikih i malih slova"}),e.jsx("li",{children:"Brojevi i specijalni karakteri (!@#$%)"}),e.jsx("li",{children:"Izbegavajte liƒçne podatke"})]})]}),u.submit&&e.jsxs("div",{className:`${styles.validationMessage} ${styles.validationError}`,children:["‚ùå ",u.submit]}),e.jsxs("div",{className:styles.modalActions,children:[e.jsx("button",{type:"button",className:styles.cancelBtn,onClick:d,disabled:x,children:"‚ùå Otka≈æi"}),e.jsx("button",{type:"submit",className:styles.submitBtn,disabled:!m||x,children:x?"üîÑ Menjam...":"üîê Promeni lozinku"})]})]})};class xt{constructor(){this.channels=[],this.isActive=!1}start(){if(this.isActive)return;console.log("üîÑ Starting realtime service...");const t=oe.channel("realtime_extra_rides").on("postgres_changes",{event:"*",schema:"public",table:"extra_rides_pending"},i=>{console.log("üöó Extra rides update:",i.eventType),K.extraRides()}).subscribe(),a=oe.channel("realtime_deliveries").on("postgres_changes",{event:"*",schema:"public",table:"deliveries"},i=>{console.log("üì¶ Deliveries update:",i.eventType),K.deliveries(),K.driverStats()}).subscribe(),r=oe.channel("realtime_drivers").on("postgres_changes",{event:"*",schema:"public",table:"drivers"},i=>{console.log("üë§ Drivers update:",i.eventType),K.drivers()}).subscribe();this.channels=[t,a,r],this.isActive=!0,console.log("‚úÖ Realtime service started - listening for changes")}stop(){this.isActive&&(console.log("üõë Stopping realtime service..."),this.channels.forEach(t=>{oe.removeChannel(t)}),this.channels=[],this.isActive=!1,console.log("‚úÖ Realtime service stopped"))}triggerDataChange(t){switch(console.log(`üîÑ Manual trigger for ${t}`),t){case"extraRides":K.extraRides(),K.driverStats();break;case"deliveries":K.deliveries(),K.driverStats();break;case"drivers":K.drivers();break;default:K.all()}}}const ve=new xt;class yt{constructor(){this.deferredPrompt=null,this.isInstalled=!1,this.isStandalone=!1,this.serviceWorkerRegistration=null,this.listeners=new Set,this.syncInProgress=!1,this.checkInstallStatus(),this.setupInstallPrompt(),this.registerServiceWorker(),this.setupServiceWorkerMessages(),console.log("üöÄ [PWA] Service inicijalizovan")}checkInstallStatus(){this.isStandalone=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone||document.referrer.includes("android-app://"),this.isInstalled=this.isStandalone,console.log("üöÄ [PWA] Install status:",{isInstalled:this.isInstalled,isStandalone:this.isStandalone})}setupInstallPrompt(){window.addEventListener("beforeinstallprompt",t=>{console.log("üöÄ [PWA] Install prompt available"),t.preventDefault(),this.deferredPrompt=t,this.notifyListeners({type:"install_available",canInstall:!0})}),window.addEventListener("appinstalled",t=>{console.log("üöÄ [PWA] App installed successfully"),this.isInstalled=!0,this.deferredPrompt=null,this.notifyListeners({type:"app_installed",isInstalled:!0}),this.trackInstallation()}),this.checkIOSInstall()}checkIOSInstall(){const t=/iPad|iPhone|iPod/.test(navigator.userAgent),a=window.navigator.standalone;t&&!a&&this.notifyListeners({type:"ios_install_available",platform:"iOS"})}async registerServiceWorker(){if("serviceWorker"in navigator)try{const t=await navigator.serviceWorker.register("/bde-evidencija/sw.js",{scope:"/bde-evidencija/"});return this.serviceWorkerRegistration=t,console.log("üöÄ [PWA] Service Worker registered:",t.scope),t.addEventListener("updatefound",()=>{console.log("üöÄ [PWA] Service Worker update found");const a=t.installing;a.addEventListener("statechange",()=>{a.state==="installed"&&navigator.serviceWorker.controller&&(console.log("üöÄ [PWA] New Service Worker available"),this.notifyListeners({type:"update_available",registration:t}))})}),this.setupBackgroundSync(),t}catch(t){throw console.error("üöÄ [PWA] Service Worker registration failed:",t),t}else console.warn("üöÄ [PWA] Service Workers not supported")}setupServiceWorkerMessages(){"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",t=>{switch(console.log("üöÄ [PWA] Message from Service Worker:",t.data),t.data.type){case"SYNC_STARTED":this.syncInProgress=!0,this.notifyListeners({type:"sync_started"});break;case"SYNC_COMPLETED":this.syncInProgress=!1,this.notifyListeners({type:"sync_completed"});break;case"SYNC_FAILED":this.syncInProgress=!1,this.notifyListeners({type:"sync_failed",error:t.data.error});break}})}setupBackgroundSync(){"sync"in window.ServiceWorkerRegistration.prototype?(console.log("üöÄ [PWA] Background Sync supported"),this.scheduleBackgroundSync()):console.warn("üöÄ [PWA] Background Sync not supported")}async scheduleBackgroundSync(){if(this.serviceWorkerRegistration&&"sync"in window.ServiceWorkerRegistration.prototype)try{await this.serviceWorkerRegistration.sync.register("background-sync-data"),console.log("üöÄ [PWA] Background sync scheduled")}catch(t){console.error("üöÄ [PWA] Background sync scheduling failed:",t)}}async showInstallPrompt(){if(!this.deferredPrompt)return console.warn("üöÄ [PWA] Install prompt not available"),!1;try{this.deferredPrompt.prompt();const{outcome:t}=await this.deferredPrompt.userChoice;return console.log("üöÄ [PWA] Install prompt result:",t),t==="accepted"?this.notifyListeners({type:"install_accepted"}):this.notifyListeners({type:"install_dismissed"}),this.deferredPrompt=null,t==="accepted"}catch(t){return console.error("üöÄ [PWA] Install prompt error:",t),!1}}canInstall(){return!this.isInstalled&&this.deferredPrompt!==null}shouldShowIOSInstructions(){const t=/iPad|iPhone|iPod/.test(navigator.userAgent),a=window.navigator.standalone;return t&&!a}async updateServiceWorker(){if(this.serviceWorkerRegistration)try{return await this.serviceWorkerRegistration.update(),console.log("üöÄ [PWA] Service Worker update triggered"),this.serviceWorkerRegistration.waiting&&this.serviceWorkerRegistration.waiting.postMessage({type:"SKIP_WAITING"}),!0}catch(t){return console.error("üöÄ [PWA] Service Worker update failed:",t),!1}return!1}async clearCache(){if(this.serviceWorkerRegistration)try{return this.serviceWorkerRegistration.active&&this.serviceWorkerRegistration.active.postMessage({type:"CLEAR_CACHE"}),console.log("üöÄ [PWA] Cache clear requested"),!0}catch(t){return console.error("üöÄ [PWA] Cache clear failed:",t),!1}return!1}getInstallInfo(){return{isInstalled:this.isInstalled,isStandalone:this.isStandalone,canInstall:this.canInstall(),shouldShowIOSInstructions:this.shouldShowIOSInstructions(),serviceWorkerSupported:"serviceWorker"in navigator,syncSupported:"sync"in window.ServiceWorkerRegistration.prototype,notificationSupported:"Notification"in window}}async requestNotificationPermission(){if("Notification"in window)try{const t=await Notification.requestPermission();return console.log("üöÄ [PWA] Notification permission:",t),this.notifyListeners({type:"notification_permission",permission:t}),t==="granted"}catch(t){return console.error("üöÄ [PWA] Notification permission request failed:",t),!1}return!1}async setupPushNotifications(){if(!this.serviceWorkerRegistration)return console.warn("üöÄ [PWA] Service Worker not available for push notifications"),!1;try{if(!("PushManager"in window))return console.warn("üöÄ [PWA] Push notifications not supported"),!1;if(!await this.requestNotificationPermission())return console.warn("üöÄ [PWA] Notification permission denied"),!1;const a=await this.serviceWorkerRegistration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:this.urlBase64ToUint8Array("YOUR_VAPID_PUBLIC_KEY")});return console.log("üöÄ [PWA] Push subscription created:",a),this.notifyListeners({type:"push_subscribed",subscription:a}),a}catch(t){return console.error("üöÄ [PWA] Push notification setup failed:",t),!1}}urlBase64ToUint8Array(t){const a="=".repeat((4-t.length%4)%4),r=(t+a).replace(/-/g,"+").replace(/_/g,"/"),i=window.atob(r),p=new Uint8Array(i.length);for(let u=0;u<i.length;++u)p[u]=i.charCodeAt(u);return p}trackInstallation(){try{typeof gtag<"u"&&gtag("event","app_install",{event_category:"PWA",event_label:"BDE Evidencija"}),localStorage.setItem("bde_app_installed",new Date().toISOString()),console.log("üöÄ [PWA] Installation tracked")}catch(t){console.error("üöÄ [PWA] Installation tracking failed:",t)}}async checkForUpdates(){if(this.serviceWorkerRegistration)try{return await this.serviceWorkerRegistration.update(),console.log("üöÄ [PWA] Update check completed"),!0}catch(t){return console.error("üöÄ [PWA] Update check failed:",t),!1}return!1}getPWACapabilities(){return{serviceWorker:"serviceWorker"in navigator,backgroundSync:"sync"in window.ServiceWorkerRegistration.prototype,pushNotifications:"PushManager"in window,notifications:"Notification"in window,installPrompt:"beforeinstallprompt"in window,periodicSync:"periodicSync"in window.ServiceWorkerRegistration.prototype,webShare:"share"in navigator,geolocation:"geolocation"in navigator,battery:"getBattery"in navigator,vibration:"vibrate"in navigator}}addListener(t){return this.listeners.add(t),()=>this.listeners.delete(t)}removeListener(t){this.listeners.delete(t)}notifyListeners(t){this.listeners.forEach(a=>{try{a(t)}catch(r){console.error("üöÄ [PWA] Listener error:",r)}})}destroy(){this.listeners.clear(),console.log("üöÄ [PWA] Service destroyed")}}const H=new yt;function ft(){const[d,t]=n.useState(H.getInstallInfo()),[a,r]=n.useState(H.getPWACapabilities()),[i,p]=n.useState(!1),[u,o]=n.useState(!1);return n.useEffect(()=>{const I=b=>{switch(b.type){case"install_available":t(g=>({...g,canInstall:!0}));break;case"app_installed":t(g=>({...g,isInstalled:!0,canInstall:!1}));break;case"update_available":p(!0);break;case"sync_started":o(!0);break;case"sync_completed":case"sync_failed":o(!1);break}},m=H.addListener(I);return t(H.getInstallInfo()),r(H.getPWACapabilities()),m},[]),{installInfo:d,capabilities:a,updateAvailable:i,syncInProgress:u,showInstallPrompt:async()=>await H.showInstallPrompt(),updateApp:async()=>{const I=await H.updateServiceWorker();return I&&(p(!1),setTimeout(()=>window.location.reload(),1e3)),I},clearCache:async()=>await H.clearCache(),requestNotifications:async()=>await H.requestNotificationPermission(),setupPushNotifications:async()=>await H.setupPushNotifications(),checkForUpdates:async()=>await H.checkForUpdates(),service:H}}const vt="_overlay_175pr_3",bt="_prompt_175pr_19",jt="_header_175pr_33",wt="_icon_175pr_40",kt="_title_175pr_45",Nt="_closeBtn_175pr_62",St="_benefits_175pr_79",Pt="_benefit_175pr_79",_t="_benefitIcon_175pr_94",It="_actions_175pr_98",Ct="_installBtn_175pr_104",$t="_laterBtn_175pr_131",At="_spinner_175pr_147",zt="_iosInstructions_175pr_157",Et="_instructionHeader_175pr_161",Wt="_iosIcon_175pr_165",Mt="_instructionSteps_175pr_177",Lt="_step_175pr_184",Tt="_stepNumber_175pr_194",Dt="_shareIcon_175pr_208",Rt="_addIcon_175pr_209",Bt="_dismissBtn_175pr_214",N={overlay:vt,prompt:bt,header:jt,icon:wt,title:kt,closeBtn:Nt,benefits:St,benefit:Pt,benefitIcon:_t,actions:It,installBtn:Ct,laterBtn:$t,spinner:At,iosInstructions:zt,instructionHeader:Et,iosIcon:Wt,instructionSteps:Mt,step:Lt,stepNumber:Tt,shareIcon:Dt,addIcon:Rt,dismissBtn:Bt},Ft=()=>{const{installInfo:d,showInstallPrompt:t}=ft(),[a,r]=n.useState(!1),[i,p]=n.useState(!1),[u,o]=n.useState(!1);n.useEffect(()=>{if(sessionStorage.getItem("pwa_install_dismissed")){p(!0);return}if(d.canInstall&&!d.isInstalled&&!i){const _=setTimeout(()=>{r(!0)},3e3);return()=>clearTimeout(_)}},[d.canInstall,d.isInstalled,i]);const x=async()=>{o(!0);try{await t()?r(!1):f()}catch(P){console.error("Install error:",P)}finally{o(!1)}},f=()=>{r(!1),p(!0),sessionStorage.setItem("pwa_install_dismissed","true")},v=()=>e.jsxs("div",{className:N.iosInstructions,children:[e.jsxs("div",{className:N.instructionHeader,children:[e.jsx("div",{className:N.iosIcon,children:"üì±"}),e.jsx("h3",{children:"Dodaj na poƒçetni ekran"})]}),e.jsxs("div",{className:N.instructionSteps,children:[e.jsxs("div",{className:N.step,children:[e.jsx("span",{className:N.stepNumber,children:"1"}),e.jsx("span",{children:"Pritisni dugme za Share"}),e.jsx("div",{className:N.shareIcon,children:"üì§"})]}),e.jsxs("div",{className:N.step,children:[e.jsx("span",{className:N.stepNumber,children:"2"}),e.jsx("span",{children:'Odaberi "Add to Home Screen"'}),e.jsx("div",{className:N.addIcon,children:"‚ûï"})]}),e.jsxs("div",{className:N.step,children:[e.jsx("span",{className:N.stepNumber,children:"3"}),e.jsx("span",{children:'Pritisni "Add"'})]})]}),e.jsx("button",{className:N.dismissBtn,onClick:f,children:"Razumem"})]});return a&&!i?e.jsx("div",{className:N.overlay,children:e.jsx("div",{className:N.prompt,children:d.shouldShowIOSInstructions?e.jsx(v,{}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:N.header,children:[e.jsx("div",{className:N.icon,children:"üöÄ"}),e.jsxs("div",{className:N.title,children:[e.jsx("h3",{children:"Instaliraj BDE Evidenciju"}),e.jsx("p",{children:"Br≈æi pristup i bolje performanse"})]}),e.jsx("button",{className:N.closeBtn,onClick:f,children:"‚úï"})]}),e.jsxs("div",{className:N.benefits,children:[e.jsxs("div",{className:N.benefit,children:[e.jsx("span",{className:N.benefitIcon,children:"‚ö°"}),e.jsx("span",{children:"Br≈æe uƒçitavanje"})]}),e.jsxs("div",{className:N.benefit,children:[e.jsx("span",{className:N.benefitIcon,children:"üì±"}),e.jsx("span",{children:"Radi offline"})]}),e.jsxs("div",{className:N.benefit,children:[e.jsx("span",{className:N.benefitIcon,children:"üîî"}),e.jsx("span",{children:"Push notifikacije"})]}),e.jsxs("div",{className:N.benefit,children:[e.jsx("span",{className:N.benefitIcon,children:"üè†"}),e.jsx("span",{children:"Poƒçetni ekran"})]})]}),e.jsxs("div",{className:N.actions,children:[e.jsx("button",{className:N.installBtn,onClick:x,disabled:u,children:u?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:N.spinner}),"Instaliranje..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"üì•"}),"Instaliraj aplikaciju"]})}),e.jsx("button",{className:N.laterBtn,onClick:f,children:"Mo≈æda kasnije"})]})]})})}):null},Ht=O.lazy(()=>q(()=>import("./chunk-v5-1764802892030-Dp0vVT2v.js").then(d=>d.H),__vite__mapDeps([0,1,2,3,4,5]))),Ot=O.lazy(()=>q(()=>import("./chunk-v5-1764802892030-Dp0vVT2v.js").then(d=>d.D),__vite__mapDeps([0,1,2,3,4,5]))),Ut=O.lazy(()=>q(()=>import("./chunk-v5-1764802892030-Dp0vVT2v.js").then(d=>d.g),__vite__mapDeps([0,1,2,3,4,5]))),Vt=O.lazy(()=>q(()=>import("./chunk-v5-1764802892030-BaxKJJL-.js"),__vite__mapDeps([6,4,2,7,1,3,5,0]))),Gt=O.lazy(()=>q(()=>import("./chunk-v5-1764802892030-CWMhAGPr.js").then(d=>d.A),__vite__mapDeps([7,4,2,1,3,5,0]))),Yt=O.lazy(()=>q(()=>import("./chunk-v5-1764802892030-DoMnzAVu.js"),__vite__mapDeps([8,4,2,1,3,0,5]))),Kt=O.lazy(()=>q(()=>import("./chunk-v5-1764802892030-BAl6N9Fc.js"),__vite__mapDeps([9,4,2,1,3]))),qt=O.lazy(()=>q(()=>import("./chunk-v5-1764802892030-Dp0vVT2v.js").then(d=>d.h),__vite__mapDeps([0,1,2,3,4,5]))),Xt=O.lazy(()=>q(()=>import("./chunk-v5-1764802892030-CTBUGFsV.js"),__vite__mapDeps([10,4,2,11,12])));function Zt({onLogout:d}){const[t,a]=n.useState(!1),{currentUser:r,changePassword:i}=he(),p=Le(),u=p.pathname==="/"||p.pathname==="",o=async(x,f)=>{await i(x,f)};return n.useEffect(()=>{if(r)return console.log("üöÄ Starting realtime service for user:",r.name),ve.start(),()=>{console.log("üõë Stopping realtime service"),ve.stop()}},[r]),r?e.jsxs("div",{className:"min-h-screen bg-background text-foreground",children:[e.jsx("main",{className:`app-main${u?" home-fullbleed":""}`,children:e.jsx(O.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}),e.jsx("p",{className:"text-gray-600",children:"Uƒçitava se..."})]})}),children:e.jsxs(Te,{children:[e.jsx(Y,{path:"/",element:e.jsx(Ht,{})}),e.jsx(Y,{path:"/statistika",element:e.jsx(qt,{})}),e.jsx(Y,{path:"/navigacija",element:e.jsx(Xt,{})}),e.jsx(Y,{path:"/deliveries",element:e.jsx(Ot,{})}),e.jsx(Y,{path:"/drivers",element:e.jsx(Ut,{})}),e.jsx(Y,{path:"/extra-rides",element:e.jsx(Vt,{})}),e.jsx(Y,{path:"/admin",element:(r==null?void 0:r.role)==="admin"?e.jsx(Gt,{}):e.jsx(ce,{to:"/"})}),e.jsx(Y,{path:"/payroll-list",element:(r==null?void 0:r.role)!=="admin"?e.jsx(Yt,{user:r}):e.jsx(ce,{to:"/"})}),e.jsx(Y,{path:"/about",element:e.jsx(Kt,{})}),e.jsx(Y,{path:"*",element:e.jsx(ce,{to:"/"})})]})})}),t&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(gt,{user:r,onClose:()=>a(!1),onChangePassword:async x=>{await o(x.oldPassword,x.newPassword),a(!1)}})})]}):e.jsx("div",{children:"Loading..."})}function Jt(){const{currentUser:d,isAuthenticated:t}=he(),[a,r]=n.useState(!1),[i,p]=n.useState(!1),u=x=>{var f;r(!0),p(!1),x!=null&&x.name&&(localStorage.setItem("DRIVER_NAME",x.name),(f=window.__USER_CONTEXT__)!=null&&f.refreshStatus&&window.__USER_CONTEXT__.refreshStatus(),console.log("[App] DRIVER_NAME postavljen:",x.name))},o=()=>{p(!0),r(!1)};return n.useEffect(()=>{!d&&!t&&r(!1),d&&t&&p(!1)},[d,t]),n.useEffect(()=>{const x=f=>{console.log("Global logout event received",f.detail);try{localStorage.removeItem("bde_current_user")}catch{}try{localStorage.removeItem("bde_login_time")}catch{}o()};return window.addEventListener("bde:logout",x),()=>window.removeEventListener("bde:logout",x)},[]),e.jsx(Me,{basename:"/bde-evidencija",future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:e.jsx(ot,{children:e.jsx(Ve,{children:e.jsx(Je,{children:e.jsx(et,{children:e.jsxs("div",{className:"app",children:[(t||a)&&!i?e.jsx(Zt,{onLogout:o}):e.jsx(mt,{onAuthSuccess:u}),e.jsx(Ft,{})]})})})})})})}function Qt({onRestart:d}){const[t,a]=n.useState(10),[r,i]=n.useState(new Date().getFullYear()),[p,u]=n.useState(!1),[o]=n.useState([{id:1,description:"Abholung Klagenfurt",quantity:22,unit:"Tag",pricePerUnit:150}]),x=20,f=o.reduce((L,B)=>L+B.quantity*B.pricePerUnit,0),v=f*x/100,P=f+v,_=new Date(r,t,0).getDate(),$=`01.${t.toString().padStart(2,"0")}.${r} ‚Äì ${_.toString().padStart(2,"0")}.${t.toString().padStart(2,"0")}.${r}`,I=`${_.toString().padStart(2,"0")}.${t.toString().padStart(2,"0")}.${r}`,m=`${t.toString().padStart(2,"0")}/${r.toString().slice(-2)}`,b=22,g=()=>{u(!0),setTimeout(()=>u(!1),3e3)},l=async()=>{try{await Ke({month:t,year:r,taxRate:x,invoiceItems:o,workingDays:b,period:$,invoiceDate:I,invoiceNumber:m,netto:f,ust:v,total:P}),g()}catch(L){alert("Gre≈°ka pri generiranju PDF-a: "+L.message)}},A=()=>{d?d():window.location.reload()};return e.jsxs("div",{className:"min-h-screen bg-gray-100 p-4",children:[e.jsx("div",{className:"max-w-4xl mx-auto mb-6",children:e.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"ml-3 flex-1",children:[e.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Aplikacija je u recovery modu (React Hook gre≈°ka)"}),e.jsx("p",{className:"mt-1 text-sm text-yellow-700",children:"Detektovan problem sa React Hook-ovima pri refreshu. Sve funkcije rade kroz recovery sistem. InvoicesTab potpuno funkcionalan!"})]}),e.jsx("div",{className:"ml-4",children:e.jsxs("button",{onClick:A,className:"bg-yellow-100 hover:bg-yellow-200 text-yellow-800 px-3 py-1 rounded text-sm font-medium flex items-center gap-2",children:[e.jsx(Ce,{className:"w-4 h-4"}),"Restart App"]})})]})})}),p&&e.jsxs("div",{className:"fixed top-4 right-4 z-50 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg flex items-center gap-2",children:[e.jsx($e,{className:"w-5 h-5"}),"‚úÖ PDF generisan uspje≈°no"]}),e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(Ae,{className:"w-8 h-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"GLS Rechnung Generator"}),e.jsx("p",{className:"text-gray-600",children:"Recovery Mode - Basic funkcionalnost"})]})]}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Konfiguracija raƒçuna"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mjesec"}),e.jsx("select",{value:t,onChange:L=>a(Number(L.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:Array.from({length:12},(L,B)=>e.jsx("option",{value:B+1,children:B+1},B+1))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Godina"}),e.jsx("input",{type:"number",value:r,onChange:L=>i(Number(L.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Pregled raƒçuna"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between py-1 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"Rechnungsnummer:"}),e.jsx("span",{className:"font-medium",children:m})]}),e.jsxs("div",{className:"flex justify-between py-1 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"Period:"}),e.jsx("span",{className:"font-medium",children:$})]}),e.jsxs("div",{className:"flex justify-between py-1 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"Radni dani:"}),e.jsx("span",{className:"font-medium",children:b})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Nettobetrag:"}),e.jsxs("span",{children:["‚Ç¨",f.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Umsatzsteuer (20%):"}),e.jsxs("span",{children:["‚Ç¨",v.toFixed(2)]})]}),e.jsx("div",{className:"border-t pt-2",children:e.jsxs("div",{className:"flex justify-between font-bold text-lg text-blue-600",children:[e.jsx("span",{children:"Rechnungsbetrag:"}),e.jsxs("span",{children:["‚Ç¨",P.toFixed(2)]})]})})]}),e.jsxs("button",{onClick:l,className:`w-full bg-blue-600 hover:bg-blue-700 text-white font-medium px-4 py-3 rounded-lg 
                         flex items-center justify-center gap-2 shadow-lg hover:shadow-xl transition-all`,children:[e.jsx(ze,{className:"w-5 h-5"}),"üíæ Generi≈°i PDF"]})]})]})]})})]})}class es extends O.Component{constructor(a){super(a);ue(this,"handleRestart",()=>{this.setState({hasError:!1,error:null})});this.state={hasError:!1,error:null}}static getDerivedStateFromError(a){return a.message.includes("useState")||a.message.includes("Invalid hook call")||a.message.includes("Cannot read properties of null")||a.message.includes("reading 'useState'")||a.stack.includes("useSimpleAuth")?(console.error("üö® ErrorBoundary: React Hook error detected",a.message),{hasError:!0,error:a}):{hasError:!1,error:null}}componentDidCatch(a,r){console.error("üö® React Error Boundary caught an error:",a,r),(a.message.includes("useState")||a.message.includes("Invalid hook call"))&&console.warn("üîß React Hook error detected - loading fallback app")}render(){return this.state.hasError?e.jsx(Qt,{onRestart:this.handleRestart}):this.props.children}}console.log("üöÄ BDEVidencija v5.0.0 - ULTRA NUCLEAR FORCE UPDATE - 20251020-HOOKS-FIXED");console.log("üì± PWA Cache Status: FORCED REFRESH");"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("controllerchange",function(){window.location.reload()});be(document.getElementById("root")).render(e.jsx(O.StrictMode,{children:e.jsx(es,{children:e.jsx(De,{client:Ge,children:e.jsx(Jt,{})})})}));export{ve as r};

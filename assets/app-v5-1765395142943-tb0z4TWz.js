const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/chunk-v5-1765395142943-D6yQlDmM.js","assets/chunk-v5-1765395142943-CtGZdOO1.js","assets/chunk-v5-1765395142943-DzTHeiPn.js","assets/chunk-v5-1765395142943-D-88VwrN.js","assets/chunk-v5-1765395142943-C41TD1cl.js","assets/chunk-v5-1765395142943-67jeV4qK.js","assets/chunk-v5-1765395142943-3AVOTI2n.js","assets/chunk-v5-1765395142943-lKBIgVAu.js","assets/chunk-v5-1765395142943-EqheQJZQ.js","assets/chunk-v5-1765395142943-Dr38-KE1.js","assets/chunk-v5-1765395142943-CZExNXil.js","assets/chunk-v5-1765395142943-DFYUCRfo.js","assets/asset-v5-1765395142943-Bq-DyqPN.css"])))=>i.map(i=>d[i]);
var ue=Object.defineProperty;var he=(c,t,a)=>t in c?ue(c,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):c[t]=a;var re=(c,t,a)=>he(c,typeof t!="symbol"?t+"":t,a);import{j as e,m as s,A as L,R as me,w as pe,aa as xe,Y as ge}from"./chunk-v5-1765395142943-CtGZdOO1.js";import{a as ye,r as n,R as W,B as fe,d as be,e as ve,f as B,N as te}from"./chunk-v5-1765395142943-DzTHeiPn.js";import{_ as H,a as je}from"./chunk-v5-1765395142943-C41TD1cl.js";import{u as ae,i as D,a as we,q as ke}from"./chunk-v5-1765395142943-D6yQlDmM.js";import{u as Ne,g as Se}from"./chunk-v5-1765395142943-lKBIgVAu.js";import{u as Pe,s as Y}from"./chunk-v5-1765395142943-D-88VwrN.js";import"./chunk-v5-1765395142943-67jeV4qK.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const u of r)if(u.type==="childList")for(const l of u.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function a(r){const u={};return r.integrity&&(u.integrity=r.integrity),r.referrerPolicy&&(u.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?u.credentials="include":r.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(r){if(r.ep)return;r.ep=!0;const u=a(r);fetch(r.href,u)}})();var oe,ie=ye;oe=ie.createRoot,ie.hydrateRoot;const _e=n.createContext();function Ie({children:c}){const t=Ne();return e.jsx(_e.Provider,{value:t,children:c})}const Ce=n.createContext(),Ae=({children:c})=>{const t=Pe(),[a,i]=n.useState(!0),[r,u]=n.useState(null);n.useEffect(()=>(a?t.start(r):t.stop(),()=>{t.stop()}),[a,r]);const l={autoSync:t,globalSyncEnabled:a,setGlobalSyncEnabled:i,syncInterval:r,setSyncInterval:u,isAutoSyncRunning:t.isRunning,isSyncInProgress:t.syncInProgress,lastSyncTime:t.lastSyncTime,nextSyncTime:t.nextSyncTime,startAutoSync:t.start,stopAutoSync:t.stop,syncNow:t.syncNow,getLastSyncText:()=>{if(!t.lastSyncTime)return"Nikad";const d=Date.now()-t.lastSyncTime,x=Math.floor(d/(1e3*60)),g=Math.floor(d%(1e3*60)/1e3);return x>0?`prije ${x}min ${g}s`:`prije ${g}s`},getNextSyncText:()=>{if(!t.nextSyncTime||!t.isRunning)return"Iskljuƒçen";const y=Date.now(),d=t.nextSyncTime-y;if(d<=0)return"Uskoro";const x=Math.floor(d/(1e3*60)),g=Math.floor(d%(1e3*60)/1e3);return x>0?`za ${x}min ${g}s`:`za ${g}s`}};return e.jsx(Ce.Provider,{value:l,children:c})},$e={confirm:"Potvrdi",enterTuraOrPin:"Unesi turu ili PIN",selectLanguage:"Odaberi jezik",enterTuraAndSelectLanguage:"Unesi turu i odaberi jezik",welcome:"Dobrodo≈°li!",setupMessage:"Molimo podes–∏—Ç–µ aplikaciju prije kori≈°ƒáenja.",tourNumber:"Broj ture",tourPlaceholder:"Unesite va≈° broj ture (npr. 8610)",appLanguage:"Jezik aplikacije",finishSetup:"Zavr≈°i pode≈°avanje",setupInfoMessage:"Ove podatke mo≈æete promijeniti kasnije u pode≈°avanjima aplikacije.",unknownTour:"Nepoznat broj ture. Molimo kontaktirajte administratora."},Me={confirm:"Confirm",enterTuraOrPin:"Enter route or PIN",selectLanguage:"Select language",enterTuraAndSelectLanguage:"Enter route and select language",welcome:"Welcome!",setupMessage:"Please configure the application before use.",tourNumber:"Route number",tourPlaceholder:"Enter your route number (e.g. 8610)",appLanguage:"Application language",finishSetup:"Finish setup",setupInfoMessage:"You can change these settings later in application settings.",unknownTour:"Unknown route number. Please contact administrator."},Ee={confirm:"Best√§tigen",enterTuraOrPin:"Route oder PIN eingeben",selectLanguage:"Sprache w√§hlen",enterTuraAndSelectLanguage:"Route eingeben und Sprache w√§hlen",welcome:"Willkommen!",setupMessage:"Bitte konfigurieren Sie die Anwendung vor der Nutzung.",tourNumber:"Routennummer",tourPlaceholder:"Geben Sie Ihre Routennummer ein (z.B. 8610)",appLanguage:"Anwendungssprache",finishSetup:"Setup abschlie√üen",setupInfoMessage:"Sie k√∂nnen diese Einstellungen sp√§ter in den Anwendungseinstellungen √§ndern.",unknownTour:"Unbekannte Routennummer. Bitte kontaktieren Sie den Administrator."},Le={confirm:"Potrdi",enterTuraOrPin:"Vnesi turo ali PIN",selectLanguage:"Izberi jezik",enterTuraAndSelectLanguage:"Vnesi turo in izberi jezik",welcome:"Dobrodo≈°li!",setupMessage:"Prosimo, konfigurirajte aplikacijo pred uporabo.",tourNumber:"≈†tevilka ture",tourPlaceholder:"Vnesite svojo ≈°tevilko ture (npr. 8610)",appLanguage:"Jezik aplikacije",finishSetup:"Zakljuƒçi nastavitev",setupInfoMessage:"Te nastavitve lahko pozneje spremenite v nastavitvah aplikacije.",unknownTour:"Neznana ≈°tevilka ture. Prosimo, kontaktirajte administratorja."},K={ba:$e,en:Me,de:Ee,si:Le},ze=n.createContext(),We="ba",se={getItem:c=>window.localStorage.getItem(c),setItem:(c,t)=>window.localStorage.setItem(c,t)},Te=({children:c})=>{const t=se.getItem("APP_LANG")||We,[a,i]=n.useState(t),[r,u]=n.useState(K[t]),[l,y]=n.useState(!1);n.useEffect(()=>{(()=>{const b=se.getItem("APP_LANG");b&&K[b]&&b!==a&&(i(b),u(K[b]))})()},[a]);const g={language:a,translations:r,isLoading:l,changeLanguage:j=>{K[j]&&(i(j),u(K[j]),se.setItem("APP_LANG",j))},t:(j,b)=>{const _=j.split(".");let v=r;for(const h of _)if(v&&v[h]!==void 0)v=v[h];else return b||j;return v}};return e.jsx(ze.Provider,{value:g,children:c})};function Re({onDriverSelected:c,loading:t}){const[a,i]=n.useState(""),[r,u]=n.useState(null),[l,y]=n.useState(!1),[d,x]=n.useState(!1),[g,j]=n.useState("medium"),[b,_]=n.useState(!1),[v,h]=n.useState(!1),[w,m]=n.useState(!1),[o,N]=n.useState(!1);n.useEffect(()=>{const P=window.matchMedia("(prefers-color-scheme: dark)");x(P.matches);const C=F=>x(F.matches);return P.addEventListener("change",C),()=>P.removeEventListener("change",C)},[]),n.useEffect(()=>{const P=C=>{C.key==="Escape"&&(i(""),u(null))};return window.addEventListener("keydown",P),()=>window.removeEventListener("keydown",P)},[]);const I=()=>{navigator.vibrate&&navigator.vibrate(50)},M=P=>{if(P.preventDefault(),!a.trim()){u("Molimo unesite va≈°u turu"),N(!0),I(),setTimeout(()=>N(!1),500);return}if(a.trim().length<3){u("Tura mora imati najmanje 3 karaktera"),N(!0),I(),setTimeout(()=>N(!1),500);return}u(null),m(!0),I(),v&&localStorage.setItem("rememberedTura",a.trim().toUpperCase()),setTimeout(()=>{c(a.trim().toUpperCase())},800)},R=P=>{const C=P.target.value;i(C),C&&C.length<3?u("Tura mora imati najmanje 3 karaktera"):u(null)},U={small:"text-sm",medium:"text-base",large:"text-lg"},O=d?"bg-gradient-to-br from-gray-900 to-blue-900 text-white":"bg-gradient-to-br from-gray-50 to-blue-50 text-gray-800",T=d?"bg-gray-800/90 backdrop-blur-lg border border-gray-700/50":"bg-white/90 backdrop-blur-lg border border-white/50",V=d?"bg-gray-700/50 border-gray-600 text-white placeholder-gray-400 focus:ring-blue-400":"bg-white/80 border-gray-300 text-gray-800 placeholder-gray-500 focus:ring-blue-400",G=d?"bg-blue-700 hover:bg-blue-600 disabled:bg-gray-700":"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-300";return e.jsxs("div",{className:`min-h-screen flex items-center justify-center relative overflow-hidden ${O} ${U[g]} ${b?"contrast-150":""}`,children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[[...Array(20)].map((P,C)=>e.jsx(s.div,{className:`absolute w-2 h-2 rounded-full ${d?"bg-blue-400/20":"bg-blue-300/30"}`,initial:{x:Math.random()*window.innerWidth,y:Math.random()*window.innerHeight},animate:{x:Math.random()*window.innerWidth,y:Math.random()*window.innerHeight},transition:{duration:Math.random()*10+20,repeat:1/0,repeatType:"reverse"}},C)),[...Array(8)].map((P,C)=>e.jsx(s.div,{className:`absolute opacity-20 ${d?"bg-gradient-to-r from-blue-600 to-purple-600":"bg-gradient-to-r from-blue-400 to-cyan-400"}`,style:{width:Math.random()*100+50,height:Math.random()*100+50,borderRadius:Math.random()*50+25,left:Math.random()*100+"%",top:Math.random()*100+"%"},animate:{rotate:360,scale:[1,1.2,1]},transition:{duration:Math.random()*20+30,repeat:1/0}},`shape-${C}`))]}),e.jsxs("div",{className:"absolute top-4 right-4 flex gap-2",children:[e.jsx(s.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>x(!d),className:`w-10 h-10 rounded-full ${T} flex items-center justify-center`,title:"Toggle Dark Mode",children:d?"‚òÄÔ∏è":"üåô"}),e.jsx(s.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>j(g==="small"?"medium":g==="medium"?"large":"small"),className:`w-10 h-10 rounded-full ${T} flex items-center justify-center text-sm`,title:"Font Size",children:"Aa"}),e.jsx(s.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>_(!b),className:`w-10 h-10 rounded-full ${T} flex items-center justify-center`,title:"High Contrast",children:"‚ö´"})]}),e.jsxs(s.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0,...o&&{x:[0,-10,10,-10,10,0],transition:{duration:.5}}},className:`w-full max-w-md ${T} rounded-2xl shadow-2xl p-8 flex flex-col gap-8 relative z-10`,children:[e.jsx(L,{children:w&&e.jsx(s.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 pointer-events-none",children:[...Array(15)].map((P,C)=>e.jsx(s.div,{className:"absolute w-2 h-2 bg-green-500 rounded",initial:{x:"50%",y:"50%",scale:0},animate:{x:Math.random()*300-150,y:Math.random()*300-150,scale:1,rotate:Math.random()*360},transition:{duration:.8,delay:C*.05}},C))})}),e.jsxs(s.div,{className:"flex flex-col items-center gap-2",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{delay:.2},children:[e.jsx(s.div,{className:`w-20 h-20 rounded-full flex items-center justify-center mb-2 ${d?"bg-gradient-to-br from-blue-600 to-purple-600":"bg-gradient-to-br from-blue-500 to-cyan-500"}`,animate:{boxShadow:["0 0 20px rgba(59, 130, 246, 0.3)","0 0 30px rgba(59, 130, 246, 0.5)","0 0 20px rgba(59, 130, 246, 0.3)"]},transition:{duration:2,repeat:1/0},children:e.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"text-white",children:[e.jsx(s.path,{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1.5,delay:.5}}),e.jsx(s.circle,{cx:"12",cy:"7",r:"4",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1.5,delay:.8}})]})}),e.jsx(s.h1,{className:`text-2xl font-bold ${d?"text-white":"text-gray-800"}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},children:"Dobrodo≈°li!"}),e.jsx(s.p,{className:`text-center ${d?"text-gray-300":"text-gray-600"}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},children:"Molimo unesite va≈°u turu za pristup aplikaciji"})]}),e.jsxs(s.form,{onSubmit:M,className:"flex flex-col gap-4",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8},children:[e.jsxs("div",{className:"relative",children:[e.jsx(s.input,{type:"text",id:"tura",value:a,onChange:R,onFocus:()=>y(!0),onBlur:()=>y(!1),placeholder:" ",maxLength:"10",disabled:t,autoFocus:!0,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 text-lg peer transition-all duration-300 ${V}`,animate:{scale:l?1.02:1,boxShadow:l?"0 0 20px rgba(59, 130, 246, 0.3)":"0 0 0px rgba(59, 130, 246, 0)"}}),e.jsx(s.label,{htmlFor:"tura",className:`absolute left-4 transition-all duration-300 pointer-events-none ${d?"text-gray-400":"text-gray-500"} ${l||a?"-top-2 text-xs bg-inherit px-2 font-medium":"top-3 text-base"}`,animate:{color:l?"#3b82f6":d?"#9ca3af":"#6b7280"},children:"Va≈°a tura"}),e.jsx(s.span,{className:`absolute right-3 top-1/2 -translate-y-1/2 ${l?"text-blue-400":d?"text-gray-500":"text-gray-400"}`,animate:{rotate:l?360:0,scale:l?1.1:1},transition:{duration:.3},children:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"8.5",cy:"7",r:"4"}),e.jsx("path",{d:"m20 8 2 2-2 2"}),e.jsx("path",{d:"m16 12-2-2 2-2"})]})}),a&&!r&&e.jsx(s.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},className:"absolute right-12 top-1/2 -translate-y-1/2",children:e.jsx("div",{className:"flex gap-1",children:[0,1,2].map(P=>e.jsx(s.div,{className:"w-1 h-1 bg-green-500 rounded-full",animate:{scale:[1,1.5,1],opacity:[.3,1,.3]},transition:{duration:1,repeat:1/0,delay:P*.2}},P))})})]}),e.jsx(L,{children:r&&e.jsxs(s.div,{initial:{opacity:0,height:0,scale:.8},animate:{opacity:1,height:"auto",scale:1},exit:{opacity:0,height:0,scale:.8},className:`flex items-center gap-2 border rounded-lg px-3 py-2 ${d?"bg-red-900/20 border-red-800 text-red-400":"bg-red-50 border-red-200 text-red-700"}`,children:[e.jsxs(s.svg,{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"text-red-500",animate:{rotate:[0,10,-10,0]},transition:{duration:.5},children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),e.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),e.jsx("span",{children:r})]})}),e.jsxs(s.label,{className:"flex items-center gap-2 text-sm cursor-pointer",whileHover:{scale:1.02},children:[e.jsx("input",{type:"checkbox",checked:v,onChange:P=>h(P.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:d?"text-gray-300":"text-gray-600",children:"Zapamti ovaj ureƒëaj"})]}),e.jsxs(s.button,{type:"submit",className:`relative overflow-hidden w-full flex items-center justify-center gap-2 font-semibold py-3 rounded-lg shadow transition-all duration-300 ${G}`,disabled:t||!a.trim(),whileHover:{scale:1.02},whileTap:{scale:.98},animate:o?{x:[0,-10,10,-10,10,0]}:{},children:[e.jsx(s.div,{className:"absolute inset-0 bg-white/20 rounded-full",initial:{scale:0,opacity:1},animate:{scale:4,opacity:0},transition:{duration:.6}},Math.random()),t?e.jsxs(e.Fragment,{children:[e.jsx(s.span,{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}}),"Provjeravam..."]}):w?e.jsxs(e.Fragment,{children:[e.jsxs(s.svg,{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:500,damping:30},children:[e.jsx("path",{d:"m9 12 2 2 4-4"}),e.jsx("circle",{cx:"12",cy:"12",r:"10"})]}),"Uspje≈°no!"]}):e.jsxs(e.Fragment,{children:[e.jsx(s.svg,{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",whileHover:{x:5},transition:{type:"spring",stiffness:400,damping:30},children:e.jsx("path",{d:"m9 18 6-6-6-6"})}),"Nastavi"]})]})]}),e.jsxs(s.div,{className:"flex flex-col items-center gap-2 mt-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1.2},children:[e.jsx(s.div,{className:`w-12 h-12 rounded-full flex items-center justify-center ${d?"bg-gradient-to-br from-gray-700 to-gray-600":"bg-gradient-to-br from-gray-100 to-gray-200"}`,animate:{rotate:[0,5,-5,0]},transition:{duration:3,repeat:1/0,ease:"easeInOut"},children:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:d?"text-gray-300":"text-gray-500",children:[e.jsx(s.path,{d:"M18 20V10",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1,delay:1.5}}),e.jsx(s.path,{d:"M12 20V4",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1,delay:1.7}}),e.jsx(s.path,{d:"M6 20v-6",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1,delay:1.9}})]})}),e.jsx(s.p,{className:`text-sm ${d?"text-gray-400":"text-gray-500"}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:1.4},children:"B&D Evidencija ‚Ä¢ Aplikacija za evidenciju vo≈ænji"}),e.jsx(s.div,{className:`px-3 py-1 rounded-full text-xs font-semibold ${d?"bg-blue-800/50 text-blue-300":"bg-blue-100 text-blue-600"}`,initial:{scale:0},animate:{scale:1},transition:{delay:1.6,type:"spring",stiffness:500,damping:30},whileHover:{scale:1.1},children:"v5.0.0"})]})]})]})}function Be({driver:c,onContinue:t,onLogin:a,onBack:i,loading:r}){const[u,l]=n.useState(""),[y,d]=n.useState(!1),[x,g]=n.useState(null),[j,b]=n.useState(!1),[_,v]=n.useState(!1),[h,w]=n.useState(!1),[m,o]=n.useState("medium"),[N,I]=n.useState(!1),[M,R]=n.useState(!1),[U,O]=n.useState(!1);n.useEffect(()=>{const A=window.matchMedia("(prefers-color-scheme: dark)");w(A.matches);const k=J=>w(J.matches);return A.addEventListener("change",k),()=>A.removeEventListener("change",k)},[]),n.useEffect(()=>{const A=k=>{k.key==="Escape"&&(l(""),g(null))};return window.addEventListener("keydown",A),()=>window.removeEventListener("keydown",A)},[]);const T=()=>{navigator.vibrate&&navigator.vibrate(50)},V=A=>{if(A.preventDefault(),!u.trim()){g("Molimo unesite lozinku"),O(!0),T(),setTimeout(()=>O(!1),500);return}g(null),R(!0),T(),setTimeout(()=>{a(c.tura,u,y)},800)},G=A=>{const k=A.target.value;l(k),k&&k.length<4?g("Lozinka mora imati najmanje 4 karaktera"):g(null)},P={small:"text-sm",medium:"text-base",large:"text-lg"},C=h?"bg-gradient-to-br from-gray-900 to-blue-900 text-white":"bg-gradient-to-br from-gray-50 to-blue-50 text-gray-800",F=h?"bg-gray-800/90 backdrop-blur-lg border border-gray-700/50":"bg-white/90 backdrop-blur-lg border border-white/50",q=h?"bg-gray-700/50 border-gray-600 text-white placeholder-gray-400 focus:ring-blue-400":"bg-white/80 border-gray-300 text-gray-800 placeholder-gray-500 focus:ring-blue-400",$=h?"bg-blue-700 hover:bg-blue-600 disabled:bg-gray-700":"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-300";return e.jsxs("div",{className:`min-h-screen flex items-center justify-center relative overflow-hidden ${C} ${P[m]} ${N?"contrast-150":""}`,children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[[...Array(15)].map((A,k)=>e.jsx(s.div,{className:`absolute w-2 h-2 rounded-full ${h?"bg-blue-400/20":"bg-blue-300/30"}`,initial:{x:Math.random()*window.innerWidth,y:Math.random()*window.innerHeight},animate:{x:Math.random()*window.innerWidth,y:Math.random()*window.innerHeight},transition:{duration:Math.random()*10+20,repeat:1/0,repeatType:"reverse"}},k)),[...Array(6)].map((A,k)=>e.jsx(s.div,{className:`absolute opacity-20 ${h?"bg-gradient-to-r from-blue-600 to-purple-600":"bg-gradient-to-r from-blue-400 to-cyan-400"}`,style:{width:Math.random()*80+40,height:Math.random()*80+40,borderRadius:Math.random()*40+20,left:Math.random()*100+"%",top:Math.random()*100+"%"},animate:{rotate:360,scale:[1,1.1,1]},transition:{duration:Math.random()*15+25,repeat:1/0}},`shape-${k}`))]}),e.jsxs("div",{className:"absolute top-4 right-4 flex gap-2",children:[e.jsx(s.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>w(!h),className:`w-10 h-10 rounded-full ${F} flex items-center justify-center`,title:"Toggle Dark Mode",children:h?"‚òÄÔ∏è":"üåô"}),e.jsx(s.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>o(m==="small"?"medium":m==="medium"?"large":"small"),className:`w-10 h-10 rounded-full ${F} flex items-center justify-center text-sm`,title:"Font Size",children:"Aa"}),e.jsx(s.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>I(!N),className:`w-10 h-10 rounded-full ${F} flex items-center justify-center`,title:"High Contrast",children:"‚ö´"})]}),e.jsxs(s.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0,...U&&{x:[0,-10,10,-10,10,0],transition:{duration:.5}}},className:`w-full max-w-lg ${F} rounded-2xl shadow-2xl p-8 flex flex-col gap-6 relative z-10`,children:[e.jsx(L,{children:M&&e.jsx(s.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 pointer-events-none",children:[...Array(12)].map((A,k)=>e.jsx(s.div,{className:"absolute w-2 h-2 bg-green-500 rounded",initial:{x:"50%",y:"50%",scale:0},animate:{x:Math.random()*250-125,y:Math.random()*250-125,scale:1,rotate:Math.random()*360},transition:{duration:.8,delay:k*.05}},k))})}),e.jsxs(s.div,{className:"flex flex-col items-center gap-3",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{delay:.2},children:[e.jsx(s.div,{className:`w-16 h-16 rounded-full flex items-center justify-center mb-2 ${h?"bg-gradient-to-br from-green-600 to-blue-600":"bg-gradient-to-br from-green-500 to-blue-500"}`,animate:{boxShadow:["0 0 20px rgba(34, 197, 94, 0.3)","0 0 30px rgba(34, 197, 94, 0.5)","0 0 20px rgba(34, 197, 94, 0.3)"]},transition:{duration:2,repeat:1/0},children:e.jsxs(s.svg,{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"text-white",initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:500,damping:30,delay:.3},children:[e.jsx(s.path,{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1.5,delay:.5}}),e.jsx(s.circle,{cx:"12",cy:"7",r:"4",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1.5,delay:.8}})]})}),e.jsx(s.h1,{className:`text-2xl font-bold ${h?"text-white":"text-gray-800"}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},children:"Vozaƒç pronaƒëen"}),e.jsx(s.p,{className:`text-center ${h?"text-gray-300":"text-gray-600"}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},children:"Uspje≈°no smo identificirali va≈° profil"})]}),e.jsx(s.div,{className:`${F} rounded-xl p-4 shadow-lg`,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.8},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(s.h2,{className:`text-xl font-bold ${h?"text-white":"text-gray-800"}`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:1},children:c.ime}),e.jsxs("div",{className:"flex flex-col gap-2 mt-3",children:[e.jsxs(s.div,{className:"flex items-center gap-2",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:1.2},children:[e.jsx("span",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${h?"bg-blue-700/50":"bg-blue-100"}`,children:e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:h?"text-blue-300":"text-blue-600",children:[e.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"8.5",cy:"7",r:"4"}),e.jsx("path",{d:"m20 8 2 2-2 2"}),e.jsx("path",{d:"m16 12-2-2 2-2"})]})}),e.jsxs("span",{className:`font-medium ${h?"text-gray-200":"text-gray-700"}`,children:["Tura: ",c.tura]})]}),e.jsxs(s.div,{className:"flex items-center gap-2",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:1.4},children:[e.jsx("span",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${h?"bg-purple-700/50":"bg-purple-100"}`,children:e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:h?"text-purple-300":"text-purple-600",children:[e.jsx("path",{d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"}),e.jsx("path",{d:"m19.4 15-1.1-2.3c-.4-.8-1.2-1.3-2.1-1.3H7.8c-.9 0-1.7.5-2.1 1.3L4.6 15"}),e.jsx("path",{d:"M12 8v7"})]})}),e.jsx("span",{className:`font-medium ${h?"text-gray-200":"text-gray-700"}`,children:c.role==="admin"?"Administrator":"Vozaƒç"})]})]})]}),e.jsx(s.div,{className:"flex flex-col items-center",initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},transition:{delay:1.6},children:c.hasPassword?e.jsxs("div",{className:`flex items-center gap-2 px-3 py-2 rounded-lg ${h?"bg-green-800/50 text-green-300":"bg-green-100 text-green-700"}`,children:[e.jsxs(s.svg,{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",animate:{scale:[1,1.1,1]},transition:{duration:2,repeat:1/0},children:[e.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),e.jsx("circle",{cx:"12",cy:"16",r:"1"}),e.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),e.jsx("span",{className:"text-sm font-medium",children:"Veƒá imate lozinku"})]}):e.jsxs("div",{className:`flex items-center gap-2 px-3 py-2 rounded-lg ${h?"bg-orange-800/50 text-orange-300":"bg-orange-100 text-orange-700"}`,children:[e.jsxs(s.svg,{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",animate:{scale:[1,1.1,1]},transition:{duration:2,repeat:1/0},children:[e.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),e.jsx("path",{d:"M7 11V7a5 5 0 0 1 9.9-1"})]}),e.jsx("span",{className:"text-sm font-medium",children:"Potrebno je postaviti lozinku"})]})})]})}),c.hasPassword?e.jsxs(s.form,{onSubmit:V,className:"flex flex-col gap-4",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1.8},children:[e.jsxs("div",{className:"relative",children:[e.jsx(s.input,{type:j?"text":"password",id:"password",value:u,onChange:G,onFocus:()=>v(!0),onBlur:()=>v(!1),placeholder:" ",disabled:r,autoFocus:!0,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 text-lg peer transition-all duration-300 ${q}`,animate:{scale:_?1.02:1,boxShadow:_?"0 0 20px rgba(59, 130, 246, 0.3)":"0 0 0px rgba(59, 130, 246, 0)"}}),e.jsx(s.label,{htmlFor:"password",className:`absolute left-4 transition-all duration-300 pointer-events-none ${h?"text-gray-400":"text-gray-500"} ${_||u?"-top-2 text-xs bg-inherit px-2 font-medium":"top-3 text-base"}`,animate:{color:_?"#3b82f6":h?"#9ca3af":"#6b7280"},children:"Lozinka"}),e.jsx(s.button,{type:"button",className:`absolute right-3 top-1/2 -translate-y-1/2 p-1 rounded ${h?"text-gray-400 hover:text-gray-200":"text-gray-500 hover:text-gray-700"}`,onClick:()=>b(!j),disabled:r,whileHover:{scale:1.1},whileTap:{scale:.9},children:e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:j?e.jsxs(e.Fragment,{children:[e.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"}),e.jsx("path",{d:"m1 1 22 22"})]}):e.jsxs(e.Fragment,{children:[e.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),e.jsx("circle",{cx:"12",cy:"12",r:"3"})]})})}),u&&!x&&e.jsx(s.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},className:"absolute right-12 top-1/2 -translate-y-1/2",children:e.jsx("div",{className:"flex gap-1",children:[0,1,2].map(A=>e.jsx(s.div,{className:"w-1 h-1 bg-green-500 rounded-full",animate:{scale:[1,1.5,1],opacity:[.3,1,.3]},transition:{duration:1,repeat:1/0,delay:A*.2}},A))})})]}),e.jsx(L,{children:x&&e.jsxs(s.div,{initial:{opacity:0,height:0,scale:.8},animate:{opacity:1,height:"auto",scale:1},exit:{opacity:0,height:0,scale:.8},className:`flex items-center gap-2 border rounded-lg px-3 py-2 ${h?"bg-red-900/20 border-red-800 text-red-400":"bg-red-50 border-red-200 text-red-700"}`,children:[e.jsxs(s.svg,{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"text-red-500",animate:{rotate:[0,10,-10,0]},transition:{duration:.5},children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),e.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),e.jsx("span",{children:x})]})}),e.jsxs(s.label,{className:"flex items-center gap-2 text-sm cursor-pointer",whileHover:{scale:1.02},children:[e.jsx("input",{type:"checkbox",checked:y,onChange:A=>d(A.target.checked),disabled:r,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:h?"text-gray-300":"text-gray-600",children:"Zapamti me"})]}),e.jsxs("div",{className:"flex gap-3 mt-4",children:[e.jsxs(s.button,{type:"button",className:`flex-1 flex items-center justify-center gap-2 font-semibold py-3 rounded-lg border transition-all duration-300 ${h?"border-gray-600 text-gray-300 hover:bg-gray-700/50":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,onClick:i,disabled:r,whileHover:{scale:1.02},whileTap:{scale:.98},children:[e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"m15 18-6-6 6-6"})}),"Nazad"]}),e.jsxs(s.button,{type:"submit",className:`flex-2 relative overflow-hidden flex items-center justify-center gap-2 font-semibold py-3 rounded-lg shadow transition-all duration-300 ${$}`,disabled:r||!u.trim(),whileHover:{scale:1.02},whileTap:{scale:.98},animate:U?{x:[0,-10,10,-10,10,0]}:{},children:[e.jsx(s.div,{className:"absolute inset-0 bg-white/20 rounded-full pointer-events-none",initial:{scale:0,opacity:1},animate:{scale:4,opacity:0},transition:{duration:.6}}),r?e.jsxs(e.Fragment,{children:[e.jsx(s.span,{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}}),"Prijavljivam..."]}):M?e.jsxs(e.Fragment,{children:[e.jsxs(s.svg,{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:500,damping:30},children:[e.jsx("path",{d:"m9 12 2 2 4-4"}),e.jsx("circle",{cx:"12",cy:"12",r:"10"})]}),"Uspje≈°no!"]}):e.jsxs(e.Fragment,{children:[e.jsx(s.svg,{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",whileHover:{x:5},transition:{type:"spring",stiffness:400,damping:30},children:e.jsx("path",{d:"m9 18 6-6-6-6"})}),"Prijavite se"]})]})]})]}):e.jsxs(s.div,{className:"flex gap-3 mt-4",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1.8},children:[e.jsxs(s.button,{type:"button",className:`flex-1 flex items-center justify-center gap-2 font-semibold py-3 rounded-lg border transition-all duration-300 ${h?"border-gray-600 text-gray-300 hover:bg-gray-700/50":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,onClick:i,disabled:r,whileHover:{scale:1.02},whileTap:{scale:.98},children:[e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"m15 18-6-6 6-6"})}),"Nazad"]}),e.jsxs(s.button,{type:"button",className:`flex-2 relative overflow-hidden flex items-center justify-center gap-2 font-semibold py-3 rounded-lg shadow transition-all duration-300 ${$}`,onClick:t,disabled:r,whileHover:{scale:1.02},whileTap:{scale:.98},children:[e.jsx(s.div,{className:"absolute inset-0 bg-white/20 rounded-full pointer-events-none",initial:{scale:0,opacity:1},animate:{scale:4,opacity:0},transition:{duration:.6}}),r?e.jsxs(e.Fragment,{children:[e.jsx(s.span,{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}}),"Molim saƒçekajte..."]}):e.jsxs(e.Fragment,{children:[e.jsxs(s.svg,{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",whileHover:{x:5},transition:{type:"spring",stiffness:400,damping:30},children:[e.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),e.jsx("path",{d:"M7 11V7a5 5 0 0 1 9.9-1"})]}),"Postavite lozinku"]})]})]}),e.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:2},children:[e.jsx(s.div,{className:`w-10 h-10 rounded-full flex items-center justify-center ${h?"bg-gradient-to-br from-gray-700 to-gray-600":"bg-gradient-to-br from-gray-100 to-gray-200"}`,animate:{rotate:[0,5,-5,0]},transition:{duration:3,repeat:1/0,ease:"easeInOut"},children:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:h?"text-gray-300":"text-gray-500",children:[e.jsx(s.rect,{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1,delay:2.2}}),e.jsx(s.circle,{cx:"12",cy:"16",r:"1",initial:{scale:0},animate:{scale:1},transition:{duration:.5,delay:2.4}}),e.jsx(s.path,{d:"M7 11V7a5 5 0 0 1 10 0v4",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1,delay:2}})]})}),e.jsx(s.p,{className:`text-sm text-center ${h?"text-gray-400":"text-gray-500"}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:2.2},children:"Provjerite da li su podaci ispravni prije nastavka"})]})]})]})}function De({driver:c,onPasswordSet:t,onBack:a,loading:i}){const[r,u]=n.useState(""),[l,y]=n.useState(""),[d,x]=n.useState(!1),[g,j]=n.useState(!1),[b,_]=n.useState(!0),[v,h]=n.useState(""),[w,m]=n.useState(""),[o,N]=n.useState(()=>localStorage.getItem("theme")==="dark"||!localStorage.getItem("theme")&&window.matchMedia("(prefers-color-scheme: dark)").matches),[I,M]=n.useState(()=>localStorage.getItem("fontSize")||"medium"),[R,U]=n.useState(()=>localStorage.getItem("highContrast")==="true"),[O,T]=n.useState(!1),[V,G]=n.useState([]),[P,C]=n.useState(!1),[F,q]=n.useState([]),[$,A]=n.useState({score:0,feedback:"Unesite lozinku"}),k={background:o?"bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900":"bg-gradient-to-br from-purple-50 via-white to-pink-50",container:o?"bg-gray-800/40 backdrop-blur-xl border-gray-700/50":"bg-white/40 backdrop-blur-xl border-white/50",card:o?"bg-gray-800/60 backdrop-blur-xl border-gray-700/50":"bg-white/60 backdrop-blur-xl border-white/60",input:o?"bg-gray-800/60 border-gray-600 text-white placeholder-gray-400 focus:border-purple-500 focus:bg-gray-800/80":"bg-white/60 border-gray-200 text-gray-900 placeholder-gray-500 focus:border-purple-500 focus:bg-white/80",text:o?"text-gray-100":"text-gray-900"},J=`${k.container} ${I==="small"?"text-sm":I==="large"?"text-lg":"text-base"} ${R?"contrast-125":""}`,Q=`${k.card} ${R?"shadow-2xl":"shadow-xl"}`,ee=`${k.input} ${R?"shadow-inner border-2":"border"}`,le=p=>{if(!p)return{score:0,feedback:"Unesite lozinku"};let S=0,E="";p.length>=8&&S++,p.length>=12&&S++,/[a-z]/.test(p)&&S++,/[A-Z]/.test(p)&&S++,/[0-9]/.test(p)&&S++,/[^a-zA-Z0-9]/.test(p)&&S++;const X=Math.min(Math.max(Math.floor(S/1.5),1),4);switch(X){case 1:E="Slaba lozinka";break;case 2:E="Umjereno jaka lozinka";break;case 3:E="Jaka lozinka";break;case 4:E="Vrlo jaka lozinka";break;default:E="Unesite lozinku"}return{score:X,feedback:E}};n.useEffect(()=>{(()=>{const S=Array.from({length:20},(E,X)=>({id:X,x:Math.random()*100,y:Math.random()*100,size:Math.random()*4+1,duration:Math.random()*20+10,delay:Math.random()*5,opacity:Math.random()*.5+.1}));G(S)})()},[]),n.useEffect(()=>{A(le(r))},[r]),n.useEffect(()=>{localStorage.setItem("theme",o?"dark":"light"),document.documentElement.classList.toggle("dark",o)},[o]),n.useEffect(()=>{localStorage.setItem("fontSize",I)},[I]),n.useEffect(()=>{localStorage.setItem("highContrast",R.toString())},[R]),n.useEffect(()=>{const p=S=>{S.ctrlKey&&S.key==="d"&&(S.preventDefault(),N(!o)),S.ctrlKey&&S.key==="="&&(S.preventDefault(),M(E=>E==="small"?"medium":"large")),S.ctrlKey&&S.key==="-"&&(S.preventDefault(),M(E=>E==="large"?"medium":"small")),S.key==="Escape"&&T(!1)};return window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)},[o]);const ce=()=>{const p=Array.from({length:50},(S,E)=>({id:E,x:Math.random()*100,y:-10,rotation:Math.random()*360,scale:Math.random()*.8+.4,color:["#8b5cf6","#ec4899","#06b6d4","#10b981","#f59e0b"][Math.floor(Math.random()*5)]}));q(p),setTimeout(()=>q([]),3e3)},Z=()=>{navigator.vibrate&&navigator.vibrate(50)},de=async p=>{if(p.preventDefault(),!r.trim()||!l.trim()){h("Molimo unesite oba polja"),Z();return}if(r!==l){h("Lozinke se ne poklapaju"),Z();return}if($.score<2){h("Lozinka mora biti jaƒça"),Z();return}h(""),C(!0),ce();try{await t(r,b)}catch(S){h(S.message||"Gre≈°ka pri postavljanju lozinke"),C(!1),Z()}};return e.jsxs("div",{className:`min-h-screen relative overflow-hidden ${k.background}`,children:[e.jsx("div",{className:"absolute inset-0 overflow-hidden",children:V.map(p=>e.jsx(s.div,{className:`absolute w-2 h-2 rounded-full ${o?"bg-purple-400/20":"bg-purple-500/10"}`,style:{left:`${p.x}%`,top:`${p.y}%`,width:`${p.size}px`,height:`${p.size}px`},animate:{y:[0,-30,0],opacity:[p.opacity,p.opacity*1.5,p.opacity],scale:[1,1.2,1]},transition:{duration:p.duration,delay:p.delay,repeat:1/0,ease:"easeInOut"}},p.id))}),e.jsx(L,{children:F.map(p=>e.jsx(s.div,{className:"absolute w-3 h-3 rounded-sm",style:{left:`${p.x}%`,backgroundColor:p.color,rotate:p.rotation,scale:p.scale},initial:{y:-50},animate:{y:window.innerHeight+100,rotate:p.rotation+360*2,opacity:[1,1,0]},transition:{duration:3,ease:"easeIn"},exit:{opacity:0}},p.id))}),e.jsx(L,{children:O&&e.jsx(s.div,{className:"fixed top-4 right-4 z-50",initial:{opacity:0,x:20,scale:.9},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:20,scale:.9},children:e.jsxs("div",{className:`${Q} p-4 rounded-2xl border shadow-2xl min-w-[200px]`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:`font-semibold ${k.text}`,children:"Postavke"}),e.jsx("button",{onClick:()=>T(!1),className:`p-1 rounded-lg transition-colors ${o?"hover:bg-gray-700":"hover:bg-gray-100"}`,children:e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:k.text,children:[e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:o,onChange:p=>N(p.target.checked),className:"rounded"}),e.jsx("span",{className:`text-sm ${k.text}`,children:"Tamna tema"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:R,onChange:p=>U(p.target.checked),className:"rounded"}),e.jsx("span",{className:`text-sm ${k.text}`,children:"Visoki kontrast"})]}),e.jsxs("div",{children:[e.jsx("label",{className:`text-sm ${k.text} block mb-1`,children:"Veliƒçina fonta"}),e.jsxs("select",{value:I,onChange:p=>M(p.target.value),className:`w-full p-1 rounded text-sm ${ee}`,children:[e.jsx("option",{value:"small",children:"Mala"}),e.jsx("option",{value:"medium",children:"Srednja"}),e.jsx("option",{value:"large",children:"Velika"})]})]})]}),e.jsx("div",{className:`mt-3 pt-3 border-t ${o?"border-gray-700":"border-gray-200"}`,children:e.jsxs("p",{className:`text-xs ${o?"text-gray-400":"text-gray-500"}`,children:["Ctrl+D: Tamna tema",e.jsx("br",{}),"Ctrl++/-: Veliƒçina fonta"]})})]})})}),e.jsx(s.button,{onClick:()=>T(!O),className:`fixed top-4 right-4 z-40 p-3 rounded-full ${Q} border shadow-lg transition-all duration-300 ${o?"hover:bg-gray-700":"hover:bg-gray-50"}`,whileHover:{scale:1.05},whileTap:{scale:.95},initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},transition:{delay:.5},children:e.jsxs(s.svg,{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:k.text,animate:{rotate:O?180:0},transition:{duration:.3},children:[e.jsx("circle",{cx:"12",cy:"12",r:"3"}),e.jsx("path",{d:"m12 1 1.7 1.7"}),e.jsx("path",{d:"m12 23-1.7-1.7"}),e.jsx("path",{d:"m5.6 5.6 1.4 1.4"}),e.jsx("path",{d:"m18.4 18.4-1.4-1.4"}),e.jsx("path",{d:"m1 12 1.7-1.7"}),e.jsx("path",{d:"m23 12-1.7 1.7"}),e.jsx("path",{d:"m5.6 18.4 1.4-1.4"}),e.jsx("path",{d:"m18.4 5.6-1.4 1.4"})]})}),e.jsx("div",{className:"relative z-10 min-h-screen flex items-center justify-center p-4",children:e.jsxs(s.div,{className:`w-full max-w-md ${J} rounded-3xl border p-8 shadow-2xl space-y-8`,initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},transition:{duration:.5},children:[e.jsxs(s.div,{className:"flex flex-col items-center gap-3",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{delay:.2},children:[e.jsx(s.div,{className:`w-16 h-16 rounded-full flex items-center justify-center mb-2 ${o?"bg-gradient-to-br from-purple-600 to-pink-600":"bg-gradient-to-br from-purple-500 to-pink-500"}`,animate:{boxShadow:["0 0 20px rgba(168, 85, 247, 0.3)","0 0 30px rgba(168, 85, 247, 0.5)","0 0 20px rgba(168, 85, 247, 0.3)"]},transition:{duration:2,repeat:1/0},children:e.jsxs(s.svg,{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"text-white",initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:500,damping:30,delay:.3},children:[e.jsx(s.rect,{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1.5,delay:.5}}),e.jsx(s.circle,{cx:"12",cy:"16",r:"1",initial:{scale:0},animate:{scale:1},transition:{duration:.5,delay:1}}),e.jsx(s.path,{d:"M7 11V7a5 5 0 0 1 10 0v4",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1.5,delay:.8}})]})}),e.jsx(s.h1,{className:`text-2xl font-bold ${o?"text-white":"text-gray-800"}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},children:"Postavite lozinku"}),e.jsx(s.p,{className:`text-center ${o?"text-gray-300":"text-gray-600"}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},children:"Ovo je va≈° prvi put. Molimo postavite lozinku za buduƒái pristup."})]}),e.jsx(s.div,{className:`${Q} rounded-xl p-4 shadow-lg`,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.8},children:e.jsxs("div",{className:"flex items-center justify-center gap-6",children:[e.jsxs(s.div,{className:"flex items-center gap-2",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:1},children:[e.jsx("span",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${o?"bg-purple-700/50":"bg-purple-100"}`,children:e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:o?"text-purple-300":"text-purple-600",children:[e.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),e.jsxs("span",{className:`font-medium ${o?"text-gray-200":"text-gray-700"}`,children:[e.jsx("strong",{children:"Vozaƒç:"})," ",c.ime]})]}),e.jsxs(s.div,{className:"flex items-center gap-2",initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:1.2},children:[e.jsx("span",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${o?"bg-blue-700/50":"bg-blue-100"}`,children:e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:o?"text-blue-300":"text-blue-600",children:[e.jsx("circle",{cx:"12",cy:"12",r:"3"}),e.jsx("path",{d:"M12 1v6m0 6v6"})]})}),e.jsxs("span",{className:`font-medium ${o?"text-gray-200":"text-gray-700"}`,children:[e.jsx("strong",{children:"Tura:"})," ",c.tura]})]})]})}),e.jsxs(s.form,{onSubmit:de,className:"flex flex-col gap-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1.4},children:[e.jsxs(s.div,{className:"relative",animate:v?{x:[-10,10,-10,10,0]}:{},transition:{type:"spring",stiffness:500,damping:30},children:[e.jsxs("div",{className:"relative",children:[e.jsx(s.input,{type:d?"text":"password",value:r,onChange:p=>u(p.target.value),className:`w-full px-4 pt-6 pb-2 border-2 rounded-xl transition-all duration-300 ${ee} peer ${v?"border-red-500 bg-red-50/50":r?"border-purple-500 bg-purple-50/20":""}`,placeholder:" ",onFocus:()=>m("password"),onBlur:()=>m(""),initial:{opacity:0},animate:{opacity:1},transition:{delay:1.6},disabled:i,autoFocus:!0}),e.jsx(s.label,{className:`absolute left-4 transition-all duration-300 pointer-events-none ${r||w==="password"?`text-xs top-2 ${o?"text-purple-400":"text-purple-600"}`:`text-base top-4 ${o?"text-gray-400":"text-gray-500"}`}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:1.8},children:"Lozinka"}),e.jsx(L,{children:r&&e.jsx(s.button,{type:"button",onClick:()=>x(!d),className:`absolute right-3 top-1/2 -translate-y-1/2 p-2 rounded-lg transition-colors ${o?"text-gray-400 hover:text-white hover:bg-gray-700":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},exit:{opacity:0,scale:0},whileHover:{scale:1.1},whileTap:{scale:.9},disabled:i,children:d?e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"}),e.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}):e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),e.jsx("circle",{cx:"12",cy:"12",r:"3"})]})})})]}),e.jsx(L,{children:r&&e.jsxs(s.div,{className:"mt-3 space-y-2",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:[e.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4].map(p=>e.jsx(s.div,{className:`h-1 rounded-full flex-1 ${p<=$.score?$.score===1?"bg-red-500":$.score===2?"bg-orange-500":$.score===3?"bg-yellow-500":"bg-green-500":o?"bg-gray-700":"bg-gray-200"}`,initial:{scaleX:0},animate:{scaleX:p<=$.score?1:0},transition:{delay:p*.1}},p))}),e.jsx(s.p,{className:`text-sm ${$.score===1?"text-red-500":$.score===2?"text-orange-500":$.score===3?"text-yellow-500":"text-green-500"}`,initial:{opacity:0},animate:{opacity:1},children:$.feedback})]})})]}),e.jsxs(s.div,{className:"relative",animate:v?{x:[-10,10,-10,10,0]}:{},transition:{type:"spring",stiffness:500,damping:30},children:[e.jsxs("div",{className:"relative",children:[e.jsx(s.input,{type:g?"text":"password",value:l,onChange:p=>y(p.target.value),className:`w-full px-4 pt-6 pb-2 border-2 rounded-xl transition-all duration-300 ${ee} peer ${v?"border-red-500 bg-red-50/50":l?"border-purple-500 bg-purple-50/20":""}`,placeholder:" ",onFocus:()=>m("confirmPassword"),onBlur:()=>m(""),initial:{opacity:0},animate:{opacity:1},transition:{delay:2},disabled:i}),e.jsx(s.label,{className:`absolute left-4 transition-all duration-300 pointer-events-none ${l||w==="confirmPassword"?`text-xs top-2 ${o?"text-purple-400":"text-purple-600"}`:`text-base top-4 ${o?"text-gray-400":"text-gray-500"}`}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:2.2},children:"Potvrdite lozinku"}),e.jsx(L,{children:l&&e.jsx(s.button,{type:"button",onClick:()=>j(!g),className:`absolute right-3 top-1/2 -translate-y-1/2 p-2 rounded-lg transition-colors ${o?"text-gray-400 hover:text-white hover:bg-gray-700":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},exit:{opacity:0,scale:0},whileHover:{scale:1.1},whileTap:{scale:.9},disabled:i,children:g?e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"}),e.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}):e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),e.jsx("circle",{cx:"12",cy:"12",r:"3"})]})})})]}),e.jsx(L,{children:l&&e.jsxs(s.div,{className:`mt-2 flex items-center gap-2 text-sm ${r===l?"text-green-500":"text-red-500"}`,initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},children:[r===l?e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("polyline",{points:"20,6 9,17 4,12"})}):e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),e.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),r===l?"Lozinke se poklapaju":"Lozinke se ne poklapaju"]})})]}),e.jsx(L,{children:v&&e.jsxs(s.div,{className:`p-4 rounded-xl flex items-center gap-3 ${o?"bg-red-900/30 border border-red-800 text-red-300":"bg-red-50 border border-red-200 text-red-700"}`,initial:{opacity:0,scale:.95,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-10},children:[e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),e.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),v]})}),e.jsx(L,{children:P&&e.jsxs(s.div,{className:`p-4 rounded-xl flex items-center gap-3 ${o?"bg-green-900/30 border border-green-800 text-green-300":"bg-green-50 border border-green-200 text-green-700"}`,initial:{opacity:0,scale:.95,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-10},children:[e.jsx(s.svg,{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:500,damping:30},children:e.jsx("polyline",{points:"20,6 9,17 4,12"})}),"Lozinka je uspje≈°no postavljena! Ulogujemo vas..."]})}),e.jsx(s.div,{className:"flex items-center gap-3",initial:{opacity:0},animate:{opacity:1},transition:{delay:2.4},children:e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"checkbox",checked:b,onChange:p=>_(p.target.checked),disabled:i,className:"sr-only"}),e.jsx(s.div,{className:`w-6 h-6 rounded-lg border-2 flex items-center justify-center transition-all duration-300 ${b?o?"bg-purple-600 border-purple-600":"bg-purple-500 border-purple-500":o?"border-gray-600 bg-gray-700":"border-gray-300 bg-white"} ${i?"opacity-50 cursor-not-allowed":"group-hover:border-purple-400"}`,whileHover:i?{}:{scale:1.05},whileTap:i?{}:{scale:.95},children:e.jsx(L,{children:b&&e.jsx(s.svg,{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"3",initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0},transition:{type:"spring",stiffness:500,damping:30},children:e.jsx("polyline",{points:"20,6 9,17 4,12"})})})})]}),e.jsx("span",{className:`font-medium ${o?"text-gray-200":"text-gray-700"} ${i?"opacity-50":""}`,children:"Zapamti me"})]})}),e.jsxs(s.div,{className:"flex gap-4 mt-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:2.6},children:[e.jsxs(s.button,{type:"button",onClick:a,disabled:i,className:`flex-1 px-6 py-3 rounded-xl font-medium transition-all duration-300 flex items-center justify-center gap-2 ${o?"bg-gray-700 text-gray-200 hover:bg-gray-600 border border-gray-600":"bg-gray-100 text-gray-700 hover:bg-gray-200 border border-gray-200"} ${i?"opacity-50 cursor-not-allowed":"hover:shadow-lg"}`,whileHover:i?{}:{scale:1.02},whileTap:i?{}:{scale:.98},children:[e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"m15 18-6-6 6-6"})}),"Nazad"]}),e.jsx(s.button,{type:"submit",disabled:i||!r.trim()||!l.trim()||r!==l||$.score<2,className:`flex-1 px-6 py-3 rounded-xl font-medium transition-all duration-300 flex items-center justify-center gap-2 ${i||!r.trim()||!l.trim()||r!==l||$.score<2?o?"bg-gray-700 text-gray-500 cursor-not-allowed":"bg-gray-200 text-gray-400 cursor-not-allowed":o?"bg-gradient-to-r from-purple-600 to-pink-600 text-white hover:from-purple-700 hover:to-pink-700":"bg-gradient-to-r from-purple-500 to-pink-500 text-white hover:from-purple-600 hover:to-pink-600"} hover:shadow-lg`,whileHover:!i&&r.trim()&&l.trim()&&r===l&&$.score>=2?{scale:1.02}:{},whileTap:!i&&r.trim()&&l.trim()&&r===l&&$.score>=2?{scale:.98}:{},children:i?e.jsxs(e.Fragment,{children:[e.jsx(s.div,{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}}),"Postavljam i ulogujem..."]}):e.jsxs(e.Fragment,{children:[e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"}),e.jsx("polyline",{points:"10,17 15,12 10,7"}),e.jsx("line",{x1:"15",y1:"12",x2:"3",y2:"12"})]}),"Postavi lozinku i uloguj se"]})})]})]}),e.jsx(s.div,{className:"text-center",initial:{opacity:0},animate:{opacity:1},transition:{delay:2.8},children:e.jsx("p",{className:`text-sm ${o?"text-gray-400":"text-gray-500"}`,children:"Lozinka ƒáe biti automatski saƒçuvana i ulogovani ƒáete se odmah."})})]})})]})}function Fe({onLogin:c,loading:t,onBack:a}){const[i,r]=n.useState(""),[u,l]=n.useState(""),[y,d]=n.useState(null),x=g=>{if(g.preventDefault(),!i.trim()){d("Molimo unesite va≈°u turu");return}if(!u.trim()){d("Molimo unesite lozinku");return}d(null),c(i.trim().toUpperCase(),u)};return e.jsx("div",{className:"login-screen",children:e.jsxs("div",{className:"login-container",children:[e.jsxs("div",{className:"login-header",children:[e.jsx("h1",{children:"Prijava"}),e.jsx("p",{children:"Unesite va≈°u turu i lozinku za pristup aplikaciji."})]}),e.jsxs("form",{onSubmit:x,className:"login-form",children:[e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"tura",children:"Tura:"}),e.jsx("input",{type:"text",id:"tura",value:i,onChange:g=>r(g.target.value),placeholder:"npr. 8610",maxLength:"10",disabled:t,autoFocus:!0})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"password",children:"Lozinka:"}),e.jsx("input",{type:"password",id:"password",value:u,onChange:g=>l(g.target.value),placeholder:"Va≈°a lozinka",disabled:t})]}),y&&e.jsx("div",{className:"error-message",children:y}),e.jsx("button",{type:"submit",className:"login-btn",disabled:t||!i.trim()||!u.trim(),children:t?"Prijavljivam...":"Prijavite se"})]}),e.jsx("div",{className:"login-footer",children:e.jsx("button",{type:"button",className:"back-btn",onClick:a,disabled:t,children:"‚Üê Nazad"})})]})})}function He({onAuthSuccess:c}){const[t,a]=n.useState("init"),[i,r]=n.useState(null),{loading:u,checkDriverExists:l,setInitialPassword:y,login:d}=ae(),x=async h=>{try{const w=await l(h);r(w),a("confirm")}catch(w){console.error("Driver check failed:",w)}},g=()=>{i.hasPassword?a("login"):a("setup")},j=async(h,w=!1)=>{var m;try{await y(i.id,h);const o=await d(i.tura,h);console.log("[AuthFlowManager] Login user:",o),w&&localStorage.setItem("bde_remember_me","true"),o!=null&&o.name&&(localStorage.setItem("DRIVER_NAME",o.name),(m=window.__USER_CONTEXT__)!=null&&m.refreshStatus&&window.__USER_CONTEXT__.refreshStatus()),c(o)}catch(o){console.error("Password setup failed:",o)}},b=async(h,w,m=!1)=>{var o;try{const N=await d(h,w);console.log("[AuthFlowManager] Login user:",N),m&&localStorage.setItem("bde_remember_me","true"),N!=null&&N.ime&&(localStorage.setItem("DRIVER_NAME",N.ime),(o=window.__USER_CONTEXT__)!=null&&o.refreshStatus&&window.__USER_CONTEXT__.refreshStatus()),c(N)}catch(N){console.error("Login failed:",N)}},_=()=>{a("init"),r(null)},v=()=>{a("confirm")};return t==="init"?e.jsx(Re,{onDriverSelected:x,loading:u}):t==="confirm"?e.jsx(Be,{driver:i,onContinue:g,onLogin:b,onBack:_,loading:u}):t==="setup"?e.jsx(De,{driver:i,onPasswordSet:j,onBack:v,loading:u}):t==="login"?e.jsx(Fe,{onLogin:b,loading:u,onBack:v}):null}const Oe=({onClose:c,onSubmit:t})=>{const[a,i]=n.useState({oldPassword:"",newPassword:"",confirmPassword:""}),[r,u]=n.useState({old:!1,new:!1,confirm:!1}),[l,y]=n.useState({}),[d,x]=n.useState(!1),g=m=>{if(!m)return null;let o=0;return m.length>=8&&o++,/[A-Z]/.test(m)&&o++,/[a-z]/.test(m)&&o++,/[0-9]/.test(m)&&o++,/[^A-Za-z0-9]/.test(m)&&o++,o<3?{level:"weak",text:"üî¥ Slaba lozinka"}:o<4?{level:"medium",text:"üü° Srednja lozinka"}:{level:"strong",text:"üü¢ Jaka lozinka"}},j=()=>{const m={};return a.oldPassword||(m.oldPassword="Stara lozinka je obavezna"),a.newPassword?a.newPassword.length<6&&(m.newPassword="Nova lozinka mora imati najmanje 6 karaktera"):m.newPassword="Nova lozinka je obavezna",a.confirmPassword?a.newPassword!==a.confirmPassword&&(m.confirmPassword="Lozinke se ne poklapaju"):m.confirmPassword="Potvrda lozinke je obavezna",a.oldPassword===a.newPassword&&(m.newPassword="Nova lozinka mora biti razliƒçita od stare"),y(m),Object.keys(m).length===0},b=(m,o)=>{i(N=>({...N,[m]:o})),l[m]&&y(N=>({...N,[m]:null}))},_=m=>{u(o=>({...o,[m]:!o[m]}))},v=async m=>{if(m.preventDefault(),!!j()){x(!0);try{await t(a),c()}catch(o){y({submit:o.message||"Gre≈°ka pri promeni lozinke"})}finally{x(!1)}}},h=a.oldPassword&&a.newPassword&&a.confirmPassword&&a.newPassword===a.confirmPassword&&a.newPassword.length>=6&&a.oldPassword!==a.newPassword,w=g(a.newPassword);return e.jsxs("form",{className:styles.modalForm,onSubmit:v,children:[e.jsxs("div",{className:styles.formHeader,children:[e.jsx("h2",{className:styles.formTitle,children:"üîê Promena lozinke"}),e.jsx("p",{className:styles.formSubtitle,children:"Unesite staru lozinku i defini≈°ite novu sigurnu lozinku"})]}),e.jsxs("div",{className:styles.inputGroup,children:[e.jsx("label",{className:styles.inputLabel,htmlFor:"oldPassword",children:"Trenutna lozinka"}),e.jsxs("div",{className:styles.inputWrapper,children:[e.jsx("input",{id:"oldPassword",type:r.old?"text":"password",value:a.oldPassword,onChange:m=>b("oldPassword",m.target.value),placeholder:"Unesite trenutnu lozinku",className:styles.passwordInput,autoComplete:"current-password"}),e.jsx("button",{type:"button",className:styles.toggleButton,onClick:()=>_("old"),"aria-label":"Prika≈æi/sakrij lozinku",children:r.old?"üëÅÔ∏è":"üôà"})]}),l.oldPassword&&e.jsxs("div",{className:`${styles.validationMessage} ${styles.validationError}`,children:["‚ùå ",l.oldPassword]})]}),e.jsxs("div",{className:styles.inputGroup,children:[e.jsx("label",{className:styles.inputLabel,htmlFor:"newPassword",children:"Nova lozinka"}),e.jsxs("div",{className:styles.inputWrapper,children:[e.jsx("input",{id:"newPassword",type:r.new?"text":"password",value:a.newPassword,onChange:m=>b("newPassword",m.target.value),placeholder:"Unesite novu lozinku",className:styles.passwordInput,autoComplete:"new-password"}),e.jsx("button",{type:"button",className:styles.toggleButton,onClick:()=>_("new"),"aria-label":"Prika≈æi/sakrij lozinku",children:r.new?"üëÅÔ∏è":"üôà"})]}),w&&e.jsx("div",{className:`${styles.strengthIndicator} ${styles[`strength${w.level.charAt(0).toUpperCase()+w.level.slice(1)}`]}`,children:w.text}),l.newPassword&&e.jsxs("div",{className:`${styles.validationMessage} ${styles.validationError}`,children:["‚ùå ",l.newPassword]})]}),e.jsxs("div",{className:styles.inputGroup,children:[e.jsx("label",{className:styles.inputLabel,htmlFor:"confirmPassword",children:"Potvrdite novu lozinku"}),e.jsxs("div",{className:styles.inputWrapper,children:[e.jsx("input",{id:"confirmPassword",type:r.confirm?"text":"password",value:a.confirmPassword,onChange:m=>b("confirmPassword",m.target.value),placeholder:"Ponovite novu lozinku",className:styles.passwordInput,autoComplete:"new-password"}),e.jsx("button",{type:"button",className:styles.toggleButton,onClick:()=>_("confirm"),"aria-label":"Prika≈æi/sakrij lozinku",children:r.confirm?"üëÅÔ∏è":"üôà"})]}),a.confirmPassword&&a.newPassword===a.confirmPassword&&e.jsx("div",{className:`${styles.validationMessage} ${styles.validationSuccess}`,children:"‚úÖ Lozinke se poklapaju"}),l.confirmPassword&&e.jsxs("div",{className:`${styles.validationMessage} ${styles.validationError}`,children:["‚ùå ",l.confirmPassword]})]}),e.jsxs("div",{className:styles.securityTips,children:[e.jsx("h4",{children:"üí° Saveti za sigurnu lozinku:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Najmanje 8 karaktera"}),e.jsx("li",{children:"Kombinacija velikih i malih slova"}),e.jsx("li",{children:"Brojevi i specijalni karakteri (!@#$%)"}),e.jsx("li",{children:"Izbegavajte liƒçne podatke"})]})]}),l.submit&&e.jsxs("div",{className:`${styles.validationMessage} ${styles.validationError}`,children:["‚ùå ",l.submit]}),e.jsxs("div",{className:styles.modalActions,children:[e.jsx("button",{type:"button",className:styles.cancelBtn,onClick:c,disabled:d,children:"‚ùå Otka≈æi"}),e.jsx("button",{type:"submit",className:styles.submitBtn,disabled:!h||d,children:d?"üîÑ Menjam...":"üîê Promeni lozinku"})]})]})};class Ue{constructor(){this.channels=[],this.isActive=!1}start(){if(this.isActive)return;console.log("üîÑ Starting realtime service...");const t=Y.channel("realtime_extra_rides").on("postgres_changes",{event:"*",schema:"public",table:"extra_rides_pending"},r=>{console.log("üöó Extra rides update:",r.eventType),D.extraRides()}).subscribe(),a=Y.channel("realtime_deliveries").on("postgres_changes",{event:"*",schema:"public",table:"deliveries"},r=>{console.log("üì¶ Deliveries update:",r.eventType),D.deliveries(),D.driverStats()}).subscribe(),i=Y.channel("realtime_drivers").on("postgres_changes",{event:"*",schema:"public",table:"drivers"},r=>{console.log("üë§ Drivers update:",r.eventType),D.drivers()}).subscribe();this.channels=[t,a,i],this.isActive=!0,console.log("‚úÖ Realtime service started - listening for changes")}stop(){this.isActive&&(console.log("üõë Stopping realtime service..."),this.channels.forEach(t=>{Y.removeChannel(t)}),this.channels=[],this.isActive=!1,console.log("‚úÖ Realtime service stopped"))}triggerDataChange(t){switch(console.log(`üîÑ Manual trigger for ${t}`),t){case"extraRides":D.extraRides(),D.driverStats();break;case"deliveries":D.deliveries(),D.driverStats();break;case"drivers":D.drivers();break;default:D.all()}}}const ne=new Ue;class Ve{constructor(){this.deferredPrompt=null,this.isInstalled=!1,this.isStandalone=!1,this.serviceWorkerRegistration=null,this.listeners=new Set,this.syncInProgress=!1,this.checkInstallStatus(),this.setupInstallPrompt(),this.registerServiceWorker(),this.setupServiceWorkerMessages(),console.log("üöÄ [PWA] Service inicijalizovan")}checkInstallStatus(){this.isStandalone=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone||document.referrer.includes("android-app://"),this.isInstalled=this.isStandalone,console.log("üöÄ [PWA] Install status:",{isInstalled:this.isInstalled,isStandalone:this.isStandalone})}setupInstallPrompt(){window.addEventListener("beforeinstallprompt",t=>{console.log("üöÄ [PWA] Install prompt available"),t.preventDefault(),this.deferredPrompt=t,this.notifyListeners({type:"install_available",canInstall:!0})}),window.addEventListener("appinstalled",t=>{console.log("üöÄ [PWA] App installed successfully"),this.isInstalled=!0,this.deferredPrompt=null,this.notifyListeners({type:"app_installed",isInstalled:!0}),this.trackInstallation()}),this.checkIOSInstall()}checkIOSInstall(){const t=/iPad|iPhone|iPod/.test(navigator.userAgent),a=window.navigator.standalone;t&&!a&&this.notifyListeners({type:"ios_install_available",platform:"iOS"})}async registerServiceWorker(){if("serviceWorker"in navigator)try{const t=await navigator.serviceWorker.register("/bde-evidencija/sw.js",{scope:"/bde-evidencija/"});return this.serviceWorkerRegistration=t,console.log("üöÄ [PWA] Service Worker registered:",t.scope),t.addEventListener("updatefound",()=>{console.log("üöÄ [PWA] Service Worker update found");const a=t.installing;a.addEventListener("statechange",()=>{a.state==="installed"&&navigator.serviceWorker.controller&&(console.log("üöÄ [PWA] New Service Worker available"),this.notifyListeners({type:"update_available",registration:t}))})}),this.setupBackgroundSync(),t}catch(t){throw console.error("üöÄ [PWA] Service Worker registration failed:",t),t}else console.warn("üöÄ [PWA] Service Workers not supported")}setupServiceWorkerMessages(){"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",t=>{switch(console.log("üöÄ [PWA] Message from Service Worker:",t.data),t.data.type){case"SYNC_STARTED":this.syncInProgress=!0,this.notifyListeners({type:"sync_started"});break;case"SYNC_COMPLETED":this.syncInProgress=!1,this.notifyListeners({type:"sync_completed"});break;case"SYNC_FAILED":this.syncInProgress=!1,this.notifyListeners({type:"sync_failed",error:t.data.error});break}})}setupBackgroundSync(){"sync"in window.ServiceWorkerRegistration.prototype?(console.log("üöÄ [PWA] Background Sync supported"),this.scheduleBackgroundSync()):console.warn("üöÄ [PWA] Background Sync not supported")}async scheduleBackgroundSync(){if(this.serviceWorkerRegistration&&"sync"in window.ServiceWorkerRegistration.prototype)try{await this.serviceWorkerRegistration.sync.register("background-sync-data"),console.log("üöÄ [PWA] Background sync scheduled")}catch(t){console.error("üöÄ [PWA] Background sync scheduling failed:",t)}}async showInstallPrompt(){if(!this.deferredPrompt)return console.warn("üöÄ [PWA] Install prompt not available"),!1;try{this.deferredPrompt.prompt();const{outcome:t}=await this.deferredPrompt.userChoice;return console.log("üöÄ [PWA] Install prompt result:",t),t==="accepted"?this.notifyListeners({type:"install_accepted"}):this.notifyListeners({type:"install_dismissed"}),this.deferredPrompt=null,t==="accepted"}catch(t){return console.error("üöÄ [PWA] Install prompt error:",t),!1}}canInstall(){return!this.isInstalled&&this.deferredPrompt!==null}shouldShowIOSInstructions(){const t=/iPad|iPhone|iPod/.test(navigator.userAgent),a=window.navigator.standalone;return t&&!a}async updateServiceWorker(){if(this.serviceWorkerRegistration)try{return await this.serviceWorkerRegistration.update(),console.log("üöÄ [PWA] Service Worker update triggered"),this.serviceWorkerRegistration.waiting&&this.serviceWorkerRegistration.waiting.postMessage({type:"SKIP_WAITING"}),!0}catch(t){return console.error("üöÄ [PWA] Service Worker update failed:",t),!1}return!1}async clearCache(){if(this.serviceWorkerRegistration)try{return this.serviceWorkerRegistration.active&&this.serviceWorkerRegistration.active.postMessage({type:"CLEAR_CACHE"}),console.log("üöÄ [PWA] Cache clear requested"),!0}catch(t){return console.error("üöÄ [PWA] Cache clear failed:",t),!1}return!1}getInstallInfo(){return{isInstalled:this.isInstalled,isStandalone:this.isStandalone,canInstall:this.canInstall(),shouldShowIOSInstructions:this.shouldShowIOSInstructions(),serviceWorkerSupported:"serviceWorker"in navigator,syncSupported:"sync"in window.ServiceWorkerRegistration.prototype,notificationSupported:"Notification"in window}}async requestNotificationPermission(){if("Notification"in window)try{const t=await Notification.requestPermission();return console.log("üöÄ [PWA] Notification permission:",t),this.notifyListeners({type:"notification_permission",permission:t}),t==="granted"}catch(t){return console.error("üöÄ [PWA] Notification permission request failed:",t),!1}return!1}async setupPushNotifications(){if(!this.serviceWorkerRegistration)return console.warn("üöÄ [PWA] Service Worker not available for push notifications"),!1;try{if(!("PushManager"in window))return console.warn("üöÄ [PWA] Push notifications not supported"),!1;if(!await this.requestNotificationPermission())return console.warn("üöÄ [PWA] Notification permission denied"),!1;const a=await this.serviceWorkerRegistration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:this.urlBase64ToUint8Array("YOUR_VAPID_PUBLIC_KEY")});return console.log("üöÄ [PWA] Push subscription created:",a),this.notifyListeners({type:"push_subscribed",subscription:a}),a}catch(t){return console.error("üöÄ [PWA] Push notification setup failed:",t),!1}}urlBase64ToUint8Array(t){const a="=".repeat((4-t.length%4)%4),i=(t+a).replace(/-/g,"+").replace(/_/g,"/"),r=window.atob(i),u=new Uint8Array(r.length);for(let l=0;l<r.length;++l)u[l]=r.charCodeAt(l);return u}trackInstallation(){try{typeof gtag<"u"&&gtag("event","app_install",{event_category:"PWA",event_label:"BDE Evidencija"}),localStorage.setItem("bde_app_installed",new Date().toISOString()),console.log("üöÄ [PWA] Installation tracked")}catch(t){console.error("üöÄ [PWA] Installation tracking failed:",t)}}async checkForUpdates(){if(this.serviceWorkerRegistration)try{return await this.serviceWorkerRegistration.update(),console.log("üöÄ [PWA] Update check completed"),!0}catch(t){return console.error("üöÄ [PWA] Update check failed:",t),!1}return!1}getPWACapabilities(){return{serviceWorker:"serviceWorker"in navigator,backgroundSync:"sync"in window.ServiceWorkerRegistration.prototype,pushNotifications:"PushManager"in window,notifications:"Notification"in window,installPrompt:"beforeinstallprompt"in window,periodicSync:"periodicSync"in window.ServiceWorkerRegistration.prototype,webShare:"share"in navigator,geolocation:"geolocation"in navigator,battery:"getBattery"in navigator,vibration:"vibrate"in navigator}}addListener(t){return this.listeners.add(t),()=>this.listeners.delete(t)}removeListener(t){this.listeners.delete(t)}notifyListeners(t){this.listeners.forEach(a=>{try{a(t)}catch(i){console.error("üöÄ [PWA] Listener error:",i)}})}destroy(){this.listeners.clear(),console.log("üöÄ [PWA] Service destroyed")}}const z=new Ve;function Ge(){const[c,t]=n.useState(z.getInstallInfo()),[a,i]=n.useState(z.getPWACapabilities()),[r,u]=n.useState(!1),[l,y]=n.useState(!1);return n.useEffect(()=>{const v=w=>{switch(w.type){case"install_available":t(m=>({...m,canInstall:!0}));break;case"app_installed":t(m=>({...m,isInstalled:!0,canInstall:!1}));break;case"update_available":u(!0);break;case"sync_started":y(!0);break;case"sync_completed":case"sync_failed":y(!1);break}},h=z.addListener(v);return t(z.getInstallInfo()),i(z.getPWACapabilities()),h},[]),{installInfo:c,capabilities:a,updateAvailable:r,syncInProgress:l,showInstallPrompt:async()=>await z.showInstallPrompt(),updateApp:async()=>{const v=await z.updateServiceWorker();return v&&(u(!1),setTimeout(()=>window.location.reload(),1e3)),v},clearCache:async()=>await z.clearCache(),requestNotifications:async()=>await z.requestNotificationPermission(),setupPushNotifications:async()=>await z.setupPushNotifications(),checkForUpdates:async()=>await z.checkForUpdates(),service:z}}const Ke="_overlay_175pr_3",qe="_prompt_175pr_19",Ze="_header_175pr_33",Xe="_icon_175pr_40",Ye="_title_175pr_45",Je="_closeBtn_175pr_62",Qe="_benefits_175pr_79",et="_benefit_175pr_79",tt="_benefitIcon_175pr_94",st="_actions_175pr_98",at="_installBtn_175pr_104",rt="_laterBtn_175pr_131",it="_spinner_175pr_147",nt="_iosInstructions_175pr_157",ot="_instructionHeader_175pr_161",lt="_iosIcon_175pr_165",ct="_instructionSteps_175pr_177",dt="_step_175pr_184",ut="_stepNumber_175pr_194",ht="_shareIcon_175pr_208",mt="_addIcon_175pr_209",pt="_dismissBtn_175pr_214",f={overlay:Ke,prompt:qe,header:Ze,icon:Xe,title:Ye,closeBtn:Je,benefits:Qe,benefit:et,benefitIcon:tt,actions:st,installBtn:at,laterBtn:rt,spinner:it,iosInstructions:nt,instructionHeader:ot,iosIcon:lt,instructionSteps:ct,step:dt,stepNumber:ut,shareIcon:ht,addIcon:mt,dismissBtn:pt},xt=()=>{const{installInfo:c,showInstallPrompt:t}=Ge(),[a,i]=n.useState(!1),[r,u]=n.useState(!1),[l,y]=n.useState(!1);n.useEffect(()=>{if(sessionStorage.getItem("pwa_install_dismissed")){u(!0);return}if(c.canInstall&&!c.isInstalled&&!r){const b=setTimeout(()=>{i(!0)},3e3);return()=>clearTimeout(b)}},[c.canInstall,c.isInstalled,r]);const d=async()=>{y(!0);try{await t()?i(!1):x()}catch(j){console.error("Install error:",j)}finally{y(!1)}},x=()=>{i(!1),u(!0),sessionStorage.setItem("pwa_install_dismissed","true")},g=()=>e.jsxs("div",{className:f.iosInstructions,children:[e.jsxs("div",{className:f.instructionHeader,children:[e.jsx("div",{className:f.iosIcon,children:"üì±"}),e.jsx("h3",{children:"Dodaj na poƒçetni ekran"})]}),e.jsxs("div",{className:f.instructionSteps,children:[e.jsxs("div",{className:f.step,children:[e.jsx("span",{className:f.stepNumber,children:"1"}),e.jsx("span",{children:"Pritisni dugme za Share"}),e.jsx("div",{className:f.shareIcon,children:"üì§"})]}),e.jsxs("div",{className:f.step,children:[e.jsx("span",{className:f.stepNumber,children:"2"}),e.jsx("span",{children:'Odaberi "Add to Home Screen"'}),e.jsx("div",{className:f.addIcon,children:"‚ûï"})]}),e.jsxs("div",{className:f.step,children:[e.jsx("span",{className:f.stepNumber,children:"3"}),e.jsx("span",{children:'Pritisni "Add"'})]})]}),e.jsx("button",{className:f.dismissBtn,onClick:x,children:"Razumem"})]});return a&&!r?e.jsx("div",{className:f.overlay,children:e.jsx("div",{className:f.prompt,children:c.shouldShowIOSInstructions?e.jsx(g,{}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:f.header,children:[e.jsx("div",{className:f.icon,children:"üöÄ"}),e.jsxs("div",{className:f.title,children:[e.jsx("h3",{children:"Instaliraj BDE Evidenciju"}),e.jsx("p",{children:"Br≈æi pristup i bolje performanse"})]}),e.jsx("button",{className:f.closeBtn,onClick:x,children:"‚úï"})]}),e.jsxs("div",{className:f.benefits,children:[e.jsxs("div",{className:f.benefit,children:[e.jsx("span",{className:f.benefitIcon,children:"‚ö°"}),e.jsx("span",{children:"Br≈æe uƒçitavanje"})]}),e.jsxs("div",{className:f.benefit,children:[e.jsx("span",{className:f.benefitIcon,children:"üì±"}),e.jsx("span",{children:"Radi offline"})]}),e.jsxs("div",{className:f.benefit,children:[e.jsx("span",{className:f.benefitIcon,children:"üîî"}),e.jsx("span",{children:"Push notifikacije"})]}),e.jsxs("div",{className:f.benefit,children:[e.jsx("span",{className:f.benefitIcon,children:"üè†"}),e.jsx("span",{children:"Poƒçetni ekran"})]})]}),e.jsxs("div",{className:f.actions,children:[e.jsx("button",{className:f.installBtn,onClick:d,disabled:l,children:l?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:f.spinner}),"Instaliranje..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"üì•"}),"Instaliraj aplikaciju"]})}),e.jsx("button",{className:f.laterBtn,onClick:x,children:"Mo≈æda kasnije"})]})]})})}):null},gt=W.lazy(()=>H(()=>import("./chunk-v5-1765395142943-D6yQlDmM.js").then(c=>c.H),__vite__mapDeps([0,1,2,3,4,5]))),yt=W.lazy(()=>H(()=>import("./chunk-v5-1765395142943-D6yQlDmM.js").then(c=>c.D),__vite__mapDeps([0,1,2,3,4,5]))),ft=W.lazy(()=>H(()=>import("./chunk-v5-1765395142943-D6yQlDmM.js").then(c=>c.c),__vite__mapDeps([0,1,2,3,4,5]))),bt=W.lazy(()=>H(()=>import("./chunk-v5-1765395142943-3AVOTI2n.js"),__vite__mapDeps([6,1,2,7,3,4,5,0]))),vt=W.lazy(()=>H(()=>import("./chunk-v5-1765395142943-lKBIgVAu.js").then(c=>c.A),__vite__mapDeps([7,1,2,3,4,5,0]))),jt=W.lazy(()=>H(()=>import("./chunk-v5-1765395142943-EqheQJZQ.js"),__vite__mapDeps([8,1,2,3,4,0,5]))),wt=W.lazy(()=>H(()=>import("./chunk-v5-1765395142943-Dr38-KE1.js"),__vite__mapDeps([9,1,2,3,4]))),kt=W.lazy(()=>H(()=>import("./chunk-v5-1765395142943-D6yQlDmM.js").then(c=>c.S),__vite__mapDeps([0,1,2,3,4,5]))),Nt=W.lazy(()=>H(()=>import("./chunk-v5-1765395142943-CZExNXil.js"),__vite__mapDeps([10,1,2,11,12])));function St({onLogout:c}){const[t,a]=n.useState(!1),{currentUser:i,changePassword:r}=ae(),u=be(),l=u.pathname==="/"||u.pathname==="",y=async(d,x)=>{await r(d,x)};return n.useEffect(()=>{if(i)return console.log("üöÄ Starting realtime service for user:",i.name),ne.start(),()=>{console.log("üõë Stopping realtime service"),ne.stop()}},[i]),i?e.jsxs("div",{className:"min-h-screen bg-background text-foreground",children:[e.jsx("main",{className:`app-main${l?" home-fullbleed":""}`,children:e.jsx(W.Suspense,{fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}),e.jsx("p",{className:"text-gray-600",children:"Uƒçitava se..."})]})}),children:e.jsxs(ve,{children:[e.jsx(B,{path:"/",element:e.jsx(gt,{})}),e.jsx(B,{path:"/statistika",element:e.jsx(kt,{})}),e.jsx(B,{path:"/navigacija",element:e.jsx(Nt,{})}),e.jsx(B,{path:"/deliveries",element:e.jsx(yt,{})}),e.jsx(B,{path:"/drivers",element:e.jsx(ft,{})}),e.jsx(B,{path:"/extra-rides",element:e.jsx(bt,{})}),e.jsx(B,{path:"/admin",element:(i==null?void 0:i.role)==="admin"?e.jsx(vt,{}):e.jsx(te,{to:"/"})}),e.jsx(B,{path:"/payroll-list",element:(i==null?void 0:i.role)!=="admin"?e.jsx(jt,{user:i}):e.jsx(te,{to:"/"})}),e.jsx(B,{path:"/about",element:e.jsx(wt,{})}),e.jsx(B,{path:"*",element:e.jsx(te,{to:"/"})})]})})}),t&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Oe,{user:i,onClose:()=>a(!1),onChangePassword:async d=>{await y(d.oldPassword,d.newPassword),a(!1)}})})]}):e.jsx("div",{children:"Loading..."})}function Pt(){const{currentUser:c,isAuthenticated:t}=ae(),[a,i]=n.useState(!1),[r,u]=n.useState(!1),l=d=>{var x;i(!0),u(!1),d!=null&&d.name&&(localStorage.setItem("DRIVER_NAME",d.name),(x=window.__USER_CONTEXT__)!=null&&x.refreshStatus&&window.__USER_CONTEXT__.refreshStatus(),console.log("[App] DRIVER_NAME postavljen:",d.name))},y=()=>{u(!0),i(!1)};return n.useEffect(()=>{!c&&!t&&i(!1),c&&t&&u(!1)},[c,t]),n.useEffect(()=>{const d=x=>{console.log("Global logout event received",x.detail);try{localStorage.removeItem("bde_current_user")}catch{}try{localStorage.removeItem("bde_login_time")}catch{}y()};return window.addEventListener("bde:logout",d),()=>window.removeEventListener("bde:logout",d)},[]),e.jsx(fe,{basename:"/bde-evidencija",future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:e.jsx(Te,{children:e.jsx(we,{children:e.jsx(Ie,{children:e.jsx(Ae,{children:e.jsxs("div",{className:"app",children:[(t||a)&&!r?e.jsx(St,{onLogout:y}):e.jsx(He,{onAuthSuccess:l}),e.jsx(xt,{})]})})})})})})}function _t({onRestart:c}){const[t,a]=n.useState(10),[i,r]=n.useState(new Date().getFullYear()),[u,l]=n.useState(!1),[y]=n.useState([{id:1,description:"Abholung Klagenfurt",quantity:22,unit:"Tag",pricePerUnit:150}]),d=20,x=y.reduce((I,M)=>I+M.quantity*M.pricePerUnit,0),g=x*d/100,j=x+g,b=new Date(i,t,0).getDate(),_=`01.${t.toString().padStart(2,"0")}.${i} ‚Äì ${b.toString().padStart(2,"0")}.${t.toString().padStart(2,"0")}.${i}`,v=`${b.toString().padStart(2,"0")}.${t.toString().padStart(2,"0")}.${i}`,h=`${t.toString().padStart(2,"0")}/${i.toString().slice(-2)}`,w=22,m=()=>{l(!0),setTimeout(()=>l(!1),3e3)},o=async()=>{try{await Se({month:t,year:i,taxRate:d,invoiceItems:y,workingDays:w,period:_,invoiceDate:v,invoiceNumber:h,netto:x,ust:g,total:j}),m()}catch(I){alert("Gre≈°ka pri generiranju PDF-a: "+I.message)}},N=()=>{c?c():window.location.reload()};return e.jsxs("div",{className:"min-h-screen bg-gray-100 p-4",children:[e.jsx("div",{className:"max-w-4xl mx-auto mb-6",children:e.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"ml-3 flex-1",children:[e.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Aplikacija je u recovery modu (React Hook gre≈°ka)"}),e.jsx("p",{className:"mt-1 text-sm text-yellow-700",children:"Detektovan problem sa React Hook-ovima pri refreshu. Sve funkcije rade kroz recovery sistem. InvoicesTab potpuno funkcionalan!"})]}),e.jsx("div",{className:"ml-4",children:e.jsxs("button",{onClick:N,className:"bg-yellow-100 hover:bg-yellow-200 text-yellow-800 px-3 py-1 rounded text-sm font-medium flex items-center gap-2",children:[e.jsx(me,{className:"w-4 h-4"}),"Restart App"]})})]})})}),u&&e.jsxs("div",{className:"fixed top-4 right-4 z-50 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg flex items-center gap-2",children:[e.jsx(pe,{className:"w-5 h-5"}),"‚úÖ PDF generisan uspje≈°no"]}),e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(xe,{className:"w-8 h-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"GLS Rechnung Generator"}),e.jsx("p",{className:"text-gray-600",children:"Recovery Mode - Basic funkcionalnost"})]})]}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Konfiguracija raƒçuna"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mjesec"}),e.jsx("select",{value:t,onChange:I=>a(Number(I.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:Array.from({length:12},(I,M)=>e.jsx("option",{value:M+1,children:M+1},M+1))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Godina"}),e.jsx("input",{type:"number",value:i,onChange:I=>r(Number(I.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Pregled raƒçuna"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between py-1 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"Rechnungsnummer:"}),e.jsx("span",{className:"font-medium",children:h})]}),e.jsxs("div",{className:"flex justify-between py-1 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"Period:"}),e.jsx("span",{className:"font-medium",children:_})]}),e.jsxs("div",{className:"flex justify-between py-1 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"Radni dani:"}),e.jsx("span",{className:"font-medium",children:w})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Nettobetrag:"}),e.jsxs("span",{children:["‚Ç¨",x.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Umsatzsteuer (20%):"}),e.jsxs("span",{children:["‚Ç¨",g.toFixed(2)]})]}),e.jsx("div",{className:"border-t pt-2",children:e.jsxs("div",{className:"flex justify-between font-bold text-lg text-blue-600",children:[e.jsx("span",{children:"Rechnungsbetrag:"}),e.jsxs("span",{children:["‚Ç¨",j.toFixed(2)]})]})})]}),e.jsxs("button",{onClick:o,className:`w-full bg-blue-600 hover:bg-blue-700 text-white font-medium px-4 py-3 rounded-lg 
                         flex items-center justify-center gap-2 shadow-lg hover:shadow-xl transition-all`,children:[e.jsx(ge,{className:"w-5 h-5"}),"üíæ Generi≈°i PDF"]})]})]})]})})]})}class It extends W.Component{constructor(a){super(a);re(this,"handleRestart",()=>{this.setState({hasError:!1,error:null})});this.state={hasError:!1,error:null}}static getDerivedStateFromError(a){return a.message.includes("useState")||a.message.includes("Invalid hook call")||a.message.includes("Cannot read properties of null")||a.message.includes("reading 'useState'")||a.stack.includes("useSimpleAuth")?(console.error("üö® ErrorBoundary: React Hook error detected",a.message),{hasError:!0,error:a}):{hasError:!1,error:null}}componentDidCatch(a,i){console.error("üö® React Error Boundary caught an error:",a,i),(a.message.includes("useState")||a.message.includes("Invalid hook call"))&&console.warn("üîß React Hook error detected - loading fallback app")}render(){return this.state.hasError?e.jsx(_t,{onRestart:this.handleRestart}):this.props.children}}console.log("üöÄ BDEVidencija v5.0.0 - ULTRA NUCLEAR FORCE UPDATE - 20251020-HOOKS-FIXED");console.log("üì± PWA Cache Status: FORCED REFRESH");"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("controllerchange",function(){window.location.reload()});oe(document.getElementById("root")).render(e.jsx(W.StrictMode,{children:e.jsx(It,{children:e.jsx(je,{client:ke,children:e.jsx(Pt,{})})})}));export{ne as r};

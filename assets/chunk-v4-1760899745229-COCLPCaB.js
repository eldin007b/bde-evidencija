const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/chunk-v4-1760899745229-CMUnjaUB.js","assets/chunk-v4-1760899745229-C91sa_mq.js","assets/chunk-v4-1760899745229-Cp1U2DWw.js","assets/chunk-v4-1760899745229-DBZTXvvv.js","assets/chunk-v4-1760899745229-BX32o4Tt.js","assets/chunk-v4-1760899745229-Da1keFKk.js","assets/chunk-v4-1760899745229-iU7ReY_7.js","assets/chunk-v4-1760899745229-DO-YtAxd.js","assets/chunk-v4-1760899745229-Dq2jMYX_.js"])))=>i.map(i=>d[i]);
import{j as e,X as Ve,m as s,x as Te,F as Ge,c as le,y as te,U as K,z as We,D as Ce,w as _e,q as re,S as he,E as Je,G as be,H as Ye,J as Ae,O as Ke,Q as Fe,R as pe,V as Be,A as He,Y as ae,Z as ye,_ as fe,$ as Ee,a0 as Ze,a1 as Qe,a2 as $e,b as ge,h as Me,a3 as Xe,g as ne,T as Ue,i as me,k as Se,a4 as Pe,B as oe,a5 as ve,e as je,l as et,C as tt,a6 as at}from"./chunk-v4-1760899745229-C91sa_mq.js";import{r as h,a as st,u as rt}from"./chunk-v4-1760899745229-Cp1U2DWw.js";import{s as T}from"./chunk-v4-1760899745229-BX32o4Tt.js";import{f as de}from"./chunk-v4-1760899745229-Da1keFKk.js";import{_ as X}from"./chunk-v4-1760899745229-DBZTXvvv.js";import{p as xe,v as Y,u as it,U as ot,C as nt}from"./chunk-v4-1760899745229-CMUnjaUB.js";class lt{constructor(){this.syncInProgress=new Set}async syncUserToDriver(n){if(this.syncInProgress.has(n))return!1;this.syncInProgress.add(n);try{const{data:t,error:a}=await T.from("app_users").select("tura, ime, role, active, last_login").eq("tura",n).single();if(a||!t)return!1;const{data:l,error:i}=await T.from("drivers").select("id, tura, ime, aktivan, target_per_day").eq("tura",n).eq("deleted",0).maybeSingle();if(i)return!1;const u={tura:t.tura,ime:t.ime,aktivan:t.active,role:t.role,last_login:t.last_login,last_updated:new Date};if(t&&t.device_id!==void 0&&(u.device_id=t.device_id),l){const{error:p}=await T.from("drivers").update(u).eq("id",l.id);if(p)return!1}else{const p={...u,target_per_day:0,deleted:0},{error:f}=await T.from("drivers").insert([p]);if(f)return!1}return!0}catch{return!1}finally{this.syncInProgress.delete(n)}}async syncDriverToUser(n,t){try{const a={};if(t.ime&&(a.ime=t.ime),t.role&&(a.role=t.role),t.aktivan!==void 0&&(a.active=t.aktivan),t.device_id!==void 0&&(a.device_id=t.device_id),Object.keys(a).length===0)return!0;a.updated_at=new Date;const{error:l}=await T.from("app_users").update(a).eq("tura",n);return!l}catch{return!1}}async syncAllUsers(){try{const{data:n,error:t}=await T.from("app_users").select("tura").eq("active",!0);if(t)return!1;const a=n.map(f=>this.syncUserToDriver(f.tura)),i=(await Promise.allSettled(a)).map((f,g)=>{var b;return{tura:(b=n[g])==null?void 0:b.tura,status:f.status,value:f.status==="fulfilled"?f.value:void 0,reason:f.status==="rejected"?f.reason&&f.reason.message||f.reason:void 0}}),u=i.filter(f=>f.status==="fulfilled"&&f.value).length,p=i.length;return{successful:u,total:p,success:u===p,details:i}}catch{return!1}}async getCombinedUserData(n){try{const[t,a]=await Promise.all([T.from("app_users").select("*").eq("tura",n).single(),T.from("drivers").select("*").eq("tura",n).eq("deleted",0).single()]),l=t.data,i=a.data;return l?{id:l.id,tura:l.tura,ime:l.ime,role:l.role,active:l.active,password_hash:l.password_hash,device_id:l.device_id,last_login:l.last_login,businessId:i==null?void 0:i.id,aktivan:(i==null?void 0:i.aktivan)??l.active,target_per_day:(i==null?void 0:i.target_per_day)??0,last_updated:i==null?void 0:i.last_updated,hasBusiness:!!i,syncNeeded:l.active!==(i==null?void 0:i.aktivan)}:null}catch{return null}}}const we=new lt;function Le(){const[y,n]=h.useState([]),[t,a]=h.useState(!0),[l,i]=h.useState(null),u=h.useCallback(async()=>{a(!0),i(null);try{const{data:N,error:v}=await T.from("drivers").select("*").eq("deleted",0).order("target_per_day",{ascending:!1}).order("tura");if(v)throw v;const r=(N==null?void 0:N.map($=>({id:$.id,tura:$.tura,ime:$.ime,target_per_day:$.target_per_day||0,aktivan:$.aktivan,role:$.role||"driver",password_hash:$.password_hash||"",last_login:$.last_login,last_updated:$.last_updated,deleted:$.deleted||0,name:$.ime,tour:$.tura,active:$.aktivan})))||[],E=["8610","8620","8630","8640"];r.sort(($,w)=>{const d=E.indexOf(String($.tura)),I=E.indexOf(String(w.tura));if(d!==-1||I!==-1)return d===-1?1:I===-1?-1:d-I;const O=String($.tura||""),j=String(w.tura||"");return O.localeCompare(j,void 0,{numeric:!0})}),n(r)}catch(N){i(N),n([])}finally{a(!1)}},[]),p=h.useCallback(async N=>{try{const v={ime:N.ime,tura:N.tura,aktivan:N.aktivan??!0,target_per_day:N.target_per_day||0,password_hash:N.password_hash||null,role:N.role||"driver",last_updated:new Date,deleted:0},{data:r,error:E}=await T.from("drivers").insert([v]).select();if(E)throw E;return await we.syncDriverToUser(N.tura,{ime:N.ime,role:N.role,aktivan:N.aktivan}),await u(),r[0]}catch(v){throw i(v),v}},[u]),f=h.useCallback(async(N,v)=>{try{const r={ime:v.ime,tura:v.tura,aktivan:v.aktivan,target_per_day:v.target_per_day||0,password_hash:v.password_hash,role:v.role||"driver",last_updated:new Date},{data:E,error:$}=await T.from("drivers").update(r).eq("id",N).select();if($)throw $;return E&&E.length>0&&await we.syncDriverToUser(E[0].tura,{ime:v.ime,role:v.role,aktivan:v.aktivan}),await u(),E[0]}catch(r){throw i(r),r}},[u]),g=h.useCallback(async N=>{try{const{error:v}=await T.from("drivers").update({deleted:1,last_updated:new Date}).eq("id",N);if(v)throw v;await u()}catch(v){throw i(v),v}},[u]),b=h.useCallback(async(N,v)=>{try{const{data:r,error:E}=await T.from("drivers").update({aktivan:!v,last_updated:new Date}).eq("id",N).select();if(E)throw E;r&&r.length>0&&await we.syncDriverToUser(r[0].tura,{aktivan:!v}),await u()}catch(r){throw i(r),r}},[u]),k=h.useCallback(async(N,v)=>{try{const{error:r}=await T.from("drivers").update({target_per_day:v,last_updated:new Date}).eq("tura",N).eq("deleted",0);if(r)throw r;return await u(),!0}catch(r){throw i(r),r}},[u]),S=h.useCallback(N=>y.find(v=>v.tura===N&&!v.deleted),[y]),z=h.useCallback(()=>y.filter(N=>N.aktivan&&!N.deleted),[y]),M=h.useCallback(()=>y.filter(N=>N.aktivan&&!N.deleted&&N.target_per_day>0),[y]);return h.useEffect(()=>{u()},[u]),{drivers:y,loading:t,error:l,addDriver:p,updateDriver:f,deleteDriver:g,toggleDriverStatus:b,updateDriverTarget:k,getDriverByTura:S,getActiveDrivers:z,getDriversWithTargets:M,refresh:u}}class ct{async testDailyDataNotification(n="test_driver",t=25){try{const{data:a,error:l}=await T.rpc("test_push_notification",{p_type:"daily_data",p_driver_id:n});if(l)throw l;return{success:!0,message:a}}catch(a){return{success:!1,error:a.message}}}async testPayrollNotification(n="test vozaƒç"){try{const{data:t,error:a}=await T.rpc("test_push_notification",{p_type:"payroll"});if(a)throw a;return{success:!0,message:t}}catch(t){return{success:!1,error:t.message}}}async testExtraRideNotification(n="test_driver"){try{const{data:t,error:a}=await T.rpc("test_push_notification",{p_type:"extra_ride",p_driver_id:n});if(a)throw a;return{success:!0,message:t}}catch(t){return{success:!1,error:t.message}}}async sendCustomMessage(n={}){var u;const{title:t="BD Evidencija",message:a,targetUsers:l=null,targetType:i="all"}=n;if(!a||a.trim().length===0)return{success:!1,error:"Poruka je obavezna"};try{const{data:p,error:f}=await T.functions.invoke("auto-push",{body:{type:"custom_message",title:t,message:a.trim(),target_type:i,target_users:l}});if(f){const{data:g,error:b}=await T.rpc("send_custom_push",{p_title:t,p_message:a.trim(),p_target_users:l,p_target_type:i});if(b)return await this.sendDirectNotifications({title:t,message:a,targetType:i});const k=(g==null?void 0:g[0])||{sent_count:0,failed_count:1};return k.sent_count>0?{success:!0,sent:k.sent_count,failed:k.failed_count,method:"database_rpc"}:await this.sendDirectNotifications({title:t,message:a,targetType:i})}return p!=null&&p.success?{success:!0,sent:((u=p.results)==null?void 0:u.length)||1,failed:0,method:"edge_function"}:await this.sendDirectNotifications({title:t,message:a,targetType:i})}catch{return await this.sendDirectNotifications({title:t,message:a,targetType:i})}}async sendServerPushOnly(n={}){var u,p,f;const{title:t="BD Evidencija",message:a,targetType:l="all"}=n;if(!a||a.trim().length===0)return{success:!1,error:"Poruka je obavezna"};let i=null;try{i=(await X(()=>import("./chunk-v4-1760899745229-CMUnjaUB.js").then(b=>b.c),__vite__mapDeps([0,1,2,3,4,5]))).default}catch{const{showNotification:b}=await X(async()=>{const{showNotification:k}=await import("./chunk-v4-1760899745229-CaAz7H5M.js");return{showNotification:k}},[]);i={log:async(k,S)=>{try{await b({title:"Debug Log",body:k,icon:"/bde-evidencija/icon-192x192.png"})}catch{}}}}i.log("üåê FORCE SERVER PUSH ONLY - STARTING...","info"),typeof window<"u"&&window.alert&&setTimeout(()=>{},100);try{let g=T.from("push_subscriptions").select("*").eq("active",!0);l==="drivers"?g=g.eq("user_type","driver"):l==="admins"&&(g=g.eq("user_type","admin"));const{data:b,error:k}=await g;!k&&b?i&&(i.log(`üìä Active subscriptions in DB: ${b.length}`,"info"),b.forEach((S,z)=>{i.log(`${z+1}. Driver: ${S.driver_id||"unknown"}, Browser: ${S.browser||"unknown"}`,"info")})):i&&i.log(`‚ö†Ô∏è DB query error: ${(k==null?void 0:k.message)||"unknown"}`,"warn")}catch{}try{i&&i.log("üöÄ Calling Edge Function auto-push...","info");const{data:g,error:b}=await T.functions.invoke("auto-push",{body:{type:"custom_message",title:t,message:a.trim(),target_type:l}});if(i&&(i.log("üîç Edge Function Response:","info"),i.log(`- Error: ${b?b.message:"none"}`,b?"error":"info"),i.log(`- Data: ${JSON.stringify(g)}`,"info")),!b&&(g!=null&&g.success))return i&&(i.log("üìä Edge Function Results:","info"),i.log(`- Success: ${g.success}`,"info"),i.log(`- Results count: ${((u=g.results)==null?void 0:u.length)||0}`,"info"),i.log(`- Data: ${JSON.stringify(g)}`,"info")),{success:!0,sent:((p=g.results)==null?void 0:p.length)||0,failed:0,method:"edge_function_server",details:g};const{data:k,error:S}=await T.rpc("send_custom_push",{p_title:t,p_message:a.trim(),p_target_type:l});if(!S&&((f=k==null?void 0:k[0])==null?void 0:f.sent_count)>0){const z=k[0];return{success:!0,sent:z.sent_count,failed:z.failed_count,method:"database_rpc_server"}}return{success:!1,error:"Server-side push methods not available or failed",sent:0,failed:1,method:"server_only_failed"}}catch(g){return{success:!1,error:`Server push failed: ${g.message}`,sent:0,failed:1,method:"server_only_error"}}}async sendDirectNotifications(n={}){const{title:t="BD Evidencija",message:a,targetType:l="all"}=n;let i;try{i=(await X(()=>import("./chunk-v4-1760899745229-CMUnjaUB.js").then(p=>p.c),__vite__mapDeps([0,1,2,3,4,5]))).default}catch{i={log:(p,f)=>{}}}try{i.log(`üöÄ DIRECT NOTIFICATIONS: Starting for "${a}" to ${l}`,"info"),i.log("üîß Checking Service Worker registration...","info");const u=await navigator.serviceWorker.getRegistration("/bde-evidencija/sw.js");if(!u||!u.active)return i.log("‚ùå Service Worker nije dostupan","error"),{success:!1,error:"Service Worker nije dostupan",method:"direct"};i.log("‚úÖ Service Worker je aktivan","success");let p=T.from("push_subscriptions").select("*").eq("active",!0);l==="drivers"?p=p.eq("user_type","driver"):l==="admins"&&(p=p.eq("user_type","admin"));const{data:f,error:g}=await p;g?i.log(`‚ö†Ô∏è Database query failed: ${g.message}`,"warn"):i.log(`üìã Found ${(f==null?void 0:f.length)||0} active subscriptions`,"info");const b=(f==null?void 0:f.length)||1;i.log(`üë• Target user count: ${b}`,"info");const k={title:t,body:`${a} (poslano ${b} ${b===1?"korisniku":"korisnika"})`,icon:"/bde-evidencija/icon-192x192.png",badge:"/bde-evidencija/badge-96x96.png",data:{type:"custom_message",sent_to_count:b,timestamp:Date.now()},requireInteraction:!0,vibrate:[200,100,200,100,200]};i.log("üì§ Sending notification to Service Worker...","info"),u.active.postMessage({type:"SHOW_NOTIFICATION",payload:k}),i.log(`‚úÖ Notification sent to ${b} users!`,"success");try{const{error:S}=await T.from("push_notification_logs").insert({notification_type:"custom_message_direct",target_user_id:"all_users",title:t,message:a,status:"sent_direct",metadata:{method:"direct_notification",target_count:b,target_type:l}})}catch{}return{success:!0,sent:b,failed:0,method:"direct_notification",message:`Notifikacija poslana ${b} ${b===1?"korisniku":"korisnika"}`}}catch(u){return i&&i.log(`‚ùå Direct notifications failed: ${u.message}`,"error"),{success:!1,error:u.message,sent:0,failed:1,method:"direct_notification"}}}async sendCustomMessageBrowser(n={}){const{title:t="BD Evidencija",message:a,targetType:l="all"}=n;try{let i=T.from("push_subscriptions").select("*").eq("active",!0);l==="drivers"?i=i.eq("user_type","driver"):l==="admins"&&(i=i.eq("user_type","admin"));const{data:u,error:p}=await i;if(p)throw p;if(!u||u.length===0)return{success:!1,error:"Nema aktivnih pretplata za push notifikacije",method:"browser"};let f=0,g=0;const b=await navigator.serviceWorker.getRegistration("/bde-evidencija/sw.js");if(!b||!b.active)return{success:!1,error:"Service Worker nije dostupan",method:"browser"};const k={title:t,body:a,icon:"/bde-evidencija/icon-192x192.png",badge:"/bde-evidencija/badge-96x96.png",data:{type:"custom_message",custom:!0,click_action:"/",timestamp:Date.now()}};b.active.postMessage({type:"SHOW_NOTIFICATION",payload:k}),f=u.length;for(const S of u)try{const z=S.driver_id||"anonymous_"+Date.now(),{error:M}=await T.from("push_notification_logs").insert({notification_type:"custom_message",target_user_id:z,title:t||"BD Evidencija",message:a||"Test notification",status:"sent_browser",metadata:{subscription_id:S.id,endpoint:S.endpoint,method:"browser_fallback"}});if("serviceWorker"in navigator&&"Notification"in window){let N=Notification.permission;if(N==="default"&&(N=await Notification.requestPermission()),N==="granted")try{await(await navigator.serviceWorker.ready).showNotification(t,{body:a,icon:"/bde-evidencija/icon-192x192.png",badge:"/bde-evidencija/badge-96x96.png",data:k.data,tag:"bd-evidencija-custom",requireInteraction:!0,actions:[{action:"view",title:"Prika≈æi"}]})}catch{try{new Notification(t,{body:a,icon:"/bde-evidencija/icon-192x192.png",tag:"bd-evidencija-custom"})}catch{}}}else alert(`${t}

${a}`);f++}catch{g++}return{success:f>0,sent:f,failed:g,method:"browser_fallback",note:"Kori≈°ten browser fallback - prikazane lokalne notifikacije"}}catch(i){return{success:!1,error:i.message,method:"browser_fallback"}}}async addExtraRide(n){const{driverId:t,driverName:a,destination:l,time:i,notes:u="",estimatedDuration:p,estimatedCost:f}=n;if(!t||!a||!l||!i)return{success:!1,error:"Nedostaju obavezni podaci"};try{const{data:g,error:b}=await T.from("extra_rides").insert({driver_id:t,driver_name:a,ride_details:{destination:l,time:i,notes:u,estimatedDuration:p,estimatedCost:f,requestedAt:new Date().toISOString()},status:"pending"}).select().single();if(b)throw b;return{success:!0,data:g}}catch(g){return{success:!1,error:g.message}}}async reviewExtraRide(n,t,a,l=""){if(!["approved","rejected"].includes(t))return{success:!1,error:"Akcija mora biti approved ili rejected"};try{const{data:i,error:u}=await T.from("extra_rides").update({status:t,reviewed_at:new Date().toISOString(),reviewed_by:a,notes:l}).eq("id",n).select().single();if(u)throw u;return{success:!0,data:i}}catch(i){return{success:!1,error:i.message}}}async getPushStats(n=7){try{const{data:t,error:a}=await T.from("push_notification_logs").select("type, status, sent_at, user_type").gte("sent_at",new Date(Date.now()-n*24*60*60*1e3).toISOString()).order("sent_at",{ascending:!1});if(a)throw a;return{success:!0,stats:t.reduce((i,u)=>{const p=u.type||"unknown";return i[p]||(i[p]={sent:0,failed:0,total:0}),i[p].total++,u.status==="sent"?i[p].sent++:u.status==="failed"&&i[p].failed++,i},{}),logs:t}}catch(t){return{success:!1,error:t.message}}}async getPushSettings(){try{const{data:n,error:t}=await T.from("push_settings").select("*").order("created_at",{ascending:!1}).limit(1).single();if(t)throw t;return{success:!0,settings:n}}catch(n){return{success:!1,error:n.message}}}async getActiveSubscriptions(){try{const{data:n,error:t}=await T.from("push_subscriptions").select("user_id, user_type, created_at, last_used").eq("active",!0).order("last_used",{ascending:!1});if(t)throw t;const a=n.reduce((l,i)=>{const u=i.user_type||"unknown";return l[u]||(l[u]=[]),l[u].push(i),l},{});return{success:!0,subscriptions:n,byType:a,total:n.length}}catch(n){return{success:!1,error:n.message}}}async getTriggerStats(){try{const{data:n,error:t}=await T.from("push_trigger_stats").select("*");if(t)throw t;return{success:!0,stats:n}}catch(n){return{success:!1,error:n.message}}}async getExtraRides(n=null,t=50){try{let a=T.from("extra_rides").select("*").order("created_at",{ascending:!1}).limit(t);n&&(a=a.eq("status",n));const{data:l,error:i}=await a;if(i)throw i;return{success:!0,rides:l}}catch(a){return{success:!1,error:a.message}}}async callAutoPushDirectly(n){try{const{data:t,error:a}=await T.functions.invoke("auto-push",{body:n});if(a)throw a;return{success:!0,result:t}}catch(t){return{success:!1,error:t.message}}}async getSimpleStats(){try{const[n,t]=await Promise.all([T.from("push_subscriptions").select("*",{count:"exact"}).eq("active",!0),T.from("push_notification_logs").select("*",{count:"exact"})]),a=new Date;a.setHours(0,0,0,0);const{count:l}=await T.from("push_notification_logs").select("*",{count:"exact",head:!0}).gte("created_at",a.toISOString());return{activeUsers:n.count||0,totalSent:t.count||0,sentToday:l||0}}catch{return{activeUsers:0,totalSent:0,sentToday:0}}}}const ee=new ct,{testDailyDataNotification:dt,testPayrollNotification:gt,testExtraRideNotification:ut,sendCustomMessage:mt,sendServerPushOnly:xt,sendDirectNotifications:ht,addExtraRide:pt,reviewExtraRide:bt,getPushStats:yt,getPushSettings:ft,getActiveSubscriptions:vt,getTriggerStats:jt,getExtraRides:wt,callAutoPushDirectly:Nt,getSimpleStats:kt}=ee,Lt=Object.freeze(Object.defineProperty({__proto__:null,addExtraRide:pt,callAutoPushDirectly:Nt,default:ee,getActiveSubscriptions:vt,getExtraRides:wt,getPushSettings:ft,getPushStats:yt,getSimpleStats:kt,getTriggerStats:jt,reviewExtraRide:bt,sendCustomMessage:mt,sendDirectNotifications:ht,sendServerPushOnly:xt,testDailyDataNotification:dt,testExtraRideNotification:ut,testPayrollNotification:gt},Symbol.toStringTag,{value:"Module"})),ce=({open:y,title:n,children:t,loading:a,onSubmit:l,onClose:i,submitLabel:u="Saƒçuvaj",closeLabel:p="Otka≈æi",showActions:f=!0})=>(h.useEffect(()=>{if(y){const g=window.scrollY;return document.body.style.position="fixed",document.body.style.top=`-${g}px`,document.body.style.left="0",document.body.style.right="0",document.body.style.overflow="hidden",document.body.style.width="100%",()=>{document.body.style.position="",document.body.style.top="",document.body.style.left="",document.body.style.right="",document.body.style.overflow="",document.body.style.width="",window.scrollTo(0,g)}}},[y]),y?st.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm z-[9999]",style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:9999},children:e.jsx("div",{className:"absolute inset-0 flex items-start justify-center p-2 sm:p-4 pt-4 sm:pt-8",style:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"flex-start",justifyContent:"center",paddingTop:"2rem"},children:e.jsxs("div",{className:"bg-white/10 backdrop-blur-md rounded-2xl w-full max-w-md sm:max-w-3xl max-h-[90vh] sm:max-h-[92vh] overflow-hidden shadow-2xl border border-white/20 animate-in fade-in-0 zoom-in-95 duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 sm:p-6 border-b border-white/10 flex-shrink-0",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-bold text-white",children:n}),e.jsx("button",{onClick:i,className:"flex items-center justify-center w-8 h-8 rounded-full bg-white/10 hover:bg-white/20 transition-colors duration-200 text-white hover:scale-110",children:e.jsx(Ve,{className:"w-4 h-4"})})]}),e.jsxs("form",{onSubmit:g=>{g.preventDefault(),l&&l()},className:"flex flex-col max-h-full",children:[e.jsx("div",{className:"p-4 sm:p-6 overflow-y-auto flex-1 min-h-0 max-h-[calc(90vh-140px)] sm:max-h-[calc(92vh-140px)]",children:t}),f&&e.jsxs("div",{className:"flex justify-end gap-3 p-4 sm:p-6 border-t border-white/10 bg-black/10 flex-shrink-0",children:[e.jsx("button",{type:"button",onClick:i,disabled:a,className:"px-6 py-2.5 bg-white/10 hover:bg-white/20 text-white rounded-xl font-medium transition-colors duration-200 border border-white/20 disabled:opacity-50",children:p}),e.jsxs("button",{type:"submit",disabled:a,className:"px-6 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-medium transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[a&&e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),u]})]})]})]})})}),document.body):null),$t=y=>{const[n,t]=h.useState(!1);return h.useEffect(()=>{const a=window.matchMedia(y);a.matches!==n&&t(a.matches);const l=()=>t(a.matches);return a.addEventListener("change",l),()=>a.removeEventListener("change",l)},[n,y]),n},ze=({status:y,children:n})=>{const t={pending:{colors:"bg-yellow-500/20 text-yellow-300 border-yellow-500/30",hoverColors:"hover:bg-yellow-500/30 hover:border-yellow-400/50",pulse:"animate-pulse"},approved:{colors:"bg-green-500/20 text-green-300 border-green-500/30",hoverColors:"hover:bg-green-500/30 hover:border-green-400/50",pulse:""},rejected:{colors:"bg-red-500/20 text-red-300 border-red-500/30",hoverColors:"hover:bg-red-500/30 hover:border-red-400/50",pulse:""}},a=t[y]||t.pending;return e.jsx(s.span,{className:`px-3 py-1 rounded-full text-xs font-semibold border transition-all duration-300 cursor-default ${a.colors} ${a.hoverColors} ${a.pulse}`,whileHover:{scale:1.05,y:-1},whileTap:{scale:.95},initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{type:"spring",stiffness:300,damping:20},children:n})},ie=({onClick:y,bgColor:n,children:t,disabled:a=!1})=>e.jsx(s.button,{whileHover:{scale:a?1:1.05,y:a?0:-1,boxShadow:a?"none":"0 8px 25px rgba(0,0,0,0.15)"},whileTap:{scale:a?1:.95,y:a?0:1},onClick:y,disabled:a,className:`px-4 py-2 rounded-lg text-white text-sm font-medium transition-all duration-200 shadow-md ${a?"opacity-50 cursor-not-allowed":"hover:shadow-lg"}`,style:{backgroundColor:a?"#9CA3AF":n},initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{type:"spring",stiffness:300,damping:20},children:t}),Oe=({icon:y,text:n,subtext:t})=>e.jsxs(s.div,{initial:{opacity:0,y:20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.9},transition:{type:"spring",stiffness:300,damping:20,duration:.5},className:"text-center py-12",children:[e.jsx(s.div,{className:"text-5xl mb-3",animate:{scale:[1,1.1,1],rotate:[0,5,-5,0]},transition:{duration:2,repeat:1/0,repeatType:"reverse",ease:"easeInOut"},children:y}),e.jsx(s.p,{className:"text-lg font-semibold text-gray-300 mb-1",initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:n}),e.jsx(s.p,{className:"text-sm text-gray-500",initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},children:t})]}),St=()=>{const[y,n]=h.useState("default");h.useEffect(()=>{const x=()=>{const A=new Date().getHours();A>=5&&A<8?n("sunrise"):A>=8&&A<12?n("default"):A>=12&&A<17?n("afternoon"):A>=17&&A<20?n("evening"):n("night")};x();const L=setInterval(x,6e4);return()=>clearInterval(L)},[]);const t=y==="night",a=$t("(min-width: 768px)"),[l,i]=h.useState([]),[u,p]=h.useState([]),[f,g]=h.useState(!0),[b,k]=h.useState(null),[S,z]=h.useState(!1),[M,N]=h.useState(!1),[v,r]=h.useState(null),[E,$]=h.useState({driver:"",date:"",tura:"",plz:"",broj_adresa:"",cijena:"",notes:""}),[w,d]=h.useState(de(new Date,"yyyy-MM")),I=l.length+u.length,O=l.length,j=u.length,_=h.useCallback(async()=>{g(!0);try{const[x,L]=w.split("-"),A=new Date(parseInt(x),parseInt(L)-1,1),m=new Date(parseInt(x),parseInt(L),0),o=de(A,"yyyy-MM-dd"),R=de(m,"yyyy-MM-dd"),{data:c,error:C}=await T.from("extra_rides").select("*").gte("date",o).lte("date",R).eq("status","approved").order("date",{ascending:!1}),{data:D,error:F}=await T.from("extra_rides_pending").select("*").gte("date",o).lte("date",R).eq("status","pending").order("date",{ascending:!1}),H=(D||[]).map(B=>({id:B.id,vozac:B.driver,datum:de(new Date(B.date),"dd.MM.yyyy"),tura:B.tura,plz:B.plz,brojAdresa:B.broj_adresa,cijena:`${B.cijena}‚Ç¨`,status:B.status,napomena:B.notes||""})),U=(c||[]).map(B=>({id:B.id,vozac:B.driver,datum:de(new Date(B.date),"dd.MM.yyyy"),tura:B.tura,plz:B.plz,brojAdresa:B.broj_adresa,cijena:`${B.cijena}‚Ç¨`,status:"approved",napomena:B.notes||""}));i(H),p(U)}catch{i([]),p([])}finally{g(!1)}},[w]);h.useEffect(()=>{_()},[_]);const P=async x=>{try{if(!l.find(c=>c.id===x))return;const{data:A,error:m}=await T.from("extra_rides_pending").select("*").eq("id",x).single();if(m)throw m;const{error:o}=await T.from("extra_rides").insert([{date:A.date,driver:A.driver,tura:A.tura,plz:A.plz,broj_adresa:A.broj_adresa,cijena:A.cijena,notes:A.notes,plz_price:A.plz_price,adresa_price:A.adresa_price,created_by:A.created_by,status:"approved",approved_by:"Admin",approved_at:new Date().toISOString(),original_id:A.original_id}]);if(o)throw o;const{error:R}=await T.from("extra_rides_pending").delete().eq("id",x);if(R)throw R;await _(),alert("Vo≈ænja je uspe≈°no odobrena!")}catch(L){alert("Gre≈°ka pri odobravanju vo≈ænje: "+L.message)}},V=async x=>{try{const{error:L}=await T.from("extra_rides_pending").update({status:"rejected"}).eq("id",x);if(L)throw L;await _(),alert("Vo≈ænja je odbijena!")}catch(L){alert("Gre≈°ka pri odbijanju vo≈ænje: "+L.message)}},G=(x,L=!0)=>{r({...x,isPending:L}),$({driver:x.vozac,date:x.datum.split(".").reverse().join("-"),tura:x.tura,plz:x.plz,broj_adresa:x.brojAdresa,cijena:parseFloat(x.cijena.replace("‚Ç¨","")),notes:x.napomena||""}),N(!0)},q=async()=>{if(v)try{const x={driver:E.driver,date:E.date,tura:E.tura,plz:E.plz,broj_adresa:parseInt(E.broj_adresa),cijena:parseFloat(E.cijena),notes:E.notes,last_updated:new Date().toISOString()},L=v.isPending?"extra_rides_pending":"extra_rides",{error:A}=await T.from(L).update(x).eq("id",v.id);if(A)throw A;N(!1),r(null),await _(),alert("Vo≈ænja je uspe≈°no izmenjena!")}catch(x){alert("Gre≈°ka pri ƒçuvanju izmena: "+x.message)}};return e.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:`p-4 sm:p-6 rounded-2xl ${t?"bg-gray-800/50":"bg-white/50"} backdrop-blur-xl border ${t?"border-gray-700":"border-white/20"} shadow-xl`,children:[e.jsxs(s.div,{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.4},children:[e.jsxs(s.div,{className:"flex items-center gap-3",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1},children:[e.jsx(s.div,{whileHover:{scale:1.1,rotate:[0,-10,10,-10,0],transition:{duration:.5}},whileTap:{scale:.95},className:"p-2 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl shadow-lg",children:e.jsx(Te,{className:"w-6 h-6 text-white"})}),e.jsxs(s.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},children:[e.jsx("h2",{className:`text-xl sm:text-2xl font-bold ${t?"text-white":"text-gray-900"}`,children:"Extra vo≈ænje"}),e.jsx("p",{className:`text-sm ${t?"text-gray-400":"text-gray-600"}`,children:"Odobravanje i upravljanje vo≈ænjama"})]})]}),e.jsxs(s.div,{className:"flex items-center gap-3",initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.2},children:[e.jsx(s.div,{whileHover:{scale:1.1,rotate:180},transition:{type:"spring",stiffness:300},children:e.jsx(Ge,{className:`w-4 h-4 ${t?"text-gray-400":"text-gray-600"}`})}),e.jsx(s.input,{type:"month",value:w,onChange:x=>d(x.target.value),whileFocus:{scale:1.02},className:`px-4 py-2 rounded-xl border-2 transition-all duration-200 ${t?"bg-gray-800/50 border-gray-600 text-white focus:border-blue-400":"bg-white/80 border-gray-200 text-gray-900 focus:border-blue-500"} focus:outline-none focus:ring-2 focus:ring-blue-500/20 hover:shadow-md`})]})]}),e.jsxs(s.div,{className:"grid grid-cols-3 gap-2 sm:gap-4 mb-6",variants:{show:{transition:{staggerChildren:.1}}},initial:"hidden",animate:"show",children:[e.jsx(s.div,{variants:{hidden:{opacity:0,y:20,scale:.8},show:{opacity:1,y:0,scale:1}},whileHover:{scale:1.05,y:-3,transition:{type:"spring",stiffness:400,damping:10}},whileTap:{scale:.95},className:`p-3 sm:p-4 rounded-xl ${t?"bg-gray-700/50":"bg-white/70"} backdrop-blur-sm border ${t?"border-gray-600":"border-white/30"} cursor-pointer transition-all duration-300 hover:shadow-lg`,children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"p-1.5 sm:p-2 rounded-lg bg-gradient-to-br from-blue-500 to-indigo-500",children:e.jsx(Te,{className:"w-4 h-4 sm:w-5 sm:h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:`text-lg sm:text-2xl font-bold ${t?"text-white":"text-gray-900"}`,children:I}),e.jsx("p",{className:`text-xs sm:text-sm ${t?"text-gray-400":"text-gray-600"}`,children:"Ukupno"})]})]})}),e.jsx(s.div,{variants:{hidden:{opacity:0,y:20,scale:.8},show:{opacity:1,y:0,scale:1}},whileHover:{scale:1.05,y:-3,transition:{type:"spring",stiffness:400,damping:10}},whileTap:{scale:.95},className:`p-3 sm:p-4 rounded-xl ${t?"bg-gray-700/50":"bg-white/70"} backdrop-blur-sm border ${t?"border-gray-600":"border-white/30"} cursor-pointer transition-all duration-300 hover:shadow-lg`,children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"p-1.5 sm:p-2 rounded-lg bg-gradient-to-br from-yellow-500 to-orange-500",children:e.jsx(le,{className:"w-4 h-4 sm:w-5 sm:h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:`text-lg sm:text-2xl font-bold ${t?"text-white":"text-gray-900"}`,children:O}),e.jsx("p",{className:`text-xs sm:text-sm ${t?"text-gray-400":"text-gray-600"}`,children:"Pending"})]})]})}),e.jsx(s.div,{variants:{hidden:{opacity:0,y:20,scale:.8},show:{opacity:1,y:0,scale:1}},whileHover:{scale:1.05,y:-3,transition:{type:"spring",stiffness:400,damping:10}},whileTap:{scale:.95},className:`p-3 sm:p-4 rounded-xl ${t?"bg-gray-700/50":"bg-white/70"} backdrop-blur-sm border ${t?"border-gray-600":"border-white/30"} cursor-pointer transition-all duration-300 hover:shadow-lg`,children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"p-1.5 sm:p-2 rounded-lg bg-gradient-to-br from-green-500 to-emerald-500",children:e.jsx(te,{className:"w-4 h-4 sm:w-5 sm:h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:`text-lg sm:text-2xl font-bold ${t?"text-white":"text-gray-900"}`,children:j}),e.jsx("p",{className:`text-xs sm:text-sm ${t?"text-gray-400":"text-gray-600"}`,children:"Odobreno"})]})]})})]}),e.jsxs(s.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:[e.jsx("h3",{className:`text-lg font-bold mb-3 ${t?"text-white":"text-gray-900"}`,children:"‚è≥ Vo≈ænje na ƒçekanju"}),f?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(s.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:`inline-block text-3xl ${t?"text-white":"text-gray-900"}`,children:"üîÑ"}),e.jsx("p",{className:`mt-2 ${t?"text-gray-400":"text-gray-600"}`,children:"Uƒçitavanje..."})]}):l.length===0?e.jsx(Oe,{icon:e.jsx("span",{children:"‚úÖ"}),text:"Nema vo≈ænji na ƒçekanju",subtext:"Sve vo≈ænje su obraƒëene."}):e.jsx(s.div,{className:"grid grid-cols-1 gap-3 mb-6",variants:{show:{transition:{staggerChildren:.1}}},initial:"hidden",animate:"show",children:l.map((x,L)=>e.jsxs(s.div,{variants:{hidden:{opacity:0,x:-20,scale:.95},show:{opacity:1,x:0,scale:1}},whileHover:{scale:1.02,y:-2,transition:{type:"spring",stiffness:300}},whileTap:{scale:.98},className:`p-4 rounded-xl border backdrop-blur-sm cursor-pointer transition-all duration-300 ${t?"bg-yellow-500/10 border-yellow-500/30 hover:bg-yellow-500/20 hover:border-yellow-400/50":"bg-yellow-50 border-yellow-200 hover:bg-yellow-100 hover:border-yellow-300"} hover:shadow-lg`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("span",{className:`font-bold text-base ${t?"text-white":"text-gray-900"}`,children:["üë§ ",x.vozac]}),e.jsx(ze,{status:x.status,children:"‚è≥ Pending"})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 mb-3",children:[e.jsxs("div",{className:`text-sm ${t?"text-gray-300":"text-gray-700"}`,children:[e.jsx("span",{className:"opacity-70",children:"üìÖ"})," ",e.jsx("strong",{children:x.datum})]}),e.jsxs("div",{className:`text-sm ${t?"text-gray-300":"text-gray-700"}`,children:[e.jsx("span",{className:"opacity-70",children:"üöõ"})," ",e.jsx("strong",{children:x.tura})]}),e.jsxs("div",{className:`text-sm ${t?"text-gray-300":"text-gray-700"}`,children:[e.jsx("span",{className:"opacity-70",children:"üìç"})," ",e.jsx("strong",{children:x.plz})]}),e.jsxs("div",{className:`text-sm ${t?"text-gray-300":"text-gray-700"}`,children:[e.jsx("span",{className:"opacity-70",children:"üè†"})," ",e.jsx("strong",{children:x.brojAdresa})]}),e.jsxs("div",{className:`text-sm ${t?"text-gray-300":"text-gray-700"}`,children:[e.jsx("span",{className:"opacity-70",children:"üí∞"})," ",e.jsx("strong",{children:x.cijena})]})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx(ie,{onClick:()=>P(x.id),bgColor:"#28a745",children:"‚úÖ Odobri"}),e.jsx(ie,{onClick:()=>V(x.id),bgColor:"#dc3545",children:"‚ùå Odbij"}),e.jsx(ie,{onClick:()=>G(x,!0),bgColor:"#ffc107",children:"‚úèÔ∏è Uredi"}),e.jsx(ie,{onClick:()=>{k(x),z(!0)},bgColor:"#007bff",children:"üìã Detalji"})]})]},x.id))})]}),e.jsxs(s.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},children:[e.jsx("h3",{className:`text-lg font-bold mb-3 mt-6 ${t?"text-white":"text-gray-900"}`,children:"‚úÖ Odobrene vo≈ænje"}),u.length===0?e.jsx(Oe,{icon:e.jsx("span",{children:"üìã"}),text:"Nema odobrenih vo≈ænji",subtext:"Za odabrani mesec."}):e.jsx(s.div,{className:`grid ${a?"grid-cols-2":"grid-cols-1"} gap-3`,variants:{show:{transition:{staggerChildren:.08}}},initial:"hidden",animate:"show",children:u.map((x,L)=>e.jsxs(s.div,{variants:{hidden:{opacity:0,y:20,scale:.95},show:{opacity:1,y:0,scale:1}},whileHover:{scale:1.02,y:-2,transition:{type:"spring",stiffness:300}},whileTap:{scale:.98},className:`p-4 rounded-xl border backdrop-blur-sm cursor-pointer transition-all duration-300 ${t?"bg-green-500/10 border-green-500/30 hover:bg-green-500/20 hover:border-green-400/50":"bg-green-50 border-green-200 hover:bg-green-100 hover:border-green-300"} hover:shadow-lg`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("span",{className:`font-bold text-base ${t?"text-white":"text-gray-900"}`,children:["üë§ ",x.vozac]}),e.jsx(ze,{status:"approved",children:"‚úÖ Odobreno"})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 mb-3",children:[e.jsxs("div",{className:`text-sm ${t?"text-gray-300":"text-gray-700"}`,children:["üìÖ ",x.datum]}),e.jsxs("div",{className:`text-sm ${t?"text-gray-300":"text-gray-700"}`,children:["üöõ ",x.tura]}),e.jsxs("div",{className:`text-sm ${t?"text-gray-300":"text-gray-700"}`,children:["üìç ",x.plz]}),e.jsxs("div",{className:`text-sm ${t?"text-gray-300":"text-gray-700"}`,children:["üè† ",x.brojAdresa]}),e.jsxs("div",{className:`text-sm ${t?"text-gray-300":"text-gray-700"}`,children:["üí∞ ",x.cijena]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ie,{onClick:()=>G(x,!1),bgColor:"#ffc107",children:"‚úèÔ∏è Uredi"}),e.jsx(ie,{onClick:()=>{k(x),z(!0)},bgColor:"#007bff",children:"üìã Detalji"})]})]},x.id))})]}),e.jsx(ce,{open:S,title:"üìã Detalji vo≈ænje",onClose:()=>z(!1),showActions:!1,children:b&&e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"grid grid-cols-[auto_1fr] gap-x-4 gap-y-2 items-center",children:[e.jsx("strong",{className:t?"text-white":"text-gray-900",children:"üë§ Vozaƒç:"}),e.jsx("span",{className:`${t?"text-gray-300":"text-gray-700"}`,children:b.vozac}),e.jsx("strong",{className:t?"text-white":"text-gray-900",children:"üìÖ Datum:"}),e.jsx("span",{className:`${t?"text-gray-300":"text-gray-700"}`,children:b.datum}),e.jsx("strong",{className:t?"text-white":"text-gray-900",children:"üöõ Tura:"}),e.jsx("span",{className:`${t?"text-gray-300":"text-gray-700"}`,children:b.tura}),e.jsx("strong",{className:t?"text-white":"text-gray-900",children:"üìç PLZ:"}),e.jsx("span",{className:`${t?"text-gray-300":"text-gray-700"}`,children:b.plz}),e.jsx("strong",{className:t?"text-white":"text-gray-900",children:"üè† Broj adresa:"}),e.jsx("span",{className:`${t?"text-gray-300":"text-gray-700"}`,children:b.brojAdresa}),e.jsx("strong",{className:t?"text-white":"text-gray-900",children:"üí∞ Cijena:"}),e.jsx("span",{className:`${t?"text-gray-300":"text-gray-700"}`,children:b.cijena}),e.jsx("strong",{className:t?"text-white":"text-gray-900",children:"üìä Status:"}),e.jsx("span",{className:`${t?"text-gray-300":"text-gray-700"}`,children:b.status}),b.napomena&&e.jsxs(e.Fragment,{children:[e.jsx("strong",{className:t?"text-white":"text-gray-900",children:"üìù Napomena:"}),e.jsx("span",{className:`${t?"text-gray-300":"text-gray-700"}`,children:b.napomena})]})]})})}),e.jsx(ce,{open:M,title:`‚úèÔ∏è Uredi vo≈ænju ${v!=null&&v.isPending?"(Pending)":"(Odobreno)"}`,onClose:()=>N(!1),onSubmit:q,loading:f,submitLabel:"üíæ Saƒçuvaj promjene",closeLabel:"‚ùå Otka≈æi",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block mb-2 font-semibold ${t?"text-white":"text-gray-900"}`,children:"üë§ Vozaƒç:"}),e.jsx("input",{type:"text",value:E.driver,onChange:x=>$({...E,driver:x.target.value}),className:`w-full px-3 py-2 rounded-lg border-2 transition-all ${t?"bg-gray-800/50 border-gray-600 text-white focus:border-blue-400":"bg-white border-gray-300 text-gray-900 focus:border-blue-500"} focus:outline-none focus:ring-2 focus:ring-blue-500/20`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block mb-2 font-semibold ${t?"text-white":"text-gray-900"}`,children:"üìÖ Datum:"}),e.jsx("input",{type:"date",value:E.date,onChange:x=>$({...E,date:x.target.value}),className:`w-full px-3 py-2 rounded-lg border-2 transition-all ${t?"bg-gray-800/50 border-gray-600 text-white focus:border-blue-400":"bg-white border-gray-300 text-gray-900 focus:border-blue-500"} focus:outline-none focus:ring-2 focus:ring-blue-500/20`})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block mb-2 font-semibold ${t?"text-white":"text-gray-900"}`,children:"üöõ Tura:"}),e.jsx("input",{type:"text",value:E.tura,onChange:x=>$({...E,tura:x.target.value}),className:`w-full px-3 py-2 rounded-lg border-2 transition-all ${t?"bg-gray-800/50 border-gray-600 text-white focus:border-blue-400":"bg-white border-gray-300 text-gray-900 focus:border-blue-500"} focus:outline-none focus:ring-2 focus:ring-blue-500/20`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block mb-2 font-semibold ${t?"text-white":"text-gray-900"}`,children:"üìç PLZ:"}),e.jsx("input",{type:"text",value:E.plz,onChange:x=>$({...E,plz:x.target.value}),className:`w-full px-3 py-2 rounded-lg border-2 transition-all ${t?"bg-gray-800/50 border-gray-600 text-white focus:border-blue-400":"bg-white border-gray-300 text-gray-900 focus:border-blue-500"} focus:outline-none focus:ring-2 focus:ring-blue-500/20`})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block mb-2 font-semibold ${t?"text-white":"text-gray-900"}`,children:"üè† Broj adresa:"}),e.jsx("input",{type:"number",min:"1",value:E.broj_adresa,onChange:x=>$({...E,broj_adresa:x.target.value}),className:`w-full px-3 py-2 rounded-lg border-2 transition-all ${t?"bg-gray-800/50 border-gray-600 text-white focus:border-blue-400":"bg-white border-gray-300 text-gray-900 focus:border-blue-500"} focus:outline-none focus:ring-2 focus:ring-blue-500/20`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block mb-2 font-semibold ${t?"text-white":"text-gray-900"}`,children:"üí∞ Cijena (‚Ç¨):"}),e.jsx("input",{type:"number",min:"0",step:"0.01",value:E.cijena,onChange:x=>$({...E,cijena:x.target.value}),className:`w-full px-3 py-2 rounded-lg border-2 transition-all ${t?"bg-gray-800/50 border-gray-600 text-white focus:border-blue-400":"bg-white border-gray-300 text-gray-900 focus:border-blue-500"} focus:outline-none focus:ring-2 focus:ring-blue-500/20`})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block mb-2 font-semibold ${t?"text-white":"text-gray-900"}`,children:"üìù Napomena:"}),e.jsx("textarea",{value:E.notes,onChange:x=>$({...E,notes:x.target.value}),rows:3,className:`w-full px-3 py-2 rounded-lg border-2 transition-all resize-vertical ${t?"bg-gray-800/50 border-gray-600 text-white focus:border-blue-400 placeholder-gray-500":"bg-white border-gray-300 text-gray-900 focus:border-blue-500 placeholder-gray-400"} focus:outline-none focus:ring-2 focus:ring-blue-500/20`,placeholder:"Dodajte napomenu..."})]})]})})]})},_t=()=>{const[y,n]=h.useState("default");h.useEffect(()=>{const o=()=>{const c=new Date().getHours();c>=5&&c<8?n("sunrise"):c>=8&&c<12?n("default"):c>=12&&c<17?n("afternoon"):c>=17&&c<20?n("evening"):n("night")};o();const R=setInterval(o,6e4);return()=>clearInterval(R)},[]);const t=y==="night",{drivers:a,loading:l,error:i,addDriver:u,updateDriver:p,deleteDriver:f,toggleDriverStatus:g}=Le(),[b,k]=h.useState(null),[S,z]=h.useState(!1),[M,N]=h.useState(!1),[v,r]=h.useState(!1),[E,$]=h.useState({}),[w,d]=h.useState({ime:"",tura:"",aktivan:!0,target_per_day:0,password_hash:"",role:"driver"}),[I,O]=h.useState(null),j=async(o,R)=>{try{await navigator.clipboard.writeText(o),O(R),setTimeout(()=>O(null),2e3)}catch{}},_=o=>{$(R=>({...R,[o]:!R[o]}))},P=o=>{try{return atob(o)}catch{return o}},V=o=>{try{return btoa(o)}catch{return o}},G=async()=>{r(!0);try{const o={...w,password_hash:w.password_hash?V(w.password_hash):""};await u(o),N(!1),d({ime:"",tura:"",aktivan:!0,target_per_day:0,password_hash:"",role:"driver"})}catch(o){alert("Gre≈°ka pri dodavanju vozaƒça: "+o.message)}finally{r(!1)}},q=async()=>{if(b){r(!0);try{const o={...w,password_hash:w.password_hash?V(w.password_hash):b.password_hash};await p(b.id,o),z(!1),k(null)}catch(o){alert("Gre≈°ka pri a≈æuriranju vozaƒça: "+o.message)}finally{r(!1)}}},x=async o=>{if(window.confirm(`Da li ste sigurni da ≈æelite obrisati vozaƒça ${o.ime}?`))try{await f(o.id)}catch(R){alert("Gre≈°ka pri brisanju vozaƒça: "+R.message)}},L=async o=>{try{await g(o.id,o.aktivan)}catch(R){alert("Gre≈°ka pri mijenjanju statusa: "+R.message)}},A=o=>{k(o),d({ime:o.ime,tura:o.tura,aktivan:o.aktivan,target_per_day:o.target_per_day||0,password_hash:o.password_hash?P(o.password_hash):"",role:o.role||"driver"}),z(!0)},m=()=>{d({ime:"",tura:"",aktivan:!0,target_per_day:0,password_hash:"",role:"driver"}),N(!0)};return e.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:`p-4 sm:p-6 rounded-2xl ${t?"bg-gray-800/50":"bg-white/50"} backdrop-blur-xl border ${t?"border-gray-700":"border-white/20"} shadow-xl`,children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(s.div,{animate:{scale:[1,1.1,1]},transition:{duration:2,repeat:1/0},className:"p-3 rounded-xl bg-gradient-to-r from-blue-500 to-indigo-600",children:e.jsx(K,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:`text-xl sm:text-2xl font-bold ${t?"text-white":"text-gray-800"}`,children:"Upravljanje vozaƒçima"}),e.jsx("p",{className:`text-sm ${t?"text-gray-400":"text-gray-600"}`,children:"Upravljaj vozaƒçima i njihovim dozvolama"})]})]}),e.jsxs(s.button,{onClick:m,whileHover:{scale:1.05},whileTap:{scale:.95},className:`flex items-center gap-2 px-4 py-2 rounded-xl font-medium transition-all ${t?"bg-gradient-to-r from-blue-600 to-indigo-600 text-white hover:from-blue-500 hover:to-indigo-500":"bg-gradient-to-r from-blue-500 to-indigo-600 text-white hover:from-blue-400 hover:to-indigo-500"} shadow-lg`,children:[e.jsx(We,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Dodaj vozaƒça"}),e.jsx("span",{className:"sm:hidden",children:"Dodaj"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 sm:gap-4 mb-6",children:[e.jsx(s.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.1},className:`p-2 sm:p-4 rounded-xl ${t?"bg-green-900/30 border-green-700/50":"bg-green-50 border-green-200/50"} border`,children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"p-1.5 sm:p-2 rounded-lg bg-gradient-to-br from-green-500 to-emerald-500",children:e.jsx(K,{className:"w-3 h-3 sm:w-4 sm:h-4 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:`text-xs ${t?"text-gray-400":"text-gray-600"}`,children:"Aktivni"}),e.jsx("p",{className:`text-sm sm:text-lg font-bold ${t?"text-green-400":"text-green-600"}`,children:a.filter(o=>o.aktivan).length})]})]})}),e.jsx(s.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.2},className:`p-2 sm:p-4 rounded-xl ${t?"bg-yellow-900/30 border-yellow-700/50":"bg-yellow-50 border-yellow-200/50"} border`,children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"p-1.5 sm:p-2 rounded-lg bg-gradient-to-br from-yellow-500 to-orange-500",children:e.jsx(Ce,{className:"w-3 h-3 sm:w-4 sm:h-4 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:`text-xs ${t?"text-gray-400":"text-gray-600"}`,children:"Neaktivni"}),e.jsx("p",{className:`text-sm sm:text-lg font-bold ${t?"text-yellow-400":"text-yellow-600"}`,children:a.filter(o=>!o.aktivan).length})]})]})}),e.jsx(s.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.3},className:`p-2 sm:p-4 rounded-xl ${t?"bg-blue-900/30 border-blue-700/50":"bg-blue-50 border-blue-200/50"} border`,children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"p-1.5 sm:p-2 rounded-lg bg-gradient-to-br from-blue-500 to-indigo-500",children:e.jsx(K,{className:"w-3 h-3 sm:w-4 sm:h-4 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:`text-xs ${t?"text-gray-400":"text-gray-600"}`,children:"Ukupno"}),e.jsx("p",{className:`text-sm sm:text-lg font-bold ${t?"text-blue-400":"text-blue-600"}`,children:a.length})]})]})})]}),i&&e.jsx(s.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:`p-4 rounded-xl mb-6 ${t?"bg-red-900/30 border-red-700/50":"bg-red-50 border-red-200/50"} border`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br from-red-500 to-red-600",children:e.jsx(_e,{className:"w-4 h-4 text-white"})}),e.jsxs("p",{className:`text-sm font-medium ${t?"text-red-400":"text-red-600"}`,children:["Gre≈°ka: ",i.message]})]})}),l?e.jsxs(s.div,{initial:{opacity:0},animate:{opacity:1},className:"flex flex-col items-center justify-center py-12",children:[e.jsx(s.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-12 h-12 mb-4 rounded-xl bg-gradient-to-r from-blue-500 to-indigo-600 flex items-center justify-center",children:e.jsx(K,{className:"w-6 h-6 text-white"})}),e.jsx("span",{className:`text-lg ${t?"text-gray-300":"text-gray-600"}`,children:"Uƒçitavanje vozaƒça..."})]}):a.length===0?e.jsxs(s.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"flex flex-col items-center justify-center py-12",children:[e.jsx("div",{className:`w-16 h-16 mb-4 rounded-xl ${t?"bg-gray-700":"bg-gray-100"} flex items-center justify-center`,children:e.jsx(K,{className:`w-8 h-8 ${t?"text-gray-400":"text-gray-500"}`})}),e.jsx("h3",{className:`text-lg font-semibold mb-2 ${t?"text-gray-300":"text-gray-700"}`,children:"Nema vozaƒça"}),e.jsx("p",{className:`text-sm ${t?"text-gray-500":"text-gray-600"}`,children:"Nema registrovanih vozaƒça u sistemu"})]}):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:a.map((o,R)=>e.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:R*.05},className:`p-4 sm:p-5 rounded-xl ${o.aktivan?t?"bg-green-900/30 border-green-700/50":"bg-green-50 border-green-200/50":t?"bg-yellow-900/30 border-yellow-700/50":"bg-yellow-50 border-yellow-200/50"} border backdrop-blur-sm hover:scale-[1.02] transition-all duration-200`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg bg-gradient-to-br ${o.aktivan?"from-green-500 to-emerald-500":"from-yellow-500 to-orange-500"}`,children:e.jsx(K,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:`font-semibold ${t?"text-white":"text-gray-800"}`,children:o.ime}),e.jsxs("p",{className:`text-xs ${t?"text-gray-400":"text-gray-600"}`,children:["Tura: ",o.tura]})]})]}),e.jsx("div",{className:`px-2 py-1 rounded-lg text-xs font-medium ${o.aktivan?t?"bg-green-700/50 text-green-300":"bg-green-100 text-green-700":t?"bg-yellow-700/50 text-yellow-300":"bg-yellow-100 text-yellow-700"}`,children:o.aktivan?"Aktivan":"Neaktivan"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(re,{className:`w-4 h-4 ${t?"text-gray-400":"text-gray-600"}`}),e.jsxs("span",{className:`text-sm ${t?"text-gray-300":"text-gray-700"}`,children:["Target: ",e.jsx("strong",{children:o.target_per_day||0})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{className:`w-4 h-4 ${t?"text-gray-400":"text-gray-600"}`}),e.jsx("span",{className:`text-sm ${t?"text-gray-300":"text-gray-700"}`,children:o.role==="admin"?"Admin":"Vozaƒç"})]}),o.last_login&&e.jsxs("div",{className:"flex items-center gap-2 sm:col-span-2",children:[e.jsx(le,{className:`w-4 h-4 ${t?"text-gray-400":"text-gray-600"}`}),e.jsxs("span",{className:`text-sm ${t?"text-gray-300":"text-gray-700"}`,children:["Zadnji login: ",new Date(o.last_login).toLocaleDateString("bs-BA")]})]})]}),o.password_hash&&e.jsx("div",{className:`p-3 rounded-lg mb-4 ${t?"bg-gray-800/50":"bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:`text-sm ${t?"text-gray-300":"text-gray-700"}`,children:["Password: ",E[o.id]?P(o.password_hash):"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(s.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>_(o.id),className:`p-1 rounded ${t?"hover:bg-gray-700":"hover:bg-gray-200"}`,children:E[o.id]?e.jsx(Je,{className:"w-4 h-4"}):e.jsx(be,{className:"w-4 h-4"})}),e.jsx(s.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>j(P(o.password_hash),o.id),className:`p-1 rounded ${t?"hover:bg-gray-700":"hover:bg-gray-200"}`,children:I===o.id?e.jsx("span",{className:"text-xs text-green-500",children:"‚úì"}):e.jsx(Ye,{className:"w-4 h-4"})})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3",children:[e.jsxs(s.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>document.getElementById(`upload-input-${o.id}`).click(),className:`flex items-center justify-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-all ${t?"bg-green-700/50 text-green-300 hover:bg-green-600/50":"bg-green-500 text-white hover:bg-green-600"}`,children:[e.jsx(Ae,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Upload"})]}),e.jsxs(s.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>A(o),className:`flex items-center justify-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-all ${t?"bg-blue-700/50 text-blue-300 hover:bg-blue-600/50":"bg-blue-500 text-white hover:bg-blue-600"}`,children:[e.jsx(Ke,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Uredi"})]}),e.jsxs(s.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>L(o),className:`flex items-center justify-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-all ${o.aktivan?t?"bg-yellow-700/50 text-yellow-300 hover:bg-yellow-600/50":"bg-yellow-500 text-white hover:bg-yellow-600":t?"bg-green-700/50 text-green-300 hover:bg-green-600/50":"bg-green-500 text-white hover:bg-green-600"}`,children:[o.aktivan?e.jsx(Ce,{className:"w-4 h-4"}):e.jsx(Fe,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:o.aktivan?"Pauza":"Aktiviraj"})]}),e.jsxs(s.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>x(o),className:`flex items-center justify-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-all ${t?"bg-red-700/50 text-red-300 hover:bg-red-600/50":"bg-red-500 text-white hover:bg-red-600"}`,children:[e.jsx(pe,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Obri≈°i"})]})]}),e.jsx("input",{id:`upload-input-${o.id}`,type:"file",accept:"application/pdf",multiple:!0,className:"hidden",onChange:async c=>{const C=Array.from(c.target.files);if(!C.length)return;const{uploadPayrollFile:D}=await X(async()=>{const{uploadPayrollFile:W}=await import("./chunk-v4-1760899745229-BX32o4Tt.js").then(Q=>Q.S);return{uploadPayrollFile:W}},__vite__mapDeps([4,2,3,1])),{extractNetoBrutoFromPDF:F}=await X(async()=>{const{extractNetoBrutoFromPDF:W}=await import("./chunk-v4-1760899745229-iU7ReY_7.js");return{extractNetoBrutoFromPDF:W}},__vite__mapDeps([6,4,2,3,1])),{supabase:H}=await X(async()=>{const{supabase:W}=await import("./chunk-v4-1760899745229-BX32o4Tt.js").then(Q=>Q.f);return{supabase:W}},__vite__mapDeps([4,2,3,1])),U=o.ime.trim().toLowerCase();let B=0,J=0;for(const W of C){if(!await D(U,W)){J++;continue}try{const ue=await W.arrayBuffer(),{neto:Z,bruto:se}=await F(ue);await H.from("payroll_amounts").upsert([{driver_name:U,file_name:W.name,neto:Z,bruto:se,created_at:new Date}]),B++}catch{J++}}typeof window.refreshPayrollFiles=="function"&&window.refreshPayrollFiles(U),B>0&&J===0?alert(`Svi fajlovi (${B}) su uspje≈°no uploadovani za vozaƒça ${o.ime} (tura ${o.tura})!`):B>0&&J>0?alert(`Upload zavr≈°en: ${B} fajlova uspje≈°no, ${J} gre≈°aka.`):alert("Nijedan fajl nije uspje≈°no uploadovan!"),c.target.value=""}})]},o.id))}),e.jsx(ce,{open:M,title:"Dodaj novog vozaƒça",onClose:()=>N(!1),onSubmit:G,loading:v,submitLabel:"Dodaj vozaƒça",closeLabel:"Otka≈æi",children:e.jsx("div",{className:"space-y-3 sm:space-y-5",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[e.jsx("div",{className:"space-y-1 sm:col-span-2",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-end gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("label",{className:`flex items-center gap-2 text-sm font-medium ${t?"text-gray-200":"text-gray-700"}`,children:[e.jsx(K,{className:"w-4 h-4"}),"Ime vozaƒça"]}),e.jsx("input",{type:"text",value:w.ime,onChange:o=>d({...w,ime:o.target.value}),placeholder:"Unesite ime vozaƒça",required:!0,className:`w-full px-4 py-3 rounded-xl border-2 transition-all duration-200 ${t?"bg-gray-800/50 border-gray-600 text-white placeholder-gray-400 focus:border-blue-400":"bg-white/80 border-gray-200 text-gray-900 placeholder-gray-500 focus:border-blue-500"} focus:outline-none focus:ring-2 focus:ring-blue-500/20`})]}),e.jsxs("div",{className:`flex items-center gap-3 px-4 py-3 rounded-xl border ${t?"bg-gray-800/30 border-gray-600":"bg-gray-50 border-gray-200"} sm:flex-shrink-0`,children:[e.jsx("input",{type:"checkbox",id:"addActiveCheckbox",checked:w.aktivan,onChange:o=>d({...w,aktivan:o.target.checked}),className:"w-4 h-4 text-green-600 bg-gray-100 border-gray-300 rounded focus:ring-green-500 focus:ring-2"}),e.jsx("label",{htmlFor:"addActiveCheckbox",className:`text-sm font-medium cursor-pointer whitespace-nowrap ${t?"text-gray-200":"text-gray-700"}`,children:"Aktivan vozaƒç"})]})]})}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:`flex items-center gap-2 text-sm font-medium ${t?"text-gray-200":"text-gray-700"}`,children:[e.jsx(re,{className:"w-4 h-4"}),"Tura"]}),e.jsx("input",{type:"text",value:w.tura,onChange:o=>d({...w,tura:o.target.value}),placeholder:"npr. A1, B2, C3...",required:!0,className:`w-full px-4 py-3 rounded-xl border-2 transition-all duration-200 ${t?"bg-gray-800/50 border-gray-600 text-white placeholder-gray-400 focus:border-blue-400":"bg-white/80 border-gray-200 text-gray-900 placeholder-gray-500 focus:border-blue-500"} focus:outline-none focus:ring-2 focus:ring-blue-500/20`})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:`flex items-center gap-2 text-sm font-medium ${t?"text-gray-200":"text-gray-700"}`,children:[e.jsx(le,{className:"w-4 h-4"}),"Target po danu"]}),e.jsx("input",{type:"number",value:w.target_per_day,onChange:o=>d({...w,target_per_day:parseInt(o.target.value)||0}),placeholder:"0",min:"0",className:`w-full px-4 py-3 rounded-xl border-2 transition-all duration-200 ${t?"bg-gray-800/50 border-gray-600 text-white placeholder-gray-400 focus:border-blue-400":"bg-white/80 border-gray-200 text-gray-900 placeholder-gray-500 focus:border-blue-500"} focus:outline-none focus:ring-2 focus:ring-blue-500/20`})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:`flex items-center gap-2 text-sm font-medium ${t?"text-gray-200":"text-gray-700"}`,children:[e.jsx(he,{className:"w-4 h-4"}),"Uloga"]}),e.jsxs("select",{value:w.role,onChange:o=>d({...w,role:o.target.value}),className:`w-full px-4 py-3 rounded-xl border-2 transition-all duration-200 ${t?"bg-gray-800/50 border-gray-600 text-white focus:border-blue-400":"bg-white/80 border-gray-200 text-gray-900 focus:border-blue-500"} focus:outline-none focus:ring-2 focus:ring-blue-500/20`,children:[e.jsx("option",{value:"driver",children:"Vozaƒç"}),e.jsx("option",{value:"admin",children:"Administrator"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:`flex items-center gap-2 text-sm font-medium ${t?"text-gray-200":"text-gray-700"}`,children:[e.jsx(be,{className:"w-4 h-4"}),"Lozinka"]}),e.jsx("input",{type:"password",value:w.password_hash,onChange:o=>d({...w,password_hash:o.target.value}),placeholder:"Unesite lozinku",className:`w-full px-4 py-3 rounded-xl border-2 transition-all duration-200 ${t?"bg-gray-800/50 border-gray-600 text-white placeholder-gray-400 focus:border-blue-400":"bg-white/80 border-gray-200 text-gray-900 placeholder-gray-500 focus:border-blue-500"} focus:outline-none focus:ring-2 focus:ring-blue-500/20`})]})]})})}),e.jsx(ce,{open:S,title:"Uredi vozaƒça",onClose:()=>z(!1),onSubmit:q,loading:v,submitLabel:"Saƒçuvaj promjene",closeLabel:"Otka≈æi",children:e.jsx("div",{className:"space-y-3 sm:space-y-5",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[e.jsx("div",{className:"space-y-1 sm:col-span-2",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-end gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("label",{className:`flex items-center gap-2 text-sm font-medium ${t?"text-gray-200":"text-gray-700"}`,children:[e.jsx(K,{className:"w-4 h-4"}),"Ime vozaƒça"]}),e.jsx("input",{type:"text",value:w.ime,onChange:o=>d({...w,ime:o.target.value}),placeholder:"Unesite ime vozaƒça",required:!0,className:`w-full px-4 py-3 rounded-xl border-2 transition-all duration-200 ${t?"bg-gray-800/50 border-gray-600 text-white placeholder-gray-400 focus:border-blue-400":"bg-white/80 border-gray-200 text-gray-900 placeholder-gray-500 focus:border-blue-500"} focus:outline-none focus:ring-2 focus:ring-blue-500/20`})]}),e.jsxs("div",{className:`flex items-center gap-3 px-4 py-3 rounded-xl border ${t?"bg-gray-800/30 border-gray-600":"bg-gray-50 border-gray-200"} sm:flex-shrink-0`,children:[e.jsx("input",{type:"checkbox",id:"editActiveCheckbox",checked:w.aktivan,onChange:o=>d({...w,aktivan:o.target.checked}),className:"w-4 h-4 text-green-600 bg-gray-100 border-gray-300 rounded focus:ring-green-500 focus:ring-2"}),e.jsx("label",{htmlFor:"editActiveCheckbox",className:`text-sm font-medium cursor-pointer whitespace-nowrap ${t?"text-gray-200":"text-gray-700"}`,children:"Aktivan vozaƒç"})]})]})}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:`flex items-center gap-2 text-sm font-medium ${t?"text-gray-200":"text-gray-700"}`,children:[e.jsx(re,{className:"w-4 h-4"}),"Tura"]}),e.jsx("input",{type:"text",value:w.tura,onChange:o=>d({...w,tura:o.target.value}),placeholder:"npr. A1, B2, C3...",required:!0,className:`w-full px-4 py-3 rounded-xl border-2 transition-all duration-200 ${t?"bg-gray-800/50 border-gray-600 text-white placeholder-gray-400 focus:border-blue-400":"bg-white/80 border-gray-200 text-gray-900 placeholder-gray-500 focus:border-blue-500"} focus:outline-none focus:ring-2 focus:ring-blue-500/20`})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:`flex items-center gap-2 text-sm font-medium ${t?"text-gray-200":"text-gray-700"}`,children:[e.jsx(le,{className:"w-4 h-4"}),"Target po danu"]}),e.jsx("input",{type:"number",value:w.target_per_day,onChange:o=>d({...w,target_per_day:parseInt(o.target.value)||0}),placeholder:"0",min:"0",className:`w-full px-4 py-3 rounded-xl border-2 transition-all duration-200 ${t?"bg-gray-800/50 border-gray-600 text-white placeholder-gray-400 focus:border-blue-400":"bg-white/80 border-gray-200 text-gray-900 placeholder-gray-500 focus:border-blue-500"} focus:outline-none focus:ring-2 focus:ring-blue-500/20`})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:`flex items-center gap-2 text-sm font-medium ${t?"text-gray-200":"text-gray-700"}`,children:[e.jsx(he,{className:"w-4 h-4"}),"Uloga"]}),e.jsxs("select",{value:w.role,onChange:o=>d({...w,role:o.target.value}),className:`w-full px-4 py-3 rounded-xl border-2 transition-all duration-200 ${t?"bg-gray-800/50 border-gray-600 text-white focus:border-blue-400":"bg-white/80 border-gray-200 text-gray-900 focus:border-blue-500"} focus:outline-none focus:ring-2 focus:ring-blue-500/20`,children:[e.jsx("option",{value:"driver",children:"Vozaƒç"}),e.jsx("option",{value:"admin",children:"Administrator"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:`flex items-center gap-2 text-sm font-medium ${t?"text-gray-200":"text-gray-700"}`,children:[e.jsx(be,{className:"w-4 h-4"}),"Lozinka"]}),e.jsx("input",{type:"password",value:w.password_hash,onChange:o=>d({...w,password_hash:o.target.value}),placeholder:"Ostavite prazno da ne mijenjate lozinku",className:`w-full px-4 py-3 rounded-xl border-2 transition-all duration-200 ${t?"bg-gray-800/50 border-gray-600 text-white placeholder-gray-400 focus:border-blue-400":"bg-white/80 border-gray-200 text-gray-900 placeholder-gray-500 focus:border-blue-500"} focus:outline-none focus:ring-2 focus:ring-blue-500/20`})]})]})})})]})},Dt=y=>{const[n,t]=h.useState(!1);return h.useEffect(()=>{const a=window.matchMedia(y);a.matches!==n&&t(a.matches);const l=()=>t(a.matches);return a.addEventListener("change",l),()=>a.removeEventListener("change",l)},[n,y]),n},Ne=({onClick:y,variant:n="primary",children:t,disabled:a=!1,loading:l=!1})=>{const i={primary:"bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700",success:"bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700",danger:"bg-gradient-to-r from-red-500 to-rose-600 hover:from-red-600 hover:to-rose-700",warning:"bg-gradient-to-r from-yellow-500 to-orange-600 hover:from-yellow-600 hover:to-orange-700"};return e.jsxs(s.button,{whileHover:{scale:a||l?1:1.02,y:a||l?0:-1},whileTap:{scale:a||l?1:.98},onClick:y,disabled:a||l,className:`px-4 py-2 rounded-lg text-white text-sm font-medium transition-all duration-200 shadow-md hover:shadow-lg ${i[n]} ${a||l?"opacity-50 cursor-not-allowed":""}`,initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{type:"spring",stiffness:300,damping:20},children:[l&&e.jsx(ae,{className:"w-4 h-4 mr-2 animate-spin inline"}),t]})},Re=({type:y,children:n})=>{const t={success:"bg-green-500/20 text-green-300 border-green-500/30",error:"bg-red-500/20 text-red-300 border-red-500/30",warning:"bg-yellow-500/20 text-yellow-300 border-yellow-500/30",info:"bg-blue-500/20 text-blue-300 border-blue-500/30"};return e.jsx(s.span,{className:`px-2 py-1 rounded-full text-xs font-semibold border ${t[y]||t.info}`,initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{type:"spring",stiffness:300},children:n})},Tt=()=>{const[y,n]=h.useState("default");h.useEffect(()=>{const c=()=>{const D=new Date().getHours();D>=5&&D<8?n("sunrise"):D>=8&&D<12?n("default"):D>=12&&D<17?n("afternoon"):D>=17&&D<20?n("evening"):n("night")};c();const C=setInterval(c,6e4);return()=>clearInterval(C)},[]);const t=y==="night",a=Dt("(min-width: 768px)"),[l,i]=h.useState({}),[u,p]=h.useState(!1),[f,g]=h.useState(""),[b,k]=h.useState({drivers:!0,deliveries:!0,extra_rides:!0,extra_rides_pending:!0,holidays:!0}),[S,z]=h.useState(!1),[M,N]=h.useState(null),[v,r]=h.useState([]),[E,$]=h.useState(!1),[w,d]=h.useState(null),I=[{key:"drivers",name:"Vozaƒçi",icon:ye,color:"from-blue-500 to-indigo-600",description:"Svi vozaƒçi i njihovi podaci"},{key:"deliveries",name:"Dostave",icon:fe,color:"from-green-500 to-emerald-600",description:"Svi podaci o dostavama"},{key:"extra_rides",name:"Extra vo≈ænje",icon:te,color:"from-purple-500 to-violet-600",description:"Odobrene extra vo≈ænje"},{key:"extra_rides_pending",name:"Pending vo≈ænje",icon:le,color:"from-yellow-500 to-orange-600",description:"Vo≈ænje na ƒçekanju"},{key:"holidays",name:"Praznici",icon:he,color:"from-pink-500 to-rose-600",description:"Kalendar praznika"}];h.useEffect(()=>{j()},[]);const O=c=>{const C=new Date,D=new Date(c),F=C-D,H=Math.floor(F/(1e3*60)),U=Math.floor(F/(1e3*60*60)),B=Math.floor(F/(1e3*60*60*24));return H<1?"Upravo sada":H<60?`Prije ${H}min`:U<24?`Prije ${U}h`:B<7?`Prije ${B}d`:"Stariji"},j=()=>{const c=localStorage.getItem("backupHistory")||"[]",C=JSON.parse(c);r(C.slice(-10))},_=()=>{P({drivers:[{id:1,name:"Test Vozaƒç 1",phone:"061234567"},{id:2,name:"Test Vozaƒç 2",phone:"062345678"}],deliveries:[{id:1,from:"Sarajevo",to:"Mostar",date:"2024-01-15"},{id:2,from:"Tuzla",to:"Zenica",date:"2024-01-16"}],extra_rides:[{id:1,driver_id:1,date:"2024-01-15",amount:50}]}),g("‚úÖ Test backup kreiran uspe≈°no!"),setTimeout(()=>g(""),3e3)},P=c=>{const C=JSON.parse(localStorage.getItem("backupHistory")||"[]"),{_metadata:D,...F}=c,H=Z=>JSON.stringify(Z).length,U=Z=>{if(Z===0)return"0 B";const se=1024,qe=["B","KB","MB","GB"],De=Math.floor(Math.log(Z)/Math.log(se));return parseFloat((Z/Math.pow(se,De)).toFixed(2))+" "+qe[De]},B=H(c),W=((D==null?void 0:D.tables)||Object.keys(F)).filter(Z=>Z!=="_metadata"),Q=(D==null?void 0:D.total_records)||Object.values(F).reduce((Z,se)=>Z+(Array.isArray(se)?se.length:0),0),ue={id:Date.now(),name:`Backup_${new Date().toLocaleDateString("sr-RS")}_${new Date().toLocaleTimeString("sr-RS",{hour:"2-digit",minute:"2-digit"})}`,timestamp:new Date().toISOString(),tables:W,totalRecords:Q,fileSize:U(B),fileSizeBytes:B,data:c};C.push(ue),localStorage.setItem("backupHistory",JSON.stringify(C.slice(-20))),j()},V=c=>{const D=JSON.parse(localStorage.getItem("backupHistory")||"[]").filter(F=>F.id!==c);localStorage.setItem("backupHistory",JSON.stringify(D)),j(),$(!1),d(null)},G=c=>{try{const C=JSON.stringify(c.data||c,null,2),D="data:application/json;charset=utf-8,"+encodeURIComponent(C),F=c.name||`backup_${new Date(c.timestamp).toLocaleDateString("sr-RS")}.json`,H=document.createElement("a");H.setAttribute("href",D),H.setAttribute("download",F),H.click(),g("‚úÖ Backup preuzet uspe≈°no!"),setTimeout(()=>g(""),3e3)}catch{g("‚ùå Gre≈°ka pri preuzimanju backup-a"),setTimeout(()=>g(""),3e3)}},q=async()=>{p(!0),g("üîÑ Kreiranje kompletnog backup-a...");try{const c={};let C=0;for(const D of I)if(b[D.key]){g(`üìä Backup tabele: ${D.name}...`);const{data:F,error:H}=await T.from(D.key).select("*");if(H)throw H;c[D.key]=F,C+=F.length,await new Promise(U=>setTimeout(U,500))}c._metadata={created_at:new Date().toISOString(),version:"1.0",total_records:C,tables:Object.keys(c).filter(D=>D!=="_metadata")},i(c),P(c),g(`‚úÖ Backup kreiran! Ukupno ${C} zapisa`),x(c),setTimeout(()=>{g(""),j()},3e3)}catch(c){g(`‚ùå Gre≈°ka: ${c.message}`)}finally{p(!1)}},x=(c=l)=>{const D=`supabase-backup-${new Date().toISOString().replace(/[:.]/g,"-")}.json`,F=new Blob([JSON.stringify(c,null,2)],{type:"application/json"}),H=URL.createObjectURL(F),U=document.createElement("a");U.href=H,U.download=D,document.body.appendChild(U),U.click(),document.body.removeChild(U),URL.revokeObjectURL(H)},L=c=>{const C=c.target.files[0];if(!C)return;const D=new FileReader;D.onload=async F=>{try{const H=JSON.parse(F.target.result);await A(H)}catch(H){g(`‚ùå Neispravna backup datoteka: ${H.message}`)}},D.readAsText(C)},A=async c=>{p(!0),g("üîÑ Vraƒáanje backup-a u bazu...");try{let C=0;for(const[D,F]of Object.entries(c)){if(D==="_metadata"||!b[D])continue;g(`üì• Vraƒáanje tabele: ${D} (${F.length} zapisa)...`);const H=100;for(let U=0;U<F.length;U+=H){const B=F.slice(U,U+H),{error:J}=await T.from(D).upsert(B);if(J)throw J;C+=B.length,await new Promise(W=>setTimeout(W,200))}}g(`‚úÖ Backup vraƒáen! ${C} zapisa uspe≈°no vraƒáeno`)}catch(C){g(`‚ùå Gre≈°ka pri vraƒáanju: ${C.message}`)}finally{p(!1)}},m=async c=>{p(!0),g(`üóëÔ∏è Brisanje podataka iz tabele: ${c}...`);try{const{data:C,error:D}=await T.from(c).select("id");if(D)throw D;if(C.length===0){g(`‚ÑπÔ∏è Tabela ${c} je veƒá prazna`),p(!1);return}const F=100;let H=0;for(let U=0;U<C.length;U+=F){const J=C.slice(U,U+F).map(Q=>Q.id),{error:W}=await T.from(c).delete().in("id",J);if(W)throw W;H+=J.length,g(`üóëÔ∏è Obrisano ${H}/${C.length} zapisa iz ${c}...`),await new Promise(Q=>setTimeout(Q,200))}g(`‚úÖ Uspe≈°no obrisano ${H} zapisa iz tabele ${c}`)}catch(C){g(`‚ùå Gre≈°ka pri brisanju: ${C.message}`)}finally{p(!1),z(!1),N(null)}},[o,R]=h.useState({});return h.useEffect(()=>{(async()=>{const C={};for(const D of I)try{const{count:F,error:H}=await T.from(D.key).select("*",{count:"exact",head:!0});H||(C[D.key]=F)}catch{C[D.key]=0}R(C)})()},[]),e.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:`p-4 sm:p-6 rounded-2xl ${t?"bg-gray-800/50":"bg-white/50"} backdrop-blur-xl border ${t?"border-gray-700":"border-white/20"} shadow-xl`,children:[e.jsx(s.div,{className:"mb-6",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.4},children:e.jsxs(s.div,{className:"flex items-center gap-3 mb-2",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1},children:[e.jsx(s.div,{whileHover:{scale:1.1,rotate:[0,-10,10,-10,0],transition:{duration:.5}},className:"p-2 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl shadow-lg",children:e.jsx(Be,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:`text-xl sm:text-2xl font-bold ${t?"text-white":"text-gray-900"}`,children:"Sistem & Backup"}),e.jsx("p",{className:`text-sm ${t?"text-gray-400":"text-gray-600"}`,children:"Kompletno backup/restore re≈°enje za Supabase bazu"})]})]})}),e.jsx(He,{children:f&&e.jsx(s.div,{initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},className:`p-4 rounded-xl mb-6 border font-mono text-sm ${u?`${t?"bg-yellow-500/10 border-yellow-500/30 text-yellow-300":"bg-yellow-50 border-yellow-200 text-yellow-800"}`:`${t?"bg-green-500/10 border-green-500/30 text-green-300":"bg-green-50 border-green-200 text-green-800"}`}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[u?e.jsx(ae,{className:"w-4 h-4 animate-spin"}):e.jsx(te,{className:"w-4 h-4"}),f]})})}),e.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},"data-backup-section":!0,className:`rounded-xl p-4 sm:p-6 mb-6 border ${t?"bg-gray-700/30 border-gray-600":"bg-white/70 border-white/30"} backdrop-blur-sm`,children:[e.jsxs(s.h3,{className:`mb-4 font-bold text-lg flex items-center gap-2 ${t?"text-white":"text-gray-900"}`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.3},children:[e.jsx(ye,{className:"w-5 h-5 text-green-500"}),"Izbor tabela za backup/restore"]}),e.jsx(s.div,{className:`grid ${a?"grid-cols-2":"grid-cols-1"} gap-3`,variants:{show:{transition:{staggerChildren:.1}}},initial:"hidden",animate:"show",children:I.map((c,C)=>{const D=c.icon,F=b[c.key];return e.jsx(s.div,{variants:{hidden:{opacity:0,y:20,scale:.95},show:{opacity:1,y:0,scale:1}},whileHover:{scale:1.02,y:-2,transition:{type:"spring",stiffness:300}},whileTap:{scale:.98},onClick:()=>k(H=>({...H,[c.key]:!H[c.key]})),className:`p-4 rounded-xl border cursor-pointer transition-all duration-300 relative ${F?`${t?"bg-blue-500/20 border-blue-400/50":"bg-blue-50 border-blue-300"} shadow-lg`:`${t?"bg-gray-800/30 border-gray-600 hover:bg-gray-700/40":"bg-white/50 border-gray-200 hover:bg-white/80"}`} hover:shadow-md`,children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(s.div,{className:`p-2 rounded-lg bg-gradient-to-r ${c.color}`,whileHover:{rotate:360},transition:{duration:.3},children:e.jsx(D,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("strong",{className:`${t?"text-white":"text-gray-900"}`,children:c.name}),e.jsxs(Re,{type:F?"success":"info",children:[o[c.key]||0," zapisa"]})]}),e.jsx("p",{className:`text-sm mt-1 ${t?"text-gray-400":"text-gray-600"}`,children:c.description})]}),e.jsx(s.div,{animate:{scale:F?1:0,opacity:F?1:0},transition:{type:"spring",stiffness:300},children:e.jsx(te,{className:"w-5 h-5 text-green-500"})})]})},c.key)})})]}),e.jsxs(s.div,{className:`grid ${a?"grid-cols-2":"grid-cols-1"} gap-4 mb-6`,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},children:[e.jsxs(s.div,{whileHover:{scale:1.02,y:-2},className:`rounded-xl p-6 border ${t?"bg-blue-500/10 border-blue-500/30":"bg-blue-50 border-blue-200"} backdrop-blur-sm`,children:[e.jsxs(s.h3,{className:`font-bold text-lg mb-3 flex items-center gap-2 ${t?"text-blue-300":"text-blue-800"}`,initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.5},children:[e.jsx(Ee,{className:"w-5 h-5"}),"Kreiranje Backup-a"]}),e.jsx("p",{className:`mb-4 text-sm ${t?"text-gray-400":"text-gray-600"}`,children:"Kreiraj backup izabranih tabela i preuzmi kao JSON fajl"}),e.jsx(Ne,{onClick:q,disabled:u||Object.values(b).every(c=>!c),loading:u,variant:"primary",children:u?"Kreiram backup...":"üíæ Kreiraj i preuzmi backup"})]}),e.jsxs(s.div,{whileHover:{scale:1.02,y:-2},className:`rounded-xl p-6 border ${t?"bg-green-500/10 border-green-500/30":"bg-green-50 border-green-200"} backdrop-blur-sm`,children:[e.jsxs(s.h3,{className:`font-bold text-lg mb-3 flex items-center gap-2 ${t?"text-green-300":"text-green-800"}`,initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.6},children:[e.jsx(Ae,{className:"w-5 h-5"}),"Restore Backup-a"]}),e.jsx("p",{className:`mb-4 text-sm ${t?"text-gray-400":"text-gray-600"}`,children:"Vrati podatke iz backup JSON fajla u bazu"}),e.jsx(s.input,{type:"file",accept:".json",onChange:L,disabled:u,whileFocus:{scale:1.02},className:`w-full p-3 rounded-lg border-2 transition-all ${t?"bg-gray-800/50 border-gray-600 text-white focus:border-green-400":"bg-white border-gray-300 text-gray-900 focus:border-green-500"} focus:outline-none cursor-pointer hover:border-green-400`})]})]}),e.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:`rounded-xl p-6 mb-6 border ${t?"bg-red-500/10 border-red-500/30":"bg-red-50 border-red-200"} backdrop-blur-sm`,children:[e.jsxs(s.h3,{className:`font-bold text-lg mb-3 flex items-center gap-2 ${t?"text-red-300":"text-red-800"}`,initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.6},children:[e.jsx(pe,{className:"w-5 h-5"}),"Brisanje Podataka"]}),e.jsx("p",{className:`mb-4 text-sm ${t?"text-gray-400":"text-gray-600"}`,children:"Obri≈°i sve podatke iz izabranih tabela (OPREZ!)"}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:I.map(c=>{if(!b[c.key])return null;const C=c.icon;return e.jsxs(s.button,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{N(c),z(!0)},disabled:u,className:`flex items-center gap-2 px-3 py-2 rounded-lg border transition-all ${t?"bg-red-900/30 border-red-700/50 hover:bg-red-800/40":"bg-red-100 border-red-300 hover:bg-red-200"} disabled:opacity-50`,children:[e.jsx(C,{className:"w-4 h-4"}),e.jsxs("span",{className:`text-sm font-medium ${t?"text-red-300":"text-red-800"}`,children:["üóëÔ∏è ",c.name]})]},c.key)})})]}),e.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},className:`rounded-2xl p-6 mb-6 relative overflow-hidden ${t?"bg-gradient-to-br from-purple-900/20 via-purple-800/10 to-indigo-900/20 border border-purple-500/30":"bg-gradient-to-br from-purple-50 via-white to-indigo-50 border border-purple-200/50"} backdrop-blur-sm shadow-xl`,children:[e.jsx("div",{className:"absolute inset-0 opacity-5",children:e.jsx("div",{className:"absolute top-0 left-0 w-full h-full",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23a855f7' fill-opacity='0.1'%3E%3Ccircle cx='30' cy='30' r='4'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`,backgroundSize:"60px 60px"}})}),e.jsxs(s.div,{className:"flex items-center justify-between mb-6 relative z-10",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.7},children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(s.div,{className:`p-3 rounded-xl ${t?"bg-gradient-to-br from-purple-600 to-indigo-600 shadow-purple-500/25":"bg-gradient-to-br from-purple-500 to-indigo-500 shadow-purple-500/25"} shadow-lg`,whileHover:{scale:1.1,rotate:5},whileTap:{scale:.95},children:e.jsx(Ze,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:`font-bold text-xl ${t?"text-purple-300":"text-purple-800"}`,children:"Backup Istorija"}),e.jsx("p",{className:`text-sm ${t?"text-purple-400/70":"text-purple-600/70"}`,children:"Upravljajte va≈°im backup fajlovima"})]})]}),v.length>0&&e.jsxs(s.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.8,type:"spring"},className:"flex items-center gap-2",children:[e.jsxs(Re,{type:"info",children:[v.length," backup",v.length!==1&&"ova"]}),e.jsx(s.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{JSON.parse(localStorage.getItem("backupHistory")||"[]"),localStorage.setItem("backupHistory","[]"),j(),g("üóëÔ∏è Sva istorija obrisana"),setTimeout(()=>g(""),3e3)},className:`p-2 rounded-lg transition-all ${t?"bg-red-600/20 hover:bg-red-500/30 border border-red-500/30 text-red-400":"bg-red-50 hover:bg-red-100 border border-red-200 text-red-600"}`,title:"Obri≈°i svu istoriju",children:e.jsx(pe,{className:"w-4 h-4"})})]})]}),v.length===0?e.jsxs(s.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.8},className:"text-center py-12 relative z-10",children:[e.jsx(s.div,{animate:{y:[-10,10,-10],rotateY:[0,360,0]},transition:{duration:4,repeat:1/0,ease:"easeInOut"},className:"text-6xl mb-6 inline-block",style:{filter:"drop-shadow(0 4px 8px rgba(168, 85, 247, 0.3))"},children:"üìö"}),e.jsxs("div",{className:"space-y-3 mb-8",children:[e.jsx("h4",{className:`text-lg font-semibold ${t?"text-purple-300":"text-purple-800"}`,children:"Nema backup-ova u istoriji"}),e.jsx("p",{className:`text-sm max-w-md mx-auto leading-relaxed ${t?"text-gray-400":"text-gray-600"}`,children:"Kreirajte prvi backup ili koristite test funkciju da vidite kako istorija funkcioni≈°e"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center items-center",children:[e.jsxs(s.button,{whileHover:{scale:1.05,y:-2},whileTap:{scale:.95},onClick:_,className:`px-6 py-3 rounded-xl font-semibold text-sm transition-all duration-300 flex items-center gap-2 ${t?"bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-500 hover:to-indigo-500 text-white shadow-lg shadow-purple-500/25":"bg-gradient-to-r from-purple-500 to-indigo-500 hover:from-purple-600 hover:to-indigo-600 text-white shadow-lg shadow-purple-500/25"}`,children:[e.jsx("span",{className:"text-lg",children:"üß™"}),"Kreiraj test backup"]}),e.jsxs(s.button,{whileHover:{scale:1.05,y:-2},whileTap:{scale:.95},onClick:()=>{var c;return(c=document.querySelector("[data-backup-section]"))==null?void 0:c.scrollIntoView({behavior:"smooth"})},className:`px-6 py-3 rounded-xl font-medium text-sm transition-all duration-300 border-2 flex items-center gap-2 ${t?"border-purple-500/50 hover:border-purple-400 bg-purple-500/10 hover:bg-purple-500/20 text-purple-300":"border-purple-300 hover:border-purple-400 bg-purple-50 hover:bg-purple-100 text-purple-700"}`,children:[e.jsx(fe,{className:"w-4 h-4"}),"Kreiraj pravi backup"]})]})]}):e.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto pr-2",children:v.slice().reverse().map((c,C)=>{const D=C===0,F=new Date(c.timestamp),H=O(c.timestamp);return e.jsxs("div",{className:`group p-5 rounded-xl border transition-all duration-300 hover:shadow-lg ${D?`${t?"bg-gradient-to-r from-purple-900/60 to-indigo-900/60 border-purple-500/50 ring-2 ring-purple-500/30":"bg-gradient-to-r from-purple-100 to-indigo-100 border-purple-300/50 ring-2 ring-purple-300/50"} shadow-lg`:`${t?"bg-gray-800/40 border-gray-600/50 hover:bg-gray-700/50":"bg-white/80 border-gray-200/50 hover:bg-white/95"}`} backdrop-blur-sm`,children:[D&&e.jsx("div",{className:"absolute -top-2 -right-2 z-10",children:e.jsx("span",{className:"px-3 py-1 text-xs font-bold bg-gradient-to-r from-purple-500 to-indigo-500 text-white rounded-full shadow-lg border-2 border-white",children:"NAJNOVIJI"})}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:`p-2.5 rounded-lg ${D?"bg-gradient-to-br from-purple-500 to-indigo-500 text-white shadow-lg shadow-purple-500/25":`${t?"bg-gray-700 text-gray-300":"bg-gray-100 text-gray-600"}`}`,children:e.jsx(fe,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("h4",{className:`font-semibold text-base ${t?"text-white":"text-gray-900"}`,children:c.name||`Backup ${F.toLocaleDateString("sr-RS")}`}),e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsxs("span",{className:t?"text-gray-400":"text-gray-500",children:[F.toLocaleDateString("sr-RS",{weekday:"short",day:"2-digit",month:"2-digit",year:"numeric"})," u ",F.toLocaleTimeString("sr-RS",{hour:"2-digit",minute:"2-digit"})]}),e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${t?"bg-purple-500/20 text-purple-300":"bg-purple-100 text-purple-700"}`,children:H})]})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:c.tables&&c.tables.length>0?c.tables.map(U=>{const B=I.find(W=>W.key===U);if(!B)return null;const J=B.icon;return e.jsxs("div",{className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-medium transition-all hover:shadow-sm hover:scale-105 ${t?"bg-gray-700/60 text-gray-300 border border-gray-600/50":"bg-gray-50 text-gray-700 border border-gray-200"}`,children:[e.jsx(J,{className:"w-3.5 h-3.5"}),B.name]},U)}):e.jsx("div",{className:"text-xs text-gray-500",children:"Nema tabela"})}),e.jsxs("div",{className:"flex items-center gap-6 text-sm",children:[e.jsxs("div",{className:`flex items-center gap-2 ${t?"text-gray-400":"text-gray-600"}`,children:[e.jsx(ye,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:c.totalRecords}),e.jsx("span",{children:"zapisa"})]}),e.jsxs("div",{className:`flex items-center gap-2 ${t?"text-gray-400":"text-gray-600"}`,children:[e.jsx(Qe,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:c.fileSize||"0 KB"})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 ml-4 opacity-60 group-hover:opacity-100 transition-opacity",children:[e.jsx(Ne,{onClick:()=>G(c),variant:"primary",size:"sm",children:e.jsx(Ee,{className:"w-4 h-4"})}),e.jsx(Ne,{onClick:()=>{d(c),$(!0)},variant:"danger",size:"sm",children:e.jsx(pe,{className:"w-4 h-4"})})]})]})]},c.id)})})]}),"      ",S&&M&&e.jsx(ce,{onClose:()=>{z(!1),N(null)},children:e.jsxs("div",{style:{padding:"2rem",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:"‚ö†Ô∏è"}),e.jsx("h2",{style:{color:"#ef4444",marginBottom:"1rem"},children:"Potvrdi brisanje"}),e.jsxs("p",{style:{marginBottom:"1.5rem"},children:["Da li ste sigurni da ≈æelite da obri≈°ete ",e.jsx("strong",{children:"SVE PODATKE"})," iz tabele:"]}),e.jsxs("div",{style:{padding:"1rem",background:"rgba(239, 68, 68, 0.1)",borderRadius:"8px",marginBottom:"1.5rem",border:"1px solid rgba(239, 68, 68, 0.2)"},children:[e.jsxs("div",{style:{fontSize:"1.5rem",marginBottom:"0.5rem"},children:[M.icon," ",M.name]}),e.jsxs("div",{style:{fontSize:"0.9rem",opacity:.8},children:[o[M.key]||0," zapisa ƒáe biti TRAJNO OBRISANO"]})]}),e.jsx("p",{style:{fontSize:"0.9rem",opacity:.8,marginBottom:"2rem"},children:"Ova akcija se NE MO≈ΩE poni≈°titi! Preporuƒçujemo da prvo napravite backup."}),e.jsxs("div",{style:{display:"flex",gap:"1rem",justifyContent:"center"},children:[e.jsx("button",{onClick:()=>{z(!1),N(null)},style:{padding:"0.75rem 1.5rem",background:"rgba(255, 255, 255, 0.1)",color:"var(--text-on-dark)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"8px",cursor:"pointer"},children:"‚ùå Otka≈æi"}),e.jsx("button",{onClick:()=>m(M.key),style:{padding:"0.75rem 1.5rem",background:"linear-gradient(145deg, #ef4444, #dc2626)",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"bold"},children:"üóëÔ∏è DA, OBRI≈†I SVE"})]})]})}),E&&e.jsx(ce,{isOpen:E,onClose:()=>{$(!1),d(null)},title:"Potvrdi brisanje backup-a",children:e.jsxs("div",{style:{padding:"1.5rem"},children:[e.jsxs(s.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:300,damping:25},style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"1.5rem"},children:[e.jsx(s.div,{animate:{rotate:[0,-10,10,-10,0]},transition:{duration:.5,delay:.2},style:{fontSize:"4rem",background:"linear-gradient(135deg, #ef4444, #dc2626)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",filter:"drop-shadow(0 4px 8px rgba(239, 68, 68, 0.3))"},children:"üóëÔ∏è"}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("h3",{style:{margin:"0 0 0.5rem 0",fontSize:"1.25rem",fontWeight:"bold",color:"#ef4444"},children:"Brisanje backup-a"}),e.jsxs("p",{style:{margin:0,color:"#6b7280",lineHeight:"1.5"},children:["Da li ste sigurni da ≈æelite da obri≈°ete backup"," ",e.jsx("strong",{style:{color:"#374151"},children:w==null?void 0:w.name}),"?",e.jsx("br",{}),e.jsx("span",{style:{fontSize:"0.875rem",fontStyle:"italic"},children:"Ova akcija se ne mo≈æe poni≈°titi."})]})]})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem",marginTop:"2rem",justifyContent:"center"},children:[e.jsx(s.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>{$(!1),d(null)},style:{padding:"0.75rem 1.5rem",background:"linear-gradient(145deg, #f3f4f6, #e5e7eb)",color:"#374151",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"600",transition:"all 0.2s ease",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"},children:"Otka≈æi"}),e.jsx(s.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>{w&&V(w.id),$(!1),d(null)},style:{padding:"0.75rem 1.5rem",background:"linear-gradient(145deg, #ef4444, #dc2626)",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"600",transition:"all 0.2s ease",boxShadow:"0 2px 4px rgba(239, 68, 68, 0.3)"},children:"Obri≈°i backup"})]})]})})]})},ke=({onClick:y,variant:n="primary",children:t,disabled:a=!1,loading:l=!1,size:i="default",icon:u,className:p=""})=>{const f={primary:"bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700",success:"bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700",danger:"bg-gradient-to-r from-red-500 to-rose-600 hover:from-red-600 hover:to-rose-700",warning:"bg-gradient-to-r from-yellow-500 to-orange-600 hover:from-yellow-600 hover:to-orange-700",secondary:"bg-gradient-to-r from-gray-500 to-slate-600 hover:from-gray-600 hover:to-slate-700"},g={sm:"px-3 py-1.5 text-xs",default:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"};return e.jsxs(s.button,{whileHover:{scale:a||l?1:1.02,y:a||l?0:-1},whileTap:{scale:a||l?1:.98},onClick:y,disabled:a||l,className:`${g[i]} rounded-lg text-white font-medium transition-all duration-200 shadow-md hover:shadow-lg ${f[n]} ${a||l?"opacity-50 cursor-not-allowed":""} flex items-center gap-2 ${p}`,initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{type:"spring",stiffness:300,damping:20},children:[l&&e.jsx(ae,{className:"w-4 h-4 animate-spin"}),u&&!l&&u,t]})},Ct=({type:y,children:n})=>{const t={success:"bg-green-500/20 text-green-300 border-green-500/30",error:"bg-red-500/20 text-red-300 border-red-500/30",warning:"bg-yellow-500/20 text-yellow-300 border-yellow-500/30",pending:"bg-blue-500/20 text-blue-300 border-blue-500/30",info:"bg-cyan-500/20 text-cyan-300 border-cyan-500/30"};return e.jsx(s.span,{className:`px-3 py-1 rounded-full text-xs font-semibold border transition-all duration-300 ${t[y]||t.info}`,whileHover:{scale:1.05},initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{type:"spring",stiffness:300,damping:20},children:n})},Et=({currentTheme:y})=>{const[n,t]=h.useState([]),[a,l]=h.useState(!1),[i,u]=h.useState(null),p=y==="night",f="https://api.github.com/repos",g="eldin007b/gls-scraper",b="eldin007b/gls-scraper",k="your_production_github_token",[S,z]=g.split("/"),M=async()=>{l(!0);try{let d=null,I="",O=await fetch(`${f}/${S}/${z}/actions/runs?per_page=20`,{headers:{Accept:"application/vnd.github.v3+json",...k&&{Authorization:`token ${k}`}}});if(O.ok)d=await O.json(),I=g;else{const[j,_]=b.split("/");O=await fetch(`${f}/${j}/${_}/actions/runs?per_page=20`,{headers:{Accept:"application/vnd.github.v3+json",...k&&{Authorization:`token ${k}`}}}),O.ok&&(d=await O.json(),I=b)}if(d){let j=(d.workflow_runs||[]).filter(_=>{const P=(_.name||"").toLowerCase();return P.includes("gls scraper")||P.includes("scraper")||P.includes("gls")||P.includes("sync")||P.includes("data")});if((!j||j.length===0)&&I===g&&b){const[_,P]=b.split("/"),V=await fetch(`${f}/${_}/${P}/actions/runs?per_page=20`,{headers:{Accept:"application/vnd.github.v3+json",...k&&{Authorization:`token ${k}`}}});if(V.ok){const G=await V.json();j=(G.workflow_runs||[]).filter(q=>{const x=(q.name||"").toLowerCase();return x.includes("gls scraper")||x.includes("scraper")||x.includes("gls")||x.includes("sync")||x.includes("data")}),j.length>0&&(I=b,d=G)}}if(t(j),j.length>0){const _=j.find(P=>P.conclusion==="success");if(_){const P=_.updated_at||_.run_started_at||_.created_at||new Date().toISOString(),G={timestamp:P,formattedTimestamp:(q=>{try{const x=new Date(q);if(isNaN(x.getTime()))return null;const L=x.getDate().toString().padStart(2,"0"),A=(x.getMonth()+1).toString().padStart(2,"0"),m=x.getHours().toString().padStart(2,"0"),o=x.getMinutes().toString().padStart(2,"0");return`${L}.${A} ${m}:${o}`}catch{return null}})(P),status:"success",workflowId:_.id,runNumber:_.run_number,source:"github_api",repoUsed:I,raw:_};localStorage.setItem("github_scraper_history",JSON.stringify([G]))}}u(new Date)}else O.status}catch{}finally{l(!1)}},N=d=>{switch(d){case"success":return e.jsx(te,{className:"h-4 w-4 text-green-400"});case"failure":return e.jsx(_e,{className:"h-4 w-4 text-red-400"});case"in_progress":return e.jsx(ae,{className:"h-4 w-4 text-blue-400 animate-spin"});default:return e.jsx(ne,{className:"h-4 w-4 text-yellow-400"})}},v=d=>{switch(d){case"success":return"success";case"failure":return"error";case"in_progress":return"pending";default:return"warning"}},r=d=>{const I=new Date(d);return new Intl.DateTimeFormat("sr-RS",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(I)},E=d=>{const I=Math.floor(d/1e3),O=Math.floor(I/60),j=I%60;return O>0?`${O}m ${j}s`:`${j}s`},$=async()=>{const d="scraper.yml",I=async O=>{const[j,_]=O.split("/"),P=`${f}/${j}/${_}/actions/workflows/${d}/dispatches`;try{return await fetch(P,{method:"POST",headers:{Accept:"application/vnd.github.v3+json",Authorization:`token ${k}`,"Content-Type":"application/json"},body:JSON.stringify({ref:"main"})})}catch(V){return{ok:!1,status:0,statusText:V.message}}};l(!0);try{let O=await I(g),j=g;if(O.ok||(O=await I(b),j=b),O.ok){alert(`Workflow dispatch poslat na ${j}. Pokreƒáem osve≈æavanje...`);try{localStorage.setItem("github_scraper_last_event",JSON.stringify({action:"workflow_dispatch",at:new Date().toISOString(),repo:j,workflowFile:d}))}catch{}setTimeout(()=>M(),3e3)}else{let _=null;try{const V=await O.clone().json();_=V.message||JSON.stringify(V)}catch{try{_=await O.text()}catch{_=O.statusText}}const P=`Neuspjeh pri pokretanju workflow-a: ${O.status} ${O.statusText} - ${_}`;alert(P);try{localStorage.setItem("github_scraper_last_event",JSON.stringify({action:"workflow_dispatch_error",at:new Date().toISOString(),repo:j,workflowFile:d,status:O.status,statusText:O.statusText,body:_}))}catch{}}}finally{l(!1)}},w=async()=>{localStorage.getItem("github_scraper_history"),await M();const d=localStorage.getItem("github_scraper_history");try{const I=d?JSON.parse(d)[0]:null;if(I){const O={...I,formattedTimestamp:new Date(I.timestamp).toLocaleString("sr-RS",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})};try{localStorage.setItem("github_scraper_last_event",JSON.stringify({action:"force_sync",at:new Date().toISOString(),payload:O}))}catch{}window.dispatchEvent(new CustomEvent("githubSync:updated",{detail:O}))}}catch{}};return h.useEffect(()=>{M();const d=setInterval(M,5*60*1e3);return()=>clearInterval(d)},[]),e.jsxs(s.div,{className:`p-6 min-h-screen transition-all duration-500 ${p?"bg-gradient-to-br from-gray-900 via-blue-900/20 to-purple-900/20":"bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50"}`,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:[e.jsxs(s.div,{className:"mb-8",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{delay:.2},children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx(s.div,{className:`p-3 rounded-2xl ${p?"bg-gradient-to-br from-purple-600 to-blue-600 shadow-2xl shadow-purple-500/25":"bg-gradient-to-br from-purple-500 to-blue-500 shadow-2xl shadow-purple-500/25"}`,whileHover:{scale:1.05,rotate:5},transition:{type:"spring",stiffness:300},children:e.jsx($e,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx(s.h3,{className:`text-xl md:text-2xl font-bold ${p?"text-white":"text-gray-900"}`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.3},children:"GitHub Actions"}),e.jsx(s.p,{className:`text-xs md:text-sm ${p?"text-gray-400":"text-gray-600"} break-all md:break-normal`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.4},children:i&&`Poslednje a≈æuriranje: ${r(i)}`})]})]}),e.jsxs(s.div,{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 sm:gap-3",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},children:[e.jsx(ke,{onClick:M,loading:a,variant:"secondary",size:"sm",icon:e.jsx(ae,{className:"w-4 h-4"}),className:"w-full justify-center",children:"Osvje≈æi"}),e.jsx(ke,{onClick:w,variant:"primary",size:"sm",icon:e.jsx(ge,{className:"w-4 h-4"}),className:"w-full justify-center",children:"Force Sync"}),e.jsx(ke,{onClick:$,variant:"success",size:"sm",icon:e.jsx(Fe,{className:"w-4 h-4"}),className:"w-full justify-center",children:"Pokreni Scraper"})]})]}),n.length>0?e.jsx(s.div,{className:"space-y-4",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},children:n.map((d,I)=>e.jsx(s.div,{className:`p-6 rounded-2xl backdrop-blur-sm border transition-all duration-300 ${p?"bg-gray-800/40 border-gray-700/50 hover:bg-gray-800/60 hover:border-gray-600/50":"bg-white/60 border-gray-200 hover:bg-white/80 hover:border-gray-300"} hover:shadow-xl group`,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.7+I*.1},whileHover:{y:-2},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(s.div,{whileHover:{scale:1.1},transition:{type:"spring",stiffness:400},children:N(d.conclusion)}),e.jsxs("div",{children:[e.jsx(s.p,{className:`font-semibold text-lg ${p?"text-white":"text-gray-900"}`,whileHover:{x:2},transition:{type:"spring",stiffness:400},children:d.name}),e.jsxs("p",{className:`text-sm ${p?"text-gray-400":"text-gray-500"}`,children:["Run #",d.run_number," ‚Ä¢ ",d.head_branch]}),e.jsx("div",{className:"flex items-center gap-2 mt-2",children:e.jsx(Ct,{type:v(d.conclusion),children:d.conclusion||"unknown"})})]})]}),e.jsxs("div",{className:`text-right text-sm ${p?"text-gray-400":"text-gray-500"}`,children:[e.jsxs("div",{className:"flex items-center justify-end gap-2 mb-2",children:[e.jsx(Me,{className:"h-4 w-4"}),e.jsx("span",{children:r(d.updated_at)})]}),d.run_started_at&&d.updated_at&&e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(le,{className:"h-4 w-4"}),e.jsx("span",{children:E(new Date(d.updated_at)-new Date(d.run_started_at))})]}),d.html_url&&e.jsxs(s.a,{href:d.html_url,target:"_blank",rel:"noopener noreferrer",className:`flex items-center justify-end gap-1 mt-2 text-xs hover:underline ${p?"text-blue-400 hover:text-blue-300":"text-blue-600 hover:text-blue-700"}`,whileHover:{scale:1.05},children:[e.jsx(Xe,{className:"w-3 h-3"}),e.jsx("span",{children:"Pogledaj na GitHub"})]})]})]})},d.id))}):e.jsxs(s.div,{className:`p-12 rounded-2xl backdrop-blur-sm border text-center ${p?"bg-gray-800/40 border-gray-700/50":"bg-white/60 border-gray-200"}`,initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.6},children:[e.jsx(s.div,{className:`w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center ${p?"bg-gray-700/50":"bg-gray-100"}`,animate:{rotate:a?360:0},transition:{duration:a?1:0,repeat:a?1/0:0},children:e.jsx($e,{className:`w-8 h-8 ${p?"text-gray-400":"text-gray-500"}`})}),e.jsx("p",{className:`text-lg font-medium mb-2 ${p?"text-gray-300":"text-gray-700"}`,children:a?"Uƒçitavam workflow podatke...":"Nema pronaƒëenih workflow-a"}),!a&&e.jsx("p",{className:"text-sm text-gray-500",children:"Proveri da li repo ima GitHub Actions ili proveri naziv repo."})]}),e.jsx(s.div,{className:`mt-8 p-4 rounded-xl backdrop-blur-sm border ${p?"bg-gray-800/20 border-gray-700/30":"bg-white/40 border-gray-200/50"}`,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8},children:e.jsxs("div",{className:`text-xs space-y-1 ${p?"text-gray-400":"text-gray-600"}`,children:[e.jsxs("p",{children:["üì° Glavni repo: ",e.jsx("span",{className:"font-mono",children:g})]}),e.jsxs("p",{children:["üîÑ Fallback repo: ",e.jsx("span",{className:"font-mono",children:b})]}),e.jsxs("p",{children:["üîë Token: ","‚úÖ Konfigurisan"]}),e.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[e.jsx("span",{children:"üåê GitHub Actions:"}),e.jsx(s.a,{href:`https://github.com/${g}/actions`,target:"_blank",rel:"noopener noreferrer",className:`${p?"text-blue-400 hover:text-blue-300":"text-blue-600 hover:text-blue-700"} hover:underline`,whileHover:{scale:1.05},children:"Glavni"}),e.jsx(s.a,{href:`https://github.com/${b}/actions`,target:"_blank",rel:"noopener noreferrer",className:`${p?"text-blue-400 hover:text-blue-300":"text-blue-600 hover:text-blue-700"} hover:underline`,whileHover:{scale:1.05},children:"Fallback"})]})]})})]})},Pt=(y=[])=>{const[n,t]=h.useState({totalStops:0,dailyStops:0,extraRides:0,pendingRides:0,activeDrivers:0,totalDrivers:0,avgStopsPerDay:0,latestDate:null,successRate:0}),[a,l]=h.useState(!0),[i,u]=h.useState(null),p=async()=>{var g,b;if(y.length){l(!0),u(null);try{const k=new Date,S=new Date(k.getFullYear(),k.getMonth(),1).toISOString().split("T")[0],z=new Date(k.getFullYear(),0,1).toISOString().split("T")[0],[M,N,v,r,E]=await Promise.all([T.from("deliveries").select("produktivitaet_stops").gte("date",S).eq("deleted",0).not("produktivitaet_stops","is",null),T.from("deliveries").select("produktivitaet_stops, date").eq("deleted",0).not("produktivitaet_stops","is",null).order("date",{ascending:!1}).limit(20),T.from("deliveries").select("produktivitaet_stops, tura, probleme_druga, date").gte("date",z).eq("deleted",0).not("produktivitaet_stops","is",null),T.from("extra_rides").select("id",{count:"exact"}),T.from("extra_rides_pending").select("id",{count:"exact"})]),$=((g=M.data)==null?void 0:g.reduce((m,o)=>m+(o.produktivitaet_stops||0),0))||0;let w=0,d=null;if(((b=N.data)==null?void 0:b.length)>0){const m=N.data.reduce((R,c)=>{const C=c.date;return R[C]||(R[C]=[]),R[C].push(c),R},{}),o=Object.keys(m).sort((R,c)=>new Date(c)-new Date(R))[0];o&&(d=o,w=m[o].reduce((R,c)=>R+(c.produktivitaet_stops||0),0))}let I=0,O=0,j=0;y&&y.length>0&&y.forEach(m=>{var R;const o=((R=v.data)==null?void 0:R.filter(c=>c.tura===m.tura))||[];I+=o.reduce((c,C)=>c+(C.produktivitaet_stops||0),0),O+=o.reduce((c,C)=>c+(C.probleme_druga||0),0),j+=(m.target_per_day||0)*o.length});const _=y.filter(m=>m.aktivan).length,P=y.length,V=k.getDate(),G=V>0?Math.round($/V):0,q=r.count||0,x=E.count||0,L=q+x>0?q/(q+x)*100:0,A=[{label:"Danas",value:w,trend:w>0?"up":"neutral"},{label:"Reklamacije",value:"0",trend:"neutral"},{label:"Ovaj mjesec",value:$,trend:$>0?"up":"neutral"},{label:"Reklamacije",value:"0",trend:"neutral"},{label:"Ova godina",value:I-j,trend:I-j>0?"up":I-j<0?"down":"neutral"},{label:"Reklamacije",value:O,trend:O===0?"up":"down"}];t({totalStops:$,dailyStops:w,yearlyStops:I,yearlyStopsResult:v,extraRides:q,pendingRides:x,activeDrivers:_,totalDrivers:P,avgStopsPerDay:G,latestDate:d,successRate:parseFloat(L.toFixed(1)),statsArray:A})}catch(k){u(k.message)}finally{l(!1)}}};return h.useEffect(()=>{p()},[y]),{stats:n,loading:a,error:i,refetch:p,getStopsForDate:async g=>{var b;try{return((b=(await T.from("deliveries").select("produktivitaet_stops").eq("date",g).eq("deleted",0).not("produktivitaet_stops","is",null)).data)==null?void 0:b.reduce((S,z)=>S+(z.produktivitaet_stops||0),0))||0}catch{return 0}}}},zt=({data:y,drivers:n,loading:t,error:a,onRefresh:l})=>{const[i,u]=h.useState("default"),[p,f]=h.useState("month"),[g,b]=h.useState(0),[k,S]=h.useState(0),[z,M]=h.useState(0),[N,v]=h.useState(0);h.useEffect(()=>{const j=async()=>{const P=new Date,V=new Date(P.getFullYear(),P.getMonth(),1).toISOString().split("T")[0],G=P.toISOString().split("T")[0],{data:q}=await T.from("deliveries").select("produktivitaet_stops, date").gte("date",V).lte("date",G).eq("deleted",0).not("produktivitaet_stops","is",null),x=(q==null?void 0:q.reduce((A,m)=>A+(m.produktivitaet_stops||0),0))||0,L=[...new Set((q==null?void 0:q.map(A=>A.date))||[])];b(x),M(L.length)},_=async()=>{const P=new Date,V=new Date(P.getFullYear(),0,1).toISOString().split("T")[0],G=P.toISOString().split("T")[0],{data:q}=await T.from("deliveries").select("produktivitaet_stops, date").gte("date",V).lte("date",G).eq("deleted",0).not("produktivitaet_stops","is",null),x=(q==null?void 0:q.reduce((A,m)=>A+(m.produktivitaet_stops||0),0))||0,L=[...new Set((q==null?void 0:q.map(A=>A.date))||[])];S(x),v(L.length)};j(),_()},[]),h.useEffect(()=>{const j=()=>{const P=new Date().getHours();P>=5&&P<8?u("sunrise"):P>=8&&P<12?u("default"):P>=12&&P<17?u("afternoon"):P>=17&&P<20?u("evening"):u("night")};j();const _=setInterval(j,6e4);return()=>clearInterval(_)},[]);const r=i==="night",E=(y==null?void 0:y.dailyStops)||0,$=300,w=$-E,d=(E/$*100).toFixed(2),I=[{title:"Danas - Stops",value:`${E} / ${$} (${d}%)`,subtitle:"Zbir stopova od zadnjeg dana za sve vozaƒçe",icon:re,gradient:"from-green-500 to-emerald-500",showSubtitle:!0},{title:"Fali do cilja",value:w>0?w:0,subtitle:`Cilj: ${$} stopova`,icon:ne,gradient:"from-red-500 to-orange-500",showSubtitle:!0},{title:"Extra Vo≈ænje",value:(y==null?void 0:y.extraRides)||0,subtitle:`${(y==null?void 0:y.pendingRides)||0} na ƒçekanju`,icon:Ue,gradient:"from-purple-500 to-pink-500",showSubtitle:!0},{title:"Uspje≈°nost",value:`${(y==null?void 0:y.successRate)||0}%`,subtitle:"Realizovano vo≈ænji",icon:me,gradient:"from-orange-500 to-red-500",showSubtitle:!0}];if(t)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ae,{className:`w-12 h-12 mx-auto mb-4 animate-spin ${r?"text-blue-400":"text-blue-600"}`}),e.jsx("p",{className:`text-lg ${r?"text-gray-400":"text-gray-600"}`,children:"Uƒçitavanje podataka..."})]})});if(a)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(_e,{className:"w-12 h-12 mx-auto mb-4 text-red-500"}),e.jsxs("p",{className:`text-lg ${r?"text-gray-400":"text-gray-600"}`,children:["Gre≈°ka pri uƒçitavanju: ",a]}),l&&e.jsx("button",{onClick:l,className:"mt-4 px-6 py-2 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-all",children:"Poku≈°aj ponovo"})]})});let O=null;if(p==="today")O=e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsx(s.div,{className:`relative overflow-hidden rounded-lg sm:rounded-xl p-3 sm:p-4 ${r?"bg-gray-800/50":"bg-white"} backdrop-blur-xl shadow-lg border ${r?"border-gray-700":"border-gray-100"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br from-green-500 to-emerald-500 flex-shrink-0",children:e.jsx(re,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-xs font-medium ${r?"text-gray-400":"text-gray-600"}`,children:"Stops"}),e.jsx("p",{className:`text-lg sm:text-xl font-bold ${r?"text-white":"text-gray-900"} truncate`,children:E})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Zbir stopova"}),e.jsx("p",{className:`text-xs font-semibold ${r?"text-blue-400":"text-blue-600"}`,children:y!=null&&y.latestDate?new Date(y.latestDate).toLocaleDateString("bs-BA",{day:"2-digit",month:"2-digit",year:"numeric"}):"danas"})]})]})}),e.jsx(s.div,{className:`relative overflow-hidden rounded-lg sm:rounded-xl p-3 sm:p-4 ${r?"bg-gray-800/50":"bg-white"} backdrop-blur-xl shadow-lg border ${r?"border-gray-700":"border-gray-100"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br from-blue-500 to-indigo-600 flex-shrink-0",children:e.jsx(te,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-xs font-medium ${r?"text-gray-400":"text-gray-600"}`,children:"Cilj"}),e.jsx("p",{className:`text-lg sm:text-xl font-bold ${r?"text-white":"text-gray-900"} truncate`,children:"300"})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Cilj za 4 ture"}),e.jsx("p",{className:"text-xs text-gray-500",children:"je 300"})]})]})}),e.jsx(s.div,{className:`relative overflow-hidden rounded-lg sm:rounded-xl p-3 sm:p-4 ${r?"bg-gray-800/50":"bg-white"} backdrop-blur-xl shadow-lg border ${r?"border-gray-700":"border-gray-100"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg bg-gradient-to-br ${w>0?"from-red-500 to-orange-500":"from-green-500 to-emerald-500"} flex-shrink-0`,children:e.jsx(ne,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-xs font-medium ${r?"text-gray-400":"text-gray-600"}`,children:"Potrebno do cilja"}),e.jsx("p",{className:`text-lg sm:text-xl font-bold ${w>0?"text-red-600":"text-green-600"} truncate`,children:w>0?`-${w}`:w<0?`+${Math.abs(w)}`:0})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsx("p",{className:"text-xs text-gray-500",children:(w>0,"≈°topovi")}),e.jsx("p",{className:"text-xs text-gray-500",children:w>0?"u minusu":"u plusu"})]})]})}),e.jsx(s.div,{className:`relative overflow-hidden rounded-lg sm:rounded-xl p-3 sm:p-4 ${r?"bg-gray-800/50":"bg-white"} backdrop-blur-xl shadow-lg border ${r?"border-gray-700":"border-gray-100"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br from-orange-500 to-red-500 flex-shrink-0",children:e.jsx(me,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-xs font-medium ${r?"text-gray-400":"text-gray-600"}`,children:"Uspje≈°nost"}),e.jsxs("p",{className:`text-lg sm:text-xl font-bold ${r?"text-white":"text-gray-900"} truncate`,children:[d,"%"]})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Uspjeh"}),e.jsx("p",{className:"text-xs text-gray-500",children:"u postotku"})]})]})})]});else if(p==="month"){const j=z*300,_=j-g,P=j>0?(g/j*100).toFixed(2):0;O=e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsx(s.div,{className:`relative overflow-hidden rounded-lg sm:rounded-xl p-3 sm:p-4 ${r?"bg-gray-800/50":"bg-white"} backdrop-blur-xl shadow-lg border ${r?"border-gray-700":"border-gray-100"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br from-blue-500 to-indigo-600 flex-shrink-0",children:e.jsx(re,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-xs font-medium ${r?"text-gray-400":"text-gray-600"}`,children:"Stops"}),e.jsx("p",{className:`text-lg sm:text-xl font-bold ${r?"text-white":"text-gray-900"} truncate`,children:g})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Zbir stopova"}),e.jsx("p",{className:`text-xs font-semibold ${r?"text-blue-400":"text-blue-600"}`,children:["Januar","Februar","Mart","April","Maj","Jun","Jul","Avgust","Septembar","Oktobar","Novembar","Decembar"][new Date().getMonth()]})]})]})}),e.jsx(s.div,{className:`relative overflow-hidden rounded-lg sm:rounded-xl p-3 sm:p-4 ${r?"bg-gray-800/50":"bg-white"} backdrop-blur-xl shadow-lg border ${r?"border-gray-700":"border-gray-100"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br from-green-500 to-emerald-500 flex-shrink-0",children:e.jsx(te,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-xs font-medium ${r?"text-gray-400":"text-gray-600"}`,children:"Cilj"}),e.jsx("p",{className:`text-lg sm:text-xl font-bold ${r?"text-white":"text-gray-900"} truncate`,children:j})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsxs("p",{className:"text-xs text-gray-500",children:[z," dana"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"√ó 300"})]})]})}),e.jsx(s.div,{className:`relative overflow-hidden rounded-lg sm:rounded-xl p-3 sm:p-4 ${r?"bg-gray-800/50":"bg-white"} backdrop-blur-xl shadow-lg border ${r?"border-gray-700":"border-gray-100"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg bg-gradient-to-br ${_>0?"from-red-500 to-orange-500":"from-green-500 to-emerald-500"} flex-shrink-0`,children:e.jsx(ne,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-xs font-medium ${r?"text-gray-400":"text-gray-600"}`,children:"Potrebno do cilja"}),e.jsx("p",{className:`text-lg sm:text-xl font-bold ${_>0?"text-red-600":"text-green-600"} truncate`,children:_>0?`-${_}`:_<0?`+${Math.abs(_)}`:0})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsx("p",{className:"text-xs text-gray-500",children:(_>0,"≈°topovi")}),e.jsx("p",{className:"text-xs text-gray-500",children:_>0?"u minusu":"u plusu"})]})]})}),e.jsx(s.div,{className:`relative overflow-hidden rounded-lg sm:rounded-xl p-3 sm:p-4 ${r?"bg-gray-800/50":"bg-white"} backdrop-blur-xl shadow-lg border ${r?"border-gray-700":"border-gray-100"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br from-orange-500 to-red-500 flex-shrink-0",children:e.jsx(me,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-xs font-medium ${r?"text-gray-400":"text-gray-600"}`,children:"Uspje≈°nost"}),e.jsxs("p",{className:`text-lg sm:text-xl font-bold ${r?"text-white":"text-gray-900"} truncate`,children:[P,"%"]})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Uspjeh"}),e.jsx("p",{className:"text-xs text-gray-500",children:"u postotku"})]})]})})]})}else if(p==="year"){const j=N*300,_=j-k,P=j>0?(k/j*100).toFixed(2):0;O=e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsx(s.div,{className:`relative overflow-hidden rounded-lg sm:rounded-xl p-3 sm:p-4 ${r?"bg-gray-800/50":"bg-white"} backdrop-blur-xl shadow-lg border ${r?"border-gray-700":"border-gray-100"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br from-purple-500 to-pink-500 flex-shrink-0",children:e.jsx(re,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-xs font-medium ${r?"text-gray-400":"text-gray-600"}`,children:"Stops"}),e.jsx("p",{className:`text-lg sm:text-xl font-bold ${r?"text-white":"text-gray-900"} truncate`,children:k})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Zbir stopova"}),e.jsxs("p",{className:`text-xs font-semibold ${r?"text-blue-400":"text-blue-600"}`,children:[new Date().getFullYear(),". godina"]})]})]})}),e.jsx(s.div,{className:`relative overflow-hidden rounded-lg sm:rounded-xl p-3 sm:p-4 ${r?"bg-gray-800/50":"bg-white"} backdrop-blur-xl shadow-lg border ${r?"border-gray-700":"border-gray-100"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br from-green-500 to-emerald-500 flex-shrink-0",children:e.jsx(te,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-xs font-medium ${r?"text-gray-400":"text-gray-600"}`,children:"Cilj"}),e.jsx("p",{className:`text-lg sm:text-xl font-bold ${r?"text-white":"text-gray-900"} truncate`,children:j})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsxs("p",{className:"text-xs text-gray-500",children:[N," dana"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"√ó 300"})]})]})}),e.jsx(s.div,{className:`relative overflow-hidden rounded-lg sm:rounded-xl p-3 sm:p-4 ${r?"bg-gray-800/50":"bg-white"} backdrop-blur-xl shadow-lg border ${r?"border-gray-700":"border-gray-100"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg bg-gradient-to-br ${_>0?"from-red-500 to-orange-500":"from-green-500 to-emerald-500"} flex-shrink-0`,children:e.jsx(ne,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-xs font-medium ${r?"text-gray-400":"text-gray-600"}`,children:"Potrebno do cilja"}),e.jsx("p",{className:`text-lg sm:text-xl font-bold ${_>0?"text-red-600":"text-green-600"} truncate`,children:_>0?`-${_}`:_<0?`+${Math.abs(_)}`:0})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsx("p",{className:"text-xs text-gray-500",children:(_>0,"≈°topovi")}),e.jsx("p",{className:"text-xs text-gray-500",children:_>0?"u minusu":"u plusu"})]})]})}),e.jsx(s.div,{className:`relative overflow-hidden rounded-lg sm:rounded-xl p-3 sm:p-4 ${r?"bg-gray-800/50":"bg-white"} backdrop-blur-xl shadow-lg border ${r?"border-gray-700":"border-gray-100"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br from-orange-500 to-red-500 flex-shrink-0",children:e.jsx(me,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-xs font-medium ${r?"text-gray-400":"text-gray-600"}`,children:"Uspje≈°nost"}),e.jsxs("p",{className:`text-lg sm:text-xl font-bold ${r?"text-white":"text-gray-900"} truncate`,children:[P,"%"]})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Uspjeh"}),e.jsx("p",{className:"text-xs text-gray-500",children:"u postotku"})]})]})})]})}else O=e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:I.map((j,_)=>e.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:_*.1},className:`relative overflow-hidden rounded-2xl p-6 ${r?"bg-gray-800/50":"bg-white"} backdrop-blur-xl shadow-xl border ${r?"border-gray-700":"border-gray-100"}`,children:[e.jsx("div",{className:`absolute top-0 right-0 w-24 h-24 bg-gradient-to-br ${j.gradient} opacity-10 rounded-full blur-2xl`}),e.jsx("div",{className:`inline-flex p-3 rounded-xl bg-gradient-to-br ${j.gradient} mb-4`,children:e.jsx(j.icon,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"relative",children:[e.jsx("p",{className:`text-sm font-medium ${r?"text-gray-400":"text-gray-600"}`,children:j.title}),e.jsx("p",{className:`text-3xl font-bold mt-2 ${r?"text-white":"text-gray-900"}`,children:j.value}),j.showSubtitle&&e.jsx("p",{className:"text-xs mt-2 text-gray-500",children:j.subtitle})]})]},j.title))});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(s.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:`flex flex-col sm:flex-row items-start sm:items-center justify-between p-4 sm:p-6 rounded-2xl ${r?"bg-gray-800/50":"bg-white/50"} backdrop-blur-xl border ${r?"border-gray-700":"border-white/20"} shadow-xl gap-4 sm:gap-0`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(s.div,{animate:{scale:[1,1.1,1]},transition:{duration:2,repeat:1/0},className:"p-2 sm:p-3 rounded-xl bg-gradient-to-r from-blue-500 to-indigo-600",children:e.jsx(Se,{className:"w-5 h-5 sm:w-6 sm:h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:`text-xl sm:text-2xl font-bold ${r?"text-white":"text-gray-800"}`,children:"Dashboard Pregled"}),e.jsx("p",{className:`text-xs sm:text-sm ${r?"text-gray-400":"text-gray-600"}`,children:y!=null&&y.latestDate?`Zadnje a≈æurirano: ${new Date(y.latestDate).toLocaleDateString("bs-BA")}`:"Pregled statistika"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 w-full sm:w-auto",children:[e.jsx("div",{className:"flex gap-1 sm:gap-2 flex-1 sm:flex-none",children:["today","month","year"].map(j=>e.jsx(s.button,{onClick:()=>f(j),whileHover:{scale:1.05},whileTap:{scale:.95},className:`px-3 py-2 sm:px-4 sm:py-2 rounded-lg sm:rounded-xl font-medium transition-all text-sm sm:text-base flex-1 sm:flex-none ${p===j?r?"bg-gradient-to-r from-blue-600 to-indigo-600 text-white":"bg-gradient-to-r from-blue-500 to-indigo-600 text-white":r?"bg-gray-700 text-gray-300 hover:bg-gray-600":"bg-white/60 text-gray-700 hover:bg-white/80"}`,children:j==="today"?"Danas":j==="month"?"Mjesec":"Godina"},j))}),l&&e.jsx(s.button,{onClick:l,whileHover:{scale:1.05,rotate:180},whileTap:{scale:.95},className:`p-2 sm:p-3 rounded-lg sm:rounded-xl ${r?"bg-gray-700 text-white hover:bg-gray-600":"bg-white text-gray-800 hover:bg-gray-50"} transition-all shadow-lg`,children:e.jsx(ae,{className:"w-4 h-4 sm:w-5 sm:h-5"})})]})]}),O]})};function Ot({drivers:y,currentTheme:n="default"}){const[t,a]=h.useState({drivers:[],total:0}),[l,i]=h.useState(!0),[u,p]=h.useState(new Date().getFullYear()),f=n==="night",g=new Date().getFullYear(),b=Array.from({length:g-2019},(S,z)=>2020+z);h.useEffect(()=>{const S=async()=>{i(!0);try{const{getPayrollAnalytics:z}=await X(async()=>{const{getPayrollAnalytics:v}=await import("./chunk-v4-1760899745229-DO-YtAxd.js");return{getPayrollAnalytics:v}},__vite__mapDeps([7,4,2,3,1])),M=await z(u),N=[...M.drivers].sort((v,r)=>(r.cost||0)-(v.cost||0));a({...M,drivers:N})}catch{a({drivers:[],total:0})}finally{i(!1)}};y.length>0&&S()},[y,u]);const k=async()=>{i(!0);try{const{refreshAllPayrolls:S}=await X(async()=>{const{refreshAllPayrolls:v}=await import("./chunk-v4-1760899745229-Dq2jMYX_.js");return{refreshAllPayrolls:v}},__vite__mapDeps([8,4,2,3,1,6]));await S();const{getPayrollAnalytics:z}=await X(async()=>{const{getPayrollAnalytics:v}=await import("./chunk-v4-1760899745229-DO-YtAxd.js");return{getPayrollAnalytics:v}},__vite__mapDeps([7,4,2,3,1])),M=await z(u),N=[...M.drivers].sort((v,r)=>(r.cost||0)-(v.cost||0));a({...M,drivers:N})}catch(S){alert("Gre≈°ka u batch refresh: "+((S==null?void 0:S.message)||S))}finally{i(!1)}};return e.jsx(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.2},className:"p-6",children:e.jsxs("div",{className:`rounded-2xl ${f?"bg-gray-800/50":"bg-white/50"} backdrop-blur-xl border ${f?"border-gray-700":"border-white/20"} shadow-xl p-6`,children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(s.div,{animate:{rotate:[0,360]},transition:{duration:20,repeat:1/0,ease:"linear"},className:"p-2 sm:p-3 rounded-lg sm:rounded-xl bg-gradient-to-r from-emerald-500 to-teal-600",children:e.jsx(Pe,{className:"w-5 h-5 sm:w-6 sm:h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:`text-xl sm:text-2xl font-bold ${f?"text-white":"text-gray-800"}`,children:"Tro≈°kovi firme po vozaƒçu"}),e.jsxs("p",{className:`text-xs sm:text-sm ${f?"text-gray-400":"text-gray-600"}`,children:["Godina: ",u]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 w-full sm:w-auto",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1 sm:flex-none",children:[e.jsx(Me,{className:`w-4 h-4 ${f?"text-gray-400":"text-gray-600"}`}),e.jsx("select",{value:u,onChange:S=>p(Number(S.target.value)),className:`flex-1 sm:flex-none px-3 py-2 rounded-lg sm:rounded-xl font-medium transition-all text-sm sm:text-base ${f?"bg-gray-700 text-white border-gray-600":"bg-white text-gray-800 border-gray-200"} border focus:outline-none focus:ring-2 focus:ring-emerald-500`,children:b.map(S=>e.jsx("option",{value:S,children:S},S))})]}),e.jsxs(s.button,{onClick:k,disabled:l,whileHover:{scale:1.05},whileTap:{scale:.95},className:`flex items-center gap-2 px-3 py-2 sm:px-4 sm:py-2 rounded-lg sm:rounded-xl font-medium transition-all text-sm sm:text-base ${l?"opacity-50 cursor-not-allowed":f?"bg-gradient-to-r from-emerald-600 to-teal-600 text-white hover:from-emerald-500 hover:to-teal-500":"bg-gradient-to-r from-emerald-500 to-teal-600 text-white hover:from-emerald-400 hover:to-teal-500"} shadow-lg flex-shrink-0`,children:[e.jsx(ae,{className:`w-4 h-4 ${l?"animate-spin":""}`}),e.jsx("span",{className:"hidden sm:inline",children:"Refresh"})]})]})]}),l?e.jsxs(s.div,{initial:{opacity:0},animate:{opacity:1},className:"flex flex-col items-center justify-center py-12",children:[e.jsx(ae,{className:`w-12 h-12 mb-4 animate-spin ${f?"text-emerald-400":"text-emerald-600"}`}),e.jsx("span",{className:`text-lg ${f?"text-gray-300":"text-gray-600"}`,children:"Uƒçitavanje podataka..."})]}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-6",children:[e.jsx("div",{className:"lg:col-span-2 grid gap-3 sm:gap-4",children:t.drivers.map((S,z)=>e.jsx(s.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:z*.05},className:`p-3 sm:p-4 rounded-lg sm:rounded-xl ${f?"bg-gray-700/50 hover:bg-gray-700/70":"bg-white/60 hover:bg-white/80"} backdrop-blur-sm border ${f?"border-gray-600":"border-white/40"} transition-all hover:scale-[1.02] hover:shadow-lg`,children:e.jsxs("div",{className:"flex items-center gap-3 sm:gap-4",children:[e.jsx("div",{className:"p-2 sm:p-3 rounded-lg bg-gradient-to-br from-blue-500 to-indigo-600 flex-shrink-0",children:e.jsx(K,{className:"w-4 h-4 sm:w-6 sm:h-6 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:`text-xs sm:text-sm ${f?"text-gray-400":"text-gray-600"}`,children:"Ukupni tro≈°ak za"}),e.jsx("div",{className:`font-semibold text-sm sm:text-base ${f?"text-white":"text-gray-800"} capitalize truncate`,children:S.name})]}),e.jsxs("div",{className:`text-base sm:text-xl font-bold ${f?"text-emerald-400":"text-emerald-600"} flex-shrink-0`,children:[(S.cost!==void 0?S.cost:0).toLocaleString("de-DE",{minimumFractionDigits:2})," ‚Ç¨"]})]})},S.name))}),e.jsxs(s.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.3},className:`p-4 sm:p-6 rounded-xl sm:rounded-2xl bg-gradient-to-br ${f?"from-emerald-900/50 to-teal-900/50 border-emerald-700/50":"from-emerald-50 to-teal-50 border-emerald-200/50"} border-2 flex flex-col justify-center items-center text-center`,children:[e.jsx(s.div,{animate:{scale:[1,1.1,1]},transition:{duration:2,repeat:1/0},className:"p-3 sm:p-4 rounded-full bg-gradient-to-br from-emerald-500 to-teal-600 mb-3 sm:mb-4",children:e.jsx(Pe,{className:"w-6 h-6 sm:w-10 sm:h-10 text-white"})}),e.jsx("div",{className:`text-xs sm:text-sm font-medium mb-2 ${f?"text-gray-300":"text-gray-600"}`,children:"Ukupni tro≈°ak za sve vozaƒçe"}),e.jsxs("div",{className:`text-xl sm:text-3xl font-bold ${f?"text-white":"text-gray-900"}`,children:[t.total.toLocaleString("de-DE",{minimumFractionDigits:2})," ‚Ç¨"]})]})]})]})})}function Rt({currentTheme:y="default"}){const[n,t]=h.useState("send"),[a,l]=h.useState(""),[i,u]=h.useState("BD Evidencija"),[p,f]=h.useState("all"),[g,b]=h.useState(!1),[k,S]=h.useState(null),[z,M]=h.useState(null),[N,v]=h.useState(!1),[r,E]=h.useState(!1),[$,w]=h.useState(!1),d=y==="night",I=()=>{Y.showDebugPanel(),Y.testAllMethods()},O=async()=>{Y.isVisible||Y.showDebugPanel();try{Y.log("üß™ Starting direct notification test...","info");const m=await ee.sendDirectNotifications({title:"Test Direct",message:"Ovo je test direktne notifikacije!",targetType:"all"});Y.log(`üß™ Test result: ${m.success?"SUCCESS":"FAILED"}`,m.success?"success":"error"),S({success:m.success,message:m.success?"Test direktne notifikacije uspe≈°an!":"Test direktne notifikacije neuspe≈°an!",details:m})}catch(m){Y.log(`üß™ Test ERROR: ${m.message}`,"error"),S({success:!1,message:"Gre≈°ka pri testu direktnih notifikacija",details:m.message})}},j=async()=>{if(alert("Test Server Push button clicked - check console!"),!ee.sendServerPushOnly){alert("ERROR: sendServerPushOnly function not found!"),S({success:!1,message:"sendServerPushOnly funkcija nije dostupna",details:"Function not exported or imported correctly"});return}try{Y.showDebugPanel(),await new Promise(m=>setTimeout(m,500))}catch(m){alert("Visual debugger error: "+m.message)}try{"Notification"in window&&Notification.permission==="granted"&&new Notification("Server Push Test",{body:"Starting server push test...",icon:"/bde-evidencija/icon-192x192.png"}),Y.log("üåê Starting server-side push test...","info");const m=await ee.sendServerPushOnly({title:"Server Push Test",message:"Ovo je test server-side push notifikacije za sve ureƒëaje!",targetType:"all"});alert("Server push completed! Result: "+JSON.stringify(m)),Y.log(`üåê Server push result: ${m.success?"SUCCESS":"FAILED"}`,m.success?"success":"error"),Y.log(`üìä Sent: ${m.sent}, Failed: ${m.failed}, Method: ${m.method}`,"info"),"Notification"in window&&Notification.permission==="granted"&&new Notification("Server Push Result",{body:`${m.success?"SUCCESS":"FAILED"} - Sent: ${m.sent}`,icon:"/bde-evidencija/icon-192x192.png"}),S({success:m.success,message:m.success?"Server push test uspe≈°an!":"Server push test neuspe≈°an!",details:m})}catch(m){alert("Server push error: "+m.message),Y.log(`üåê Server push ERROR: ${m.message}`,"error"),S({success:!1,message:"Gre≈°ka pri server push testu",details:m.message})}},_=async()=>{try{alert("üîç Proveravam push pretplate...");const m=await navigator.serviceWorker.getRegistration();if(!m){alert("‚ùå Service Worker nije registrovan!");return}const o=await m.pushManager.getSubscription();if(!o){alert("‚ùå Nema aktivne push pretplate na ovom ureƒëaju!");return}alert("‚úÖ Lokalna pretplata pronaƒëena, proveravam bazu...");try{const R=await ee.getSimpleStats();if(alert(`üìä Ukupno pretplata u bazi: ${(R==null?void 0:R.totalSubscriptions)||0}`),!R||!R.totalSubscriptions||R.totalSubscriptions===0){alert("üîß Nema pretplata u bazi - registruj push notifikacije prvo!");const c=await xe.requestPermissionAndRegister("admin","debug-fix");c.success?alert("‚úÖ Push notifikacije registrovane! Poku≈°aj ponovo server push test."):alert(`‚ùå Gre≈°ka pri registraciji: ${c.reason}`)}else alert(`‚úÖ Ima ${R.totalSubscriptions} pretplata u bazi. Edge Function radi ali mo≈æda nema aktivnih korisnika.`)}catch(R){alert(`‚ùå Gre≈°ka pri ƒçitanju baze: ${R.message}`)}window.debugger&&window.debugger.log("Subscriptions Check:",{local:!!o,serviceWorker:!!m})}catch(m){alert(`‚ùå Gre≈°ka pri proveri pretplata: ${m.message}`)}},P=async()=>{try{if(alert("üîß FORSIRAM registraciju trenutnog ureƒëaja..."),!navigator.serviceWorker||!("PushManager"in window)){alert("‚ùå Browser ne podr≈æava push notifikacije!");return}const m=await navigator.serviceWorker.getRegistration();if(!m){alert("‚ùå Service Worker nije registrovan!");return}const o=await m.pushManager.getSubscription();if(!o){alert("‚ùå Nema push pretplate na ovom ureƒëaju!");return}alert("‚úÖ Na≈°ao push pretplatu, forsiram upis u bazu...");const R=o.toJSON(),c={driver_id:2,driver_tura:"admin",endpoint:o.endpoint,p256dh_key:R.keys.p256dh,auth_key:R.keys.auth,user_agent:navigator.userAgent,platform:navigator.platform,browser:"Chrome",active:!0,created_at:new Date().toISOString()},{supabase:C}=await X(async()=>{const{supabase:U}=await import("./chunk-v4-1760899745229-BX32o4Tt.js").then(B=>B.f);return{supabase:U}},__vite__mapDeps([4,2,3,1])),{data:D,error:F}=await C.from("push_subscriptions").upsert(c,{onConflict:"endpoint",ignoreDuplicates:!1}).select();if(F){alert(`‚ùå Gre≈°ka pri upisu u bazu: ${F.message}`);return}alert(`‚úÖ USPE≈†NO! Registracija upisana u bazu: ${JSON.stringify(D)}`),alert("üß™ Testiram server push sa novom registracijom...");const H=await ee.sendServerPushOnly({title:"üéâ FORSIRANA REGISTRACIJA",message:"Test nakon forsiranje registracije - treba da radi!",targetType:"all"});alert(`üìä Test rezultat: ${JSON.stringify(H)}`)}catch(m){alert(`‚ùå Gre≈°ka pri forsirajnju: ${m.message}`)}};h.useEffect(()=>{V(),n==="stats"&&q()},[n]);const V=async()=>{const m=await xe.checkRegistrationStatus("admin");E(m)},G=async()=>{w(!0);try{const m=await xe.requestPermissionAndRegister("admin","admin");m.success?(E(!0),S({success:!0,message:"Push notifikacije aktivirane! üéâ",details:"Sada ƒáete dobijati notifikacije."})):S({success:!1,message:"Gre≈°ka pri aktivaciji push notifikacija",details:m.reason})}catch(m){S({success:!1,message:"Gre≈°ka pri registraciji",details:m.message})}finally{w(!1)}},q=async()=>{v(!0);try{const m=await ee.getSimpleStats();M(m)}catch{}finally{v(!1)}},x=async()=>{if(a.trim()){b(!0),S(null);try{const m=await ee.sendCustomMessage({title:i||"BD Evidencija",message:a.trim(),targetType:p});S({success:!0,message:"Poruka uspje≈°no poslana!",details:m}),l("")}catch(m){S({success:!1,message:"Gre≈°ka pri slanju poruke",details:m.message})}finally{b(!1)}}},L=["Nova platna lista je dostupna! üí∞","Sistemi ƒáe biti u odr≈æavanju veƒçeras od 22:00 üîß","Hvala svima na odliƒçnom radu ovog mjeseca! üôè","Nova a≈æuriranja su dostupna u aplikaciji üì±"],A=[{id:"send",label:"Po≈°alji poruku",icon:ve},{id:"stats",label:"Statistike",icon:Se},{id:"debug",label:"Debug System",icon:je}];return e.jsxs("div",{className:`min-h-screen p-6 ${d?"bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900 text-white":"bg-gradient-to-br from-blue-50 to-indigo-100 text-gray-800"}`,children:[e.jsx(s.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-8",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:`p-3 rounded-full ${d?"bg-purple-500/20 text-purple-300":"bg-purple-100 text-purple-600"}`,children:e.jsx(oe,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Push Notifikacije"}),e.jsx("p",{className:`text-sm ${d?"text-gray-300":"text-gray-600"}`,children:"Po≈°aljite poruke svim vozaƒçima"})]})]})}),e.jsx("div",{className:"flex space-x-1 mb-6",children:A.map(m=>e.jsxs("button",{onClick:()=>t(m.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-all ${n===m.id?d?"bg-purple-500 text-white shadow-lg shadow-purple-500/25":"bg-purple-600 text-white shadow-lg":d?"bg-white/10 text-gray-300 hover:bg-white/20":"bg-white text-gray-600 hover:bg-gray-50"}`,children:[e.jsx(m.icon,{className:"w-4 h-4"}),m.label]},m.id))}),e.jsxs(s.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.2},children:[n==="send"&&e.jsxs("div",{className:"space-y-6",children:[!r&&e.jsx(s.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:`p-4 rounded-lg border-2 border-dashed ${d?"border-yellow-400/50 bg-yellow-400/10 text-yellow-300":"border-yellow-400 bg-yellow-50 text-yellow-700"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ne,{className:"w-6 h-6 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold mb-1",children:"Push notifikacije nisu aktivne"}),e.jsx("p",{className:"text-sm mb-3",children:"Da biste primili push notifikacije, morate ih prvo aktivirati u browseru."}),e.jsx("button",{onClick:G,disabled:$,className:`px-4 py-2 rounded-lg font-medium transition-all flex items-center gap-2 ${$?"bg-gray-400 text-gray-600 cursor-not-allowed":"bg-yellow-500 text-white hover:bg-yellow-600"}`,children:$?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),"Aktiviranje..."]}):e.jsxs(e.Fragment,{children:[e.jsx(oe,{className:"w-4 h-4"}),"Aktiviraj push notifikacije"]})})]})]})}),e.jsxs("div",{className:`p-6 rounded-xl shadow-lg ${d?"bg-white/5 border border-white/10":"bg-white border border-gray-200"}`,children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(ve,{className:"w-5 h-5"}),"Nova poruka"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-1 ${d?"text-gray-300":"text-gray-700"}`,children:"Naslov poruke"}),e.jsx("input",{type:"text",value:i,onChange:m=>u(m.target.value),className:`w-full p-3 rounded-lg border transition-colors ${d?"bg-white/5 border-white/20 text-white placeholder-gray-400":"bg-white border-gray-300 text-gray-900"}`,placeholder:"BD Evidencija"})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-1 ${d?"text-gray-300":"text-gray-700"}`,children:"Sadr≈æaj poruke"}),e.jsx("textarea",{value:a,onChange:m=>l(m.target.value),rows:4,className:`w-full p-3 rounded-lg border transition-colors resize-none ${d?"bg-white/5 border-white/20 text-white placeholder-gray-400":"bg-white border-gray-300 text-gray-900"}`,placeholder:"Unesite va≈°u poruku ovdje..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-1 ${d?"text-gray-300":"text-gray-700"}`,children:"Po≈°alji"}),e.jsxs("select",{value:p,onChange:m=>f(m.target.value),className:`w-full p-3 rounded-lg border ${d?"bg-white/5 border-white/20 text-white":"bg-white border-gray-300 text-gray-900"}`,children:[e.jsx("option",{value:"all",children:"Svim korisnicima"}),e.jsx("option",{value:"drivers",children:"Samo vozaƒçima"}),e.jsx("option",{value:"admins",children:"Samo admin-ima"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:x,disabled:!a.trim()||g,className:`flex-1 py-3 px-4 rounded-lg font-medium transition-all flex items-center justify-center gap-2 ${!a.trim()||g?d?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-gradient-to-r from-purple-500 to-pink-500 text-white hover:from-purple-600 hover:to-pink-600 shadow-lg hover:shadow-xl"}`,children:g?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),"Slanje..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ve,{className:"w-4 h-4"}),"Po≈°alji poruku"]})}),r&&e.jsxs("button",{onClick:()=>xe.sendTestNotification(),className:`px-4 py-3 rounded-lg font-medium transition-all flex items-center gap-2 ${d?"bg-blue-500/20 text-blue-300 hover:bg-blue-500/30 border border-blue-500/30":"bg-blue-50 text-blue-600 hover:bg-blue-100 border border-blue-200"}`,children:[e.jsx(ge,{className:"w-4 h-4"}),"Test"]})]})]})]}),e.jsxs("div",{className:`p-6 rounded-xl shadow-lg ${d?"bg-white/5 border border-white/10":"bg-white border border-gray-200"}`,children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Brze poruke"}),e.jsx("div",{className:"grid gap-2",children:L.map((m,o)=>e.jsx("button",{onClick:()=>l(m),className:`text-left p-3 rounded-lg transition-colors ${d?"bg-white/5 hover:bg-white/10 text-gray-300":"bg-gray-50 hover:bg-gray-100 text-gray-700"}`,children:m},o))})]}),k&&e.jsx(s.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:`p-4 rounded-lg ${k.success?"bg-green-500/20 border border-green-500/30 text-green-300":"bg-red-500/20 border border-red-500/30 text-red-300"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:k.message})]})})]}),n==="stats"&&e.jsxs("div",{className:`p-6 rounded-xl shadow-lg ${d?"bg-white/5 border border-white/10":"bg-white border border-gray-200"}`,children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Se,{className:"w-5 h-5"}),"Push Notification Statistike"]}),N?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-purple-500 border-t-transparent"})}):z?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:`p-4 rounded-lg ${d?"bg-white/5":"bg-gray-50"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(K,{className:"w-5 h-5 text-blue-500"}),e.jsx("span",{className:"font-medium",children:"Aktivni korisnici"})]}),e.jsx("div",{className:"text-2xl font-bold",children:z.activeUsers||0})]}),e.jsxs("div",{className:`p-4 rounded-lg ${d?"bg-white/5":"bg-gray-50"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(oe,{className:"w-5 h-5 text-purple-500"}),e.jsx("span",{className:"font-medium",children:"Poslano danas"})]}),e.jsx("div",{className:"text-2xl font-bold",children:z.sentToday||0})]}),e.jsxs("div",{className:`p-4 rounded-lg ${d?"bg-white/5":"bg-gray-50"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ge,{className:"w-5 h-5 text-green-500"}),e.jsx("span",{className:"font-medium",children:"Ukupno poslano"})]}),e.jsx("div",{className:"text-2xl font-bold",children:z.totalSent||0})]})]}):e.jsx("div",{className:`text-center py-8 ${d?"text-gray-400":"text-gray-600"}`,children:"Nema dostupnih statistika"})]}),n==="debug"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:`p-6 rounded-lg ${d?"bg-white/5 border border-white/10":"bg-white border border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(je,{className:"w-6 h-6 text-orange-500"}),e.jsx("h3",{className:"text-xl font-semibold",children:"Push System Debug"})]}),e.jsx("p",{className:`mb-4 ${d?"text-gray-300":"text-gray-600"}`,children:"Testira sve komponente push notifikacija sistema i prikazuje detaljnu dijagnostiku."}),e.jsx(s.button,{onClick:I,whileHover:{scale:1.02},whileTap:{scale:.98},className:`w-full py-3 px-4 rounded-lg font-medium transition-all mb-3 ${d?"bg-orange-500 hover:bg-orange-600 text-white":"bg-orange-600 hover:bg-orange-700 text-white"} shadow-lg hover:shadow-xl`,children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(je,{className:"w-5 h-5"}),"Otvori Visual Debugger"]})}),e.jsx(s.button,{onClick:()=>O(),whileHover:{scale:1.02},whileTap:{scale:.98},className:`w-full py-3 px-4 rounded-lg font-medium transition-all mb-3 ${d?"bg-green-500 hover:bg-green-600 text-white":"bg-green-600 hover:bg-green-700 text-white"} shadow-lg hover:shadow-xl`,children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(oe,{className:"w-5 h-5"}),"Test Direktne Notifikacije (lokalno)"]})}),e.jsx(s.button,{onClick:()=>j(),whileHover:{scale:1.02},whileTap:{scale:.98},className:`w-full py-3 px-4 rounded-lg font-medium transition-all mb-3 ${d?"bg-blue-500 hover:bg-blue-600 text-white":"bg-blue-600 hover:bg-blue-700 text-white"} shadow-lg hover:shadow-xl`,children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(K,{className:"w-5 h-5"}),"Test Server Push (svi ureƒëaji)"]})}),e.jsx(s.button,{onClick:()=>_(),whileHover:{scale:1.02},whileTap:{scale:.98},className:`w-full py-3 px-4 rounded-lg font-medium transition-all mb-3 ${d?"bg-purple-500 hover:bg-purple-600 text-white":"bg-purple-600 hover:bg-purple-700 text-white"} shadow-lg hover:shadow-xl`,children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(ge,{className:"w-5 h-5"}),"Proveri i Popravi Pretplate"]})}),e.jsx(s.button,{onClick:()=>P(),whileHover:{scale:1.02},whileTap:{scale:.98},className:`w-full py-3 px-4 rounded-lg font-medium transition-all ${d?"bg-red-500 hover:bg-red-600 text-white":"bg-red-600 hover:bg-red-700 text-white"} shadow-lg hover:shadow-xl`,children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(oe,{className:"w-5 h-5"}),"üîß FORSIRAJ Registraciju"]})}),e.jsxs("div",{className:`mt-4 p-4 rounded-lg ${d?"bg-orange-500/10 border border-orange-500/20":"bg-orange-50 border border-orange-200"}`,children:[e.jsx("h4",{className:"font-semibold mb-2 text-orange-600",children:"≈†ta debugger testira:"}),e.jsxs("ul",{className:`text-sm space-y-1 ${d?"text-gray-300":"text-gray-600"}`,children:[e.jsx("li",{children:"‚Ä¢ Browser Notification API (desktop/mobile kompatibilnost)"}),e.jsx("li",{children:"‚Ä¢ Service Worker registracija i funkcionalnost"}),e.jsx("li",{children:"‚Ä¢ Push subscription status u bazi podataka"}),e.jsx("li",{children:"‚Ä¢ VAPID kljuƒçevi i konfiguraciju"}),e.jsx("li",{children:"‚Ä¢ AutoPushService komunikaciju"})]})]})]})})]},n)]})}const Ie=[{id:"dashboard",label:"Dashboard",icon:at,component:"dashboard",description:"Pregled sistema u realnom vremenu",gradient:"from-blue-500 to-purple-600"},{id:"users",label:"Vozaƒçi",icon:K,component:_t,description:"Upravljanje vozaƒçima i korisnicima",gradient:"from-green-500 to-teal-600"},{id:"rides",label:"Vo≈ænje",icon:Ue,component:St,description:"Extra vo≈ænje i odobravanja",gradient:"from-orange-500 to-red-600"},{id:"push",label:"Push Notifikacije",icon:oe,component:Rt,description:"Po≈°aljite push poruke vozaƒçima",gradient:"from-purple-500 to-pink-600"},{id:"settings",label:"Sistem",icon:Be,component:Tt,description:"Sistemske postavke i konfiguracija",gradient:"from-purple-500 to-pink-600"},{id:"github",label:"GitHub",icon:$e,component:Et,description:"GitHub integracija i verzije",gradient:"from-gray-600 to-gray-800"}];function It(){const[y,n]=h.useState("dashboard"),[t,a]=h.useState(!1),[l,i]=h.useState("night"),u=rt(),{currentUser:p,logout:f,changePassword:g}=it(),b=Le(),{drivers:k}=b,{stats:S,loading:z,error:M,refetch:N}=Pt(k),v={night:{background:"from-slate-900 via-blue-900 to-indigo-900",accent:"from-blue-400 to-purple-400"}};h.useEffect(()=>{i("night")},[]);const r=l==="night",E=()=>{const $=Ie.find(w=>w.id===y);if(y==="dashboard")return e.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:[e.jsx(zt,{data:S,drivers:k,loading:z,error:M,onRefresh:N}),e.jsx(Ot,{drivers:k,currentTheme:l})]},"dashboard");if($!=null&&$.component&&typeof $.component!="string"){const w=$.component;return $.id==="github"||$.id==="custom-push"?e.jsx(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:e.jsx(w,{currentTheme:l})},y):e.jsx(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:e.jsx(w,{driversHook:b,drivers:k})},y)}return e.jsx(s.div,{initial:{opacity:0},animate:{opacity:1},className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:`text-center ${r?"text-gray-400":"text-gray-600"}`,children:[e.jsx(ge,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),e.jsxs("p",{className:"text-lg",children:['Tab "',y,'" nije implementiran']})]})},"not-implemented")};return e.jsxs("div",{className:`min-h-screen bg-gradient-to-br ${v[l].background} transition-all duration-1000`,children:[e.jsxs("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:[e.jsx(s.div,{animate:{scale:[1,1.2,1],rotate:[0,90,0]},transition:{duration:20,repeat:1/0,ease:"linear"},className:`absolute top-20 left-10 w-96 h-96 bg-gradient-to-r ${v[l].accent} rounded-full mix-blend-multiply filter blur-3xl opacity-20`}),e.jsx(s.div,{animate:{scale:[1.2,1,1.2],rotate:[90,0,90]},transition:{duration:25,repeat:1/0,ease:"linear"},className:`absolute bottom-20 right-10 w-96 h-96 bg-gradient-to-r ${v[l].accent} rounded-full mix-blend-multiply filter blur-3xl opacity-20`})]}),e.jsxs("div",{className:"relative z-10",children:[e.jsx(s.header,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:`sticky top-0 z-50 backdrop-blur-xl ${r?"bg-gray-900/80":"bg-white/80"} border-b ${r?"border-gray-700":"border-gray-200"}`,children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(s.button,{onClick:()=>u(-1),whileHover:{scale:1.05},whileTap:{scale:.95},className:`p-2 rounded-xl ${r?"bg-gray-800 text-white hover:bg-gray-700":"bg-white text-gray-800 hover:bg-gray-50"} shadow-lg transition-all`,children:e.jsx(et,{className:"w-6 h-6"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(s.div,{animate:{rotate:[0,360]},transition:{duration:20,repeat:1/0,ease:"linear"},className:`p-3 rounded-xl bg-gradient-to-r ${v[l].accent}`,children:e.jsx(tt,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:`text-2xl font-bold ${r?"text-white":"text-gray-800"}`,children:"Admin Panel"}),e.jsx("p",{className:`text-sm ${r?"text-gray-400":"text-gray-600"}`,children:"Upravljanje sistemom"})]})]})]}),e.jsx(ot,{user:p,onChangePassword:()=>a(!0),onLogout:f,currentTheme:l,themes:v})]}),e.jsx("nav",{className:"mt-6 flex gap-2 overflow-x-auto pb-2 scrollbar-hide",children:Ie.map(({id:$,label:w,icon:d,description:I,gradient:O})=>{const j=y===$;return e.jsxs(s.button,{onClick:()=>n($),whileHover:{scale:1.02,y:-2},whileTap:{scale:.98},className:`relative px-4 py-3 rounded-xl flex items-center gap-2 font-medium transition-all ${j?`bg-gradient-to-r ${O} text-white shadow-lg`:r?"bg-gray-800/50 text-gray-300 hover:bg-gray-700/50":"bg-white/50 text-gray-700 hover:bg-white/80"}`,title:I,children:[e.jsx(d,{className:"w-5 h-5"}),e.jsx("span",{className:"whitespace-nowrap",children:w}),j&&e.jsx(s.div,{layoutId:"activeTab",className:"absolute inset-0 rounded-xl border-2 border-white/30",transition:{type:"spring",bounce:.2,duration:.6}})]},$)})})]})}),e.jsx("main",{className:"max-w-7xl mx-auto px-4 py-6",children:e.jsx(He,{mode:"wait",children:E()})})]}),e.jsx(nt,{isOpen:t,onClose:()=>a(!1),onChangePassword:g,loading:!1})]})}const qt=Object.freeze(Object.defineProperty({__proto__:null,default:It},Symbol.toStringTag,{value:"Module"}));export{Lt as A,qt as a,Le as u};

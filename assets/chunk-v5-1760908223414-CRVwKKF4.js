const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/chunk-v5-1760908223414-bFjT9cHD.js","assets/chunk-v5-1760908223414-DzTHeiPn.js","assets/chunk-v5-1760908223414-BQZtm19x.js","assets/chunk-v5-1760908223414-Dlb8a0CI.js","assets/chunk-v5-1760908223414-fR8G6j7r.js","assets/chunk-v5-1760908223414-BaSNy0Ok.js","assets/chunk-v5-1760908223414-DR1PuY8k.js"])))=>i.map(i=>d[i]);
import{j as e,X as Be,m as r,v as ve,F as He,c as re,w as ee,U as Z,x as Me,y as we,u as fe,o as te,S as de,E as Ue,z as ge,B as Fe,D as Ce,G as Le,H as Te,J as xe,O as ze,A as Ee,R as Q,Q as me,V as ue,Y as Ne,Z as Ge,_ as Ve,$ as be,b as Oe,f as Pe,a0 as qe,e as oe,T as Ae,g as ce,h as Je,a1 as ke,i as Ye,C as Ke,a2 as We}from"./chunk-v5-1760908223414-Dlb8a0CI.js";import{r as d,a as Ze,u as Qe}from"./chunk-v5-1760908223414-DzTHeiPn.js";import{s as H}from"./chunk-v5-1760908223414-bFjT9cHD.js";import{f as ne}from"./chunk-v5-1760908223414-67jeV4qK.js";import{_ as se}from"./chunk-v5-1760908223414-BQZtm19x.js";import{u as Xe,U as et,C as tt}from"./chunk-v5-1760908223414-BysMqPZw.js";class at{constructor(){this.syncInProgress=new Set}async syncUserToDriver(x){if(this.syncInProgress.has(x))return console.log(`Skipping sync for ${x} - already in progress`),!1;this.syncInProgress.add(x);try{const{data:t,error:n}=await H.from("app_users").select("tura, ime, role, active, last_login").eq("tura",x).single();if(n)return console.error("Error fetching user:",n),!1;if(!t)return console.warn(`User ${x} not found in app_users`),!1;const{data:o,error:y}=await H.from("drivers").select("id, tura, ime, aktivan, target_per_day").eq("tura",x).eq("deleted",0).maybeSingle();if(y)return console.error("Error checking driver:",y),!1;const b={tura:t.tura,ime:t.ime,aktivan:t.active,role:t.role,last_login:t.last_login,last_updated:new Date};if(t&&t.device_id!==void 0&&(b.device_id=t.device_id),o){const{error:w}=await H.from("drivers").update(b).eq("id",o.id);if(w)return console.error("Error updating driver:",w),!1;console.log(`Synced user ${x} to existing driver record`)}else{const w={...b,target_per_day:0,deleted:0},{error:k}=await H.from("drivers").insert([w]);if(k)return console.error("Error creating driver:",k),!1;console.log(`Created new driver record for user ${x}`)}return!0}catch(t){return console.error("Sync error:",t),!1}finally{this.syncInProgress.delete(x)}}async syncDriverToUser(x,t){try{const n={};if(t.ime&&(n.ime=t.ime),t.role&&(n.role=t.role),t.aktivan!==void 0&&(n.active=t.aktivan),t.device_id!==void 0&&(n.device_id=t.device_id),Object.keys(n).length===0)return!0;n.updated_at=new Date;const{error:o}=await H.from("app_users").update(n).eq("tura",x);return o?(console.error("Error syncing driver to user:",o),!1):(console.log(`Synced driver ${x} changes back to app_users`),!0)}catch(n){return console.error("Sync driver to user error:",n),!1}}async syncAllUsers(){try{const{data:x,error:t}=await H.from("app_users").select("tura").eq("active",!0);if(t)return console.error("Error fetching all users:",t),!1;const n=x.map(k=>this.syncUserToDriver(k.tura)),y=(await Promise.allSettled(n)).map((k,p)=>{var _;return{tura:(_=x[p])==null?void 0:_.tura,status:k.status,value:k.status==="fulfilled"?k.value:void 0,reason:k.status==="rejected"?k.reason&&k.reason.message||k.reason:void 0}}),b=y.filter(k=>k.status==="fulfilled"&&k.value).length,w=y.length;return console.log("Bulk sync detailed results:",y),console.log(`Bulk sync completed: ${b}/${w} users synced`),{successful:b,total:w,success:b===w,details:y}}catch(x){return console.error("Bulk sync error:",x),!1}}async getCombinedUserData(x){try{const[t,n]=await Promise.all([H.from("app_users").select("*").eq("tura",x).single(),H.from("drivers").select("*").eq("tura",x).eq("deleted",0).single()]),o=t.data,y=n.data;return o?{id:o.id,tura:o.tura,ime:o.ime,role:o.role,active:o.active,password_hash:o.password_hash,device_id:o.device_id,last_login:o.last_login,businessId:y==null?void 0:y.id,aktivan:(y==null?void 0:y.aktivan)??o.active,target_per_day:(y==null?void 0:y.target_per_day)??0,last_updated:y==null?void 0:y.last_updated,hasBusiness:!!y,syncNeeded:o.active!==(y==null?void 0:y.aktivan)}:(console.warn(`No auth data found for ${x}`),null)}catch(t){return console.error("Error getting combined data:",t),null}}}const he=new at;function Ie(){const[c,x]=d.useState([]),[t,n]=d.useState(!0),[o,y]=d.useState(null),b=d.useCallback(async()=>{n(!0),y(null);try{const{data:f,error:u}=await H.from("drivers").select("*").eq("deleted",0).order("target_per_day",{ascending:!1}).order("tura");if(u)throw u;const a=(f==null?void 0:f.map(v=>({id:v.id,tura:v.tura,ime:v.ime,target_per_day:v.target_per_day||0,aktivan:v.aktivan,role:v.role||"driver",password_hash:v.password_hash||"",last_login:v.last_login,last_updated:v.last_updated,deleted:v.deleted||0,name:v.ime,tour:v.tura,active:v.aktivan})))||[],S=["8610","8620","8630","8640"];a.sort((v,h)=>{const g=S.indexOf(String(v.tura)),T=S.indexOf(String(h.tura));if(g!==-1||T!==-1)return g===-1?1:T===-1?-1:g-T;const D=String(v.tura||""),m=String(h.tura||"");return D.localeCompare(m,void 0,{numeric:!0})}),x(a),console.log("useDrivers: drivers loaded",{count:a.length})}catch(f){y(f),x([])}finally{n(!1)}},[]),w=d.useCallback(async f=>{try{const u={ime:f.ime,tura:f.tura,aktivan:f.aktivan??!0,target_per_day:f.target_per_day||0,password_hash:f.password_hash||null,role:f.role||"driver",last_updated:new Date,deleted:0},{data:a,error:S}=await H.from("drivers").insert([u]).select();if(S)throw S;return await he.syncDriverToUser(f.tura,{ime:f.ime,role:f.role,aktivan:f.aktivan}),await b(),a[0]}catch(u){throw y(u),u}},[b]),k=d.useCallback(async(f,u)=>{try{const a={ime:u.ime,tura:u.tura,aktivan:u.aktivan,target_per_day:u.target_per_day||0,password_hash:u.password_hash,role:u.role||"driver",last_updated:new Date},{data:S,error:v}=await H.from("drivers").update(a).eq("id",f).select();if(v)throw v;return S&&S.length>0&&await he.syncDriverToUser(S[0].tura,{ime:u.ime,role:u.role,aktivan:u.aktivan}),await b(),S[0]}catch(a){throw y(a),a}},[b]),p=d.useCallback(async f=>{try{const{error:u}=await H.from("drivers").update({deleted:1,last_updated:new Date}).eq("id",f);if(u)throw u;await b()}catch(u){throw y(u),u}},[b]),_=d.useCallback(async(f,u)=>{try{const{data:a,error:S}=await H.from("drivers").update({aktivan:!u,last_updated:new Date}).eq("id",f).select();if(S)throw S;a&&a.length>0&&await he.syncDriverToUser(a[0].tura,{aktivan:!u}),await b()}catch(a){throw y(a),a}},[b]),O=d.useCallback(async(f,u)=>{try{const{error:a}=await H.from("drivers").update({target_per_day:u,last_updated:new Date}).eq("tura",f).eq("deleted",0);if(a)throw a;return await b(),!0}catch(a){throw y(a),a}},[b]),P=d.useCallback(f=>c.find(u=>u.tura===f&&!u.deleted),[c]),B=d.useCallback(()=>c.filter(f=>f.aktivan&&!f.deleted),[c]),F=d.useCallback(()=>c.filter(f=>f.aktivan&&!f.deleted&&f.target_per_day>0),[c]);return d.useEffect(()=>{b()},[b]),{drivers:c,loading:t,error:o,addDriver:w,updateDriver:k,deleteDriver:p,toggleDriverStatus:_,updateDriverTarget:O,getDriverByTura:P,getActiveDrivers:B,getDriversWithTargets:F,refresh:b}}const ie=({open:c,title:x,children:t,loading:n,onSubmit:o,onClose:y,submitLabel:b="Sačuvaj",closeLabel:w="Otkaži",showActions:k=!0})=>(d.useEffect(()=>{if(c){const p=window.scrollY;return document.body.style.position="fixed",document.body.style.top=`-${p}px`,document.body.style.left="0",document.body.style.right="0",document.body.style.overflow="hidden",document.body.style.width="100%",()=>{document.body.style.position="",document.body.style.top="",document.body.style.left="",document.body.style.right="",document.body.style.overflow="",document.body.style.width="",window.scrollTo(0,p)}}},[c]),c?Ze.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm z-[9999]",style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:9999},children:e.jsx("div",{className:"absolute inset-0 flex items-start justify-center p-2 sm:p-4 pt-4 sm:pt-8",style:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"flex-start",justifyContent:"center",paddingTop:"2rem"},children:e.jsxs("div",{className:"bg-white/10 backdrop-blur-md rounded-2xl w-full max-w-md sm:max-w-3xl max-h-[90vh] sm:max-h-[92vh] overflow-hidden shadow-2xl border border-white/20 animate-in fade-in-0 zoom-in-95 duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 sm:p-6 border-b border-white/10 flex-shrink-0",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-bold text-white",children:x}),e.jsx("button",{onClick:y,className:"flex items-center justify-center w-8 h-8 rounded-full bg-white/10 hover:bg-white/20 transition-colors duration-200 text-white hover:scale-110",children:e.jsx(Be,{className:"w-4 h-4"})})]}),e.jsxs("form",{onSubmit:p=>{p.preventDefault(),o&&o()},className:"flex flex-col max-h-full",children:[e.jsx("div",{className:"p-4 sm:p-6 overflow-y-auto flex-1 min-h-0 max-h-[calc(90vh-140px)] sm:max-h-[calc(92vh-140px)]",children:t}),k&&e.jsxs("div",{className:"flex justify-end gap-3 p-4 sm:p-6 border-t border-white/10 bg-black/10 flex-shrink-0",children:[e.jsx("button",{type:"button",onClick:y,disabled:n,className:"px-6 py-2.5 bg-white/10 hover:bg-white/20 text-white rounded-xl font-medium transition-colors duration-200 border border-white/20 disabled:opacity-50",children:w}),e.jsxs("button",{type:"submit",disabled:n,className:"px-6 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-medium transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[n&&e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),b]})]})]})]})})}),document.body):null),rt=c=>{const[x,t]=d.useState(!1);return d.useEffect(()=>{const n=window.matchMedia(c);n.matches!==x&&t(n.matches);const o=()=>t(n.matches);return n.addEventListener("change",o),()=>n.removeEventListener("change",o)},[x,c]),x},$e=({status:c,children:x})=>{const t={pending:{colors:"bg-yellow-500/20 text-yellow-300 border-yellow-500/30",hoverColors:"hover:bg-yellow-500/30 hover:border-yellow-400/50",pulse:"animate-pulse"},approved:{colors:"bg-green-500/20 text-green-300 border-green-500/30",hoverColors:"hover:bg-green-500/30 hover:border-green-400/50",pulse:""},rejected:{colors:"bg-red-500/20 text-red-300 border-red-500/30",hoverColors:"hover:bg-red-500/30 hover:border-red-400/50",pulse:""}},n=t[c]||t.pending;return e.jsx(r.span,{className:`px-3 py-1 rounded-full text-xs font-semibold border transition-all duration-300 cursor-default ${n.colors} ${n.hoverColors} ${n.pulse}`,whileHover:{scale:1.05,y:-1},whileTap:{scale:.95},initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{type:"spring",stiffness:300,damping:20},children:x})},ae=({onClick:c,bgColor:x,children:t,disabled:n=!1})=>e.jsx(r.button,{whileHover:{scale:n?1:1.05,y:n?0:-1,boxShadow:n?"none":"0 8px 25px rgba(0,0,0,0.15)"},whileTap:{scale:n?1:.95,y:n?0:1},onClick:c,disabled:n,className:`px-4 py-2 rounded-lg text-white text-sm font-medium transition-all duration-200 shadow-md ${n?"opacity-50 cursor-not-allowed":"hover:shadow-lg"}`,style:{backgroundColor:n?"#9CA3AF":x},initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{type:"spring",stiffness:300,damping:20},children:t}),Se=({icon:c,text:x,subtext:t})=>e.jsxs(r.div,{initial:{opacity:0,y:20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.9},transition:{type:"spring",stiffness:300,damping:20,duration:.5},className:"text-center py-12",children:[e.jsx(r.div,{className:"text-5xl mb-3",animate:{scale:[1,1.1,1],rotate:[0,5,-5,0]},transition:{duration:2,repeat:1/0,repeatType:"reverse",ease:"easeInOut"},children:c}),e.jsx(r.p,{className:"text-lg font-semibold text-gray-300 mb-1",initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:x}),e.jsx(r.p,{className:"text-sm text-gray-500",initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},children:t})]}),st=()=>{const[c,x]=d.useState("default");d.useEffect(()=>{const l=()=>{const z=new Date().getHours();z>=5&&z<8?x("sunrise"):z>=8&&z<12?x("default"):z>=12&&z<17?x("afternoon"):z>=17&&z<20?x("evening"):x("night")};l();const M=setInterval(l,6e4);return()=>clearInterval(M)},[]);const t=c==="night",n=rt("(min-width: 768px)"),[o,y]=d.useState([]),[b,w]=d.useState([]),[k,p]=d.useState(!0),[_,O]=d.useState(null),[P,B]=d.useState(!1),[F,f]=d.useState(!1),[u,a]=d.useState(null),[S,v]=d.useState({driver:"",date:"",tura:"",plz:"",broj_adresa:"",cijena:"",notes:""}),[h,g]=d.useState(ne(new Date,"yyyy-MM")),T=o.length+b.length,D=o.length,m=b.length,j=d.useCallback(async()=>{p(!0);try{const[l,M]=h.split("-"),z=new Date(parseInt(l),parseInt(M)-1,1),V=new Date(parseInt(l),parseInt(M),0),s=ne(z,"yyyy-MM-dd"),I=ne(V,"yyyy-MM-dd");console.log("📅 [RidesTab] Date range:",s,"to",I);const{data:i,error:N}=await H.from("extra_rides").select("*").gte("date",s).lte("date",I).eq("status","approved").order("date",{ascending:!1}),{data:$,error:E}=await H.from("extra_rides_pending").select("*").gte("date",s).lte("date",I).eq("status","pending").order("date",{ascending:!1});N&&console.error("Error fetching approved rides:",N),E&&console.error("❌ [RidesTab] Error fetching pending rides:",E);const R=($||[]).map(A=>({id:A.id,vozac:A.driver,datum:ne(new Date(A.date),"dd.MM.yyyy"),tura:A.tura,plz:A.plz,brojAdresa:A.broj_adresa,cijena:`${A.cijena}€`,status:A.status,napomena:A.notes||""})),U=(i||[]).map(A=>({id:A.id,vozac:A.driver,datum:ne(new Date(A.date),"dd.MM.yyyy"),tura:A.tura,plz:A.plz,brojAdresa:A.broj_adresa,cijena:`${A.cijena}€`,status:"approved",napomena:A.notes||""}));y(R),w(U)}catch(l){console.error("❌ [RidesTab] Error fetching rides:",l),y([]),w([])}finally{p(!1)}},[h]);d.useEffect(()=>{j()},[j]);const C=async l=>{try{if(!o.find(i=>i.id===l))return;const{data:z,error:V}=await H.from("extra_rides_pending").select("*").eq("id",l).single();if(V)throw V;const{error:s}=await H.from("extra_rides").insert([{date:z.date,driver:z.driver,tura:z.tura,plz:z.plz,broj_adresa:z.broj_adresa,cijena:z.cijena,notes:z.notes,plz_price:z.plz_price,adresa_price:z.adresa_price,created_by:z.created_by,status:"approved",approved_by:"Admin",approved_at:new Date().toISOString(),original_id:z.original_id}]);if(s)throw s;const{error:I}=await H.from("extra_rides_pending").delete().eq("id",l);if(I)throw I;await j(),alert("Vožnja je uspešno odobrena!")}catch(M){console.error("❌ [RidesTab] Error approving ride:",M),alert("Greška pri odobravanju vožnje: "+M.message)}},G=async l=>{try{const{error:M}=await H.from("extra_rides_pending").update({status:"rejected"}).eq("id",l);if(M)throw M;await j(),alert("Vožnja je odbijena!")}catch(M){console.error("❌ [RidesTab] Error rejecting ride:",M),alert("Greška pri odbijanju vožnje: "+M.message)}},q=(l,M=!0)=>{console.log("📝 [RidesTab] Opening edit modal for ride:",l),a({...l,isPending:M}),v({driver:l.vozac,date:l.datum.split(".").reverse().join("-"),tura:l.tura,plz:l.plz,broj_adresa:l.brojAdresa,cijena:parseFloat(l.cijena.replace("€","")),notes:l.napomena||""}),f(!0)},L=async()=>{if(u)try{console.log("💾 [RidesTab] Saving ride edit:",S);const l={driver:S.driver,date:S.date,tura:S.tura,plz:S.plz,broj_adresa:parseInt(S.broj_adresa),cijena:parseFloat(S.cijena),notes:S.notes,last_updated:new Date().toISOString()},M=u.isPending?"extra_rides_pending":"extra_rides",{error:z}=await H.from(M).update(l).eq("id",u.id);if(z)throw z;f(!1),a(null),await j(),alert("Vožnja je uspešno izmenjena!")}catch(l){console.error("❌ [RidesTab] Error saving ride edit:",l),alert("Greška pri čuvanju izmena: "+l.message)}};return e.jsxs(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:`p-4 sm:p-6 rounded-2xl ${t?"bg-gray-800/50":"bg-white/50"} backdrop-blur-xl border ${t?"border-gray-700":"border-white/20"} shadow-xl`,children:[e.jsxs(r.div,{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.4},children:[e.jsxs(r.div,{className:"flex items-center gap-3",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1},children:[e.jsx(r.div,{whileHover:{scale:1.1,rotate:[0,-10,10,-10,0],transition:{duration:.5}},whileTap:{scale:.95},className:"p-2 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl shadow-lg",children:e.jsx(ve,{className:"w-6 h-6 text-white"})}),e.jsxs(r.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},children:[e.jsx("h2",{className:`text-xl sm:text-2xl font-bold ${t?"text-white":"text-gray-900"}`,children:"Extra vožnje"}),e.jsx("p",{className:`text-sm ${t?"text-gray-400":"text-gray-600"}`,children:"Odobravanje i upravljanje vožnjama"})]})]}),e.jsxs(r.div,{className:"flex items-center gap-3",initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.2},children:[e.jsx(r.div,{whileHover:{scale:1.1,rotate:180},transition:{type:"spring",stiffness:300},children:e.jsx(He,{className:`w-4 h-4 ${t?"text-gray-400":"text-gray-600"}`})}),e.jsx(r.input,{type:"month",value:h,onChange:l=>g(l.target.value),whileFocus:{scale:1.02},className:`px-4 py-2 rounded-xl border-2 transition-all duration-200 ${t?"bg-gray-800/50 border-gray-600 text-white focus:border-blue-400":"bg-white/80 border-gray-200 text-gray-900 focus:border-blue-500"} focus:outline-none focus:ring-2 focus:ring-blue-500/20 hover:shadow-md`})]})]}),e.jsxs(r.div,{className:"grid grid-cols-3 gap-2 sm:gap-4 mb-6",variants:{show:{transition:{staggerChildren:.1}}},initial:"hidden",animate:"show",children:[e.jsx(r.div,{variants:{hidden:{opacity:0,y:20,scale:.8},show:{opacity:1,y:0,scale:1}},whileHover:{scale:1.05,y:-3,transition:{type:"spring",stiffness:400,damping:10}},whileTap:{scale:.95},className:`p-3 sm:p-4 rounded-xl ${t?"bg-gray-700/50":"bg-white/70"} backdrop-blur-sm border ${t?"border-gray-600":"border-white/30"} cursor-pointer transition-all duration-300 hover:shadow-lg`,children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"p-1.5 sm:p-2 rounded-lg bg-gradient-to-br from-blue-500 to-indigo-500",children:e.jsx(ve,{className:"w-4 h-4 sm:w-5 sm:h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:`text-lg sm:text-2xl font-bold ${t?"text-white":"text-gray-900"}`,children:T}),e.jsx("p",{className:`text-xs sm:text-sm ${t?"text-gray-400":"text-gray-600"}`,children:"Ukupno"})]})]})}),e.jsx(r.div,{variants:{hidden:{opacity:0,y:20,scale:.8},show:{opacity:1,y:0,scale:1}},whileHover:{scale:1.05,y:-3,transition:{type:"spring",stiffness:400,damping:10}},whileTap:{scale:.95},className:`p-3 sm:p-4 rounded-xl ${t?"bg-gray-700/50":"bg-white/70"} backdrop-blur-sm border ${t?"border-gray-600":"border-white/30"} cursor-pointer transition-all duration-300 hover:shadow-lg`,children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"p-1.5 sm:p-2 rounded-lg bg-gradient-to-br from-yellow-500 to-orange-500",children:e.jsx(re,{className:"w-4 h-4 sm:w-5 sm:h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:`text-lg sm:text-2xl font-bold ${t?"text-white":"text-gray-900"}`,children:D}),e.jsx("p",{className:`text-xs sm:text-sm ${t?"text-gray-400":"text-gray-600"}`,children:"Pending"})]})]})}),e.jsx(r.div,{variants:{hidden:{opacity:0,y:20,scale:.8},show:{opacity:1,y:0,scale:1}},whileHover:{scale:1.05,y:-3,transition:{type:"spring",stiffness:400,damping:10}},whileTap:{scale:.95},className:`p-3 sm:p-4 rounded-xl ${t?"bg-gray-700/50":"bg-white/70"} backdrop-blur-sm border ${t?"border-gray-600":"border-white/30"} cursor-pointer transition-all duration-300 hover:shadow-lg`,children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"p-1.5 sm:p-2 rounded-lg bg-gradient-to-br from-green-500 to-emerald-500",children:e.jsx(ee,{className:"w-4 h-4 sm:w-5 sm:h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:`text-lg sm:text-2xl font-bold ${t?"text-white":"text-gray-900"}`,children:m}),e.jsx("p",{className:`text-xs sm:text-sm ${t?"text-gray-400":"text-gray-600"}`,children:"Odobreno"})]})]})})]}),e.jsxs(r.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:[e.jsx("h3",{className:`text-lg font-bold mb-3 ${t?"text-white":"text-gray-900"}`,children:"⏳ Vožnje na čekanju"}),k?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(r.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:`inline-block text-3xl ${t?"text-white":"text-gray-900"}`,children:"🔄"}),e.jsx("p",{className:`mt-2 ${t?"text-gray-400":"text-gray-600"}`,children:"Učitavanje..."})]}):o.length===0?e.jsx(Se,{icon:e.jsx("span",{children:"✅"}),text:"Nema vožnji na čekanju",subtext:"Sve vožnje su obrađene."}):e.jsx(r.div,{className:"grid grid-cols-1 gap-3 mb-6",variants:{show:{transition:{staggerChildren:.1}}},initial:"hidden",animate:"show",children:o.map((l,M)=>e.jsxs(r.div,{variants:{hidden:{opacity:0,x:-20,scale:.95},show:{opacity:1,x:0,scale:1}},whileHover:{scale:1.02,y:-2,transition:{type:"spring",stiffness:300}},whileTap:{scale:.98},className:`p-4 rounded-xl border backdrop-blur-sm cursor-pointer transition-all duration-300 ${t?"bg-yellow-500/10 border-yellow-500/30 hover:bg-yellow-500/20 hover:border-yellow-400/50":"bg-yellow-50 border-yellow-200 hover:bg-yellow-100 hover:border-yellow-300"} hover:shadow-lg`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("span",{className:`font-bold text-base ${t?"text-white":"text-gray-900"}`,children:["👤 ",l.vozac]}),e.jsx($e,{status:l.status,children:"⏳ Pending"})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 mb-3",children:[e.jsxs("div",{className:`text-sm ${t?"text-gray-300":"text-gray-700"}`,children:[e.jsx("span",{className:"opacity-70",children:"📅"})," ",e.jsx("strong",{children:l.datum})]}),e.jsxs("div",{className:`text-sm ${t?"text-gray-300":"text-gray-700"}`,children:[e.jsx("span",{className:"opacity-70",children:"🚛"})," ",e.jsx("strong",{children:l.tura})]}),e.jsxs("div",{className:`text-sm ${t?"text-gray-300":"text-gray-700"}`,children:[e.jsx("span",{className:"opacity-70",children:"📍"})," ",e.jsx("strong",{children:l.plz})]}),e.jsxs("div",{className:`text-sm ${t?"text-gray-300":"text-gray-700"}`,children:[e.jsx("span",{className:"opacity-70",children:"🏠"})," ",e.jsx("strong",{children:l.brojAdresa})]}),e.jsxs("div",{className:`text-sm ${t?"text-gray-300":"text-gray-700"}`,children:[e.jsx("span",{className:"opacity-70",children:"💰"})," ",e.jsx("strong",{children:l.cijena})]})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx(ae,{onClick:()=>C(l.id),bgColor:"#28a745",children:"✅ Odobri"}),e.jsx(ae,{onClick:()=>G(l.id),bgColor:"#dc3545",children:"❌ Odbij"}),e.jsx(ae,{onClick:()=>q(l,!0),bgColor:"#ffc107",children:"✏️ Uredi"}),e.jsx(ae,{onClick:()=>{O(l),B(!0)},bgColor:"#007bff",children:"📋 Detalji"})]})]},l.id))})]}),e.jsxs(r.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},children:[e.jsx("h3",{className:`text-lg font-bold mb-3 mt-6 ${t?"text-white":"text-gray-900"}`,children:"✅ Odobrene vožnje"}),b.length===0?e.jsx(Se,{icon:e.jsx("span",{children:"📋"}),text:"Nema odobrenih vožnji",subtext:"Za odabrani mesec."}):e.jsx(r.div,{className:`grid ${n?"grid-cols-2":"grid-cols-1"} gap-3`,variants:{show:{transition:{staggerChildren:.08}}},initial:"hidden",animate:"show",children:b.map((l,M)=>e.jsxs(r.div,{variants:{hidden:{opacity:0,y:20,scale:.95},show:{opacity:1,y:0,scale:1}},whileHover:{scale:1.02,y:-2,transition:{type:"spring",stiffness:300}},whileTap:{scale:.98},className:`p-4 rounded-xl border backdrop-blur-sm cursor-pointer transition-all duration-300 ${t?"bg-green-500/10 border-green-500/30 hover:bg-green-500/20 hover:border-green-400/50":"bg-green-50 border-green-200 hover:bg-green-100 hover:border-green-300"} hover:shadow-lg`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("span",{className:`font-bold text-base ${t?"text-white":"text-gray-900"}`,children:["👤 ",l.vozac]}),e.jsx($e,{status:"approved",children:"✅ Odobreno"})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 mb-3",children:[e.jsxs("div",{className:`text-sm ${t?"text-gray-300":"text-gray-700"}`,children:["📅 ",l.datum]}),e.jsxs("div",{className:`text-sm ${t?"text-gray-300":"text-gray-700"}`,children:["🚛 ",l.tura]}),e.jsxs("div",{className:`text-sm ${t?"text-gray-300":"text-gray-700"}`,children:["📍 ",l.plz]}),e.jsxs("div",{className:`text-sm ${t?"text-gray-300":"text-gray-700"}`,children:["🏠 ",l.brojAdresa]}),e.jsxs("div",{className:`text-sm ${t?"text-gray-300":"text-gray-700"}`,children:["💰 ",l.cijena]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ae,{onClick:()=>q(l,!1),bgColor:"#ffc107",children:"✏️ Uredi"}),e.jsx(ae,{onClick:()=>{O(l),B(!0)},bgColor:"#007bff",children:"📋 Detalji"})]})]},l.id))})]}),e.jsx(ie,{open:P,title:"📋 Detalji vožnje",onClose:()=>B(!1),showActions:!1,children:_&&e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"grid grid-cols-[auto_1fr] gap-x-4 gap-y-2 items-center",children:[e.jsx("strong",{className:t?"text-white":"text-gray-900",children:"👤 Vozač:"}),e.jsx("span",{className:`${t?"text-gray-300":"text-gray-700"}`,children:_.vozac}),e.jsx("strong",{className:t?"text-white":"text-gray-900",children:"📅 Datum:"}),e.jsx("span",{className:`${t?"text-gray-300":"text-gray-700"}`,children:_.datum}),e.jsx("strong",{className:t?"text-white":"text-gray-900",children:"🚛 Tura:"}),e.jsx("span",{className:`${t?"text-gray-300":"text-gray-700"}`,children:_.tura}),e.jsx("strong",{className:t?"text-white":"text-gray-900",children:"📍 PLZ:"}),e.jsx("span",{className:`${t?"text-gray-300":"text-gray-700"}`,children:_.plz}),e.jsx("strong",{className:t?"text-white":"text-gray-900",children:"🏠 Broj adresa:"}),e.jsx("span",{className:`${t?"text-gray-300":"text-gray-700"}`,children:_.brojAdresa}),e.jsx("strong",{className:t?"text-white":"text-gray-900",children:"💰 Cijena:"}),e.jsx("span",{className:`${t?"text-gray-300":"text-gray-700"}`,children:_.cijena}),e.jsx("strong",{className:t?"text-white":"text-gray-900",children:"📊 Status:"}),e.jsx("span",{className:`${t?"text-gray-300":"text-gray-700"}`,children:_.status}),_.napomena&&e.jsxs(e.Fragment,{children:[e.jsx("strong",{className:t?"text-white":"text-gray-900",children:"📝 Napomena:"}),e.jsx("span",{className:`${t?"text-gray-300":"text-gray-700"}`,children:_.napomena})]})]})})}),e.jsx(ie,{open:F,title:`✏️ Uredi vožnju ${u!=null&&u.isPending?"(Pending)":"(Odobreno)"}`,onClose:()=>f(!1),onSubmit:L,loading:k,submitLabel:"💾 Sačuvaj promjene",closeLabel:"❌ Otkaži",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block mb-2 font-semibold ${t?"text-white":"text-gray-900"}`,children:"👤 Vozač:"}),e.jsx("input",{type:"text",value:S.driver,onChange:l=>v({...S,driver:l.target.value}),className:`w-full px-3 py-2 rounded-lg border-2 transition-all ${t?"bg-gray-800/50 border-gray-600 text-white focus:border-blue-400":"bg-white border-gray-300 text-gray-900 focus:border-blue-500"} focus:outline-none focus:ring-2 focus:ring-blue-500/20`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block mb-2 font-semibold ${t?"text-white":"text-gray-900"}`,children:"📅 Datum:"}),e.jsx("input",{type:"date",value:S.date,onChange:l=>v({...S,date:l.target.value}),className:`w-full px-3 py-2 rounded-lg border-2 transition-all ${t?"bg-gray-800/50 border-gray-600 text-white focus:border-blue-400":"bg-white border-gray-300 text-gray-900 focus:border-blue-500"} focus:outline-none focus:ring-2 focus:ring-blue-500/20`})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block mb-2 font-semibold ${t?"text-white":"text-gray-900"}`,children:"🚛 Tura:"}),e.jsx("input",{type:"text",value:S.tura,onChange:l=>v({...S,tura:l.target.value}),className:`w-full px-3 py-2 rounded-lg border-2 transition-all ${t?"bg-gray-800/50 border-gray-600 text-white focus:border-blue-400":"bg-white border-gray-300 text-gray-900 focus:border-blue-500"} focus:outline-none focus:ring-2 focus:ring-blue-500/20`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block mb-2 font-semibold ${t?"text-white":"text-gray-900"}`,children:"📍 PLZ:"}),e.jsx("input",{type:"text",value:S.plz,onChange:l=>v({...S,plz:l.target.value}),className:`w-full px-3 py-2 rounded-lg border-2 transition-all ${t?"bg-gray-800/50 border-gray-600 text-white focus:border-blue-400":"bg-white border-gray-300 text-gray-900 focus:border-blue-500"} focus:outline-none focus:ring-2 focus:ring-blue-500/20`})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block mb-2 font-semibold ${t?"text-white":"text-gray-900"}`,children:"🏠 Broj adresa:"}),e.jsx("input",{type:"number",min:"1",value:S.broj_adresa,onChange:l=>v({...S,broj_adresa:l.target.value}),className:`w-full px-3 py-2 rounded-lg border-2 transition-all ${t?"bg-gray-800/50 border-gray-600 text-white focus:border-blue-400":"bg-white border-gray-300 text-gray-900 focus:border-blue-500"} focus:outline-none focus:ring-2 focus:ring-blue-500/20`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block mb-2 font-semibold ${t?"text-white":"text-gray-900"}`,children:"💰 Cijena (€):"}),e.jsx("input",{type:"number",min:"0",step:"0.01",value:S.cijena,onChange:l=>v({...S,cijena:l.target.value}),className:`w-full px-3 py-2 rounded-lg border-2 transition-all ${t?"bg-gray-800/50 border-gray-600 text-white focus:border-blue-400":"bg-white border-gray-300 text-gray-900 focus:border-blue-500"} focus:outline-none focus:ring-2 focus:ring-blue-500/20`})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block mb-2 font-semibold ${t?"text-white":"text-gray-900"}`,children:"📝 Napomena:"}),e.jsx("textarea",{value:S.notes,onChange:l=>v({...S,notes:l.target.value}),rows:3,className:`w-full px-3 py-2 rounded-lg border-2 transition-all resize-vertical ${t?"bg-gray-800/50 border-gray-600 text-white focus:border-blue-400 placeholder-gray-500":"bg-white border-gray-300 text-gray-900 focus:border-blue-500 placeholder-gray-400"} focus:outline-none focus:ring-2 focus:ring-blue-500/20`,placeholder:"Dodajte napomenu..."})]})]})})]})},it=()=>{const[c,x]=d.useState("default");d.useEffect(()=>{const s=()=>{const i=new Date().getHours();i>=5&&i<8?x("sunrise"):i>=8&&i<12?x("default"):i>=12&&i<17?x("afternoon"):i>=17&&i<20?x("evening"):x("night")};s();const I=setInterval(s,6e4);return()=>clearInterval(I)},[]);const t=c==="night",{drivers:n,loading:o,error:y,addDriver:b,updateDriver:w,deleteDriver:k,toggleDriverStatus:p}=Ie(),[_,O]=d.useState(null),[P,B]=d.useState(!1),[F,f]=d.useState(!1),[u,a]=d.useState(!1),[S,v]=d.useState({}),[h,g]=d.useState({ime:"",tura:"",aktivan:!0,target_per_day:0,password_hash:"",role:"driver"}),[T,D]=d.useState(null),m=async(s,I)=>{try{await navigator.clipboard.writeText(s),D(I),setTimeout(()=>D(null),2e3)}catch(i){console.error("Failed to copy: ",i)}},j=s=>{v(I=>({...I,[s]:!I[s]}))},C=s=>{try{return atob(s)}catch{return s}},G=s=>{try{return btoa(s)}catch{return s}},q=async()=>{a(!0);try{const s={...h,password_hash:h.password_hash?G(h.password_hash):""};await b(s),f(!1),g({ime:"",tura:"",aktivan:!0,target_per_day:0,password_hash:"",role:"driver"})}catch(s){console.error("Greška pri dodavanju vozača:",s),alert("Greška pri dodavanju vozača: "+s.message)}finally{a(!1)}},L=async()=>{if(_){a(!0);try{const s={...h,password_hash:h.password_hash?G(h.password_hash):_.password_hash};await w(_.id,s),B(!1),O(null)}catch(s){console.error("Greška pri ažuriranju vozača:",s),alert("Greška pri ažuriranju vozača: "+s.message)}finally{a(!1)}}},l=async s=>{if(window.confirm(`Da li ste sigurni da želite obrisati vozača ${s.ime}?`))try{await k(s.id)}catch(I){console.error("Greška pri brisanju vozača:",I),alert("Greška pri brisanju vozača: "+I.message)}},M=async s=>{try{await p(s.id,s.aktivan)}catch(I){console.error("Greška pri mijenjanju statusa:",I),alert("Greška pri mijenjanju statusa: "+I.message)}},z=s=>{O(s),g({ime:s.ime,tura:s.tura,aktivan:s.aktivan,target_per_day:s.target_per_day||0,password_hash:s.password_hash?C(s.password_hash):"",role:s.role||"driver"}),B(!0)},V=()=>{g({ime:"",tura:"",aktivan:!0,target_per_day:0,password_hash:"",role:"driver"}),f(!0)};return e.jsxs(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:`p-4 sm:p-6 rounded-2xl ${t?"bg-gray-800/50":"bg-white/50"} backdrop-blur-xl border ${t?"border-gray-700":"border-white/20"} shadow-xl`,children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(r.div,{animate:{scale:[1,1.1,1]},transition:{duration:2,repeat:1/0},className:"p-3 rounded-xl bg-gradient-to-r from-blue-500 to-indigo-600",children:e.jsx(Z,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:`text-xl sm:text-2xl font-bold ${t?"text-white":"text-gray-800"}`,children:"Upravljanje vozačima"}),e.jsx("p",{className:`text-sm ${t?"text-gray-400":"text-gray-600"}`,children:"Upravljaj vozačima i njihovim dozvolama"})]})]}),e.jsxs(r.button,{onClick:V,whileHover:{scale:1.05},whileTap:{scale:.95},className:`flex items-center gap-2 px-4 py-2 rounded-xl font-medium transition-all ${t?"bg-gradient-to-r from-blue-600 to-indigo-600 text-white hover:from-blue-500 hover:to-indigo-500":"bg-gradient-to-r from-blue-500 to-indigo-600 text-white hover:from-blue-400 hover:to-indigo-500"} shadow-lg`,children:[e.jsx(Me,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Dodaj vozača"}),e.jsx("span",{className:"sm:hidden",children:"Dodaj"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 sm:gap-4 mb-6",children:[e.jsx(r.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.1},className:`p-2 sm:p-4 rounded-xl ${t?"bg-green-900/30 border-green-700/50":"bg-green-50 border-green-200/50"} border`,children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"p-1.5 sm:p-2 rounded-lg bg-gradient-to-br from-green-500 to-emerald-500",children:e.jsx(Z,{className:"w-3 h-3 sm:w-4 sm:h-4 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:`text-xs ${t?"text-gray-400":"text-gray-600"}`,children:"Aktivni"}),e.jsx("p",{className:`text-sm sm:text-lg font-bold ${t?"text-green-400":"text-green-600"}`,children:n.filter(s=>s.aktivan).length})]})]})}),e.jsx(r.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.2},className:`p-2 sm:p-4 rounded-xl ${t?"bg-yellow-900/30 border-yellow-700/50":"bg-yellow-50 border-yellow-200/50"} border`,children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"p-1.5 sm:p-2 rounded-lg bg-gradient-to-br from-yellow-500 to-orange-500",children:e.jsx(we,{className:"w-3 h-3 sm:w-4 sm:h-4 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:`text-xs ${t?"text-gray-400":"text-gray-600"}`,children:"Neaktivni"}),e.jsx("p",{className:`text-sm sm:text-lg font-bold ${t?"text-yellow-400":"text-yellow-600"}`,children:n.filter(s=>!s.aktivan).length})]})]})}),e.jsx(r.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.3},className:`p-2 sm:p-4 rounded-xl ${t?"bg-blue-900/30 border-blue-700/50":"bg-blue-50 border-blue-200/50"} border`,children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"p-1.5 sm:p-2 rounded-lg bg-gradient-to-br from-blue-500 to-indigo-500",children:e.jsx(Z,{className:"w-3 h-3 sm:w-4 sm:h-4 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:`text-xs ${t?"text-gray-400":"text-gray-600"}`,children:"Ukupno"}),e.jsx("p",{className:`text-sm sm:text-lg font-bold ${t?"text-blue-400":"text-blue-600"}`,children:n.length})]})]})})]}),y&&e.jsx(r.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:`p-4 rounded-xl mb-6 ${t?"bg-red-900/30 border-red-700/50":"bg-red-50 border-red-200/50"} border`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br from-red-500 to-red-600",children:e.jsx(fe,{className:"w-4 h-4 text-white"})}),e.jsxs("p",{className:`text-sm font-medium ${t?"text-red-400":"text-red-600"}`,children:["Greška: ",y.message]})]})}),o?e.jsxs(r.div,{initial:{opacity:0},animate:{opacity:1},className:"flex flex-col items-center justify-center py-12",children:[e.jsx(r.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-12 h-12 mb-4 rounded-xl bg-gradient-to-r from-blue-500 to-indigo-600 flex items-center justify-center",children:e.jsx(Z,{className:"w-6 h-6 text-white"})}),e.jsx("span",{className:`text-lg ${t?"text-gray-300":"text-gray-600"}`,children:"Učitavanje vozača..."})]}):n.length===0?e.jsxs(r.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"flex flex-col items-center justify-center py-12",children:[e.jsx("div",{className:`w-16 h-16 mb-4 rounded-xl ${t?"bg-gray-700":"bg-gray-100"} flex items-center justify-center`,children:e.jsx(Z,{className:`w-8 h-8 ${t?"text-gray-400":"text-gray-500"}`})}),e.jsx("h3",{className:`text-lg font-semibold mb-2 ${t?"text-gray-300":"text-gray-700"}`,children:"Nema vozača"}),e.jsx("p",{className:`text-sm ${t?"text-gray-500":"text-gray-600"}`,children:"Nema registrovanih vozača u sistemu"})]}):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:n.map((s,I)=>e.jsxs(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:I*.05},className:`p-4 sm:p-5 rounded-xl ${s.aktivan?t?"bg-green-900/30 border-green-700/50":"bg-green-50 border-green-200/50":t?"bg-yellow-900/30 border-yellow-700/50":"bg-yellow-50 border-yellow-200/50"} border backdrop-blur-sm hover:scale-[1.02] transition-all duration-200`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg bg-gradient-to-br ${s.aktivan?"from-green-500 to-emerald-500":"from-yellow-500 to-orange-500"}`,children:e.jsx(Z,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:`font-semibold ${t?"text-white":"text-gray-800"}`,children:s.ime}),e.jsxs("p",{className:`text-xs ${t?"text-gray-400":"text-gray-600"}`,children:["Tura: ",s.tura]})]})]}),e.jsx("div",{className:`px-2 py-1 rounded-lg text-xs font-medium ${s.aktivan?t?"bg-green-700/50 text-green-300":"bg-green-100 text-green-700":t?"bg-yellow-700/50 text-yellow-300":"bg-yellow-100 text-yellow-700"}`,children:s.aktivan?"Aktivan":"Neaktivan"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{className:`w-4 h-4 ${t?"text-gray-400":"text-gray-600"}`}),e.jsxs("span",{className:`text-sm ${t?"text-gray-300":"text-gray-700"}`,children:["Target: ",e.jsx("strong",{children:s.target_per_day||0})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(de,{className:`w-4 h-4 ${t?"text-gray-400":"text-gray-600"}`}),e.jsx("span",{className:`text-sm ${t?"text-gray-300":"text-gray-700"}`,children:s.role==="admin"?"Admin":"Vozač"})]}),s.last_login&&e.jsxs("div",{className:"flex items-center gap-2 sm:col-span-2",children:[e.jsx(re,{className:`w-4 h-4 ${t?"text-gray-400":"text-gray-600"}`}),e.jsxs("span",{className:`text-sm ${t?"text-gray-300":"text-gray-700"}`,children:["Zadnji login: ",new Date(s.last_login).toLocaleDateString("bs-BA")]})]})]}),s.password_hash&&e.jsx("div",{className:`p-3 rounded-lg mb-4 ${t?"bg-gray-800/50":"bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:`text-sm ${t?"text-gray-300":"text-gray-700"}`,children:["Password: ",S[s.id]?C(s.password_hash):"••••••••"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(r.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>j(s.id),className:`p-1 rounded ${t?"hover:bg-gray-700":"hover:bg-gray-200"}`,children:S[s.id]?e.jsx(Ue,{className:"w-4 h-4"}):e.jsx(ge,{className:"w-4 h-4"})}),e.jsx(r.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>m(C(s.password_hash),s.id),className:`p-1 rounded ${t?"hover:bg-gray-700":"hover:bg-gray-200"}`,children:T===s.id?e.jsx("span",{className:"text-xs text-green-500",children:"✓"}):e.jsx(Fe,{className:"w-4 h-4"})})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3",children:[e.jsxs(r.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>document.getElementById(`upload-input-${s.id}`).click(),className:`flex items-center justify-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-all ${t?"bg-green-700/50 text-green-300 hover:bg-green-600/50":"bg-green-500 text-white hover:bg-green-600"}`,children:[e.jsx(Ce,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Upload"})]}),e.jsxs(r.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>z(s),className:`flex items-center justify-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-all ${t?"bg-blue-700/50 text-blue-300 hover:bg-blue-600/50":"bg-blue-500 text-white hover:bg-blue-600"}`,children:[e.jsx(Le,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Uredi"})]}),e.jsxs(r.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>M(s),className:`flex items-center justify-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-all ${s.aktivan?t?"bg-yellow-700/50 text-yellow-300 hover:bg-yellow-600/50":"bg-yellow-500 text-white hover:bg-yellow-600":t?"bg-green-700/50 text-green-300 hover:bg-green-600/50":"bg-green-500 text-white hover:bg-green-600"}`,children:[s.aktivan?e.jsx(we,{className:"w-4 h-4"}):e.jsx(Te,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:s.aktivan?"Pauza":"Aktiviraj"})]}),e.jsxs(r.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>l(s),className:`flex items-center justify-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-all ${t?"bg-red-700/50 text-red-300 hover:bg-red-600/50":"bg-red-500 text-white hover:bg-red-600"}`,children:[e.jsx(xe,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Obriši"})]})]}),e.jsx("input",{id:`upload-input-${s.id}`,type:"file",accept:"application/pdf",multiple:!0,className:"hidden",onChange:async i=>{const N=Array.from(i.target.files);if(!N.length)return;const{uploadPayrollFile:$}=await se(async()=>{const{uploadPayrollFile:J}=await import("./chunk-v5-1760908223414-bFjT9cHD.js").then(W=>W.S);return{uploadPayrollFile:J}},__vite__mapDeps([0,1,2,3])),{extractNetoBrutoFromPDF:E}=await se(async()=>{const{extractNetoBrutoFromPDF:J}=await import("./chunk-v5-1760908223414-fR8G6j7r.js");return{extractNetoBrutoFromPDF:J}},__vite__mapDeps([4,0,1,2,3])),{supabase:R}=await se(async()=>{const{supabase:J}=await import("./chunk-v5-1760908223414-bFjT9cHD.js").then(W=>W.f);return{supabase:J}},__vite__mapDeps([0,1,2,3])),U=s.ime.trim().toLowerCase();let A=0,Y=0;for(const J of N){if(!await $(U,J)){Y++,console.error(`Greška pri uploadu platne liste ${J.name}! Provjeri konekciju, dozvole ili ime fajla.`);continue}try{const le=await J.arrayBuffer(),{neto:K,bruto:X}=await E(le);await R.from("payroll_amounts").upsert([{driver_name:U,file_name:J.name,neto:K,bruto:X,created_at:new Date}]),A++}catch(le){Y++,console.error("Greška pri parsiranju PDF-a ili upisu u payroll_amounts:",le)}}typeof window.refreshPayrollFiles=="function"&&window.refreshPayrollFiles(U),A>0&&Y===0?alert(`Svi fajlovi (${A}) su uspješno uploadovani za vozača ${s.ime} (tura ${s.tura})!`):A>0&&Y>0?alert(`Upload završen: ${A} fajlova uspješno, ${Y} grešaka.`):alert("Nijedan fajl nije uspješno uploadovan!"),i.target.value=""}})]},s.id))}),e.jsx(ie,{open:F,title:"Dodaj novog vozača",onClose:()=>f(!1),onSubmit:q,loading:u,submitLabel:"Dodaj vozača",closeLabel:"Otkaži",children:e.jsx("div",{className:"space-y-3 sm:space-y-5",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[e.jsx("div",{className:"space-y-1 sm:col-span-2",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-end gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("label",{className:`flex items-center gap-2 text-sm font-medium ${t?"text-gray-200":"text-gray-700"}`,children:[e.jsx(Z,{className:"w-4 h-4"}),"Ime vozača"]}),e.jsx("input",{type:"text",value:h.ime,onChange:s=>g({...h,ime:s.target.value}),placeholder:"Unesite ime vozača",required:!0,className:`w-full px-4 py-3 rounded-xl border-2 transition-all duration-200 ${t?"bg-gray-800/50 border-gray-600 text-white placeholder-gray-400 focus:border-blue-400":"bg-white/80 border-gray-200 text-gray-900 placeholder-gray-500 focus:border-blue-500"} focus:outline-none focus:ring-2 focus:ring-blue-500/20`})]}),e.jsxs("div",{className:`flex items-center gap-3 px-4 py-3 rounded-xl border ${t?"bg-gray-800/30 border-gray-600":"bg-gray-50 border-gray-200"} sm:flex-shrink-0`,children:[e.jsx("input",{type:"checkbox",id:"addActiveCheckbox",checked:h.aktivan,onChange:s=>g({...h,aktivan:s.target.checked}),className:"w-4 h-4 text-green-600 bg-gray-100 border-gray-300 rounded focus:ring-green-500 focus:ring-2"}),e.jsx("label",{htmlFor:"addActiveCheckbox",className:`text-sm font-medium cursor-pointer whitespace-nowrap ${t?"text-gray-200":"text-gray-700"}`,children:"Aktivan vozač"})]})]})}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:`flex items-center gap-2 text-sm font-medium ${t?"text-gray-200":"text-gray-700"}`,children:[e.jsx(te,{className:"w-4 h-4"}),"Tura"]}),e.jsx("input",{type:"text",value:h.tura,onChange:s=>g({...h,tura:s.target.value}),placeholder:"npr. A1, B2, C3...",required:!0,className:`w-full px-4 py-3 rounded-xl border-2 transition-all duration-200 ${t?"bg-gray-800/50 border-gray-600 text-white placeholder-gray-400 focus:border-blue-400":"bg-white/80 border-gray-200 text-gray-900 placeholder-gray-500 focus:border-blue-500"} focus:outline-none focus:ring-2 focus:ring-blue-500/20`})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:`flex items-center gap-2 text-sm font-medium ${t?"text-gray-200":"text-gray-700"}`,children:[e.jsx(re,{className:"w-4 h-4"}),"Target po danu"]}),e.jsx("input",{type:"number",value:h.target_per_day,onChange:s=>g({...h,target_per_day:parseInt(s.target.value)||0}),placeholder:"0",min:"0",className:`w-full px-4 py-3 rounded-xl border-2 transition-all duration-200 ${t?"bg-gray-800/50 border-gray-600 text-white placeholder-gray-400 focus:border-blue-400":"bg-white/80 border-gray-200 text-gray-900 placeholder-gray-500 focus:border-blue-500"} focus:outline-none focus:ring-2 focus:ring-blue-500/20`})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:`flex items-center gap-2 text-sm font-medium ${t?"text-gray-200":"text-gray-700"}`,children:[e.jsx(de,{className:"w-4 h-4"}),"Uloga"]}),e.jsxs("select",{value:h.role,onChange:s=>g({...h,role:s.target.value}),className:`w-full px-4 py-3 rounded-xl border-2 transition-all duration-200 ${t?"bg-gray-800/50 border-gray-600 text-white focus:border-blue-400":"bg-white/80 border-gray-200 text-gray-900 focus:border-blue-500"} focus:outline-none focus:ring-2 focus:ring-blue-500/20`,children:[e.jsx("option",{value:"driver",children:"Vozač"}),e.jsx("option",{value:"admin",children:"Administrator"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:`flex items-center gap-2 text-sm font-medium ${t?"text-gray-200":"text-gray-700"}`,children:[e.jsx(ge,{className:"w-4 h-4"}),"Lozinka"]}),e.jsx("input",{type:"password",value:h.password_hash,onChange:s=>g({...h,password_hash:s.target.value}),placeholder:"Unesite lozinku",className:`w-full px-4 py-3 rounded-xl border-2 transition-all duration-200 ${t?"bg-gray-800/50 border-gray-600 text-white placeholder-gray-400 focus:border-blue-400":"bg-white/80 border-gray-200 text-gray-900 placeholder-gray-500 focus:border-blue-500"} focus:outline-none focus:ring-2 focus:ring-blue-500/20`})]})]})})}),e.jsx(ie,{open:P,title:"Uredi vozača",onClose:()=>B(!1),onSubmit:L,loading:u,submitLabel:"Sačuvaj promjene",closeLabel:"Otkaži",children:e.jsx("div",{className:"space-y-3 sm:space-y-5",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[e.jsx("div",{className:"space-y-1 sm:col-span-2",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-end gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("label",{className:`flex items-center gap-2 text-sm font-medium ${t?"text-gray-200":"text-gray-700"}`,children:[e.jsx(Z,{className:"w-4 h-4"}),"Ime vozača"]}),e.jsx("input",{type:"text",value:h.ime,onChange:s=>g({...h,ime:s.target.value}),placeholder:"Unesite ime vozača",required:!0,className:`w-full px-4 py-3 rounded-xl border-2 transition-all duration-200 ${t?"bg-gray-800/50 border-gray-600 text-white placeholder-gray-400 focus:border-blue-400":"bg-white/80 border-gray-200 text-gray-900 placeholder-gray-500 focus:border-blue-500"} focus:outline-none focus:ring-2 focus:ring-blue-500/20`})]}),e.jsxs("div",{className:`flex items-center gap-3 px-4 py-3 rounded-xl border ${t?"bg-gray-800/30 border-gray-600":"bg-gray-50 border-gray-200"} sm:flex-shrink-0`,children:[e.jsx("input",{type:"checkbox",id:"editActiveCheckbox",checked:h.aktivan,onChange:s=>g({...h,aktivan:s.target.checked}),className:"w-4 h-4 text-green-600 bg-gray-100 border-gray-300 rounded focus:ring-green-500 focus:ring-2"}),e.jsx("label",{htmlFor:"editActiveCheckbox",className:`text-sm font-medium cursor-pointer whitespace-nowrap ${t?"text-gray-200":"text-gray-700"}`,children:"Aktivan vozač"})]})]})}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:`flex items-center gap-2 text-sm font-medium ${t?"text-gray-200":"text-gray-700"}`,children:[e.jsx(te,{className:"w-4 h-4"}),"Tura"]}),e.jsx("input",{type:"text",value:h.tura,onChange:s=>g({...h,tura:s.target.value}),placeholder:"npr. A1, B2, C3...",required:!0,className:`w-full px-4 py-3 rounded-xl border-2 transition-all duration-200 ${t?"bg-gray-800/50 border-gray-600 text-white placeholder-gray-400 focus:border-blue-400":"bg-white/80 border-gray-200 text-gray-900 placeholder-gray-500 focus:border-blue-500"} focus:outline-none focus:ring-2 focus:ring-blue-500/20`})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:`flex items-center gap-2 text-sm font-medium ${t?"text-gray-200":"text-gray-700"}`,children:[e.jsx(re,{className:"w-4 h-4"}),"Target po danu"]}),e.jsx("input",{type:"number",value:h.target_per_day,onChange:s=>g({...h,target_per_day:parseInt(s.target.value)||0}),placeholder:"0",min:"0",className:`w-full px-4 py-3 rounded-xl border-2 transition-all duration-200 ${t?"bg-gray-800/50 border-gray-600 text-white placeholder-gray-400 focus:border-blue-400":"bg-white/80 border-gray-200 text-gray-900 placeholder-gray-500 focus:border-blue-500"} focus:outline-none focus:ring-2 focus:ring-blue-500/20`})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:`flex items-center gap-2 text-sm font-medium ${t?"text-gray-200":"text-gray-700"}`,children:[e.jsx(de,{className:"w-4 h-4"}),"Uloga"]}),e.jsxs("select",{value:h.role,onChange:s=>g({...h,role:s.target.value}),className:`w-full px-4 py-3 rounded-xl border-2 transition-all duration-200 ${t?"bg-gray-800/50 border-gray-600 text-white focus:border-blue-400":"bg-white/80 border-gray-200 text-gray-900 focus:border-blue-500"} focus:outline-none focus:ring-2 focus:ring-blue-500/20`,children:[e.jsx("option",{value:"driver",children:"Vozač"}),e.jsx("option",{value:"admin",children:"Administrator"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:`flex items-center gap-2 text-sm font-medium ${t?"text-gray-200":"text-gray-700"}`,children:[e.jsx(ge,{className:"w-4 h-4"}),"Lozinka"]}),e.jsx("input",{type:"password",value:h.password_hash,onChange:s=>g({...h,password_hash:s.target.value}),placeholder:"Ostavite prazno da ne mijenjate lozinku",className:`w-full px-4 py-3 rounded-xl border-2 transition-all duration-200 ${t?"bg-gray-800/50 border-gray-600 text-white placeholder-gray-400 focus:border-blue-400":"bg-white/80 border-gray-200 text-gray-900 placeholder-gray-500 focus:border-blue-500"} focus:outline-none focus:ring-2 focus:ring-blue-500/20`})]})]})})})]})},lt=c=>{const[x,t]=d.useState(!1);return d.useEffect(()=>{const n=window.matchMedia(c);n.matches!==x&&t(n.matches);const o=()=>t(n.matches);return n.addEventListener("change",o),()=>n.removeEventListener("change",o)},[x,c]),x},pe=({onClick:c,variant:x="primary",children:t,disabled:n=!1,loading:o=!1})=>{const y={primary:"bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700",success:"bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700",danger:"bg-gradient-to-r from-red-500 to-rose-600 hover:from-red-600 hover:to-rose-700",warning:"bg-gradient-to-r from-yellow-500 to-orange-600 hover:from-yellow-600 hover:to-orange-700"};return e.jsxs(r.button,{whileHover:{scale:n||o?1:1.02,y:n||o?0:-1},whileTap:{scale:n||o?1:.98},onClick:c,disabled:n||o,className:`px-4 py-2 rounded-lg text-white text-sm font-medium transition-all duration-200 shadow-md hover:shadow-lg ${y[x]} ${n||o?"opacity-50 cursor-not-allowed":""}`,initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{type:"spring",stiffness:300,damping:20},children:[o&&e.jsx(Q,{className:"w-4 h-4 mr-2 animate-spin inline"}),t]})},_e=({type:c,children:x})=>{const t={success:"bg-green-500/20 text-green-300 border-green-500/30",error:"bg-red-500/20 text-red-300 border-red-500/30",warning:"bg-yellow-500/20 text-yellow-300 border-yellow-500/30",info:"bg-blue-500/20 text-blue-300 border-blue-500/30"};return e.jsx(r.span,{className:`px-2 py-1 rounded-full text-xs font-semibold border ${t[c]||t.info}`,initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{type:"spring",stiffness:300},children:x})},nt=()=>{const[c,x]=d.useState("default");d.useEffect(()=>{const i=()=>{const $=new Date().getHours();$>=5&&$<8?x("sunrise"):$>=8&&$<12?x("default"):$>=12&&$<17?x("afternoon"):$>=17&&$<20?x("evening"):x("night")};i();const N=setInterval(i,6e4);return()=>clearInterval(N)},[]);const t=c==="night",n=lt("(min-width: 768px)"),[o,y]=d.useState({}),[b,w]=d.useState(!1),[k,p]=d.useState(""),[_,O]=d.useState({drivers:!0,deliveries:!0,extra_rides:!0,extra_rides_pending:!0,holidays:!0}),[P,B]=d.useState(!1),[F,f]=d.useState(null),[u,a]=d.useState([]),[S,v]=d.useState(!1),[h,g]=d.useState(null),T=[{key:"drivers",name:"Vozači",icon:me,color:"from-blue-500 to-indigo-600",description:"Svi vozači i njihovi podaci"},{key:"deliveries",name:"Dostave",icon:ue,color:"from-green-500 to-emerald-600",description:"Svi podaci o dostavama"},{key:"extra_rides",name:"Extra vožnje",icon:ee,color:"from-purple-500 to-violet-600",description:"Odobrene extra vožnje"},{key:"extra_rides_pending",name:"Pending vožnje",icon:re,color:"from-yellow-500 to-orange-600",description:"Vožnje na čekanju"},{key:"holidays",name:"Praznici",icon:de,color:"from-pink-500 to-rose-600",description:"Kalendar praznika"}];d.useEffect(()=>{m()},[]);const D=i=>{const N=new Date,$=new Date(i),E=N-$,R=Math.floor(E/(1e3*60)),U=Math.floor(E/(1e3*60*60)),A=Math.floor(E/(1e3*60*60*24));return R<1?"Upravo sada":R<60?`Prije ${R}min`:U<24?`Prije ${U}h`:A<7?`Prije ${A}d`:"Stariji"},m=()=>{const i=localStorage.getItem("backupHistory")||"[]",N=JSON.parse(i);a(N.slice(-10))},j=()=>{C({drivers:[{id:1,name:"Test Vozač 1",phone:"061234567"},{id:2,name:"Test Vozač 2",phone:"062345678"}],deliveries:[{id:1,from:"Sarajevo",to:"Mostar",date:"2024-01-15"},{id:2,from:"Tuzla",to:"Zenica",date:"2024-01-16"}],extra_rides:[{id:1,driver_id:1,date:"2024-01-15",amount:50}]}),p("✅ Test backup kreiran uspešno!"),setTimeout(()=>p(""),3e3)},C=i=>{const N=JSON.parse(localStorage.getItem("backupHistory")||"[]"),{_metadata:$,...E}=i,R=K=>JSON.stringify(K).length,U=K=>{if(K===0)return"0 B";const X=1024,Re=["B","KB","MB","GB"],je=Math.floor(Math.log(K)/Math.log(X));return parseFloat((K/Math.pow(X,je)).toFixed(2))+" "+Re[je]},A=R(i),J=(($==null?void 0:$.tables)||Object.keys(E)).filter(K=>K!=="_metadata"),W=($==null?void 0:$.total_records)||Object.values(E).reduce((K,X)=>K+(Array.isArray(X)?X.length:0),0),le={id:Date.now(),name:`Backup_${new Date().toLocaleDateString("sr-RS")}_${new Date().toLocaleTimeString("sr-RS",{hour:"2-digit",minute:"2-digit"})}`,timestamp:new Date().toISOString(),tables:J,totalRecords:W,fileSize:U(A),fileSizeBytes:A,data:i};N.push(le),localStorage.setItem("backupHistory",JSON.stringify(N.slice(-20))),m()},G=i=>{const $=JSON.parse(localStorage.getItem("backupHistory")||"[]").filter(E=>E.id!==i);localStorage.setItem("backupHistory",JSON.stringify($)),m(),v(!1),g(null)},q=i=>{try{const N=JSON.stringify(i.data||i,null,2),$="data:application/json;charset=utf-8,"+encodeURIComponent(N),E=i.name||`backup_${new Date(i.timestamp).toLocaleDateString("sr-RS")}.json`,R=document.createElement("a");R.setAttribute("href",$),R.setAttribute("download",E),R.click(),p("✅ Backup preuzet uspešno!"),setTimeout(()=>p(""),3e3)}catch(N){console.error("Greška pri preuzimanju backup-a:",N),p("❌ Greška pri preuzimanju backup-a"),setTimeout(()=>p(""),3e3)}},L=async()=>{w(!0),p("🔄 Kreiranje kompletnog backup-a...");try{const i={};let N=0;for(const $ of T)if(_[$.key]){p(`📊 Backup tabele: ${$.name}...`);const{data:E,error:R}=await H.from($.key).select("*");if(R)throw R;i[$.key]=E,N+=E.length,await new Promise(U=>setTimeout(U,500))}i._metadata={created_at:new Date().toISOString(),version:"1.0",total_records:N,tables:Object.keys(i).filter($=>$!=="_metadata")},y(i),C(i),p(`✅ Backup kreiran! Ukupno ${N} zapisa`),l(i),setTimeout(()=>{p(""),m()},3e3)}catch(i){console.error("Backup error:",i),p(`❌ Greška: ${i.message}`)}finally{w(!1)}},l=(i=o)=>{const $=`supabase-backup-${new Date().toISOString().replace(/[:.]/g,"-")}.json`,E=new Blob([JSON.stringify(i,null,2)],{type:"application/json"}),R=URL.createObjectURL(E),U=document.createElement("a");U.href=R,U.download=$,document.body.appendChild(U),U.click(),document.body.removeChild(U),URL.revokeObjectURL(R)},M=i=>{const N=i.target.files[0];if(!N)return;const $=new FileReader;$.onload=async E=>{try{const R=JSON.parse(E.target.result);await z(R)}catch(R){p(`❌ Neispravna backup datoteka: ${R.message}`)}},$.readAsText(N)},z=async i=>{w(!0),p("🔄 Vraćanje backup-a u bazu...");try{let N=0;for(const[$,E]of Object.entries(i)){if($==="_metadata"||!_[$])continue;p(`📥 Vraćanje tabele: ${$} (${E.length} zapisa)...`);const R=100;for(let U=0;U<E.length;U+=R){const A=E.slice(U,U+R),{error:Y}=await H.from($).upsert(A);if(Y)throw Y;N+=A.length,await new Promise(J=>setTimeout(J,200))}}p(`✅ Backup vraćen! ${N} zapisa uspešno vraćeno`)}catch(N){console.error("Restore error:",N),p(`❌ Greška pri vraćanju: ${N.message}`)}finally{w(!1)}},V=async i=>{w(!0),p(`🗑️ Brisanje podataka iz tabele: ${i}...`);try{const{data:N,error:$}=await H.from(i).select("id");if($)throw $;if(N.length===0){p(`ℹ️ Tabela ${i} je već prazna`),w(!1);return}const E=100;let R=0;for(let U=0;U<N.length;U+=E){const Y=N.slice(U,U+E).map(W=>W.id),{error:J}=await H.from(i).delete().in("id",Y);if(J)throw J;R+=Y.length,p(`🗑️ Obrisano ${R}/${N.length} zapisa iz ${i}...`),await new Promise(W=>setTimeout(W,200))}p(`✅ Uspešno obrisano ${R} zapisa iz tabele ${i}`)}catch(N){console.error("Delete error:",N),p(`❌ Greška pri brisanju: ${N.message}`)}finally{w(!1),B(!1),f(null)}},[s,I]=d.useState({});return d.useEffect(()=>{(async()=>{const N={};for(const $ of T)try{const{count:E,error:R}=await H.from($.key).select("*",{count:"exact",head:!0});R||(N[$.key]=E)}catch{N[$.key]=0}I(N)})()},[]),e.jsxs(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:`p-4 sm:p-6 rounded-2xl ${t?"bg-gray-800/50":"bg-white/50"} backdrop-blur-xl border ${t?"border-gray-700":"border-white/20"} shadow-xl`,children:[e.jsx(r.div,{className:"mb-6",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.4},children:e.jsxs(r.div,{className:"flex items-center gap-3 mb-2",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1},children:[e.jsx(r.div,{whileHover:{scale:1.1,rotate:[0,-10,10,-10,0],transition:{duration:.5}},className:"p-2 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl shadow-lg",children:e.jsx(ze,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:`text-xl sm:text-2xl font-bold ${t?"text-white":"text-gray-900"}`,children:"Sistem & Backup"}),e.jsx("p",{className:`text-sm ${t?"text-gray-400":"text-gray-600"}`,children:"Kompletno backup/restore rešenje za Supabase bazu"})]})]})}),e.jsx(Ee,{children:k&&e.jsx(r.div,{initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},className:`p-4 rounded-xl mb-6 border font-mono text-sm ${b?`${t?"bg-yellow-500/10 border-yellow-500/30 text-yellow-300":"bg-yellow-50 border-yellow-200 text-yellow-800"}`:`${t?"bg-green-500/10 border-green-500/30 text-green-300":"bg-green-50 border-green-200 text-green-800"}`}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[b?e.jsx(Q,{className:"w-4 h-4 animate-spin"}):e.jsx(ee,{className:"w-4 h-4"}),k]})})}),e.jsxs(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},"data-backup-section":!0,className:`rounded-xl p-4 sm:p-6 mb-6 border ${t?"bg-gray-700/30 border-gray-600":"bg-white/70 border-white/30"} backdrop-blur-sm`,children:[e.jsxs(r.h3,{className:`mb-4 font-bold text-lg flex items-center gap-2 ${t?"text-white":"text-gray-900"}`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.3},children:[e.jsx(me,{className:"w-5 h-5 text-green-500"}),"Izbor tabela za backup/restore"]}),e.jsx(r.div,{className:`grid ${n?"grid-cols-2":"grid-cols-1"} gap-3`,variants:{show:{transition:{staggerChildren:.1}}},initial:"hidden",animate:"show",children:T.map((i,N)=>{const $=i.icon,E=_[i.key];return e.jsx(r.div,{variants:{hidden:{opacity:0,y:20,scale:.95},show:{opacity:1,y:0,scale:1}},whileHover:{scale:1.02,y:-2,transition:{type:"spring",stiffness:300}},whileTap:{scale:.98},onClick:()=>O(R=>({...R,[i.key]:!R[i.key]})),className:`p-4 rounded-xl border cursor-pointer transition-all duration-300 relative ${E?`${t?"bg-blue-500/20 border-blue-400/50":"bg-blue-50 border-blue-300"} shadow-lg`:`${t?"bg-gray-800/30 border-gray-600 hover:bg-gray-700/40":"bg-white/50 border-gray-200 hover:bg-white/80"}`} hover:shadow-md`,children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(r.div,{className:`p-2 rounded-lg bg-gradient-to-r ${i.color}`,whileHover:{rotate:360},transition:{duration:.3},children:e.jsx($,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("strong",{className:`${t?"text-white":"text-gray-900"}`,children:i.name}),e.jsxs(_e,{type:E?"success":"info",children:[s[i.key]||0," zapisa"]})]}),e.jsx("p",{className:`text-sm mt-1 ${t?"text-gray-400":"text-gray-600"}`,children:i.description})]}),e.jsx(r.div,{animate:{scale:E?1:0,opacity:E?1:0},transition:{type:"spring",stiffness:300},children:e.jsx(ee,{className:"w-5 h-5 text-green-500"})})]})},i.key)})})]}),e.jsxs(r.div,{className:`grid ${n?"grid-cols-2":"grid-cols-1"} gap-4 mb-6`,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},children:[e.jsxs(r.div,{whileHover:{scale:1.02,y:-2},className:`rounded-xl p-6 border ${t?"bg-blue-500/10 border-blue-500/30":"bg-blue-50 border-blue-200"} backdrop-blur-sm`,children:[e.jsxs(r.h3,{className:`font-bold text-lg mb-3 flex items-center gap-2 ${t?"text-blue-300":"text-blue-800"}`,initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.5},children:[e.jsx(Ne,{className:"w-5 h-5"}),"Kreiranje Backup-a"]}),e.jsx("p",{className:`mb-4 text-sm ${t?"text-gray-400":"text-gray-600"}`,children:"Kreiraj backup izabranih tabela i preuzmi kao JSON fajl"}),e.jsx(pe,{onClick:L,disabled:b||Object.values(_).every(i=>!i),loading:b,variant:"primary",children:b?"Kreiram backup...":"💾 Kreiraj i preuzmi backup"})]}),e.jsxs(r.div,{whileHover:{scale:1.02,y:-2},className:`rounded-xl p-6 border ${t?"bg-green-500/10 border-green-500/30":"bg-green-50 border-green-200"} backdrop-blur-sm`,children:[e.jsxs(r.h3,{className:`font-bold text-lg mb-3 flex items-center gap-2 ${t?"text-green-300":"text-green-800"}`,initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.6},children:[e.jsx(Ce,{className:"w-5 h-5"}),"Restore Backup-a"]}),e.jsx("p",{className:`mb-4 text-sm ${t?"text-gray-400":"text-gray-600"}`,children:"Vrati podatke iz backup JSON fajla u bazu"}),e.jsx(r.input,{type:"file",accept:".json",onChange:M,disabled:b,whileFocus:{scale:1.02},className:`w-full p-3 rounded-lg border-2 transition-all ${t?"bg-gray-800/50 border-gray-600 text-white focus:border-green-400":"bg-white border-gray-300 text-gray-900 focus:border-green-500"} focus:outline-none cursor-pointer hover:border-green-400`})]})]}),e.jsxs(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:`rounded-xl p-6 mb-6 border ${t?"bg-red-500/10 border-red-500/30":"bg-red-50 border-red-200"} backdrop-blur-sm`,children:[e.jsxs(r.h3,{className:`font-bold text-lg mb-3 flex items-center gap-2 ${t?"text-red-300":"text-red-800"}`,initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.6},children:[e.jsx(xe,{className:"w-5 h-5"}),"Brisanje Podataka"]}),e.jsx("p",{className:`mb-4 text-sm ${t?"text-gray-400":"text-gray-600"}`,children:"Obriši sve podatke iz izabranih tabela (OPREZ!)"}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:T.map(i=>{if(!_[i.key])return null;const N=i.icon;return e.jsxs(r.button,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{f(i),B(!0)},disabled:b,className:`flex items-center gap-2 px-3 py-2 rounded-lg border transition-all ${t?"bg-red-900/30 border-red-700/50 hover:bg-red-800/40":"bg-red-100 border-red-300 hover:bg-red-200"} disabled:opacity-50`,children:[e.jsx(N,{className:"w-4 h-4"}),e.jsxs("span",{className:`text-sm font-medium ${t?"text-red-300":"text-red-800"}`,children:["🗑️ ",i.name]})]},i.key)})})]}),e.jsxs(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},className:`rounded-2xl p-6 mb-6 relative overflow-hidden ${t?"bg-gradient-to-br from-purple-900/20 via-purple-800/10 to-indigo-900/20 border border-purple-500/30":"bg-gradient-to-br from-purple-50 via-white to-indigo-50 border border-purple-200/50"} backdrop-blur-sm shadow-xl`,children:[e.jsx("div",{className:"absolute inset-0 opacity-5",children:e.jsx("div",{className:"absolute top-0 left-0 w-full h-full",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23a855f7' fill-opacity='0.1'%3E%3Ccircle cx='30' cy='30' r='4'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`,backgroundSize:"60px 60px"}})}),e.jsxs(r.div,{className:"flex items-center justify-between mb-6 relative z-10",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.7},children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(r.div,{className:`p-3 rounded-xl ${t?"bg-gradient-to-br from-purple-600 to-indigo-600 shadow-purple-500/25":"bg-gradient-to-br from-purple-500 to-indigo-500 shadow-purple-500/25"} shadow-lg`,whileHover:{scale:1.1,rotate:5},whileTap:{scale:.95},children:e.jsx(Ge,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:`font-bold text-xl ${t?"text-purple-300":"text-purple-800"}`,children:"Backup Istorija"}),e.jsx("p",{className:`text-sm ${t?"text-purple-400/70":"text-purple-600/70"}`,children:"Upravljajte vašim backup fajlovima"})]})]}),u.length>0&&e.jsxs(r.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.8,type:"spring"},className:"flex items-center gap-2",children:[e.jsxs(_e,{type:"info",children:[u.length," backup",u.length!==1&&"ova"]}),e.jsx(r.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{JSON.parse(localStorage.getItem("backupHistory")||"[]"),localStorage.setItem("backupHistory","[]"),m(),p("🗑️ Sva istorija obrisana"),setTimeout(()=>p(""),3e3)},className:`p-2 rounded-lg transition-all ${t?"bg-red-600/20 hover:bg-red-500/30 border border-red-500/30 text-red-400":"bg-red-50 hover:bg-red-100 border border-red-200 text-red-600"}`,title:"Obriši svu istoriju",children:e.jsx(xe,{className:"w-4 h-4"})})]})]}),u.length===0?e.jsxs(r.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.8},className:"text-center py-12 relative z-10",children:[e.jsx(r.div,{animate:{y:[-10,10,-10],rotateY:[0,360,0]},transition:{duration:4,repeat:1/0,ease:"easeInOut"},className:"text-6xl mb-6 inline-block",style:{filter:"drop-shadow(0 4px 8px rgba(168, 85, 247, 0.3))"},children:"📚"}),e.jsxs("div",{className:"space-y-3 mb-8",children:[e.jsx("h4",{className:`text-lg font-semibold ${t?"text-purple-300":"text-purple-800"}`,children:"Nema backup-ova u istoriji"}),e.jsx("p",{className:`text-sm max-w-md mx-auto leading-relaxed ${t?"text-gray-400":"text-gray-600"}`,children:"Kreirajte prvi backup ili koristite test funkciju da vidite kako istorija funkcioniše"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center items-center",children:[e.jsxs(r.button,{whileHover:{scale:1.05,y:-2},whileTap:{scale:.95},onClick:j,className:`px-6 py-3 rounded-xl font-semibold text-sm transition-all duration-300 flex items-center gap-2 ${t?"bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-500 hover:to-indigo-500 text-white shadow-lg shadow-purple-500/25":"bg-gradient-to-r from-purple-500 to-indigo-500 hover:from-purple-600 hover:to-indigo-600 text-white shadow-lg shadow-purple-500/25"}`,children:[e.jsx("span",{className:"text-lg",children:"🧪"}),"Kreiraj test backup"]}),e.jsxs(r.button,{whileHover:{scale:1.05,y:-2},whileTap:{scale:.95},onClick:()=>{var i;return(i=document.querySelector("[data-backup-section]"))==null?void 0:i.scrollIntoView({behavior:"smooth"})},className:`px-6 py-3 rounded-xl font-medium text-sm transition-all duration-300 border-2 flex items-center gap-2 ${t?"border-purple-500/50 hover:border-purple-400 bg-purple-500/10 hover:bg-purple-500/20 text-purple-300":"border-purple-300 hover:border-purple-400 bg-purple-50 hover:bg-purple-100 text-purple-700"}`,children:[e.jsx(ue,{className:"w-4 h-4"}),"Kreiraj pravi backup"]})]})]}):e.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto pr-2",children:u.slice().reverse().map((i,N)=>{const $=N===0,E=new Date(i.timestamp),R=D(i.timestamp);return e.jsxs("div",{className:`group p-5 rounded-xl border transition-all duration-300 hover:shadow-lg ${$?`${t?"bg-gradient-to-r from-purple-900/60 to-indigo-900/60 border-purple-500/50 ring-2 ring-purple-500/30":"bg-gradient-to-r from-purple-100 to-indigo-100 border-purple-300/50 ring-2 ring-purple-300/50"} shadow-lg`:`${t?"bg-gray-800/40 border-gray-600/50 hover:bg-gray-700/50":"bg-white/80 border-gray-200/50 hover:bg-white/95"}`} backdrop-blur-sm`,children:[$&&e.jsx("div",{className:"absolute -top-2 -right-2 z-10",children:e.jsx("span",{className:"px-3 py-1 text-xs font-bold bg-gradient-to-r from-purple-500 to-indigo-500 text-white rounded-full shadow-lg border-2 border-white",children:"NAJNOVIJI"})}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:`p-2.5 rounded-lg ${$?"bg-gradient-to-br from-purple-500 to-indigo-500 text-white shadow-lg shadow-purple-500/25":`${t?"bg-gray-700 text-gray-300":"bg-gray-100 text-gray-600"}`}`,children:e.jsx(ue,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("h4",{className:`font-semibold text-base ${t?"text-white":"text-gray-900"}`,children:i.name||`Backup ${E.toLocaleDateString("sr-RS")}`}),e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsxs("span",{className:t?"text-gray-400":"text-gray-500",children:[E.toLocaleDateString("sr-RS",{weekday:"short",day:"2-digit",month:"2-digit",year:"numeric"})," u ",E.toLocaleTimeString("sr-RS",{hour:"2-digit",minute:"2-digit"})]}),e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${t?"bg-purple-500/20 text-purple-300":"bg-purple-100 text-purple-700"}`,children:R})]})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:i.tables&&i.tables.length>0?i.tables.map(U=>{const A=T.find(J=>J.key===U);if(!A)return null;const Y=A.icon;return e.jsxs("div",{className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-medium transition-all hover:shadow-sm hover:scale-105 ${t?"bg-gray-700/60 text-gray-300 border border-gray-600/50":"bg-gray-50 text-gray-700 border border-gray-200"}`,children:[e.jsx(Y,{className:"w-3.5 h-3.5"}),A.name]},U)}):e.jsx("div",{className:"text-xs text-gray-500",children:"Nema tabela"})}),e.jsxs("div",{className:"flex items-center gap-6 text-sm",children:[e.jsxs("div",{className:`flex items-center gap-2 ${t?"text-gray-400":"text-gray-600"}`,children:[e.jsx(me,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:i.totalRecords}),e.jsx("span",{children:"zapisa"})]}),e.jsxs("div",{className:`flex items-center gap-2 ${t?"text-gray-400":"text-gray-600"}`,children:[e.jsx(Ve,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:i.fileSize||"0 KB"})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 ml-4 opacity-60 group-hover:opacity-100 transition-opacity",children:[e.jsx(pe,{onClick:()=>q(i),variant:"primary",size:"sm",children:e.jsx(Ne,{className:"w-4 h-4"})}),e.jsx(pe,{onClick:()=>{g(i),v(!0)},variant:"danger",size:"sm",children:e.jsx(xe,{className:"w-4 h-4"})})]})]})]},i.id)})})]}),"      ",P&&F&&e.jsx(ie,{onClose:()=>{B(!1),f(null)},children:e.jsxs("div",{style:{padding:"2rem",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:"⚠️"}),e.jsx("h2",{style:{color:"#ef4444",marginBottom:"1rem"},children:"Potvrdi brisanje"}),e.jsxs("p",{style:{marginBottom:"1.5rem"},children:["Da li ste sigurni da želite da obrišete ",e.jsx("strong",{children:"SVE PODATKE"})," iz tabele:"]}),e.jsxs("div",{style:{padding:"1rem",background:"rgba(239, 68, 68, 0.1)",borderRadius:"8px",marginBottom:"1.5rem",border:"1px solid rgba(239, 68, 68, 0.2)"},children:[e.jsxs("div",{style:{fontSize:"1.5rem",marginBottom:"0.5rem"},children:[F.icon," ",F.name]}),e.jsxs("div",{style:{fontSize:"0.9rem",opacity:.8},children:[s[F.key]||0," zapisa će biti TRAJNO OBRISANO"]})]}),e.jsx("p",{style:{fontSize:"0.9rem",opacity:.8,marginBottom:"2rem"},children:"Ova akcija se NE MOŽE poništiti! Preporučujemo da prvo napravite backup."}),e.jsxs("div",{style:{display:"flex",gap:"1rem",justifyContent:"center"},children:[e.jsx("button",{onClick:()=>{B(!1),f(null)},style:{padding:"0.75rem 1.5rem",background:"rgba(255, 255, 255, 0.1)",color:"var(--text-on-dark)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"8px",cursor:"pointer"},children:"❌ Otkaži"}),e.jsx("button",{onClick:()=>V(F.key),style:{padding:"0.75rem 1.5rem",background:"linear-gradient(145deg, #ef4444, #dc2626)",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"bold"},children:"🗑️ DA, OBRIŠI SVE"})]})]})}),S&&e.jsx(ie,{isOpen:S,onClose:()=>{v(!1),g(null)},title:"Potvrdi brisanje backup-a",children:e.jsxs("div",{style:{padding:"1.5rem"},children:[e.jsxs(r.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:300,damping:25},style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"1.5rem"},children:[e.jsx(r.div,{animate:{rotate:[0,-10,10,-10,0]},transition:{duration:.5,delay:.2},style:{fontSize:"4rem",background:"linear-gradient(135deg, #ef4444, #dc2626)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",filter:"drop-shadow(0 4px 8px rgba(239, 68, 68, 0.3))"},children:"🗑️"}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("h3",{style:{margin:"0 0 0.5rem 0",fontSize:"1.25rem",fontWeight:"bold",color:"#ef4444"},children:"Brisanje backup-a"}),e.jsxs("p",{style:{margin:0,color:"#6b7280",lineHeight:"1.5"},children:["Da li ste sigurni da želite da obrišete backup"," ",e.jsx("strong",{style:{color:"#374151"},children:h==null?void 0:h.name}),"?",e.jsx("br",{}),e.jsx("span",{style:{fontSize:"0.875rem",fontStyle:"italic"},children:"Ova akcija se ne može poništiti."})]})]})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem",marginTop:"2rem",justifyContent:"center"},children:[e.jsx(r.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>{v(!1),g(null)},style:{padding:"0.75rem 1.5rem",background:"linear-gradient(145deg, #f3f4f6, #e5e7eb)",color:"#374151",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"600",transition:"all 0.2s ease",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"},children:"Otkaži"}),e.jsx(r.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>{h&&G(h.id),v(!1),g(null)},style:{padding:"0.75rem 1.5rem",background:"linear-gradient(145deg, #ef4444, #dc2626)",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"600",transition:"all 0.2s ease",boxShadow:"0 2px 4px rgba(239, 68, 68, 0.3)"},children:"Obriši backup"})]})]})})]})},ye=({onClick:c,variant:x="primary",children:t,disabled:n=!1,loading:o=!1,size:y="default",icon:b,className:w=""})=>{const k={primary:"bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700",success:"bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700",danger:"bg-gradient-to-r from-red-500 to-rose-600 hover:from-red-600 hover:to-rose-700",warning:"bg-gradient-to-r from-yellow-500 to-orange-600 hover:from-yellow-600 hover:to-orange-700",secondary:"bg-gradient-to-r from-gray-500 to-slate-600 hover:from-gray-600 hover:to-slate-700"},p={sm:"px-3 py-1.5 text-xs",default:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"};return e.jsxs(r.button,{whileHover:{scale:n||o?1:1.02,y:n||o?0:-1},whileTap:{scale:n||o?1:.98},onClick:c,disabled:n||o,className:`${p[y]} rounded-lg text-white font-medium transition-all duration-200 shadow-md hover:shadow-lg ${k[x]} ${n||o?"opacity-50 cursor-not-allowed":""} flex items-center gap-2 ${w}`,initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{type:"spring",stiffness:300,damping:20},children:[o&&e.jsx(Q,{className:"w-4 h-4 animate-spin"}),b&&!o&&b,t]})},ot=({type:c,children:x})=>{const t={success:"bg-green-500/20 text-green-300 border-green-500/30",error:"bg-red-500/20 text-red-300 border-red-500/30",warning:"bg-yellow-500/20 text-yellow-300 border-yellow-500/30",pending:"bg-blue-500/20 text-blue-300 border-blue-500/30",info:"bg-cyan-500/20 text-cyan-300 border-cyan-500/30"};return e.jsx(r.span,{className:`px-3 py-1 rounded-full text-xs font-semibold border transition-all duration-300 ${t[c]||t.info}`,whileHover:{scale:1.05},initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{type:"spring",stiffness:300,damping:20},children:x})},ct=({currentTheme:c})=>{const[x,t]=d.useState([]),[n,o]=d.useState(!1),[y,b]=d.useState(null),w=c==="night",k="https://api.github.com/repos",p="eldin007b/gls-scraper",_="eldin007b/gls-scraper",O="your_production_github_token",[P,B]=p.split("/"),F=async()=>{o(!0);try{let g=null,T="",D=await fetch(`${k}/${P}/${B}/actions/runs?per_page=20`,{headers:{Accept:"application/vnd.github.v3+json",...O&&{Authorization:`token ${O}`}}});if(D.ok)g=await D.json(),T=p;else{console.log(`⚠️ Glavni repo ${p} ne radi, pokušavam fallback...`);const[m,j]=_.split("/");D=await fetch(`${k}/${m}/${j}/actions/runs?per_page=20`,{headers:{Accept:"application/vnd.github.v3+json",...O&&{Authorization:`token ${O}`}}}),D.ok&&(g=await D.json(),T=_)}if(g){let m=(g.workflow_runs||[]).filter(j=>{const C=(j.name||"").toLowerCase();return C.includes("gls scraper")||C.includes("scraper")||C.includes("gls")||C.includes("sync")||C.includes("data")});if((!m||m.length===0)&&T===p&&_){console.log(`ℹ️ Nema scraper-like workflow-a u ${p}, pokušavam fallback ${_}...`);const[j,C]=_.split("/"),G=await fetch(`${k}/${j}/${C}/actions/runs?per_page=20`,{headers:{Accept:"application/vnd.github.v3+json",...O&&{Authorization:`token ${O}`}}});if(G.ok){const q=await G.json();m=(q.workflow_runs||[]).filter(L=>{const l=(L.name||"").toLowerCase();return l.includes("gls scraper")||l.includes("scraper")||l.includes("gls")||l.includes("sync")||l.includes("data")}),m.length>0&&(T=_,g=q)}}if(console.log(`📊 Pronašao ${m.length} workflow-a u ${T}:`,m.map(j=>j.name)),t(m),m.length>0){const j=m.find(C=>C.conclusion==="success");if(j){const C=j.updated_at||j.run_started_at||j.created_at||new Date().toISOString(),q={timestamp:C,formattedTimestamp:(L=>{try{const l=new Date(L);if(isNaN(l.getTime()))return null;const M=l.getDate().toString().padStart(2,"0"),z=(l.getMonth()+1).toString().padStart(2,"0"),V=l.getHours().toString().padStart(2,"0"),s=l.getMinutes().toString().padStart(2,"0");return`${M}.${z} ${V}:${s}`}catch{return null}})(C),status:"success",workflowId:j.id,runNumber:j.run_number,source:"github_api",repoUsed:T,raw:j};localStorage.setItem("github_scraper_history",JSON.stringify([q])),console.log("✅ Sačuvao GitHub scraper podatke u localStorage:",q)}}b(new Date)}else console.error("Greška pri dohvatanju workflow-a:",D.status,D.statusText),D.status===404&&console.log("❌ Ni jedan repo nema GitHub Actions")}catch(g){console.error("Greška pri GitHub API pozivu:",g)}finally{o(!1)}},f=g=>{switch(g){case"success":return e.jsx(ee,{className:"h-4 w-4 text-green-400"});case"failure":return e.jsx(fe,{className:"h-4 w-4 text-red-400"});case"in_progress":return e.jsx(Q,{className:"h-4 w-4 text-blue-400 animate-spin"});default:return e.jsx(oe,{className:"h-4 w-4 text-yellow-400"})}},u=g=>{switch(g){case"success":return"success";case"failure":return"error";case"in_progress":return"pending";default:return"warning"}},a=g=>{const T=new Date(g);return new Intl.DateTimeFormat("sr-RS",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(T)},S=g=>{const T=Math.floor(g/1e3),D=Math.floor(T/60),m=T%60;return D>0?`${D}m ${m}s`:`${m}s`},v=async()=>{const g="scraper.yml",T=async D=>{const[m,j]=D.split("/"),C=`${k}/${m}/${j}/actions/workflows/${g}/dispatches`;try{return await fetch(C,{method:"POST",headers:{Accept:"application/vnd.github.v3+json",Authorization:`token ${O}`,"Content-Type":"application/json"},body:JSON.stringify({ref:"main"})})}catch(G){return{ok:!1,status:0,statusText:G.message}}};o(!0);try{let D=await T(p),m=p;if(D.ok||(D=await T(_),m=_),D.ok){alert(`Workflow dispatch poslat na ${m}. Pokrećem osvežavanje...`);try{localStorage.setItem("github_scraper_last_event",JSON.stringify({action:"workflow_dispatch",at:new Date().toISOString(),repo:m,workflowFile:g}))}catch{}setTimeout(()=>F(),3e3)}else{let j=null;try{const G=await D.clone().json();j=G.message||JSON.stringify(G)}catch{try{j=await D.text()}catch{j=D.statusText}}const C=`Neuspjeh pri pokretanju workflow-a: ${D.status} ${D.statusText} - ${j}`;alert(C);try{localStorage.setItem("github_scraper_last_event",JSON.stringify({action:"workflow_dispatch_error",at:new Date().toISOString(),repo:m,workflowFile:g,status:D.status,statusText:D.statusText,body:j}))}catch{}}}finally{o(!1)}},h=async()=>{localStorage.getItem("github_scraper_history"),await F();const g=localStorage.getItem("github_scraper_history");try{const T=g?JSON.parse(g)[0]:null;if(T){const D={...T,formattedTimestamp:new Date(T.timestamp).toLocaleString("sr-RS",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})};try{localStorage.setItem("github_scraper_last_event",JSON.stringify({action:"force_sync",at:new Date().toISOString(),payload:D}))}catch{}window.dispatchEvent(new CustomEvent("githubSync:updated",{detail:D}))}}catch(T){console.warn("Ne mogu parsirati github_scraper_history nakon Force sync",T)}};return d.useEffect(()=>{F();const g=setInterval(F,5*60*1e3);return()=>clearInterval(g)},[]),e.jsxs(r.div,{className:`p-6 min-h-screen transition-all duration-500 ${w?"bg-gradient-to-br from-gray-900 via-blue-900/20 to-purple-900/20":"bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50"}`,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:[e.jsxs(r.div,{className:"mb-8",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{delay:.2},children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx(r.div,{className:`p-3 rounded-2xl ${w?"bg-gradient-to-br from-purple-600 to-blue-600 shadow-2xl shadow-purple-500/25":"bg-gradient-to-br from-purple-500 to-blue-500 shadow-2xl shadow-purple-500/25"}`,whileHover:{scale:1.05,rotate:5},transition:{type:"spring",stiffness:300},children:e.jsx(be,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx(r.h3,{className:`text-xl md:text-2xl font-bold ${w?"text-white":"text-gray-900"}`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.3},children:"GitHub Actions"}),e.jsx(r.p,{className:`text-xs md:text-sm ${w?"text-gray-400":"text-gray-600"} break-all md:break-normal`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.4},children:y&&`Poslednje ažuriranje: ${a(y)}`})]})]}),e.jsxs(r.div,{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 sm:gap-3",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},children:[e.jsx(ye,{onClick:F,loading:n,variant:"secondary",size:"sm",icon:e.jsx(Q,{className:"w-4 h-4"}),className:"w-full justify-center",children:"Osvježi"}),e.jsx(ye,{onClick:h,variant:"primary",size:"sm",icon:e.jsx(Oe,{className:"w-4 h-4"}),className:"w-full justify-center",children:"Force Sync"}),e.jsx(ye,{onClick:v,variant:"success",size:"sm",icon:e.jsx(Te,{className:"w-4 h-4"}),className:"w-full justify-center",children:"Pokreni Scraper"})]})]}),x.length>0?e.jsx(r.div,{className:"space-y-4",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},children:x.map((g,T)=>e.jsx(r.div,{className:`p-6 rounded-2xl backdrop-blur-sm border transition-all duration-300 ${w?"bg-gray-800/40 border-gray-700/50 hover:bg-gray-800/60 hover:border-gray-600/50":"bg-white/60 border-gray-200 hover:bg-white/80 hover:border-gray-300"} hover:shadow-xl group`,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.7+T*.1},whileHover:{y:-2},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(r.div,{whileHover:{scale:1.1},transition:{type:"spring",stiffness:400},children:f(g.conclusion)}),e.jsxs("div",{children:[e.jsx(r.p,{className:`font-semibold text-lg ${w?"text-white":"text-gray-900"}`,whileHover:{x:2},transition:{type:"spring",stiffness:400},children:g.name}),e.jsxs("p",{className:`text-sm ${w?"text-gray-400":"text-gray-500"}`,children:["Run #",g.run_number," • ",g.head_branch]}),e.jsx("div",{className:"flex items-center gap-2 mt-2",children:e.jsx(ot,{type:u(g.conclusion),children:g.conclusion||"unknown"})})]})]}),e.jsxs("div",{className:`text-right text-sm ${w?"text-gray-400":"text-gray-500"}`,children:[e.jsxs("div",{className:"flex items-center justify-end gap-2 mb-2",children:[e.jsx(Pe,{className:"h-4 w-4"}),e.jsx("span",{children:a(g.updated_at)})]}),g.run_started_at&&g.updated_at&&e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(re,{className:"h-4 w-4"}),e.jsx("span",{children:S(new Date(g.updated_at)-new Date(g.run_started_at))})]}),g.html_url&&e.jsxs(r.a,{href:g.html_url,target:"_blank",rel:"noopener noreferrer",className:`flex items-center justify-end gap-1 mt-2 text-xs hover:underline ${w?"text-blue-400 hover:text-blue-300":"text-blue-600 hover:text-blue-700"}`,whileHover:{scale:1.05},children:[e.jsx(qe,{className:"w-3 h-3"}),e.jsx("span",{children:"Pogledaj na GitHub"})]})]})]})},g.id))}):e.jsxs(r.div,{className:`p-12 rounded-2xl backdrop-blur-sm border text-center ${w?"bg-gray-800/40 border-gray-700/50":"bg-white/60 border-gray-200"}`,initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.6},children:[e.jsx(r.div,{className:`w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center ${w?"bg-gray-700/50":"bg-gray-100"}`,animate:{rotate:n?360:0},transition:{duration:n?1:0,repeat:n?1/0:0},children:e.jsx(be,{className:`w-8 h-8 ${w?"text-gray-400":"text-gray-500"}`})}),e.jsx("p",{className:`text-lg font-medium mb-2 ${w?"text-gray-300":"text-gray-700"}`,children:n?"Učitavam workflow podatke...":"Nema pronađenih workflow-a"}),!n&&e.jsx("p",{className:"text-sm text-gray-500",children:"Proveri da li repo ima GitHub Actions ili proveri naziv repo."})]}),e.jsx(r.div,{className:`mt-8 p-4 rounded-xl backdrop-blur-sm border ${w?"bg-gray-800/20 border-gray-700/30":"bg-white/40 border-gray-200/50"}`,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8},children:e.jsxs("div",{className:`text-xs space-y-1 ${w?"text-gray-400":"text-gray-600"}`,children:[e.jsxs("p",{children:["📡 Glavni repo: ",e.jsx("span",{className:"font-mono",children:p})]}),e.jsxs("p",{children:["🔄 Fallback repo: ",e.jsx("span",{className:"font-mono",children:_})]}),e.jsxs("p",{children:["🔑 Token: ","✅ Konfigurisan"]}),e.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[e.jsx("span",{children:"🌐 GitHub Actions:"}),e.jsx(r.a,{href:`https://github.com/${p}/actions`,target:"_blank",rel:"noopener noreferrer",className:`${w?"text-blue-400 hover:text-blue-300":"text-blue-600 hover:text-blue-700"} hover:underline`,whileHover:{scale:1.05},children:"Glavni"}),e.jsx(r.a,{href:`https://github.com/${_}/actions`,target:"_blank",rel:"noopener noreferrer",className:`${w?"text-blue-400 hover:text-blue-300":"text-blue-600 hover:text-blue-700"} hover:underline`,whileHover:{scale:1.05},children:"Fallback"})]})]})})]})},dt=(c=[])=>{const[x,t]=d.useState({totalStops:0,dailyStops:0,extraRides:0,pendingRides:0,activeDrivers:0,totalDrivers:0,avgStopsPerDay:0,latestDate:null,successRate:0}),[n,o]=d.useState(!0),[y,b]=d.useState(null),w=async()=>{var p,_;if(c.length){o(!0),b(null);try{const O=new Date,P=new Date(O.getFullYear(),O.getMonth(),1).toISOString().split("T")[0],B=new Date(O.getFullYear(),0,1).toISOString().split("T")[0],[F,f,u,a,S]=await Promise.all([H.from("deliveries").select("produktivitaet_stops").gte("date",P).eq("deleted",0).not("produktivitaet_stops","is",null),H.from("deliveries").select("produktivitaet_stops, date").eq("deleted",0).not("produktivitaet_stops","is",null).order("date",{ascending:!1}).limit(20),H.from("deliveries").select("produktivitaet_stops, tura, probleme_druga, date").gte("date",B).eq("deleted",0).not("produktivitaet_stops","is",null),H.from("extra_rides").select("id",{count:"exact"}),H.from("extra_rides_pending").select("id",{count:"exact"})]),v=((p=F.data)==null?void 0:p.reduce((V,s)=>V+(s.produktivitaet_stops||0),0))||0;let h=0,g=null;if(((_=f.data)==null?void 0:_.length)>0){const V=f.data.reduce((I,i)=>{const N=i.date;return I[N]||(I[N]=[]),I[N].push(i),I},{}),s=Object.keys(V).sort((I,i)=>new Date(i)-new Date(I))[0];s&&(g=s,h=V[s].reduce((I,i)=>I+(i.produktivitaet_stops||0),0))}let T=0,D=0,m=0;c&&c.length>0&&c.forEach(V=>{var I;const s=((I=u.data)==null?void 0:I.filter(i=>i.tura===V.tura))||[];T+=s.reduce((i,N)=>i+(N.produktivitaet_stops||0),0),D+=s.reduce((i,N)=>i+(N.probleme_druga||0),0),m+=(V.target_per_day||0)*s.length});const j=c.filter(V=>V.aktivan).length,C=c.length,G=O.getDate(),q=G>0?Math.round(v/G):0,L=a.count||0,l=S.count||0,M=L+l>0?L/(L+l)*100:0,z=[{label:"Danas",value:h,trend:h>0?"up":"neutral"},{label:"Reklamacije",value:"0",trend:"neutral"},{label:"Ovaj mjesec",value:v,trend:v>0?"up":"neutral"},{label:"Reklamacije",value:"0",trend:"neutral"},{label:"Ova godina",value:T-m,trend:T-m>0?"up":T-m<0?"down":"neutral"},{label:"Reklamacije",value:D,trend:D===0?"up":"down"}];t({totalStops:v,dailyStops:h,yearlyStops:T,yearlyStopsResult:u,extraRides:L,pendingRides:l,activeDrivers:j,totalDrivers:C,avgStopsPerDay:q,latestDate:g,successRate:parseFloat(M.toFixed(1)),statsArray:z})}catch(O){console.error("Dashboard data fetch error:",O),b(O.message)}finally{o(!1)}}};return d.useEffect(()=>{w()},[c]),{stats:x,loading:n,error:y,refetch:w,getStopsForDate:async p=>{var _;try{return((_=(await H.from("deliveries").select("produktivitaet_stops").eq("date",p).eq("deleted",0).not("produktivitaet_stops","is",null)).data)==null?void 0:_.reduce((P,B)=>P+(B.produktivitaet_stops||0),0))||0}catch(O){return console.error("Greška pri dohvaćanju stopova za dan:",O),0}}}},xt=({data:c,drivers:x,loading:t,error:n,onRefresh:o})=>{const[y,b]=d.useState("default"),[w,k]=d.useState("month"),[p,_]=d.useState(0),[O,P]=d.useState(0),[B,F]=d.useState(0),[f,u]=d.useState(0);d.useEffect(()=>{const m=async()=>{const C=new Date,G=new Date(C.getFullYear(),C.getMonth(),1).toISOString().split("T")[0],q=C.toISOString().split("T")[0],{data:L}=await H.from("deliveries").select("produktivitaet_stops, date").gte("date",G).lte("date",q).eq("deleted",0).not("produktivitaet_stops","is",null),l=(L==null?void 0:L.reduce((z,V)=>z+(V.produktivitaet_stops||0),0))||0,M=[...new Set((L==null?void 0:L.map(z=>z.date))||[])];_(l),F(M.length)},j=async()=>{const C=new Date,G=new Date(C.getFullYear(),0,1).toISOString().split("T")[0],q=C.toISOString().split("T")[0],{data:L}=await H.from("deliveries").select("produktivitaet_stops, date").gte("date",G).lte("date",q).eq("deleted",0).not("produktivitaet_stops","is",null),l=(L==null?void 0:L.reduce((z,V)=>z+(V.produktivitaet_stops||0),0))||0,M=[...new Set((L==null?void 0:L.map(z=>z.date))||[])];P(l),u(M.length)};m(),j()},[]),d.useEffect(()=>{const m=()=>{const C=new Date().getHours();C>=5&&C<8?b("sunrise"):C>=8&&C<12?b("default"):C>=12&&C<17?b("afternoon"):C>=17&&C<20?b("evening"):b("night")};m();const j=setInterval(m,6e4);return()=>clearInterval(j)},[]);const a=y==="night",S=(c==null?void 0:c.dailyStops)||0,v=300,h=v-S,g=(S/v*100).toFixed(2),T=[{title:"Danas - Stops",value:`${S} / ${v} (${g}%)`,subtitle:"Zbir stopova od zadnjeg dana za sve vozače",icon:te,gradient:"from-green-500 to-emerald-500",showSubtitle:!0},{title:"Fali do cilja",value:h>0?h:0,subtitle:`Cilj: ${v} stopova`,icon:oe,gradient:"from-red-500 to-orange-500",showSubtitle:!0},{title:"Extra Vožnje",value:(c==null?void 0:c.extraRides)||0,subtitle:`${(c==null?void 0:c.pendingRides)||0} na čekanju`,icon:Ae,gradient:"from-purple-500 to-pink-500",showSubtitle:!0},{title:"Uspješnost",value:`${(c==null?void 0:c.successRate)||0}%`,subtitle:"Realizovano vožnji",icon:ce,gradient:"from-orange-500 to-red-500",showSubtitle:!0}];if(t)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Q,{className:`w-12 h-12 mx-auto mb-4 animate-spin ${a?"text-blue-400":"text-blue-600"}`}),e.jsx("p",{className:`text-lg ${a?"text-gray-400":"text-gray-600"}`,children:"Učitavanje podataka..."})]})});if(n)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(fe,{className:"w-12 h-12 mx-auto mb-4 text-red-500"}),e.jsxs("p",{className:`text-lg ${a?"text-gray-400":"text-gray-600"}`,children:["Greška pri učitavanju: ",n]}),o&&e.jsx("button",{onClick:o,className:"mt-4 px-6 py-2 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-all",children:"Pokušaj ponovo"})]})});let D=null;if(w==="today")D=e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsx(r.div,{className:`relative overflow-hidden rounded-lg sm:rounded-xl p-3 sm:p-4 ${a?"bg-gray-800/50":"bg-white"} backdrop-blur-xl shadow-lg border ${a?"border-gray-700":"border-gray-100"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br from-green-500 to-emerald-500 flex-shrink-0",children:e.jsx(te,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-xs font-medium ${a?"text-gray-400":"text-gray-600"}`,children:"Stops"}),e.jsx("p",{className:`text-lg sm:text-xl font-bold ${a?"text-white":"text-gray-900"} truncate`,children:S})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Zbir stopova"}),e.jsx("p",{className:`text-xs font-semibold ${a?"text-blue-400":"text-blue-600"}`,children:c!=null&&c.latestDate?new Date(c.latestDate).toLocaleDateString("bs-BA",{day:"2-digit",month:"2-digit",year:"numeric"}):"danas"})]})]})}),e.jsx(r.div,{className:`relative overflow-hidden rounded-lg sm:rounded-xl p-3 sm:p-4 ${a?"bg-gray-800/50":"bg-white"} backdrop-blur-xl shadow-lg border ${a?"border-gray-700":"border-gray-100"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br from-blue-500 to-indigo-600 flex-shrink-0",children:e.jsx(ee,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-xs font-medium ${a?"text-gray-400":"text-gray-600"}`,children:"Cilj"}),e.jsx("p",{className:`text-lg sm:text-xl font-bold ${a?"text-white":"text-gray-900"} truncate`,children:"300"})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Cilj za 4 ture"}),e.jsx("p",{className:"text-xs text-gray-500",children:"je 300"})]})]})}),e.jsx(r.div,{className:`relative overflow-hidden rounded-lg sm:rounded-xl p-3 sm:p-4 ${a?"bg-gray-800/50":"bg-white"} backdrop-blur-xl shadow-lg border ${a?"border-gray-700":"border-gray-100"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg bg-gradient-to-br ${h>0?"from-red-500 to-orange-500":"from-green-500 to-emerald-500"} flex-shrink-0`,children:e.jsx(oe,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-xs font-medium ${a?"text-gray-400":"text-gray-600"}`,children:"Potrebno do cilja"}),e.jsx("p",{className:`text-lg sm:text-xl font-bold ${h>0?"text-red-600":"text-green-600"} truncate`,children:h>0?`-${h}`:h<0?`+${Math.abs(h)}`:0})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsx("p",{className:"text-xs text-gray-500",children:(h>0,"štopovi")}),e.jsx("p",{className:"text-xs text-gray-500",children:h>0?"u minusu":"u plusu"})]})]})}),e.jsx(r.div,{className:`relative overflow-hidden rounded-lg sm:rounded-xl p-3 sm:p-4 ${a?"bg-gray-800/50":"bg-white"} backdrop-blur-xl shadow-lg border ${a?"border-gray-700":"border-gray-100"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br from-orange-500 to-red-500 flex-shrink-0",children:e.jsx(ce,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-xs font-medium ${a?"text-gray-400":"text-gray-600"}`,children:"Uspješnost"}),e.jsxs("p",{className:`text-lg sm:text-xl font-bold ${a?"text-white":"text-gray-900"} truncate`,children:[g,"%"]})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Uspjeh"}),e.jsx("p",{className:"text-xs text-gray-500",children:"u postotku"})]})]})})]});else if(w==="month"){const m=B*300,j=m-p,C=m>0?(p/m*100).toFixed(2):0;D=e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsx(r.div,{className:`relative overflow-hidden rounded-lg sm:rounded-xl p-3 sm:p-4 ${a?"bg-gray-800/50":"bg-white"} backdrop-blur-xl shadow-lg border ${a?"border-gray-700":"border-gray-100"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br from-blue-500 to-indigo-600 flex-shrink-0",children:e.jsx(te,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-xs font-medium ${a?"text-gray-400":"text-gray-600"}`,children:"Stops"}),e.jsx("p",{className:`text-lg sm:text-xl font-bold ${a?"text-white":"text-gray-900"} truncate`,children:p})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Zbir stopova"}),e.jsx("p",{className:`text-xs font-semibold ${a?"text-blue-400":"text-blue-600"}`,children:["Januar","Februar","Mart","April","Maj","Jun","Jul","Avgust","Septembar","Oktobar","Novembar","Decembar"][new Date().getMonth()]})]})]})}),e.jsx(r.div,{className:`relative overflow-hidden rounded-lg sm:rounded-xl p-3 sm:p-4 ${a?"bg-gray-800/50":"bg-white"} backdrop-blur-xl shadow-lg border ${a?"border-gray-700":"border-gray-100"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br from-green-500 to-emerald-500 flex-shrink-0",children:e.jsx(ee,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-xs font-medium ${a?"text-gray-400":"text-gray-600"}`,children:"Cilj"}),e.jsx("p",{className:`text-lg sm:text-xl font-bold ${a?"text-white":"text-gray-900"} truncate`,children:m})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsxs("p",{className:"text-xs text-gray-500",children:[B," dana"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"× 300"})]})]})}),e.jsx(r.div,{className:`relative overflow-hidden rounded-lg sm:rounded-xl p-3 sm:p-4 ${a?"bg-gray-800/50":"bg-white"} backdrop-blur-xl shadow-lg border ${a?"border-gray-700":"border-gray-100"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg bg-gradient-to-br ${j>0?"from-red-500 to-orange-500":"from-green-500 to-emerald-500"} flex-shrink-0`,children:e.jsx(oe,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-xs font-medium ${a?"text-gray-400":"text-gray-600"}`,children:"Potrebno do cilja"}),e.jsx("p",{className:`text-lg sm:text-xl font-bold ${j>0?"text-red-600":"text-green-600"} truncate`,children:j>0?`-${j}`:j<0?`+${Math.abs(j)}`:0})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsx("p",{className:"text-xs text-gray-500",children:(j>0,"štopovi")}),e.jsx("p",{className:"text-xs text-gray-500",children:j>0?"u minusu":"u plusu"})]})]})}),e.jsx(r.div,{className:`relative overflow-hidden rounded-lg sm:rounded-xl p-3 sm:p-4 ${a?"bg-gray-800/50":"bg-white"} backdrop-blur-xl shadow-lg border ${a?"border-gray-700":"border-gray-100"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br from-orange-500 to-red-500 flex-shrink-0",children:e.jsx(ce,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-xs font-medium ${a?"text-gray-400":"text-gray-600"}`,children:"Uspješnost"}),e.jsxs("p",{className:`text-lg sm:text-xl font-bold ${a?"text-white":"text-gray-900"} truncate`,children:[C,"%"]})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Uspjeh"}),e.jsx("p",{className:"text-xs text-gray-500",children:"u postotku"})]})]})})]})}else if(w==="year"){const m=f*300,j=m-O,C=m>0?(O/m*100).toFixed(2):0;D=e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsx(r.div,{className:`relative overflow-hidden rounded-lg sm:rounded-xl p-3 sm:p-4 ${a?"bg-gray-800/50":"bg-white"} backdrop-blur-xl shadow-lg border ${a?"border-gray-700":"border-gray-100"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br from-purple-500 to-pink-500 flex-shrink-0",children:e.jsx(te,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-xs font-medium ${a?"text-gray-400":"text-gray-600"}`,children:"Stops"}),e.jsx("p",{className:`text-lg sm:text-xl font-bold ${a?"text-white":"text-gray-900"} truncate`,children:O})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Zbir stopova"}),e.jsxs("p",{className:`text-xs font-semibold ${a?"text-blue-400":"text-blue-600"}`,children:[new Date().getFullYear(),". godina"]})]})]})}),e.jsx(r.div,{className:`relative overflow-hidden rounded-lg sm:rounded-xl p-3 sm:p-4 ${a?"bg-gray-800/50":"bg-white"} backdrop-blur-xl shadow-lg border ${a?"border-gray-700":"border-gray-100"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br from-green-500 to-emerald-500 flex-shrink-0",children:e.jsx(ee,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-xs font-medium ${a?"text-gray-400":"text-gray-600"}`,children:"Cilj"}),e.jsx("p",{className:`text-lg sm:text-xl font-bold ${a?"text-white":"text-gray-900"} truncate`,children:m})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsxs("p",{className:"text-xs text-gray-500",children:[f," dana"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"× 300"})]})]})}),e.jsx(r.div,{className:`relative overflow-hidden rounded-lg sm:rounded-xl p-3 sm:p-4 ${a?"bg-gray-800/50":"bg-white"} backdrop-blur-xl shadow-lg border ${a?"border-gray-700":"border-gray-100"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg bg-gradient-to-br ${j>0?"from-red-500 to-orange-500":"from-green-500 to-emerald-500"} flex-shrink-0`,children:e.jsx(oe,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-xs font-medium ${a?"text-gray-400":"text-gray-600"}`,children:"Potrebno do cilja"}),e.jsx("p",{className:`text-lg sm:text-xl font-bold ${j>0?"text-red-600":"text-green-600"} truncate`,children:j>0?`-${j}`:j<0?`+${Math.abs(j)}`:0})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsx("p",{className:"text-xs text-gray-500",children:(j>0,"štopovi")}),e.jsx("p",{className:"text-xs text-gray-500",children:j>0?"u minusu":"u plusu"})]})]})}),e.jsx(r.div,{className:`relative overflow-hidden rounded-lg sm:rounded-xl p-3 sm:p-4 ${a?"bg-gray-800/50":"bg-white"} backdrop-blur-xl shadow-lg border ${a?"border-gray-700":"border-gray-100"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br from-orange-500 to-red-500 flex-shrink-0",children:e.jsx(ce,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-xs font-medium ${a?"text-gray-400":"text-gray-600"}`,children:"Uspješnost"}),e.jsxs("p",{className:`text-lg sm:text-xl font-bold ${a?"text-white":"text-gray-900"} truncate`,children:[C,"%"]})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Uspjeh"}),e.jsx("p",{className:"text-xs text-gray-500",children:"u postotku"})]})]})})]})}else D=e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:T.map((m,j)=>e.jsxs(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:j*.1},className:`relative overflow-hidden rounded-2xl p-6 ${a?"bg-gray-800/50":"bg-white"} backdrop-blur-xl shadow-xl border ${a?"border-gray-700":"border-gray-100"}`,children:[e.jsx("div",{className:`absolute top-0 right-0 w-24 h-24 bg-gradient-to-br ${m.gradient} opacity-10 rounded-full blur-2xl`}),e.jsx("div",{className:`inline-flex p-3 rounded-xl bg-gradient-to-br ${m.gradient} mb-4`,children:e.jsx(m.icon,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"relative",children:[e.jsx("p",{className:`text-sm font-medium ${a?"text-gray-400":"text-gray-600"}`,children:m.title}),e.jsx("p",{className:`text-3xl font-bold mt-2 ${a?"text-white":"text-gray-900"}`,children:m.value}),m.showSubtitle&&e.jsx("p",{className:"text-xs mt-2 text-gray-500",children:m.subtitle})]})]},m.title))});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(r.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:`flex flex-col sm:flex-row items-start sm:items-center justify-between p-4 sm:p-6 rounded-2xl ${a?"bg-gray-800/50":"bg-white/50"} backdrop-blur-xl border ${a?"border-gray-700":"border-white/20"} shadow-xl gap-4 sm:gap-0`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(r.div,{animate:{scale:[1,1.1,1]},transition:{duration:2,repeat:1/0},className:"p-2 sm:p-3 rounded-xl bg-gradient-to-r from-blue-500 to-indigo-600",children:e.jsx(Je,{className:"w-5 h-5 sm:w-6 sm:h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:`text-xl sm:text-2xl font-bold ${a?"text-white":"text-gray-800"}`,children:"Dashboard Pregled"}),e.jsx("p",{className:`text-xs sm:text-sm ${a?"text-gray-400":"text-gray-600"}`,children:c!=null&&c.latestDate?`Zadnje ažurirano: ${new Date(c.latestDate).toLocaleDateString("bs-BA")}`:"Pregled statistika"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 w-full sm:w-auto",children:[e.jsx("div",{className:"flex gap-1 sm:gap-2 flex-1 sm:flex-none",children:["today","month","year"].map(m=>e.jsx(r.button,{onClick:()=>k(m),whileHover:{scale:1.05},whileTap:{scale:.95},className:`px-3 py-2 sm:px-4 sm:py-2 rounded-lg sm:rounded-xl font-medium transition-all text-sm sm:text-base flex-1 sm:flex-none ${w===m?a?"bg-gradient-to-r from-blue-600 to-indigo-600 text-white":"bg-gradient-to-r from-blue-500 to-indigo-600 text-white":a?"bg-gray-700 text-gray-300 hover:bg-gray-600":"bg-white/60 text-gray-700 hover:bg-white/80"}`,children:m==="today"?"Danas":m==="month"?"Mjesec":"Godina"},m))}),o&&e.jsx(r.button,{onClick:o,whileHover:{scale:1.05,rotate:180},whileTap:{scale:.95},className:`p-2 sm:p-3 rounded-lg sm:rounded-xl ${a?"bg-gray-700 text-white hover:bg-gray-600":"bg-white text-gray-800 hover:bg-gray-50"} transition-all shadow-lg`,children:e.jsx(Q,{className:"w-4 h-4 sm:w-5 sm:h-5"})})]})]}),D]})};function gt({drivers:c,currentTheme:x="default"}){const[t,n]=d.useState({drivers:[],total:0}),[o,y]=d.useState(!0),[b,w]=d.useState(new Date().getFullYear()),k=x==="night",p=new Date().getFullYear(),_=Array.from({length:p-2019},(P,B)=>2020+B);d.useEffect(()=>{const P=async()=>{y(!0);try{const{getPayrollAnalytics:B}=await se(async()=>{const{getPayrollAnalytics:u}=await import("./chunk-v5-1760908223414-BaSNy0Ok.js");return{getPayrollAnalytics:u}},__vite__mapDeps([5,0,1,2,3])),F=await B(b),f=[...F.drivers].sort((u,a)=>(a.cost||0)-(u.cost||0));n({...F,drivers:f})}catch(B){console.error("Greška pri učitavanju payroll analitike:",B),n({drivers:[],total:0})}finally{y(!1)}};c.length>0&&P()},[c,b]);const O=async()=>{y(!0);try{const{refreshAllPayrolls:P}=await se(async()=>{const{refreshAllPayrolls:u}=await import("./chunk-v5-1760908223414-DR1PuY8k.js");return{refreshAllPayrolls:u}},__vite__mapDeps([6,0,1,2,3,4]));await P();const{getPayrollAnalytics:B}=await se(async()=>{const{getPayrollAnalytics:u}=await import("./chunk-v5-1760908223414-BaSNy0Ok.js");return{getPayrollAnalytics:u}},__vite__mapDeps([5,0,1,2,3])),F=await B(b),f=[...F.drivers].sort((u,a)=>(a.cost||0)-(u.cost||0));n({...F,drivers:f})}catch(P){console.error("Greška u batch refresh:",P),alert("Greška u batch refresh: "+((P==null?void 0:P.message)||P))}finally{y(!1)}};return e.jsx(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.2},className:"p-6",children:e.jsxs("div",{className:`rounded-2xl ${k?"bg-gray-800/50":"bg-white/50"} backdrop-blur-xl border ${k?"border-gray-700":"border-white/20"} shadow-xl p-6`,children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(r.div,{animate:{rotate:[0,360]},transition:{duration:20,repeat:1/0,ease:"linear"},className:"p-2 sm:p-3 rounded-lg sm:rounded-xl bg-gradient-to-r from-emerald-500 to-teal-600",children:e.jsx(ke,{className:"w-5 h-5 sm:w-6 sm:h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:`text-xl sm:text-2xl font-bold ${k?"text-white":"text-gray-800"}`,children:"Troškovi firme po vozaču"}),e.jsxs("p",{className:`text-xs sm:text-sm ${k?"text-gray-400":"text-gray-600"}`,children:["Godina: ",b]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 w-full sm:w-auto",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1 sm:flex-none",children:[e.jsx(Pe,{className:`w-4 h-4 ${k?"text-gray-400":"text-gray-600"}`}),e.jsx("select",{value:b,onChange:P=>w(Number(P.target.value)),className:`flex-1 sm:flex-none px-3 py-2 rounded-lg sm:rounded-xl font-medium transition-all text-sm sm:text-base ${k?"bg-gray-700 text-white border-gray-600":"bg-white text-gray-800 border-gray-200"} border focus:outline-none focus:ring-2 focus:ring-emerald-500`,children:_.map(P=>e.jsx("option",{value:P,children:P},P))})]}),e.jsxs(r.button,{onClick:O,disabled:o,whileHover:{scale:1.05},whileTap:{scale:.95},className:`flex items-center gap-2 px-3 py-2 sm:px-4 sm:py-2 rounded-lg sm:rounded-xl font-medium transition-all text-sm sm:text-base ${o?"opacity-50 cursor-not-allowed":k?"bg-gradient-to-r from-emerald-600 to-teal-600 text-white hover:from-emerald-500 hover:to-teal-500":"bg-gradient-to-r from-emerald-500 to-teal-600 text-white hover:from-emerald-400 hover:to-teal-500"} shadow-lg flex-shrink-0`,children:[e.jsx(Q,{className:`w-4 h-4 ${o?"animate-spin":""}`}),e.jsx("span",{className:"hidden sm:inline",children:"Refresh"})]})]})]}),o?e.jsxs(r.div,{initial:{opacity:0},animate:{opacity:1},className:"flex flex-col items-center justify-center py-12",children:[e.jsx(Q,{className:`w-12 h-12 mb-4 animate-spin ${k?"text-emerald-400":"text-emerald-600"}`}),e.jsx("span",{className:`text-lg ${k?"text-gray-300":"text-gray-600"}`,children:"Učitavanje podataka..."})]}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-6",children:[e.jsx("div",{className:"lg:col-span-2 grid gap-3 sm:gap-4",children:t.drivers.map((P,B)=>e.jsx(r.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:B*.05},className:`p-3 sm:p-4 rounded-lg sm:rounded-xl ${k?"bg-gray-700/50 hover:bg-gray-700/70":"bg-white/60 hover:bg-white/80"} backdrop-blur-sm border ${k?"border-gray-600":"border-white/40"} transition-all hover:scale-[1.02] hover:shadow-lg`,children:e.jsxs("div",{className:"flex items-center gap-3 sm:gap-4",children:[e.jsx("div",{className:"p-2 sm:p-3 rounded-lg bg-gradient-to-br from-blue-500 to-indigo-600 flex-shrink-0",children:e.jsx(Z,{className:"w-4 h-4 sm:w-6 sm:h-6 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:`text-xs sm:text-sm ${k?"text-gray-400":"text-gray-600"}`,children:"Ukupni trošak za"}),e.jsx("div",{className:`font-semibold text-sm sm:text-base ${k?"text-white":"text-gray-800"} capitalize truncate`,children:P.name})]}),e.jsxs("div",{className:`text-base sm:text-xl font-bold ${k?"text-emerald-400":"text-emerald-600"} flex-shrink-0`,children:[(P.cost!==void 0?P.cost:0).toLocaleString("de-DE",{minimumFractionDigits:2})," €"]})]})},P.name))}),e.jsxs(r.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.3},className:`p-4 sm:p-6 rounded-xl sm:rounded-2xl bg-gradient-to-br ${k?"from-emerald-900/50 to-teal-900/50 border-emerald-700/50":"from-emerald-50 to-teal-50 border-emerald-200/50"} border-2 flex flex-col justify-center items-center text-center`,children:[e.jsx(r.div,{animate:{scale:[1,1.1,1]},transition:{duration:2,repeat:1/0},className:"p-3 sm:p-4 rounded-full bg-gradient-to-br from-emerald-500 to-teal-600 mb-3 sm:mb-4",children:e.jsx(ke,{className:"w-6 h-6 sm:w-10 sm:h-10 text-white"})}),e.jsx("div",{className:`text-xs sm:text-sm font-medium mb-2 ${k?"text-gray-300":"text-gray-600"}`,children:"Ukupni trošak za sve vozače"}),e.jsxs("div",{className:`text-xl sm:text-3xl font-bold ${k?"text-white":"text-gray-900"}`,children:[t.total.toLocaleString("de-DE",{minimumFractionDigits:2})," €"]})]})]})]})})}const De=[{id:"dashboard",label:"Dashboard",icon:We,component:"dashboard",description:"Pregled sistema u realnom vremenu",gradient:"from-blue-500 to-purple-600"},{id:"users",label:"Vozači",icon:Z,component:it,description:"Upravljanje vozačima i korisnicima",gradient:"from-green-500 to-teal-600"},{id:"rides",label:"Vožnje",icon:Ae,component:st,description:"Extra vožnje i odobravanja",gradient:"from-orange-500 to-red-600"},{id:"settings",label:"Sistem",icon:ze,component:nt,description:"Sistemske postavke i konfiguracija",gradient:"from-purple-500 to-pink-600"},{id:"github",label:"GitHub",icon:be,component:ct,description:"GitHub integracija i verzije",gradient:"from-gray-600 to-gray-800"}];function mt(){const[c,x]=d.useState("dashboard"),[t,n]=d.useState(!1),[o,y]=d.useState("night"),b=Qe(),{currentUser:w,logout:k,changePassword:p}=Xe(),_=Ie(),{drivers:O}=_,{stats:P,loading:B,error:F,refetch:f}=dt(O),u={night:{background:"from-slate-900 via-blue-900 to-indigo-900",accent:"from-blue-400 to-purple-400"}};d.useEffect(()=>{y("night")},[]);const a=o==="night",S=()=>{const v=De.find(h=>h.id===c);if(c==="dashboard")return e.jsxs(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:[e.jsx(xt,{data:P,drivers:O,loading:B,error:F,onRefresh:f}),e.jsx(gt,{drivers:O,currentTheme:o})]},"dashboard");if(v!=null&&v.component&&typeof v.component!="string"){const h=v.component;return v.id==="github"?e.jsx(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:e.jsx(h,{currentTheme:o})},c):e.jsx(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:e.jsx(h,{driversHook:_,drivers:O})},c)}return e.jsx(r.div,{initial:{opacity:0},animate:{opacity:1},className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:`text-center ${a?"text-gray-400":"text-gray-600"}`,children:[e.jsx(Oe,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),e.jsxs("p",{className:"text-lg",children:['Tab "',c,'" nije implementiran']})]})},"not-implemented")};return e.jsxs("div",{className:`min-h-screen bg-gradient-to-br ${u[o].background} transition-all duration-1000`,children:[e.jsxs("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:[e.jsx(r.div,{animate:{scale:[1,1.2,1],rotate:[0,90,0]},transition:{duration:20,repeat:1/0,ease:"linear"},className:`absolute top-20 left-10 w-96 h-96 bg-gradient-to-r ${u[o].accent} rounded-full mix-blend-multiply filter blur-3xl opacity-20`}),e.jsx(r.div,{animate:{scale:[1.2,1,1.2],rotate:[90,0,90]},transition:{duration:25,repeat:1/0,ease:"linear"},className:`absolute bottom-20 right-10 w-96 h-96 bg-gradient-to-r ${u[o].accent} rounded-full mix-blend-multiply filter blur-3xl opacity-20`})]}),e.jsxs("div",{className:"relative z-10",children:[e.jsx(r.header,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:`sticky top-0 z-50 backdrop-blur-xl ${a?"bg-gray-900/80":"bg-white/80"} border-b ${a?"border-gray-700":"border-gray-200"}`,children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(r.button,{onClick:()=>b(-1),whileHover:{scale:1.05},whileTap:{scale:.95},className:`p-2 rounded-xl ${a?"bg-gray-800 text-white hover:bg-gray-700":"bg-white text-gray-800 hover:bg-gray-50"} shadow-lg transition-all`,children:e.jsx(Ye,{className:"w-6 h-6"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(r.div,{animate:{rotate:[0,360]},transition:{duration:20,repeat:1/0,ease:"linear"},className:`p-3 rounded-xl bg-gradient-to-r ${u[o].accent}`,children:e.jsx(Ke,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:`text-2xl font-bold ${a?"text-white":"text-gray-800"}`,children:"Admin Panel"}),e.jsx("p",{className:`text-sm ${a?"text-gray-400":"text-gray-600"}`,children:"Upravljanje sistemom"})]})]})]}),e.jsx(et,{user:w,onChangePassword:()=>n(!0),onLogout:k,currentTheme:o,themes:u})]}),e.jsx("nav",{className:"mt-6 flex gap-2 overflow-x-auto pb-2 scrollbar-hide",children:De.map(({id:v,label:h,icon:g,description:T,gradient:D})=>{const m=c===v;return e.jsxs(r.button,{onClick:()=>x(v),whileHover:{scale:1.02,y:-2},whileTap:{scale:.98},className:`relative px-4 py-3 rounded-xl flex items-center gap-2 font-medium transition-all ${m?`bg-gradient-to-r ${D} text-white shadow-lg`:a?"bg-gray-800/50 text-gray-300 hover:bg-gray-700/50":"bg-white/50 text-gray-700 hover:bg-white/80"}`,title:T,children:[e.jsx(g,{className:"w-5 h-5"}),e.jsx("span",{className:"whitespace-nowrap",children:h}),m&&e.jsx(r.div,{layoutId:"activeTab",className:"absolute inset-0 rounded-xl border-2 border-white/30",transition:{type:"spring",bounce:.2,duration:.6}})]},v)})})]})}),e.jsx("main",{className:"max-w-7xl mx-auto px-4 py-6",children:e.jsx(Ee,{mode:"wait",children:S()})})]}),e.jsx(tt,{isOpen:t,onClose:()=>n(!1),onChangePassword:p,loading:!1})]})}const jt=Object.freeze(Object.defineProperty({__proto__:null,default:mt},Symbol.toStringTag,{value:"Module"}));export{jt as A,Ie as u};

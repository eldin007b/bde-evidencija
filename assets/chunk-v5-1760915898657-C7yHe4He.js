import{j as e,m as H,i as Le,N as De}from"./chunk-v5-1760915898657-Ct5jlNu9.js";import{r as n,a as Ge,u as He}from"./chunk-v5-1760915898657-DzTHeiPn.js";import{u as Ye,a as Ce,C as Ke,M as We,T as qe,b as Ze,P as Xe,L as Me}from"./chunk-v5-1760915898657-CBsBZvd5.js";const ke={VITE_MAPQUEST_PROXY_URL:"https://dsltpiupbfopyvuiqffg.supabase.co/functions/v1/mapquest-proxy",VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRzbHRwaXVwYmZvcHl2dWlxZmZnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk5Mjc3MzcsImV4cCI6MjA2NTUwMzczN30.suu_OSbTBSEkM3YMiPDFIAgDnX3bDavcD8BX4ZfYZxw",VITE_SUPABASE_URL:"https://dsltpiupbfopyvuiqffg.supabase.co"};var Se={};const f=typeof import.meta<"u"&&ke?ke:{},k=typeof process<"u"&&Se?Se:{},Je="https://dsltpiupbfopyvuiqffg.supabase.co",Qe="",et="https://dsltpiupbfopyvuiqffg.supabase.co/functions/v1",I={SUPABASE_URL:f.VITE_SUPABASE_URL||f.REACT_APP_SUPABASE_URL||k.REACT_APP_SUPABASE_URL||Je,SUPABASE_KEY:f.VITE_SUPABASE_ANON_KEY||f.VITE_SUPABASE_KEY||f.REACT_APP_SUPABASE_KEY||k.REACT_APP_SUPABASE_KEY||Qe,API_BASE_URL:f.VITE_API_BASE_URL||f.REACT_APP_API_BASE_URL||k.REACT_APP_API_BASE_URL||et,GOOGLE_MAPS_API_KEY:f.VITE_GOOGLE_MAPS_API_KEY||f.REACT_APP_GOOGLE_MAPS_API_KEY||k.REACT_APP_GOOGLE_MAPS_API_KEY||"",GOOGLE_DRIVE_API_KEY:f.VITE_GOOGLE_DRIVE_API_KEY||k.VITE_GOOGLE_DRIVE_API_KEY||"",GOOGLE_DRIVE_FOLDER_ID:f.VITE_GOOGLE_DRIVE_FOLDER_ID||k.VITE_GOOGLE_DRIVE_FOLDER_ID||""};I.MAPQUEST_API_KEY=f.VITE_MAPQUEST_API_KEY||f.REACT_APP_MAPQUEST_API_KEY||k.REACT_APP_MAPQUEST_API_KEY||"";I.MAPQUEST_PROXY_URL=f.VITE_MAPQUEST_PROXY_URL||f.REACT_APP_MAPQUEST_PROXY_URL||k.REACT_APP_MAPQUEST_PROXY_URL||`${I.API_BASE_URL}/mapquest-proxy`;I.GITHUB_TOKEN=f.VITE_GITHUB_TOKEN||f.REACT_APP_GITHUB_TOKEN||k.REACT_APP_GITHUB_TOKEN||"";I.GITHUB_REPO=f.VITE_GITHUB_REPO||f.REACT_APP_GITHUB_REPO||k.REACT_APP_GITHUB_REPO||"eldin007b/gls-scraper";I.WORKFLOW_FILE=f.VITE_WORKFLOW_FILE||f.REACT_APP_WORKFLOW_FILE||k.REACT_APP_WORKFLOW_FILE||"scraper.yml";I.ROUTE_STRATEGY=f.VITE_ROUTE_STRATEGY||f.REACT_APP_ROUTE_STRATEGY||k.REACT_APP_ROUTE_STRATEGY||"";I.VORANACHB_URL=f.VITE_VORANACHB_URL||f.REACT_APP_VORANACHB_URL||k.REACT_APP_VORANACHB_URL||"";async function tt(s){var v,m,u,y;const i={id:"ibwmnqg8g2kj8iwg",ver:"1.59",lang:"deu",auth:{type:"AID",aid:"wf7mcf9bv3nv8g5f"},client:{id:"VAO",type:"WEB",name:"webapp",l:"vs_anachb",v:10010,pos:{x:14289510,y:46624050,acc:16.185}},formatted:!1,ext:"VAO.22",svcReqL:[{meth:"LocMatch",req:{input:{field:"S",loc:{type:"ALL",dist:1e3,name:s},maxLoc:7}},id:"1|43|"}]};try{const d=await fetch(`${I.API_BASE_URL}/vor-proxy`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(d.ok){const g=await d.json();return((y=(u=(m=(v=g==null?void 0:g.svcResL)==null?void 0:v[0])==null?void 0:m.res)==null?void 0:u.match)==null?void 0:y.locL)||[]}}catch(d){console.warn("VAO proxy failed, falling back to Nominatim",d)}try{const d=`https://nominatim.openstreetmap.org/search?q=${encodeURIComponent(s)}&format=json&addressdetails=1&limit=8&accept-language=de`,g=await fetch(d,{headers:{"User-Agent":"bde-evidencija/1.0 (+https://eldin007b.github.io/bde-evidencija)"}});return g.ok?(await g.json()).map(a=>({name:a.display_name,nameFormatted:{text:a.display_name},crd:{x:Math.round(a.lon*1e6),y:Math.round(a.lat*1e6)}})):[]}catch(d){return console.warn("Nominatim fallback failed",d),[]}}function X(s){if(s==null)return null;if(s>=1e3){const i=s/1e3;return new Intl.NumberFormat("de-DE",{maximumFractionDigits:1}).format(i)+" km"}return`${s} m`}function J(s){if(s==null)return null;const i=Math.round(s/60);if(i>=60){const v=Math.floor(i/60),m=i%60;return m>0?`${v}h ${m}min`:`${v}h`}return`${i} min`}const st=({children:s,className:i="",style:v,title:m="Mapa dostave - Austrija",loading:u=!1,address:y="",city:d="",onNavigate:g,onSearchSelect:A,mapRef:a,onLocateMe:h,autoLocate:b=!0,selectedMarker:o=null,footerRef:P,isMobile:E=typeof window<"u"?window.innerWidth<768:!1,sidebarLayout:U=!1,headerHeight:Q=80,onMapClickCloseSidebar:T,alwaysShowSearchInterface:L=!1,hideSearchAndInfo:x=!1})=>{const[c,z]=n.useState(null),[S,B]=n.useState(""),[C,ee]=n.useState(""),[F,Y]=n.useState([]),[j,re]=n.useState(null),[M,oe]=n.useState(!1),[V,$]=n.useState(!1),[te,he]=n.useState(!1),[K,ut]=n.useState(null),[Re,ht]=n.useState(!1),[xe,xt]=n.useState(null),[Ie,me]=n.useState(!1),[D,ze]=n.useState(0),[ge,Oe]=n.useState(0),[se,pe]=n.useState(!1),[le,Ve]=n.useState({top:0,left:0,width:0});console.log("üéØ MapCardModern initialized with props:",{address:y,city:d,selectedMarker:o});const O=n.useRef(null),ne=n.useRef(null),fe=typeof window<"u"&&("ontouchstart"in window||navigator.maxTouchPoints>0),ve=typeof window<"u"&&window.innerWidth>=1024,ie=()=>{if(O.current&&E){const t=O.current.getBoundingClientRect();Ve({top:t.bottom+window.scrollY+8,left:t.left+window.scrollX,width:t.width})}},Be=(t,r,l,p)=>{const w=(l-t)*Math.PI/180,N=(p-r)*Math.PI/180,R=Math.sin(w/2)*Math.sin(w/2)+Math.cos(t*Math.PI/180)*Math.cos(l*Math.PI/180)*Math.sin(N/2)*Math.sin(N/2);return 6371*(2*Math.atan2(Math.sqrt(R),Math.sqrt(1-R)))},$e=(t,r=50)=>{if(!t||t<=0)return null;const l=t/1e3/r;return Math.round(l*3600)},be=()=>{var t;(t=a==null?void 0:a.current)!=null&&t.zoomIn&&a.current.zoomIn()},we=()=>{var t;(t=a==null?void 0:a.current)!=null&&t.zoomOut&&a.current.zoomOut()},je=()=>{if(console.log("üìç Lociraj me kliknuto - tra≈æim GPS lokaciju"),!navigator.geolocation){alert("Geolokacija nije podr≈æana u ovom pregledniku.");return}navigator.geolocation.getCurrentPosition(t=>{var l;console.log("üìç GPS lokacija pronaƒëena:",t.coords);const r=[t.coords.latitude,t.coords.longitude];z({lat:t.coords.latitude,lon:t.coords.longitude});try{(l=a==null?void 0:a.current)!=null&&l.setView&&a.current.setView(r,17)}catch(p){console.warn("Map setView not available",p)}h&&h(r)},t=>{console.error("üìç GPS gre≈°ka:",t),alert("Nije moguƒáe dobiti lokaciju. Provjerite dozvole preglednika.")},{enableHighAccuracy:!0,maximumAge:5e3,timeout:15e3})},Ue=async(t,r)=>{me(!0);try{console.log("üîÑ Starting reverse geocoding for:",t,r);try{const l=await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${t}&lon=${r}&accept-language=de,en&addressdetails=1`);if(l.ok){const p=await l.json();if(console.log("üîÑ Nominatim response:",p),p.display_name){let _=p.display_name;if(p.address){const w=p.address;let N="";w.house_number&&w.road?N=`${w.road} ${w.house_number}`:w.road&&(N=w.road),w.postcode&&w.city?N+=N?`, ${w.postcode} ${w.city}`:`${w.postcode} ${w.city}`:w.city&&(N+=N?`, ${w.city}`:w.city),N&&(_=N)}B(_),console.log("üìç Address found via Nominatim:",_);return}}}catch(l){console.warn("üîÑ Nominatim failed:",l)}try{const l={id:"ibwmnqg8g2kj8iwg",ver:"1.59",lang:"deu",auth:{type:"AID",aid:"wf7mcf9bv3nv8g5f"},client:{id:"VAO",type:"WEB",name:"webapp",l:"vs_anachb",v:10010,pos:{x:Math.round(r*1e6),y:Math.round(t*1e6),acc:16.185}},formatted:!1,ext:"VAO.22",svcReqL:[{meth:"LocMatch",req:{input:{field:"S",loc:{type:"ALL",crd:{x:Math.round(r*1e6),y:Math.round(t*1e6)},dist:500},maxLoc:3}},id:"1|43|"}]},p=await fetch(`${I.API_BASE_URL}/vor-proxy`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(p.ok){const _=await p.json();if(console.log("üîÑ VAO response:",_),_.svcResL&&_.svcResL[0]&&_.svcResL[0].res&&_.svcResL[0].res.match&&_.svcResL[0].res.match.locL){const w=_.svcResL[0].res.match.locL;if(w.length>0){const N=w[0];let R="";if(N.nameFormatted&&N.nameFormatted.text?R=N.nameFormatted.text.replace(/<[^>]*>/g,""):N.name&&(R=N.name),R){B(R),console.log("üìç Address found via VAO:",R);return}}}}}catch(l){console.warn("üîÑ VAO fallback failed:",l)}console.log("üìç Using coordinates as final fallback"),B(`${t.toFixed(6)}, ${r.toFixed(6)}`)}catch(l){console.error("üîÑ Reverse geocoding error:",l),B(`${t.toFixed(6)}, ${r.toFixed(6)}`)}finally{me(!1)}},ye=()=>{if(M)document.exitFullscreen&&document.exitFullscreen().then(()=>{oe(!1)});else{const t=ne.current;t!=null&&t.requestFullscreen&&t.requestFullscreen().then(()=>{oe(!0),setTimeout(()=>{var r;(r=a==null?void 0:a.current)!=null&&r.setView&&c&&a.current.setView([c.lat,c.lon],19)},100)})}};n.useEffect(()=>{if(M&&navigator.geolocation){const t=navigator.geolocation.watchPosition(r=>{var p;const l={lat:r.coords.latitude,lon:r.coords.longitude};z(l),ze(r.coords.speed||0),Oe(r.coords.heading||0),(p=a==null?void 0:a.current)!=null&&p.setView&&a.current.setView([l.lat,l.lon],19)},r=>console.error("GPS tracking error:",r),{enableHighAccuracy:!0,maximumAge:1e3,timeout:5e3});return()=>navigator.geolocation.clearWatch(t)}},[M]),n.useEffect(()=>{const t=()=>{oe(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",t),()=>document.removeEventListener("fullscreenchange",t)},[]),n.useEffect(()=>{c&&c.lat&&c.lon&&(console.log("üìç Coordinates changed, starting reverse geocoding:",c),Ue(c.lat,c.lon))},[c]),n.useEffect(()=>{b&&!c&&navigator.geolocation&&(console.log("üöÄ Auto-locating on component mount"),navigator.geolocation.getCurrentPosition(t=>{var r;console.log("üìç Auto-locate GPS found:",t.coords),z({lat:t.coords.latitude,lon:t.coords.longitude});try{(r=a==null?void 0:a.current)!=null&&r.setView&&a.current.setView([t.coords.latitude,t.coords.longitude],15)}catch(l){console.warn("Map setView not available",l)}},t=>{console.warn("üìç Auto-locate failed:",t)},{enableHighAccuracy:!0,maximumAge:1e4,timeout:1e4}))},[b,c,a]),n.useEffect(()=>{if(console.log("üìç Props changed - address:",y,"city:",d,"selectedMarker:",o),y||d||o){console.log("üìç Setting location from props:",{address:y,city:d,selectedMarker:o});let t=null,r=null;o&&(o.lat!==void 0&&o.lon!==void 0?(t=o.lat,r=o.lon):o.lat!==void 0&&o.lng!==void 0&&(t=o.lat,r=o.lng));const l={address:y||"",city:d||"",lat:t,lon:r};if(l.address||l.city||l.lat&&l.lon){re(l),console.log("üéØ Selected location set from external props:",l);const p=(y||"")+(d?`, ${d}`:"");p.trim()&&ee(p.trim())}}else console.log("üìç Clearing selected location - no data"),re(null),ee("")},[y,d,o]),n.useEffect(()=>{const t=()=>{V&&E&&ie()};return window.addEventListener("scroll",t),window.addEventListener("resize",t),()=>{window.removeEventListener("scroll",t),window.removeEventListener("resize",t)}},[V,E]);const Fe=async t=>{if(!t||t.length<3){Y([]);return}he(!0);try{const r=await tt(t);Y(r||[])}catch(r){console.error("Gre≈°ka pri pretra≈æivanju:",r),Y([])}finally{he(!1)}},ce=t=>{const r=t.target.value;if(ee(r),se){pe(!1);return}r.length>=3?Fe(r):Y([])},Ne=t=>{var p,_,w,N;console.log("üéØ Suggestion clicked:",t);const r=(p=t.crd)==null?void 0:p.x,l=(_=t.crd)==null?void 0:_.y;if(typeof r=="number"&&typeof l=="number"&&((w=a==null?void 0:a.current)!=null&&w.setView)){const R=l/1e6,de=r/1e6;a.current.setView([R,de],17);let G=((N=t.nameFormatted)==null?void 0:N.text)||t.name||"",W=G,q="";const Ae=/<br\s*\/?.*?>/i;if(Ae.test(G)){const Z=G.split(Ae);W=Z[0].trim(),q=Z.slice(1).join(" ").trim()}else if(G.includes(",")){const Z=G.split(",");W=Z[0].trim(),q=Z.slice(1).join(",").trim()}const Pe=W+(q?`, ${q}`:"");ee(Pe);const ue={address:W,city:q,lat:R,lon:de,data:{nameFormatted:{text:G},name:W},label:Pe};re(ue),console.log("üéØ Selected location set:",ue),A&&A(ue),Y([]),pe(!0),$(!1),O.current&&O.current.blur()}},_e=()=>{C.trim()&&g&&g(C.trim())},Ee=M?{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",zIndex:9999}:{};return e.jsxs("div",{className:`relative ${i} ${M?"fixed inset-0 z-[9999]":""}`,style:v,children:[ve&&!M?e.jsxs("div",{className:"flex h-screen bg-gradient-to-br from-slate-100 via-white to-blue-50",children:[e.jsx("div",{className:"w-1/2 bg-gradient-to-b from-white via-slate-50 to-blue-50 border-r border-slate-200/50 flex flex-col backdrop-blur-sm",children:e.jsxs("div",{className:"p-6 flex flex-col gap-6 h-full overflow-y-auto",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("h2",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent mb-2",children:"Navigacija"}),e.jsx("p",{className:"text-slate-600",children:"Pronaƒëi rutu do odredi≈°ta"})]}),e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("input",{ref:O,type:"text",value:C,onChange:ce,onFocus:()=>$(!0),onBlur:()=>{setTimeout(()=>{se||$(!1)},200)},className:"w-full px-4 py-3 rounded-2xl border border-slate-300 bg-white/80 backdrop-blur-sm shadow-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all duration-200 placeholder-slate-500",placeholder:"Unesi adresu za navigaciju...",autoComplete:"off"}),V&&(F.length>0||te)&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white/95 backdrop-blur-sm border border-slate-200 rounded-2xl shadow-2xl max-h-60 overflow-y-auto z-[3000]",children:te?e.jsxs("div",{className:"p-4 flex items-center gap-3 text-slate-600",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),"Tra≈æim adrese..."]}):F.length===0?e.jsxs("div",{className:"p-4 text-slate-600",children:['Nema rezultata za "',C,'"']}):F.map((t,r)=>{var l,p;return e.jsx("div",{className:"p-4 hover:bg-blue-50/50 cursor-pointer border-b border-slate-100 last:border-b-0 transition-colors duration-150",onClick:()=>Ne(t),onMouseDown:_=>_.preventDefault(),children:e.jsx("div",{className:"font-medium text-slate-800",children:((p=(l=t.nameFormatted)==null?void 0:l.text)==null?void 0:p.replace(/<[^>]*>/g,""))||t.name||""})},r)})})]}),e.jsx("button",{className:"px-6 py-3 rounded-2xl bg-gradient-to-r from-blue-500 to-blue-600 text-white hover:from-blue-600 hover:to-blue-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-95",onClick:_e,disabled:!C.trim(),title:"Otvori navigaciju",children:e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2L4.5 20.29l.71.71L12 18l6.79 3 .71-.71z"})})})]})})}),e.jsx("div",{className:"space-y-4 flex-1",children:j?e.jsx("div",{className:"p-4 rounded-2xl bg-gradient-to-br from-white/90 via-blue-50/30 to-purple-50/20 backdrop-blur-md border border-white/30 shadow-xl",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[S?e.jsxs("div",{className:"flex items-center gap-2 p-3 rounded-xl bg-gradient-to-r from-emerald-50/80 to-green-50/60 backdrop-blur-sm border border-emerald-200/40",children:[e.jsxs("svg",{className:"w-4 h-4 text-emerald-600 flex-shrink-0",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[e.jsx("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0Z"}),e.jsx("circle",{cx:"12",cy:"10",r:"3"})]}),e.jsx("span",{className:"text-sm font-medium text-slate-800 truncate",title:S,children:S})]}):c?e.jsxs("div",{className:"flex items-center gap-2 p-3 rounded-xl bg-gradient-to-r from-emerald-50/80 to-green-50/60 backdrop-blur-sm border border-emerald-200/40",children:[e.jsxs("svg",{className:"w-4 h-4 text-emerald-600 flex-shrink-0",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[e.jsx("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0Z"}),e.jsx("circle",{cx:"12",cy:"10",r:"3"})]}),e.jsxs("span",{className:"text-sm font-medium text-slate-800 truncate",title:`${c.lat.toFixed(6)}, ${c.lon.toFixed(6)}`,children:[c.lat.toFixed(6),", ",c.lon.toFixed(6)]})]}):e.jsxs("div",{className:"flex items-center gap-2 p-3 rounded-xl bg-gradient-to-r from-gray-50/80 to-slate-50/60 backdrop-blur-sm border border-gray-200/40",children:[e.jsxs("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[e.jsx("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0Z"}),e.jsx("circle",{cx:"12",cy:"10",r:"3"})]}),e.jsx("span",{className:"text-sm font-medium text-slate-600 truncate",children:"Moja lokacija nije dostupna"})]}),e.jsxs("div",{className:"flex items-center gap-2 p-3 rounded-xl bg-gradient-to-r from-rose-50/80 to-red-50/60 backdrop-blur-sm border border-rose-200/40",children:[e.jsxs("svg",{className:"w-4 h-4 text-rose-600 flex-shrink-0",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("circle",{cx:"12",cy:"12",r:"6"}),e.jsx("circle",{cx:"12",cy:"12",r:"2"})]}),e.jsx("span",{className:"text-sm font-medium text-slate-800 truncate",title:`${j.address}${j.city?`, ${j.city}`:""}`,children:`${j.address}${j.city?`, ${j.city}`:""}`})]})]}),e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"text-right bg-gradient-to-br from-blue-50/50 to-indigo-50/30 backdrop-blur-sm border border-blue-200/30 rounded-xl px-4 py-3",children:e.jsxs("div",{className:"text-base font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:[xe?xe.compact:K?e.jsxs(e.Fragment,{children:[K.durationText||J(K.durationSeconds)||"--"," ‚Ä¢ ",K.distanceText||X(K.distanceMeters)||"--"]}):c&&j?(()=>{const t=Be(c.lat,c.lon,j.lat,j.lon),r=Math.round(t*1e3),l=$e(r,40);return l?`${J(l)} ‚Ä¢ ${X(r)}`:"--"})():"--",Re&&e.jsx("span",{className:"ml-2",children:e.jsx("div",{className:"w-3 h-3 border border-blue-500 border-t-transparent rounded-full animate-spin inline-block"})})]})})})]})}):e.jsxs(e.Fragment,{children:[Ie?e.jsx("div",{className:"p-4 rounded-2xl bg-white/80 backdrop-blur-sm border border-slate-200/50 shadow-lg",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:"üìç"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"text-sm text-slate-600 font-medium",children:"Prepoznajem adresu..."})]})]})}):S?e.jsx("div",{className:"p-4 rounded-2xl bg-white/80 backdrop-blur-sm border border-slate-200/50 shadow-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-2xl",children:"ÔøΩ"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-slate-800 mb-1",children:"Moja lokacija"}),e.jsx("p",{className:"text-sm text-slate-600",children:S})]})]})}):c?e.jsx("div",{className:"p-4 rounded-2xl bg-white/70 backdrop-blur-sm border border-slate-200/50 shadow-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-2xl",children:"ÔøΩ"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-slate-800 mb-1",children:"Moja lokacija"}),e.jsxs("p",{className:"text-sm text-slate-600",children:[c.lat.toFixed(6),", ",c.lon.toFixed(6)]})]})]})}):e.jsx("div",{className:"p-4 rounded-2xl bg-white/60 backdrop-blur-sm border border-slate-200/50 shadow-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-2xl opacity-60",children:"üìç"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-slate-700 mb-1",children:"Moja lokacija"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Lokacija nije dostupna"})]})]})}),j&&!S&&e.jsx("div",{className:"p-4 rounded-2xl bg-white/80 backdrop-blur-sm border border-slate-200/50 shadow-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-2xl",children:"üéØ"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-800 mb-1",children:"Odabrana adresa"}),e.jsx("p",{className:"text-sm text-gray-600",children:`${j.address}${j.city?`, ${j.city}`:""}`})]})]})}),C&&!j&&e.jsx("div",{className:"p-3 rounded-lg bg-white border border-gray-200 shadow-sm",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-2xl",children:"üîç"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-800 mb-1",children:"Pretra≈æivanje"}),e.jsx("p",{className:"text-sm text-gray-600",children:C})]})]})})]})})]})}),e.jsx("div",{className:"w-1/2 relative",children:e.jsx("div",{ref:ne,className:"w-full h-full bg-gradient-to-br from-gray-100 via-gray-200 to-gray-300 overflow-hidden",style:Ee,children:u?e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-white/90 backdrop-blur-sm z-20",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mb-6"}),e.jsx("p",{className:"text-slate-700 font-medium text-lg",children:"Uƒçitavam mapu..."})]}):e.jsxs(e.Fragment,{children:[s,e.jsxs("div",{className:"absolute right-6 top-6 flex flex-col gap-3 z-30",children:[e.jsx("button",{className:"w-12 h-12 bg-white/90 backdrop-blur-sm border border-slate-200/50 rounded-2xl shadow-xl hover:shadow-2xl hover:scale-110 active:scale-95 transition-all duration-200 flex items-center justify-center text-slate-700 hover:text-blue-600 hover:bg-white group",onClick:be,title:"Poveƒáaj zoom",children:e.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",className:"group-hover:scale-110 transition-transform",children:e.jsx("path",{d:"M19 11h-6V5h-2v6H5v2h6v6h2v-6h6z"})})}),e.jsx("button",{className:"w-12 h-12 bg-white/90 backdrop-blur-sm border border-slate-200/50 rounded-2xl shadow-xl hover:shadow-2xl hover:scale-110 active:scale-95 transition-all duration-200 flex items-center justify-center text-slate-700 hover:text-blue-600 hover:bg-white group",onClick:we,title:"Smanji zoom",children:e.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",className:"group-hover:scale-110 transition-transform",children:e.jsx("path",{d:"M19 11H5v2h14z"})})}),e.jsx("button",{className:"w-12 h-12 bg-white/90 backdrop-blur-sm border border-slate-200/50 rounded-2xl shadow-xl hover:shadow-2xl hover:scale-110 active:scale-95 transition-all duration-200 flex items-center justify-center text-slate-700 hover:text-emerald-600 hover:bg-white group",onClick:je,title:"Lociraj me",children:e.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",className:"group-hover:scale-110 transition-transform",children:e.jsx("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5a2.5 2.5 0 1 1 0-5 2.5 2.5 0 0 1 0 5z"})})}),fe&&e.jsx("button",{className:"w-12 h-12 bg-gradient-to-br from-purple-500 to-purple-600 text-white border border-purple-400/50 rounded-2xl shadow-xl hover:shadow-2xl hover:scale-110 active:scale-95 transition-all duration-200 flex items-center justify-center hover:from-purple-600 hover:to-purple-700 group",onClick:ye,title:M?"Izaƒëi iz punog ekrana":"Puni ekran",children:e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",className:"group-hover:scale-110 transition-transform",children:M?e.jsx("path",{d:"M18 7h-3V4h-2v3H10V4H8v3H5v2h3v3H5v2h3v3h2v-3h3v3h2v-3h3v-2h-3V9h3V7z"}):e.jsx("path",{d:"M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"})})})]}),c&&e.jsx("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",zIndex:1e3,pointerEvents:"none"},children:D>0?e.jsx("svg",{width:"32",height:"32",viewBox:"0 0 32 32",style:{transform:`rotate(${ge||0}deg)`},children:e.jsx("polygon",{points:"16,4 28,28 16,22 4,28",fill:"green"})}):e.jsx("svg",{width:"32",height:"32",viewBox:"0 0 32 32",children:e.jsx("circle",{cx:"16",cy:"16",r:"12",fill:"red"})})}),e.jsx("div",{className:"absolute right-6 bottom-6 bg-white/95 backdrop-blur-sm border border-slate-300 rounded-2xl px-4 py-3 shadow-xl z-1000",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),e.jsx("span",{className:"font-bold text-lg text-slate-800",children:D?(D*3.6).toFixed(1):"0"}),e.jsx("span",{className:"text-sm text-slate-700 font-medium",children:"km/h"})]})})]})})})]}):e.jsxs("div",{className:`relative ${M?"fixed inset-0":"min-h-[300px] h-full"} ${x&&E?"bg-white":"bg-gradient-to-br from-slate-100 via-white to-blue-50 backdrop-blur-sm rounded-3xl shadow-2xl border border-white/20"} overflow-hidden`,children:[(!x||!E)&&e.jsxs("div",{className:"relative bg-gradient-to-r from-blue-600 via-purple-600 to-blue-700 text-white p-6 backdrop-blur-sm",children:[e.jsx("div",{className:"absolute inset-0 bg-black/10"}),e.jsxs("div",{className:"relative z-10",children:[m&&e.jsx("h3",{className:"text-2xl font-bold mb-2 text-center",children:m}),!x&&e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"flex-1 relative",children:e.jsx("input",{ref:O,type:"text",value:C,onChange:ce,onFocus:()=>{$(!0),ie()},onBlur:()=>{setTimeout(()=>{se||$(!1)},200)},className:"w-full px-4 py-3 rounded-2xl border border-white/30 bg-white/90 backdrop-blur-sm shadow-lg focus:ring-2 focus:ring-white focus:border-white outline-none transition-all duration-200 text-slate-800 placeholder-slate-500",placeholder:"Unesi adresu za navigaciju...",autoComplete:"off"})}),e.jsx("button",{className:"px-6 py-3 rounded-2xl bg-white/20 backdrop-blur-sm border border-white/30 text-white hover:bg-white/30 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg",onClick:_e,disabled:!C.trim(),title:"Otvori navigaciju",children:e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2L4.5 20.29l.71.71L12 18l6.79 3 .71-.71z"})})})]})]})]}),e.jsxs("div",{ref:ne,className:"flex-1 relative min-h-[500px] h-full bg-gradient-to-br from-gray-100 via-gray-200 to-gray-300 w-full box-border overflow-hidden",style:Ee,children:[u?e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-white/90 backdrop-blur-sm z-20",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mb-6"}),e.jsx("p",{className:"text-slate-700 font-medium text-lg",children:"Uƒçitavam mapu..."})]}):e.jsxs(e.Fragment,{children:[s,x&&E&&e.jsx("div",{className:"absolute left-6 top-6 flex flex-col gap-3 z-30",children:e.jsx("button",{className:"w-12 h-12 bg-white/90 backdrop-blur-sm border border-slate-200/50 rounded-2xl shadow-xl hover:shadow-2xl hover:scale-110 active:scale-95 transition-all duration-200 flex items-center justify-center text-slate-700 hover:text-blue-600 hover:bg-white group",onClick:()=>{$(!V),V||(ie(),setTimeout(()=>{O.current&&O.current.focus()},100))},title:"Pretra≈æi lokaciju",children:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",className:"group-hover:scale-110 transition-transform",children:[e.jsx("circle",{cx:"11",cy:"11",r:"8"}),e.jsx("path",{d:"M21 21l-4.35-4.35"})]})})}),x&&E&&V&&e.jsx("div",{className:"absolute left-20 top-6 right-6 z-40",children:e.jsx("div",{className:"h-12 bg-white/95 backdrop-blur-sm border border-slate-200/50 rounded-2xl shadow-xl overflow-hidden",children:e.jsx("input",{ref:O,type:"text",value:C,onChange:ce,onBlur:()=>{setTimeout(()=>{se||$(!1)},200)},className:"w-full h-full px-4 text-sm border-0 bg-transparent focus:ring-0 focus:outline-none text-slate-800 placeholder-slate-500",placeholder:"Unesi adresu za navigaciju...",autoComplete:"off"})})}),e.jsxs("div",{className:"absolute right-6 top-6 flex flex-col gap-3 z-30",children:[e.jsx("button",{className:"w-12 h-12 bg-white/90 backdrop-blur-sm border border-slate-200/50 rounded-2xl shadow-xl hover:shadow-2xl hover:scale-110 active:scale-95 transition-all duration-200 flex items-center justify-center text-slate-700 hover:text-blue-600 hover:bg-white group",onClick:be,title:"Poveƒáaj zoom",children:e.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",className:"group-hover:scale-110 transition-transform",children:e.jsx("path",{d:"M19 11h-6V5h-2v6H5v2h6v6h2v-6h6z"})})}),e.jsx("button",{className:"w-12 h-12 bg-white/90 backdrop-blur-sm border border-slate-200/50 rounded-2xl shadow-xl hover:shadow-2xl hover:scale-110 active:scale-95 transition-all duration-200 flex items-center justify-center text-slate-700 hover:text-blue-600 hover:bg-white group",onClick:we,title:"Smanji zoom",children:e.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",className:"group-hover:scale-110 transition-transform",children:e.jsx("path",{d:"M19 11H5v2h14z"})})}),e.jsx("button",{className:"w-12 h-12 bg-white/90 backdrop-blur-sm border border-slate-200/50 rounded-2xl shadow-xl hover:shadow-2xl hover:scale-110 active:scale-95 transition-all duration-200 flex items-center justify-center text-slate-700 hover:text-emerald-600 hover:bg-white group",onClick:je,title:"Lociraj me",children:e.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",className:"group-hover:scale-110 transition-transform",children:e.jsx("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5a2.5 2.5 0 1 1 0-5 2.5 2.5 0 0 1 0 5z"})})}),fe&&e.jsx("button",{className:"w-12 h-12 bg-gradient-to-br from-purple-500 to-purple-600 text-white border border-purple-400/50 rounded-2xl shadow-xl hover:shadow-2xl hover:scale-110 active:scale-95 transition-all duration-200 flex items-center justify-center hover:from-purple-600 hover:to-purple-700 group",onClick:ye,title:M?"Izaƒëi iz punog ekrana":"Puni ekran",children:e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",className:"group-hover:scale-110 transition-transform",children:M?e.jsx("path",{d:"M18 7h-3V4h-2v3H10V4H8v3H5v2h3v3H5v2h3v3h2v-3h3v3h2v-3h3v-2h-3V9h3V7z"}):e.jsx("path",{d:"M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"})})})]}),c&&e.jsx("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",zIndex:1e3,pointerEvents:"none"},children:D>0?e.jsx("svg",{width:"32",height:"32",viewBox:"0 0 32 32",style:{transform:`rotate(${ge||0}deg)`},children:e.jsx("polygon",{points:"16,4 28,28 16,22 4,28",fill:"green"})}):e.jsx("svg",{width:"32",height:"32",viewBox:"0 0 32 32",children:e.jsx("circle",{cx:"16",cy:"16",r:"12",fill:"red"})})}),e.jsx("div",{className:"absolute right-6 bottom-6 bg-white/95 backdrop-blur-sm border border-slate-300 rounded-2xl px-4 py-3 shadow-xl z-1000",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),e.jsx("span",{className:"font-bold text-lg text-slate-800",children:D?(D*3.6).toFixed(1):"0"}),e.jsx("span",{className:"text-sm text-slate-700 font-medium",children:"km/h"})]})})]}),!ve&&!x&&e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-white/95 via-white/90 to-transparent backdrop-blur-sm border-t border-white/20 p-4 space-y-2",children:[c?e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-lg bg-gradient-to-r from-blue-50/80 to-indigo-50/60 backdrop-blur-sm border border-blue-200/40",children:[e.jsxs("svg",{className:"w-4 h-4 text-blue-600 flex-shrink-0",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[e.jsx("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0Z"}),e.jsx("circle",{cx:"12",cy:"10",r:"3"})]}),e.jsxs("span",{className:"text-xs font-medium text-slate-800 truncate",children:["Moja lokacija: ",c.lat.toFixed(4),", ",c.lon.toFixed(4)]})]}):e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-lg bg-gradient-to-r from-gray-50/80 to-slate-50/60 backdrop-blur-sm border border-gray-200/40",children:[e.jsxs("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[e.jsx("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0Z"}),e.jsx("circle",{cx:"12",cy:"10",r:"3"})]}),e.jsx("span",{className:"text-xs font-medium text-slate-600 truncate",children:"Moja lokacija nije dostupna"})]}),j&&e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-lg bg-gradient-to-r from-rose-50/80 to-red-50/60 backdrop-blur-sm border border-rose-200/40",children:[e.jsxs("svg",{className:"w-4 h-4 text-rose-600 flex-shrink-0",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("circle",{cx:"12",cy:"12",r:"6"}),e.jsx("circle",{cx:"12",cy:"12",r:"2"})]}),e.jsx("span",{className:"text-xs font-medium text-slate-800 truncate",title:`${j.address}${j.city?`, ${j.city}`:""}`,children:`${j.address}${j.city?`, ${j.city}`:""}`})]}),C&&!j&&e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-lg bg-gradient-to-r from-amber-50/80 to-yellow-50/60 backdrop-blur-sm border border-amber-200/40",children:[e.jsxs("svg",{className:"w-4 h-4 text-amber-600 flex-shrink-0",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[e.jsx("circle",{cx:"11",cy:"11",r:"8"}),e.jsx("path",{d:"M21 21l-4.35-4.35"})]}),e.jsxs("span",{className:"text-xs font-medium text-slate-800 truncate",children:["Pretra≈æivanje: ",C]})]})]})]}),U&&e.jsx("div",{className:"w-80 bg-gradient-to-b from-white via-slate-50 to-blue-50 border-l border-slate-200/50 flex flex-col backdrop-blur-sm",children:e.jsxs("div",{ref:P,className:"p-6 flex flex-col gap-4 h-full",children:[e.jsxs("h3",{className:"text-xl font-bold text-slate-800 mb-3 flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),"Informacije"]}),e.jsx("div",{className:"flex flex-col gap-4 flex-1"})]})})]}),E&&(!x&&V||x&&V)&&(F.length>0||te)&&Ge.createPortal(e.jsx("div",{className:"fixed bg-white/95 backdrop-blur-sm border border-slate-200 rounded-xl shadow-xl max-h-48 overflow-y-auto z-[99999]",style:{top:x?"calc(1.5rem + 48px + 8px)":le.top,left:x?"5rem":le.left,right:x?"1.5rem":"auto",width:x?"auto":le.width},children:te?e.jsxs("div",{className:"p-3 flex items-center gap-2 text-slate-600",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"text-sm",children:"Tra≈æim adrese..."})]}):F.length===0?e.jsxs("div",{className:"p-3 text-slate-600 text-sm",children:['Nema rezultata za "',C,'"']}):F.map((t,r)=>{var l,p;return e.jsxs("div",{className:"p-3 hover:bg-blue-50/50 cursor-pointer border-b border-slate-100 last:border-b-0 transition-colors duration-150",onClick:()=>Ne(t),onMouseDown:_=>_.preventDefault(),children:[e.jsx("div",{className:"font-medium text-slate-800 text-sm",children:((p=(l=t.nameFormatted)==null?void 0:l.text)==null?void 0:p.replace(/<[^>]*>/g,""))||t.name||""}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:t.district||t.region||t.country||""})]},r)})}),document.body)]})},at=()=>{const s=Ye();return n.useEffect(()=>{setTimeout(()=>{s.invalidateSize()},200)},[s]),null};function rt(s,i){const v=Math.round(i*1e6),m=Math.round(s*1e6);return{x:v,y:m}}const Te=`${I.API_BASE_URL}/vor-proxy`,ae={id:"ibwmnqg8g2kj8iwg",ver:"1.59",lang:"deu",auth:{type:"AID",aid:"wf7mcf9bv3nv8g5f"},client:{id:"VAO",type:"WEB",name:"webapp",l:"vs_anachb",v:10010,pos:{x:14289513,y:46624058,acc:20}},formatted:!1,ext:"VAO.22",svcReqL:[]};function ot({onAddressSelect:s}){const[i,v]=n.useState(null),[m,u]=n.useState(""),[y,d]=n.useState(null);if(n.useRef(null),Ce({click:a=>{console.log("üó∫Ô∏è Map clicked at:",a.latlng),v(a.latlng),u("Uƒçitavanje adrese..."),d(null);const{x:h,y:b}=rt(a.latlng.lat,a.latlng.lng);console.log("üìç Projected coordinates:",{x:h,y:b}),(async()=>{const o={...ae,client:{...ae.client,pos:{x:h,y:b,acc:20}},svcReqL:[{meth:"LocGeoPos",req:{ring:{cCrd:{x:h,y:b},minDist:0,maxDist:30},maxLoc:1,locFltrL:[{type:"PROD",mode:"INC",value:4087}],getPOIs:!0},id:"1|5|"}]};try{const E=await(await fetch(Te,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})).json();if(E&&E.svcResL&&E.svcResL.length>0&&E.svcResL[0].res&&E.svcResL[0].res.locL&&E.svcResL[0].res.locL.length>0){const L=E.svcResL[0].res.locL[0];let x=L.nameFormatted&&L.nameFormatted.text||L.name||L.txt||"";/^-?\d+\.\d+, ?-?\d+\.\d+$/.test(x)&&(x="Nema adrese za ovu lokaciju"),u(x||"Adresa pronaƒëena"),d({geoData:E,x:h,y:b});let c=x,z="";if(x&&x.includes(",")){const B=x.split(",");c=B[0].trim(),z=B.slice(1).join(",").trim()}const S={address:c,city:z,lat:a.latlng.lat,lon:a.latlng.lng};console.log("üéØ ClickToVORAddress calling onAddressSelect:",S),s&&s(S);return}const U={...ae,client:{...ae.client,pos:{x:h,y:b,acc:20}},svcReqL:[{meth:"LocMatch",req:{input:{field:"S",loc:{type:"C",crd:{x:h,y:b}},maxLoc:1,locFltrL:[{type:"META",value:"in_austria_test"}]}},id:"1|24|"}]},T=await(await fetch(Te,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(U)})).json();if(d({matchData:T,x:h,y:b}),T&&T.svcResL&&T.svcResL.length>0&&T.svcResL[0].res&&T.svcResL[0].res.match&&T.svcResL[0].res.match.locL&&T.svcResL[0].res.match.locL.length>0){const L=T.svcResL[0].res.match.locL[0];let x=L.nameFormatted&&L.nameFormatted.text||L.name||L.txt||"";/^-?\d+\.\d+, ?-?\d+\.\d+$/.test(x)&&(x="Nema adrese za ovu lokaciju"),u(x||"Adresa pronaƒëena");let c=x,z="";if(x&&x.includes(",")){const S=x.split(",");c=S[0].trim(),z=S.slice(1).join(",").trim()}s&&s({address:c,city:z,lat:a.latlng.lat,lon:a.latlng.lng});return}u("Adresa nije pronaƒëena"),s&&s({address:"",city:"",lat:a.latlng.lat,lon:a.latlng.lng})}catch(P){u("Gre≈°ka pri dohvaƒáanju adrese: "+((P==null?void 0:P.message)||JSON.stringify(P))),d(P),s&&s({address:"",city:"",lat:a.latlng.lat,lon:a.latlng.lng})}})()},move:()=>{v(null),u(""),A(!1)}}),m&&m.includes(",")){const a=m.split(",");a[0].trim(),a.slice(1).join(",").trim()}i==null||i.lat,i==null||i.lng;const[g,A]=n.useState(!0);return Ce({}),i?e.jsx(Ke,{center:i,radius:7,pathOptions:{color:"#0ea5e9",fillColor:"#0ea5e9",fillOpacity:.92,weight:1.5}}):null}let lt=Me.divIcon({html:`<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0Z" fill="#ef4444" stroke="#dc2626" stroke-width="2"/>
    <circle cx="12" cy="10" r="3" fill="white"/>
  </svg>`,className:"custom-div-icon",iconSize:[24,24],iconAnchor:[12,24]});Me.Marker.prototype.options.icon=lt;function nt({address:s,lat:i,lon:v,onClose:m,routeInfo:u,userLocation:y}){let d=s,g="";if(s&&s.includes(",")){const h=s.split(",");d=h[0].trim(),g=h.slice(1).join(",").trim()}const A=i&&v?`https://www.google.com/maps/search/?api=1&query=${i},${v}`:"#";let a=null;if(u&&u.distanceMeters&&u.durationSeconds){const h=u.durationText||J(u.durationSeconds)||"--",b=u.distanceText||X(u.distanceMeters)||"--";a=`${h} ‚Ä¢ ${b}`}else if(u&&u.distance&&u.duration){const h=J(u.duration)||"--",b=X(u.distance)||"--";a=`${h} ‚Ä¢ ${b}`}else if(y&&i&&v){const b=(i-y[0])*Math.PI/180,o=(v-y[1])*Math.PI/180,P=Math.sin(b/2)*Math.sin(b/2)+Math.cos(y[0]*Math.PI/180)*Math.cos(i*Math.PI/180)*Math.sin(o/2)*Math.sin(o/2),U=6371*(2*Math.atan2(Math.sqrt(P),Math.sqrt(1-P))),Q=Math.round(U*1e3),L=Q>0?Math.round(U/40*3600):null,x=L?J(L):"--",c=X(Q);a=`${x} ‚Ä¢ ${c}`}return e.jsxs("div",{className:"bg-white/95 backdrop-blur-sm rounded-xl shadow-2xl p-4 min-w-[240px] max-w-[320px] border border-gray-100 relative z-50",onMouseDown:h=>h.stopPropagation(),onClick:h=>h.stopPropagation(),children:[e.jsx("button",{onClick:h=>{h.preventDefault(),h.stopPropagation(),m()},onMouseDown:h=>{h.preventDefault(),h.stopPropagation()},className:"absolute -top-2 -right-2 w-8 h-8 flex items-center justify-center bg-gray-800 text-white hover:bg-gray-900 rounded-full shadow-lg transition-all duration-200 hover:scale-105 z-50","aria-label":"Zatvori popup",title:"Zatvori",children:e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center shadow-lg",children:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2.5",children:[e.jsx("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0Z"}),e.jsx("circle",{cx:"12",cy:"10",r:"3"})]})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-base font-semibold text-gray-900 leading-tight",children:d}),g&&e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:g})]})]}),a&&e.jsx("div",{className:"flex items-center justify-center py-2 px-4 bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg border border-blue-100",children:e.jsx("div",{className:"text-lg font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:a})}),e.jsx("button",{onClick:()=>window.open(A,"_blank"),className:"w-full py-3 px-4 bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white font-semibold rounded-xl shadow-lg hover:shadow-xl transition-all duration-200 hover:scale-[1.02] active:scale-[0.98]",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2L4.5 20.29l.71.71L12 18l6.79 3 .71-.71z"})}),"Pokreni navigaciju"]})})]})]})}function it({position:s}){return null}function ct({marker:s,onAddressSelect:i,routeInfo:v,userLocation:m}){var d,g,A;const u=n.useRef();if(n.useEffect(()=>{u.current&&s&&s.lat&&s.lon&&setTimeout(()=>{u.current.openPopup()},100)},[s==null?void 0:s.lat,s==null?void 0:s.lon]),!s||!s.lat||!s.lon)return null;const y=[s.lat,s.lon];return e.jsx(Ze,{position:y,ref:u,children:e.jsx(Xe,{autoPan:!0,autoClose:!1,closeOnClick:!1,children:e.jsx(nt,{address:((g=(d=s.data)==null?void 0:d.nameFormatted)==null?void 0:g.text)||((A=s.data)==null?void 0:A.name)||s.label||`${s.address||""}${s.city?`, ${s.city}`:""}`,lat:s.lat,lon:s.lon,routeInfo:v,userLocation:m,onClose:()=>{i&&i(null)}})})})}function dt({onAddressSelect:s,mapRef:i,selectedMarker:v,userLocation:m,routeInfo:u}){const y=n.useRef(),d=i||y,g=n.useCallback(A=>{d&&(d.current=A)},[d]);return e.jsx("div",{className:"relative w-full h-full bg-gray-100",children:e.jsx("div",{className:"w-full h-full",children:e.jsxs(We,{center:[47.0707,15.4395],zoom:8,className:"w-full h-full z-0",ref:g,maxZoom:18,minZoom:6,zoomControl:!1,attributionControl:!1,children:[e.jsx(qe,{url:"https://maps.wien.gv.at/basemap/geolandbasemap/normal/google3857/{z}/{y}/{x}.png",attribution:'Datenquelle: <a href="https://www.basemap.at">basemap.at</a>',maxZoom:19}),e.jsx(at,{}),m&&e.jsx(it,{position:m}),v&&e.jsx(ct,{marker:v,onAddressSelect:s,routeInfo:u,userLocation:m}),e.jsx(ot,{onAddressSelect:s})]})})})}const ft=()=>{const s=He(),i=n.useRef(null),v=n.useRef(null),[m,u]=n.useState("night"),[y,d]=n.useState(null),[g,A]=n.useState({address:"",city:"",lat:null,lon:null}),a={night:{background:"from-slate-900 via-blue-900 to-indigo-900",accent:"from-blue-400 to-purple-400"}};n.useEffect(()=>{u("night")},[]);const h=m==="night",b=typeof window<"u"?window.innerWidth<768:!1;return n.useEffect(()=>{const o=()=>{i.current&&typeof i.current.invalidateSize=="function"&&(console.log("üó∫Ô∏è Invalidating map size..."),i.current.invalidateSize())},P=setTimeout(o,500);return window.addEventListener("resize",o),()=>{clearTimeout(P),window.removeEventListener("resize",o)}},[]),n.useEffect(()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(o=>d([o.coords.latitude,o.coords.longitude]),o=>console.warn("Geolocation error:",o))},[]),e.jsxs("div",{className:`min-h-screen bg-gradient-to-br ${a[m].background} transition-all duration-1000`,children:[e.jsxs("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:[e.jsx(H.div,{animate:{scale:[1,1.2,1],rotate:[0,90,0]},transition:{duration:20,repeat:1/0,ease:"linear"},className:`absolute top-20 left-10 w-96 h-96 bg-gradient-to-r ${a[m].accent} rounded-full mix-blend-multiply filter blur-3xl opacity-20`}),e.jsx(H.div,{animate:{scale:[1.2,1,1.2],rotate:[90,0,90]},transition:{duration:25,repeat:1/0,ease:"linear"},className:`absolute bottom-20 right-10 w-96 h-96 bg-gradient-to-r ${a[m].accent} rounded-full mix-blend-multiply filter blur-3xl opacity-20`})]}),e.jsx(H.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6},className:"relative z-10",children:e.jsx("div",{className:"flex items-center justify-between p-4 md:p-6",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(H.button,{onClick:()=>s(-1),whileHover:{scale:1.05},whileTap:{scale:.95},className:`p-3 rounded-xl backdrop-blur-sm border transition-all duration-200 ${h?"bg-gray-800/90 border-gray-700 text-gray-100 hover:bg-gray-700/90":"bg-white/90 border-gray-200 text-gray-700 hover:bg-white/95"} shadow-lg hover:shadow-xl`,children:e.jsx(Le,{className:"w-6 h-6"})}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`p-3 rounded-xl bg-gradient-to-r ${a[m].accent} shadow-lg`,children:e.jsx(De,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:`text-2xl font-bold ${h?"text-white":"text-gray-900"}`,children:"Navigacija"}),e.jsx("p",{className:`text-sm ${h?"text-gray-400":"text-gray-600"}`,children:"Mapa dostave - Austrija"})]})]})]})})}),e.jsx(H.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:`relative z-10 ${b?"h-screen":"px-2 md:px-6 pb-2 md:pb-6"}`,children:e.jsx("div",{className:`${b?"h-full":`rounded-lg md:rounded-2xl backdrop-blur-sm border overflow-hidden shadow-2xl h-[calc(100vh-120px)] md:h-[calc(100vh-160px)] ${h?"bg-gray-800/90 border-gray-700":"bg-white/90 border-gray-200"}`}`,children:e.jsx(st,{title:"Navigacija - Mapa dostave",mapRef:i,footerRef:v,className:"h-full w-full",style:{height:"100%",width:"100%"},address:(g==null?void 0:g.address)||"",city:(g==null?void 0:g.city)||"",selectedMarker:g,headerHeight:b?120:160,sidebarLayout:!b,hideSearchAndInfo:b,onNavigate:o=>{if(o&&typeof o=="object"&&typeof o.lat=="number"&&typeof o.lon=="number"){window.open(`https://www.google.com/maps/dir/?api=1&destination=${encodeURIComponent(`${o.lat},${o.lon}`)}&travelmode=driving`,"_blank");return}o&&window.open(`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(o)}`,"_blank")},onSearchSelect:o=>{console.log("üéØ Address selected:",o),A(o)},onLocateMe:d,children:e.jsx(dt,{onAddressSelect:o=>{console.log("üó∫Ô∏è MapView address select:",o),A(o)},mapRef:i,selectedMarker:g,userLocation:y,routeInfo:null})})})}),b&&e.jsx(H.button,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.3,delay:.2},onClick:()=>s(-1),className:"fixed top-4 left-4 z-50 p-3 rounded-2xl bg-white/90 backdrop-blur-sm border border-gray-200/50 shadow-xl hover:shadow-2xl hover:scale-105 active:scale-95 transition-all duration-200",children:e.jsx(Le,{className:"w-6 h-6 text-gray-700"})})]})};export{ft as default};

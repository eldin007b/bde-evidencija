import{j as e,m as Y,i as Te,N as Ye}from"./chunk-v5-1760917804227-BEi5jB5u.js";import{r as d,a as Ke,u as qe}from"./chunk-v5-1760917804227-DzTHeiPn.js";import{u as We,a as Le,C as Qe,M as Ze,T as Je,b as Xe,P as et,L as Ie}from"./chunk-v5-1760917804227-BqcAwtq0.js";const ke={VITE_MAPQUEST_PROXY_URL:"https://dsltpiupbfopyvuiqffg.supabase.co/functions/v1/mapquest-proxy",VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRzbHRwaXVwYmZvcHl2dWlxZmZnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk5Mjc3MzcsImV4cCI6MjA2NTUwMzczN30.suu_OSbTBSEkM3YMiPDFIAgDnX3bDavcD8BX4ZfYZxw",VITE_SUPABASE_URL:"https://dsltpiupbfopyvuiqffg.supabase.co"};var Ce={};const j=typeof import.meta<"u"&&ke?ke:{},L=typeof process<"u"&&Ce?Ce:{},tt="https://dsltpiupbfopyvuiqffg.supabase.co",st="",rt="https://dsltpiupbfopyvuiqffg.supabase.co/functions/v1",P={SUPABASE_URL:j.VITE_SUPABASE_URL||j.REACT_APP_SUPABASE_URL||L.REACT_APP_SUPABASE_URL||tt,SUPABASE_KEY:j.VITE_SUPABASE_ANON_KEY||j.VITE_SUPABASE_KEY||j.REACT_APP_SUPABASE_KEY||L.REACT_APP_SUPABASE_KEY||st,API_BASE_URL:j.VITE_API_BASE_URL||j.REACT_APP_API_BASE_URL||L.REACT_APP_API_BASE_URL||rt,GOOGLE_MAPS_API_KEY:j.VITE_GOOGLE_MAPS_API_KEY||j.REACT_APP_GOOGLE_MAPS_API_KEY||L.REACT_APP_GOOGLE_MAPS_API_KEY||"",GOOGLE_DRIVE_API_KEY:j.VITE_GOOGLE_DRIVE_API_KEY||L.VITE_GOOGLE_DRIVE_API_KEY||"",GOOGLE_DRIVE_FOLDER_ID:j.VITE_GOOGLE_DRIVE_FOLDER_ID||L.VITE_GOOGLE_DRIVE_FOLDER_ID||""};P.MAPQUEST_API_KEY=j.VITE_MAPQUEST_API_KEY||j.REACT_APP_MAPQUEST_API_KEY||L.REACT_APP_MAPQUEST_API_KEY||"";P.MAPQUEST_PROXY_URL=j.VITE_MAPQUEST_PROXY_URL||j.REACT_APP_MAPQUEST_PROXY_URL||L.REACT_APP_MAPQUEST_PROXY_URL||`${P.API_BASE_URL}/mapquest-proxy`;P.GITHUB_TOKEN=j.VITE_GITHUB_TOKEN||j.REACT_APP_GITHUB_TOKEN||L.REACT_APP_GITHUB_TOKEN||"";P.GITHUB_REPO=j.VITE_GITHUB_REPO||j.REACT_APP_GITHUB_REPO||L.REACT_APP_GITHUB_REPO||"eldin007b/gls-scraper";P.WORKFLOW_FILE=j.VITE_WORKFLOW_FILE||j.REACT_APP_WORKFLOW_FILE||L.REACT_APP_WORKFLOW_FILE||"scraper.yml";P.ROUTE_STRATEGY=j.VITE_ROUTE_STRATEGY||j.REACT_APP_ROUTE_STRATEGY||L.REACT_APP_ROUTE_STRATEGY||"";P.VORANACHB_URL=j.VITE_VORANACHB_URL||j.REACT_APP_VORANACHB_URL||L.REACT_APP_VORANACHB_URL||"";async function ot(t){var u,i,a,g;const r={id:"ibwmnqg8g2kj8iwg",ver:"1.59",lang:"deu",auth:{type:"AID",aid:"wf7mcf9bv3nv8g5f"},client:{id:"VAO",type:"WEB",name:"webapp",l:"vs_anachb",v:10010,pos:{x:14289510,y:46624050,acc:16.185}},formatted:!1,ext:"VAO.22",svcReqL:[{meth:"LocMatch",req:{input:{field:"S",loc:{type:"ALL",dist:1e3,name:t},maxLoc:7}},id:"1|43|"}]};try{const h=await fetch(`${P.API_BASE_URL}/vor-proxy`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});console.debug("[AddressSearchService] vor-proxy status:",h.status);try{const m=await h.text();console.debug("[AddressSearchService] vor-proxy response (preview):",m.slice(0,1e3));const N=m?JSON.parse(m):null;return((g=(a=(i=(u=N==null?void 0:N.svcResL)==null?void 0:u[0])==null?void 0:i.res)==null?void 0:a.match)==null?void 0:g.locL)||[]}catch(m){console.warn("[AddressSearchService] Failed to parse vor-proxy response as JSON",m)}}catch(h){console.warn("VAO proxy failed, falling back to Nominatim",h)}try{const h=`https://nominatim.openstreetmap.org/search?q=${encodeURIComponent(t)}&format=json&addressdetails=1&limit=8&accept-language=de`,m=await fetch(h,{headers:{"User-Agent":"bde-evidencija/1.0 (+https://eldin007b.github.io/bde-evidencija)"}});return m.ok?(await m.json()).map(o=>({name:o.display_name,nameFormatted:{text:o.display_name},crd:{x:Math.round(o.lon*1e6),y:Math.round(o.lat*1e6)}})):[]}catch(h){return console.warn("Nominatim fallback failed",h),[]}}function $e(t){var a;if(t.info.statuscode!==0){const g={400:"Bad request",401:"Unauthorized - check API key",403:"Forbidden",500:"MapQuest server error"};throw new Error(`MapQuest API error ${t.info.statuscode}: ${g[t.info.statuscode]||((a=t.info.messages)==null?void 0:a.join(", "))||"Unknown error"}`)}const r=t.route;if(!r)throw new Error("No route data received from MapQuest");const u=Math.round(r.distance*1e3),i=Math.round(r.time);return{distanceMeters:u,distanceText:ct(u),durationSeconds:i,durationText:dt(i),mapQuestData:{fuelUsed:r.fuelUsed,realTime:r.hasRealTime,sessionId:r.sessionId}}}async function at(t,r,u,i){return await lt(t,r,u,i)}async function lt(t,r,u,i){if(P.MAPQUEST_PROXY_URL)try{return await nt(t,r,u,i)}catch{}try{return await it(t,r,u,i)}catch(a){throw new Error(`Both MapQuest methods failed. Proxy: ${(proxyError==null?void 0:proxyError.message)||"not available"}, Direct: ${a.message}`)}}async function nt(t,r,u,i){try{const a={locations:[{latLng:{lat:t,lng:r}},{latLng:{lat:u,lng:i}}],options:{routeType:"fastest",unit:"k",doReverseGeocode:!1,enhancesNarratives:!1,avoidTimedConditions:!1}},g=P.MAPQUEST_PROXY_URL||`${P.API_BASE_URL}/mapquest-proxy`,h=await fetch(g,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!h.ok)throw new Error(`MapQuest proxy error: ${h.status} - ${h.statusText}`);const m=await h.json();return $e(m)}catch(a){throw a}}async function it(t,r,u,i){const a=P.MAPQUEST_API_KEY;if(!a||a==="your_mapquest_key_here")throw new Error("MapQuest API key not configured");try{const g=`https://www.mapquestapi.com/directions/v2/route?key=${encodeURIComponent(a)}`,m=await fetch(g,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({locations:[{latLng:{lat:t,lng:r}},{latLng:{lat:u,lng:i}}],options:{routeType:"fastest",unit:"k",doReverseGeocode:!1,enhancesNarratives:!1,avoidTimedConditions:!1}})});if(!m.ok)throw new Error(`MapQuest API error: ${m.status} - ${m.statusText}`);const N=await m.json();return $e(N)}catch(g){throw g}}function ct(t){if(t==null)return null;if(t>=1e3){const r=t/1e3;return new Intl.NumberFormat("de-DE",{maximumFractionDigits:1}).format(r)+" km"}return`${t} m`}function dt(t){if(t==null)return null;const r=Math.round(t/60);if(r>=60){const u=Math.floor(r/60),i=r%60;return i>0?`${u}h ${i}min`:`${u}h`}return`${r} min`}function J(t){if(t==null)return null;if(t>=1e3){const r=t/1e3;return new Intl.NumberFormat("de-DE",{maximumFractionDigits:1}).format(r)+" km"}return`${t} m`}function X(t){if(t==null)return null;const r=Math.round(t/60);if(r>=60){const u=Math.floor(r/60),i=r%60;return i>0?`${u}h ${i}min`:`${u}h`}return`${r} min`}async function ut(t,r,u,i){try{const a=await at(t,r,u,i);return a?{...a,source:"mapquest"}:{distanceMeters:null,distanceText:null,durationSeconds:null,durationText:null,source:"none"}}catch(a){return console.warn("MapQuest routing failed:",(a==null?void 0:a.message)||a),{distanceMeters:null,distanceText:null,durationSeconds:null,durationText:null,source:"none",error:(a==null?void 0:a.message)||String(a)}}}const ht=({children:t,className:r="",style:u,title:i="Mapa dostave - Austrija",loading:a=!1,address:g="",city:h="",onNavigate:m,onSearchSelect:N,mapRef:o,onLocateMe:p,autoLocate:y=!0,selectedMarker:c=null,footerRef:M,isMobile:_=typeof window<"u"?window.innerWidth<768:!1,sidebarLayout:F=!1,headerHeight:ee=80,onMapClickCloseSidebar:C,alwaysShowSearchInterface:S=!1,hideSearchAndInfo:f=!1})=>{const[x,$]=d.useState(null),[k,B]=d.useState(""),[T,te]=d.useState(""),[D,K]=d.useState([]),[v,ae]=d.useState(null),[R,le]=d.useState(!1),[U,V]=d.useState(!1),[se,he]=d.useState(!1),[q,xe]=d.useState(null),[Oe,me]=d.useState(!1),[pe,jt]=d.useState(null),[ze,ge]=d.useState(!1),[G,Ue]=d.useState(0),[fe,Be]=d.useState(0),[re,ve]=d.useState(!1),[ne,Ve]=d.useState({top:0,left:0,width:0});console.log("üéØ MapCardModern initialized with props:",{address:g,city:h,selectedMarker:c});const O=d.useRef(null),ie=d.useRef(null),be=typeof window<"u"&&("ontouchstart"in window||navigator.maxTouchPoints>0),we=typeof window<"u"&&window.innerWidth>=1024,ce=()=>{if(O.current&&_){const s=O.current.getBoundingClientRect();Ve({top:s.bottom+window.scrollY+8,left:s.left+window.scrollX,width:s.width})}},Fe=(s,n,l,w)=>{const b=(l-s)*Math.PI/180,E=(w-n)*Math.PI/180,I=Math.sin(b/2)*Math.sin(b/2)+Math.cos(s*Math.PI/180)*Math.cos(l*Math.PI/180)*Math.sin(E/2)*Math.sin(E/2);return 6371*(2*Math.atan2(Math.sqrt(I),Math.sqrt(1-I)))},De=(s,n=50)=>{if(!s||s<=0)return null;const l=s/1e3/n;return Math.round(l*3600)},je=()=>{var s;(s=o==null?void 0:o.current)!=null&&s.zoomIn&&o.current.zoomIn()},ye=()=>{var s;(s=o==null?void 0:o.current)!=null&&s.zoomOut&&o.current.zoomOut()},Ne=()=>{if(console.log("üìç Lociraj me kliknuto - tra≈æim GPS lokaciju"),!navigator.geolocation){alert("Geolokacija nije podr≈æana u ovom pregledniku.");return}navigator.geolocation.getCurrentPosition(s=>{var l;console.log("üìç GPS lokacija pronaƒëena:",s.coords);const n=[s.coords.latitude,s.coords.longitude];$({lat:s.coords.latitude,lon:s.coords.longitude});try{(l=o==null?void 0:o.current)!=null&&l.setView&&o.current.setView(n,17)}catch(w){console.warn("Map setView not available",w)}p&&p(n)},s=>{console.error("üìç GPS gre≈°ka:",s),alert("Nije moguƒáe dobiti lokaciju. Provjerite dozvole preglednika.")},{enableHighAccuracy:!0,maximumAge:5e3,timeout:15e3})},Ge=async(s,n)=>{ge(!0);try{console.log("üîÑ Starting reverse geocoding for:",s,n);try{const l=await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${s}&lon=${n}&accept-language=de,en&addressdetails=1`);if(l.ok){const w=await l.json();if(console.log("üîÑ Nominatim response:",w),w.display_name){let A=w.display_name;if(w.address){const b=w.address;let E="";b.house_number&&b.road?E=`${b.road} ${b.house_number}`:b.road&&(E=b.road),b.postcode&&b.city?E+=E?`, ${b.postcode} ${b.city}`:`${b.postcode} ${b.city}`:b.city&&(E+=E?`, ${b.city}`:b.city),E&&(A=E)}B(A),console.log("üìç Address found via Nominatim:",A);return}}}catch(l){console.warn("üîÑ Nominatim failed:",l)}try{const l={id:"ibwmnqg8g2kj8iwg",ver:"1.59",lang:"deu",auth:{type:"AID",aid:"wf7mcf9bv3nv8g5f"},client:{id:"VAO",type:"WEB",name:"webapp",l:"vs_anachb",v:10010,pos:{x:Math.round(n*1e6),y:Math.round(s*1e6),acc:16.185}},formatted:!1,ext:"VAO.22",svcReqL:[{meth:"LocMatch",req:{input:{field:"S",loc:{type:"ALL",crd:{x:Math.round(n*1e6),y:Math.round(s*1e6)},dist:500},maxLoc:3}},id:"1|43|"}]},w=await fetch(`${P.API_BASE_URL}/vor-proxy`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});console.debug("[MapCardModern] vor-proxy status:",w.status);try{const A=await w.text();console.debug("[MapCardModern] vor-proxy response (preview):",A?A.slice(0,1e3):"");const b=A?JSON.parse(A):null;if(console.log("üîÑ VAO response:",b),b&&Array.isArray(b.svcResL)&&b.svcResL[0]&&b.svcResL[0].res&&b.svcResL[0].res.match&&Array.isArray(b.svcResL[0].res.match.locL)){const E=b.svcResL[0].res.match.locL;if(E.length>0){const I=E[0];let z="";if(I.nameFormatted&&I.nameFormatted.text?z=I.nameFormatted.text.replace(/<[^>]*>/g,""):I.name&&(z=I.name),z){B(z),console.log("üìç Address found via VAO:",z);return}}}}catch(A){console.warn("üîÑ VAO fallback failed (parse/response):",A)}}catch(l){console.warn("üîÑ VAO proxy request failed:",l)}console.log("üìç Using coordinates as final fallback"),B(`${s.toFixed(6)}, ${n.toFixed(6)}`)}catch(l){console.error("üîÑ Reverse geocoding error:",l),B(`${s.toFixed(6)}, ${n.toFixed(6)}`)}finally{ge(!1)}},_e=()=>{if(R)document.exitFullscreen&&document.exitFullscreen().then(()=>{le(!1)});else{const s=ie.current;s!=null&&s.requestFullscreen&&s.requestFullscreen().then(()=>{le(!0),setTimeout(()=>{var n;(n=o==null?void 0:o.current)!=null&&n.setView&&x&&o.current.setView([x.lat,x.lon],19)},100)})}};d.useEffect(()=>{if(R&&navigator.geolocation){const s=navigator.geolocation.watchPosition(n=>{var w;const l={lat:n.coords.latitude,lon:n.coords.longitude};$(l),Ue(n.coords.speed||0),Be(n.coords.heading||0),(w=o==null?void 0:o.current)!=null&&w.setView&&o.current.setView([l.lat,l.lon],19)},n=>console.error("GPS tracking error:",n),{enableHighAccuracy:!0,maximumAge:1e3,timeout:5e3});return()=>navigator.geolocation.clearWatch(s)}},[R]),d.useEffect(()=>{const s=()=>{le(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",s),()=>document.removeEventListener("fullscreenchange",s)},[]),d.useEffect(()=>{x&&x.lat&&x.lon&&(console.log("üìç Coordinates changed, starting reverse geocoding:",x),Ge(x.lat,x.lon))},[x]),d.useEffect(()=>{let s=!1;return(async()=>{if(!(!x||!v||!v.lat||!v.lon))try{me(!0),console.debug("üó∫Ô∏è Computing route from",x,"to",v);const l=await ut(x.lat,x.lon,v.lat,v.lon);if(s)return;xe(l||null)}catch(l){console.warn("üó∫Ô∏è Route computation failed:",(l==null?void 0:l.message)||l),s||xe(null)}finally{s||me(!1)}})(),()=>{s=!0}},[x,v]),d.useEffect(()=>{y&&!x&&navigator.geolocation&&(console.log("üöÄ Auto-locating on component mount"),navigator.geolocation.getCurrentPosition(s=>{var n;console.log("üìç Auto-locate GPS found:",s.coords),$({lat:s.coords.latitude,lon:s.coords.longitude});try{(n=o==null?void 0:o.current)!=null&&n.setView&&o.current.setView([s.coords.latitude,s.coords.longitude],15)}catch(l){console.warn("Map setView not available",l)}},s=>{console.warn("üìç Auto-locate failed:",s)},{enableHighAccuracy:!0,maximumAge:1e4,timeout:1e4}))},[y,x,o]),d.useEffect(()=>{if(console.log("üìç Props changed - address:",g,"city:",h,"selectedMarker:",c),g||h||c){console.log("üìç Setting location from props:",{address:g,city:h,selectedMarker:c});let s=null,n=null;c&&(c.lat!==void 0&&c.lon!==void 0?(s=c.lat,n=c.lon):c.lat!==void 0&&c.lng!==void 0&&(s=c.lat,n=c.lng));const l={address:g||"",city:h||"",lat:s,lon:n};if(l.address||l.city||l.lat&&l.lon){ae(l),console.log("üéØ Selected location set from external props:",l);const w=(g||"")+(h?`, ${h}`:"");w.trim()&&te(w.trim())}}else console.log("üìç Clearing selected location - no data"),ae(null),te("")},[g,h,c]),d.useEffect(()=>{const s=()=>{U&&_&&ce()};return window.addEventListener("scroll",s),window.addEventListener("resize",s),()=>{window.removeEventListener("scroll",s),window.removeEventListener("resize",s)}},[U,_]);const He=async s=>{if(!s||s.length<3){K([]);return}he(!0);try{const n=await ot(s);K(n||[])}catch(n){console.error("Gre≈°ka pri pretra≈æivanju:",n),K([])}finally{he(!1)}},de=s=>{const n=s.target.value;if(te(n),re){ve(!1);return}n.length>=3?He(n):K([])},Ae=s=>{var w,A,b,E;console.log("üéØ Suggestion clicked:",s);const n=(w=s.crd)==null?void 0:w.x,l=(A=s.crd)==null?void 0:A.y;if(typeof n=="number"&&typeof l=="number"&&((b=o==null?void 0:o.current)!=null&&b.setView)){const I=l/1e6,z=n/1e6;o.current.setView([I,z],17);let H=((E=s.nameFormatted)==null?void 0:E.text)||s.name||"",W=H,Q="";const Me=/<br\s*\/?.*?>/i;if(Me.test(H)){const Z=H.split(Me);W=Z[0].trim(),Q=Z.slice(1).join(" ").trim()}else if(H.includes(",")){const Z=H.split(",");W=Z[0].trim(),Q=Z.slice(1).join(",").trim()}const Se=W+(Q?`, ${Q}`:"");te(Se);const ue={address:W,city:Q,lat:I,lon:z,data:{nameFormatted:{text:H},name:W},label:Se};ae(ue),console.log("üéØ Selected location set:",ue),N&&N(ue),K([]),ve(!0),V(!1),O.current&&O.current.blur()}},Ee=()=>{T.trim()&&m&&m(T.trim())},Pe=R?{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",zIndex:9999}:{};return e.jsxs("div",{className:`relative ${r} ${R?"fixed inset-0 z-[9999]":""}`,style:u,children:[we&&!R?e.jsxs("div",{className:"flex h-screen bg-gradient-to-br from-slate-100 via-white to-blue-50",children:[e.jsx("div",{className:"w-1/2 bg-gradient-to-b from-white via-slate-50 to-blue-50 border-r border-slate-200/50 flex flex-col backdrop-blur-sm",children:e.jsxs("div",{className:"p-6 flex flex-col gap-6 h-full overflow-y-auto",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("h2",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent mb-2",children:"Navigacija"}),e.jsx("p",{className:"text-slate-600",children:"Pronaƒëi rutu do odredi≈°ta"})]}),e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("input",{ref:O,type:"text",value:T,onChange:de,onFocus:()=>V(!0),onBlur:()=>{setTimeout(()=>{re||V(!1)},200)},className:"w-full px-4 py-3 rounded-2xl border border-slate-300 bg-white/80 backdrop-blur-sm shadow-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all duration-200 placeholder-slate-500",placeholder:"Unesi adresu za navigaciju...",autoComplete:"off"}),U&&(D.length>0||se)&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white/95 backdrop-blur-sm border border-slate-200 rounded-2xl shadow-2xl max-h-60 overflow-y-auto z-[3000]",children:se?e.jsxs("div",{className:"p-4 flex items-center gap-3 text-slate-600",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),"Tra≈æim adrese..."]}):D.length===0?e.jsxs("div",{className:"p-4 text-slate-600",children:['Nema rezultata za "',T,'"']}):D.map((s,n)=>{var l,w;return e.jsx("div",{className:"p-4 hover:bg-blue-50/50 cursor-pointer border-b border-slate-100 last:border-b-0 transition-colors duration-150",onClick:()=>Ae(s),onMouseDown:A=>A.preventDefault(),children:e.jsx("div",{className:"font-medium text-slate-800",children:((w=(l=s.nameFormatted)==null?void 0:l.text)==null?void 0:w.replace(/<[^>]*>/g,""))||s.name||""})},n)})})]}),e.jsx("button",{className:"px-6 py-3 rounded-2xl bg-gradient-to-r from-blue-500 to-blue-600 text-white hover:from-blue-600 hover:to-blue-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-95",onClick:Ee,disabled:!T.trim(),title:"Otvori navigaciju",children:e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2L4.5 20.29l.71.71L12 18l6.79 3 .71-.71z"})})})]})})}),e.jsx("div",{className:"space-y-4 flex-1",children:v?e.jsx("div",{className:"p-4 rounded-2xl bg-gradient-to-br from-white/90 via-blue-50/30 to-purple-50/20 backdrop-blur-md border border-white/30 shadow-xl",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[k?e.jsxs("div",{className:"flex items-center gap-2 p-3 rounded-xl bg-gradient-to-r from-emerald-50/80 to-green-50/60 backdrop-blur-sm border border-emerald-200/40",children:[e.jsxs("svg",{className:"w-4 h-4 text-emerald-600 flex-shrink-0",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[e.jsx("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0Z"}),e.jsx("circle",{cx:"12",cy:"10",r:"3"})]}),e.jsx("span",{className:"text-sm font-medium text-slate-800 truncate",title:k,children:k})]}):x?e.jsxs("div",{className:"flex items-center gap-2 p-3 rounded-xl bg-gradient-to-r from-emerald-50/80 to-green-50/60 backdrop-blur-sm border border-emerald-200/40",children:[e.jsxs("svg",{className:"w-4 h-4 text-emerald-600 flex-shrink-0",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[e.jsx("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0Z"}),e.jsx("circle",{cx:"12",cy:"10",r:"3"})]}),e.jsxs("span",{className:"text-sm font-medium text-slate-800 truncate",title:`${x.lat.toFixed(6)}, ${x.lon.toFixed(6)}`,children:[x.lat.toFixed(6),", ",x.lon.toFixed(6)]})]}):e.jsxs("div",{className:"flex items-center gap-2 p-3 rounded-xl bg-gradient-to-r from-gray-50/80 to-slate-50/60 backdrop-blur-sm border border-gray-200/40",children:[e.jsxs("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[e.jsx("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0Z"}),e.jsx("circle",{cx:"12",cy:"10",r:"3"})]}),e.jsx("span",{className:"text-sm font-medium text-slate-600 truncate",children:"Moja lokacija nije dostupna"})]}),e.jsxs("div",{className:"flex items-center gap-2 p-3 rounded-xl bg-gradient-to-r from-rose-50/80 to-red-50/60 backdrop-blur-sm border border-rose-200/40",children:[e.jsxs("svg",{className:"w-4 h-4 text-rose-600 flex-shrink-0",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("circle",{cx:"12",cy:"12",r:"6"}),e.jsx("circle",{cx:"12",cy:"12",r:"2"})]}),e.jsx("span",{className:"text-sm font-medium text-slate-800 truncate",title:`${v.address}${v.city?`, ${v.city}`:""}`,children:`${v.address}${v.city?`, ${v.city}`:""}`})]})]}),e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"text-right bg-gradient-to-br from-blue-50/50 to-indigo-50/30 backdrop-blur-sm border border-blue-200/30 rounded-xl px-4 py-3",children:e.jsxs("div",{className:"text-base font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:[pe?pe.compact:q?e.jsxs(e.Fragment,{children:[q.durationText||X(q.durationSeconds)||"--"," ‚Ä¢ ",q.distanceText||J(q.distanceMeters)||"--"]}):x&&v?(()=>{const s=Fe(x.lat,x.lon,v.lat,v.lon),n=Math.round(s*1e3),l=De(n,40);return l?`${X(l)} ‚Ä¢ ${J(n)}`:"--"})():"--",Oe&&e.jsx("span",{className:"ml-2",children:e.jsx("div",{className:"w-3 h-3 border border-blue-500 border-t-transparent rounded-full animate-spin inline-block"})})]})})})]})}):e.jsxs(e.Fragment,{children:[ze?e.jsx("div",{className:"p-4 rounded-2xl bg-white/80 backdrop-blur-sm border border-slate-200/50 shadow-lg",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:"üìç"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"text-sm text-slate-600 font-medium",children:"Prepoznajem adresu..."})]})]})}):k?e.jsx("div",{className:"p-4 rounded-2xl bg-white/80 backdrop-blur-sm border border-slate-200/50 shadow-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-2xl",children:"ÔøΩ"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-slate-800 mb-1",children:"Moja lokacija"}),e.jsx("p",{className:"text-sm text-slate-600",children:k})]})]})}):x?e.jsx("div",{className:"p-4 rounded-2xl bg-white/70 backdrop-blur-sm border border-slate-200/50 shadow-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-2xl",children:"ÔøΩ"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-slate-800 mb-1",children:"Moja lokacija"}),e.jsxs("p",{className:"text-sm text-slate-600",children:[x.lat.toFixed(6),", ",x.lon.toFixed(6)]})]})]})}):e.jsx("div",{className:"p-4 rounded-2xl bg-white/60 backdrop-blur-sm border border-slate-200/50 shadow-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-2xl opacity-60",children:"üìç"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-slate-700 mb-1",children:"Moja lokacija"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Lokacija nije dostupna"})]})]})}),v&&!k&&e.jsx("div",{className:"p-4 rounded-2xl bg-white/80 backdrop-blur-sm border border-slate-200/50 shadow-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-2xl",children:"üéØ"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-800 mb-1",children:"Odabrana adresa"}),e.jsx("p",{className:"text-sm text-gray-600",children:`${v.address}${v.city?`, ${v.city}`:""}`})]})]})}),T&&!v&&e.jsx("div",{className:"p-3 rounded-lg bg-white border border-gray-200 shadow-sm",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-2xl",children:"üîç"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-800 mb-1",children:"Pretra≈æivanje"}),e.jsx("p",{className:"text-sm text-gray-600",children:T})]})]})})]})})]})}),e.jsx("div",{className:"w-1/2 relative",children:e.jsx("div",{ref:ie,className:"w-full h-full bg-gradient-to-br from-gray-100 via-gray-200 to-gray-300 overflow-hidden",style:Pe,children:a?e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-white/90 backdrop-blur-sm z-20",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mb-6"}),e.jsx("p",{className:"text-slate-700 font-medium text-lg",children:"Uƒçitavam mapu..."})]}):e.jsxs(e.Fragment,{children:[t,e.jsxs("div",{className:"absolute right-6 top-6 flex flex-col gap-3 z-30",children:[e.jsx("button",{className:"w-12 h-12 bg-white/90 backdrop-blur-sm border border-slate-200/50 rounded-2xl shadow-xl hover:shadow-2xl hover:scale-110 active:scale-95 transition-all duration-200 flex items-center justify-center text-slate-700 hover:text-blue-600 hover:bg-white group",onClick:je,title:"Poveƒáaj zoom",children:e.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",className:"group-hover:scale-110 transition-transform",children:e.jsx("path",{d:"M19 11h-6V5h-2v6H5v2h6v6h2v-6h6z"})})}),e.jsx("button",{className:"w-12 h-12 bg-white/90 backdrop-blur-sm border border-slate-200/50 rounded-2xl shadow-xl hover:shadow-2xl hover:scale-110 active:scale-95 transition-all duration-200 flex items-center justify-center text-slate-700 hover:text-blue-600 hover:bg-white group",onClick:ye,title:"Smanji zoom",children:e.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",className:"group-hover:scale-110 transition-transform",children:e.jsx("path",{d:"M19 11H5v2h14z"})})}),e.jsx("button",{className:"w-12 h-12 bg-white/90 backdrop-blur-sm border border-slate-200/50 rounded-2xl shadow-xl hover:shadow-2xl hover:scale-110 active:scale-95 transition-all duration-200 flex items-center justify-center text-slate-700 hover:text-emerald-600 hover:bg-white group",onClick:Ne,title:"Lociraj me",children:e.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",className:"group-hover:scale-110 transition-transform",children:e.jsx("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5a2.5 2.5 0 1 1 0-5 2.5 2.5 0 0 1 0 5z"})})}),be&&e.jsx("button",{className:"w-12 h-12 bg-gradient-to-br from-purple-500 to-purple-600 text-white border border-purple-400/50 rounded-2xl shadow-xl hover:shadow-2xl hover:scale-110 active:scale-95 transition-all duration-200 flex items-center justify-center hover:from-purple-600 hover:to-purple-700 group",onClick:_e,title:R?"Izaƒëi iz punog ekrana":"Puni ekran",children:e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",className:"group-hover:scale-110 transition-transform",children:R?e.jsx("path",{d:"M18 7h-3V4h-2v3H10V4H8v3H5v2h3v3H5v2h3v3h2v-3h3v3h2v-3h3v-2h-3V9h3V7z"}):e.jsx("path",{d:"M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"})})})]}),x&&e.jsx("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",zIndex:1e3,pointerEvents:"none"},children:G>0?e.jsx("svg",{width:"32",height:"32",viewBox:"0 0 32 32",style:{transform:`rotate(${fe||0}deg)`},children:e.jsx("polygon",{points:"16,4 28,28 16,22 4,28",fill:"green"})}):e.jsx("svg",{width:"32",height:"32",viewBox:"0 0 32 32",children:e.jsx("circle",{cx:"16",cy:"16",r:"12",fill:"red"})})}),e.jsx("div",{className:"absolute right-6 bottom-6 bg-white/95 backdrop-blur-sm border border-slate-300 rounded-2xl px-4 py-3 shadow-xl z-1000",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),e.jsx("span",{className:"font-bold text-lg text-slate-800",children:G?(G*3.6).toFixed(1):"0"}),e.jsx("span",{className:"text-sm text-slate-700 font-medium",children:"km/h"})]})})]})})})]}):e.jsxs("div",{className:`relative ${R?"fixed inset-0":"min-h-[300px] h-full"} ${f&&_?"bg-white":"bg-gradient-to-br from-slate-100 via-white to-blue-50 backdrop-blur-sm rounded-3xl shadow-2xl border border-white/20"} overflow-hidden`,children:[(!f||!_)&&e.jsxs("div",{className:"relative bg-gradient-to-r from-blue-600 via-purple-600 to-blue-700 text-white p-6 backdrop-blur-sm",children:[e.jsx("div",{className:"absolute inset-0 bg-black/10"}),e.jsxs("div",{className:"relative z-10",children:[i&&e.jsx("h3",{className:"text-2xl font-bold mb-2 text-center",children:i}),!f&&e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"flex-1 relative",children:e.jsx("input",{ref:O,type:"text",value:T,onChange:de,onFocus:()=>{V(!0),ce()},onBlur:()=>{setTimeout(()=>{re||V(!1)},200)},className:"w-full px-4 py-3 rounded-2xl border border-white/30 bg-white/90 backdrop-blur-sm shadow-lg focus:ring-2 focus:ring-white focus:border-white outline-none transition-all duration-200 text-slate-800 placeholder-slate-500",placeholder:"Unesi adresu za navigaciju...",autoComplete:"off"})}),e.jsx("button",{className:"px-6 py-3 rounded-2xl bg-white/20 backdrop-blur-sm border border-white/30 text-white hover:bg-white/30 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg",onClick:Ee,disabled:!T.trim(),title:"Otvori navigaciju",children:e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2L4.5 20.29l.71.71L12 18l6.79 3 .71-.71z"})})})]})]})]}),e.jsxs("div",{ref:ie,className:"flex-1 relative min-h-[500px] h-full bg-gradient-to-br from-gray-100 via-gray-200 to-gray-300 w-full box-border overflow-hidden",style:Pe,children:[a?e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-white/90 backdrop-blur-sm z-20",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mb-6"}),e.jsx("p",{className:"text-slate-700 font-medium text-lg",children:"Uƒçitavam mapu..."})]}):e.jsxs(e.Fragment,{children:[t,f&&_&&e.jsx("div",{className:"absolute left-6 top-6 flex flex-col gap-3 z-30",children:e.jsx("button",{className:"w-12 h-12 bg-white/90 backdrop-blur-sm border border-slate-200/50 rounded-2xl shadow-xl hover:shadow-2xl hover:scale-110 active:scale-95 transition-all duration-200 flex items-center justify-center text-slate-700 hover:text-blue-600 hover:bg-white group",onClick:()=>{V(!U),U||(ce(),setTimeout(()=>{O.current&&O.current.focus()},100))},title:"Pretra≈æi lokaciju",children:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",className:"group-hover:scale-110 transition-transform",children:[e.jsx("circle",{cx:"11",cy:"11",r:"8"}),e.jsx("path",{d:"M21 21l-4.35-4.35"})]})})}),f&&_&&U&&e.jsx("div",{className:"absolute left-20 top-6 right-6 z-40",children:e.jsx("div",{className:"h-12 bg-white/95 backdrop-blur-sm border border-slate-200/50 rounded-2xl shadow-xl overflow-hidden",children:e.jsx("input",{ref:O,type:"text",value:T,onChange:de,onBlur:()=>{setTimeout(()=>{re||V(!1)},200)},className:"w-full h-full px-4 text-sm border-0 bg-transparent focus:ring-0 focus:outline-none text-slate-800 placeholder-slate-500",placeholder:"Unesi adresu za navigaciju...",autoComplete:"off"})})}),e.jsxs("div",{className:"absolute right-6 top-6 flex flex-col gap-3 z-30",children:[e.jsx("button",{className:"w-12 h-12 bg-white/90 backdrop-blur-sm border border-slate-200/50 rounded-2xl shadow-xl hover:shadow-2xl hover:scale-110 active:scale-95 transition-all duration-200 flex items-center justify-center text-slate-700 hover:text-blue-600 hover:bg-white group",onClick:je,title:"Poveƒáaj zoom",children:e.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",className:"group-hover:scale-110 transition-transform",children:e.jsx("path",{d:"M19 11h-6V5h-2v6H5v2h6v6h2v-6h6z"})})}),e.jsx("button",{className:"w-12 h-12 bg-white/90 backdrop-blur-sm border border-slate-200/50 rounded-2xl shadow-xl hover:shadow-2xl hover:scale-110 active:scale-95 transition-all duration-200 flex items-center justify-center text-slate-700 hover:text-blue-600 hover:bg-white group",onClick:ye,title:"Smanji zoom",children:e.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",className:"group-hover:scale-110 transition-transform",children:e.jsx("path",{d:"M19 11H5v2h14z"})})}),e.jsx("button",{className:"w-12 h-12 bg-white/90 backdrop-blur-sm border border-slate-200/50 rounded-2xl shadow-xl hover:shadow-2xl hover:scale-110 active:scale-95 transition-all duration-200 flex items-center justify-center text-slate-700 hover:text-emerald-600 hover:bg-white group",onClick:Ne,title:"Lociraj me",children:e.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",className:"group-hover:scale-110 transition-transform",children:e.jsx("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5a2.5 2.5 0 1 1 0-5 2.5 2.5 0 0 1 0 5z"})})}),be&&e.jsx("button",{className:"w-12 h-12 bg-gradient-to-br from-purple-500 to-purple-600 text-white border border-purple-400/50 rounded-2xl shadow-xl hover:shadow-2xl hover:scale-110 active:scale-95 transition-all duration-200 flex items-center justify-center hover:from-purple-600 hover:to-purple-700 group",onClick:_e,title:R?"Izaƒëi iz punog ekrana":"Puni ekran",children:e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",className:"group-hover:scale-110 transition-transform",children:R?e.jsx("path",{d:"M18 7h-3V4h-2v3H10V4H8v3H5v2h3v3H5v2h3v3h2v-3h3v3h2v-3h3v-2h-3V9h3V7z"}):e.jsx("path",{d:"M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"})})})]}),x&&e.jsx("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",zIndex:1e3,pointerEvents:"none"},children:G>0?e.jsx("svg",{width:"32",height:"32",viewBox:"0 0 32 32",style:{transform:`rotate(${fe||0}deg)`},children:e.jsx("polygon",{points:"16,4 28,28 16,22 4,28",fill:"green"})}):e.jsx("svg",{width:"32",height:"32",viewBox:"0 0 32 32",children:e.jsx("circle",{cx:"16",cy:"16",r:"12",fill:"red"})})}),e.jsx("div",{className:"absolute right-6 bottom-6 bg-white/95 backdrop-blur-sm border border-slate-300 rounded-2xl px-4 py-3 shadow-xl z-1000",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),e.jsx("span",{className:"font-bold text-lg text-slate-800",children:G?(G*3.6).toFixed(1):"0"}),e.jsx("span",{className:"text-sm text-slate-700 font-medium",children:"km/h"})]})})]}),!we&&!f&&e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-white/95 via-white/90 to-transparent backdrop-blur-sm border-t border-white/20 p-4 space-y-2",children:[x?e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-lg bg-gradient-to-r from-blue-50/80 to-indigo-50/60 backdrop-blur-sm border border-blue-200/40",children:[e.jsxs("svg",{className:"w-4 h-4 text-blue-600 flex-shrink-0",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[e.jsx("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0Z"}),e.jsx("circle",{cx:"12",cy:"10",r:"3"})]}),e.jsxs("span",{className:"text-xs font-medium text-slate-800 truncate",children:["Moja lokacija: ",x.lat.toFixed(4),", ",x.lon.toFixed(4)]})]}):e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-lg bg-gradient-to-r from-gray-50/80 to-slate-50/60 backdrop-blur-sm border border-gray-200/40",children:[e.jsxs("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[e.jsx("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0Z"}),e.jsx("circle",{cx:"12",cy:"10",r:"3"})]}),e.jsx("span",{className:"text-xs font-medium text-slate-600 truncate",children:"Moja lokacija nije dostupna"})]}),v&&e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-lg bg-gradient-to-r from-rose-50/80 to-red-50/60 backdrop-blur-sm border border-rose-200/40",children:[e.jsxs("svg",{className:"w-4 h-4 text-rose-600 flex-shrink-0",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("circle",{cx:"12",cy:"12",r:"6"}),e.jsx("circle",{cx:"12",cy:"12",r:"2"})]}),e.jsx("span",{className:"text-xs font-medium text-slate-800 truncate",title:`${v.address}${v.city?`, ${v.city}`:""}`,children:`${v.address}${v.city?`, ${v.city}`:""}`})]}),T&&!v&&e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-lg bg-gradient-to-r from-amber-50/80 to-yellow-50/60 backdrop-blur-sm border border-amber-200/40",children:[e.jsxs("svg",{className:"w-4 h-4 text-amber-600 flex-shrink-0",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[e.jsx("circle",{cx:"11",cy:"11",r:"8"}),e.jsx("path",{d:"M21 21l-4.35-4.35"})]}),e.jsxs("span",{className:"text-xs font-medium text-slate-800 truncate",children:["Pretra≈æivanje: ",T]})]})]})]}),F&&e.jsx("div",{className:"w-80 bg-gradient-to-b from-white via-slate-50 to-blue-50 border-l border-slate-200/50 flex flex-col backdrop-blur-sm",children:e.jsxs("div",{ref:M,className:"p-6 flex flex-col gap-4 h-full",children:[e.jsxs("h3",{className:"text-xl font-bold text-slate-800 mb-3 flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),"Informacije"]}),e.jsx("div",{className:"flex flex-col gap-4 flex-1"})]})})]}),_&&(!f&&U||f&&U)&&(D.length>0||se)&&Ke.createPortal(e.jsx("div",{className:"fixed bg-white/95 backdrop-blur-sm border border-slate-200 rounded-xl shadow-xl max-h-48 overflow-y-auto z-[99999]",style:{top:f?"calc(1.5rem + 48px + 8px)":ne.top,left:f?"5rem":ne.left,right:f?"1.5rem":"auto",width:f?"auto":ne.width},children:se?e.jsxs("div",{className:"p-3 flex items-center gap-2 text-slate-600",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"text-sm",children:"Tra≈æim adrese..."})]}):D.length===0?e.jsxs("div",{className:"p-3 text-slate-600 text-sm",children:['Nema rezultata za "',T,'"']}):D.map((s,n)=>{var l,w;return e.jsxs("div",{className:"p-3 hover:bg-blue-50/50 cursor-pointer border-b border-slate-100 last:border-b-0 transition-colors duration-150",onClick:()=>Ae(s),onMouseDown:A=>A.preventDefault(),children:[e.jsx("div",{className:"font-medium text-slate-800 text-sm",children:((w=(l=s.nameFormatted)==null?void 0:l.text)==null?void 0:w.replace(/<[^>]*>/g,""))||s.name||""}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:s.district||s.region||s.country||""})]},n)})}),document.body)]})},xt=()=>{const t=We();return d.useEffect(()=>{setTimeout(()=>{t.invalidateSize()},200)},[t]),null};function mt(t,r){const u=Math.round(r*1e6),i=Math.round(t*1e6);return{x:u,y:i}}const Re=`${P.API_BASE_URL}/vor-proxy`,oe={id:"ibwmnqg8g2kj8iwg",ver:"1.59",lang:"deu",auth:{type:"AID",aid:"wf7mcf9bv3nv8g5f"},client:{id:"VAO",type:"WEB",name:"webapp",l:"vs_anachb",v:10010,pos:{x:14289513,y:46624058,acc:20}},formatted:!1,ext:"VAO.22",svcReqL:[]};function pt({onAddressSelect:t}){const[r,u]=d.useState(null),[i,a]=d.useState(""),[g,h]=d.useState(null);if(d.useRef(null),Le({click:o=>{console.log("üó∫Ô∏è Map clicked at:",o.latlng),u(o.latlng),a("Uƒçitavanje adrese..."),h(null);const{x:p,y}=mt(o.latlng.lat,o.latlng.lng);console.log("üìç Projected coordinates:",{x:p,y}),(async()=>{const c={...oe,client:{...oe.client,pos:{x:p,y,acc:20}},svcReqL:[{meth:"LocGeoPos",req:{ring:{cCrd:{x:p,y},minDist:0,maxDist:30},maxLoc:1,locFltrL:[{type:"PROD",mode:"INC",value:4087}],getPOIs:!0},id:"1|5|"}]};try{const _=await(await fetch(Re,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)})).json();if(_&&_.svcResL&&_.svcResL.length>0&&_.svcResL[0].res&&_.svcResL[0].res.locL&&_.svcResL[0].res.locL.length>0){const S=_.svcResL[0].res.locL[0];let f=S.nameFormatted&&S.nameFormatted.text||S.name||S.txt||"";/^-?\d+\.\d+, ?-?\d+\.\d+$/.test(f)&&(f="Nema adrese za ovu lokaciju"),a(f||"Adresa pronaƒëena"),h({geoData:_,x:p,y});let x=f,$="";if(f&&f.includes(",")){const B=f.split(",");x=B[0].trim(),$=B.slice(1).join(",").trim()}const k={address:x,city:$,lat:o.latlng.lat,lon:o.latlng.lng};console.log("üéØ ClickToVORAddress calling onAddressSelect:",k),t&&t(k);return}const F={...oe,client:{...oe.client,pos:{x:p,y,acc:20}},svcReqL:[{meth:"LocMatch",req:{input:{field:"S",loc:{type:"C",crd:{x:p,y}},maxLoc:1,locFltrL:[{type:"META",value:"in_austria_test"}]}},id:"1|24|"}]},C=await(await fetch(Re,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(F)})).json();if(h({matchData:C,x:p,y}),C&&C.svcResL&&C.svcResL.length>0&&C.svcResL[0].res&&C.svcResL[0].res.match&&C.svcResL[0].res.match.locL&&C.svcResL[0].res.match.locL.length>0){const S=C.svcResL[0].res.match.locL[0];let f=S.nameFormatted&&S.nameFormatted.text||S.name||S.txt||"";/^-?\d+\.\d+, ?-?\d+\.\d+$/.test(f)&&(f="Nema adrese za ovu lokaciju"),a(f||"Adresa pronaƒëena");let x=f,$="";if(f&&f.includes(",")){const k=f.split(",");x=k[0].trim(),$=k.slice(1).join(",").trim()}t&&t({address:x,city:$,lat:o.latlng.lat,lon:o.latlng.lng});return}a("Adresa nije pronaƒëena"),t&&t({address:"",city:"",lat:o.latlng.lat,lon:o.latlng.lng})}catch(M){a("Gre≈°ka pri dohvaƒáanju adrese: "+((M==null?void 0:M.message)||JSON.stringify(M))),h(M),t&&t({address:"",city:"",lat:o.latlng.lat,lon:o.latlng.lng})}})()},move:()=>{u(null),a(""),N(!1)}}),i&&i.includes(",")){const o=i.split(",");o[0].trim(),o.slice(1).join(",").trim()}r==null||r.lat,r==null||r.lng;const[m,N]=d.useState(!0);return Le({}),r?e.jsx(Qe,{center:r,radius:7,pathOptions:{color:"#0ea5e9",fillColor:"#0ea5e9",fillOpacity:.92,weight:1.5}}):null}let gt=Ie.divIcon({html:`<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0Z" fill="#ef4444" stroke="#dc2626" stroke-width="2"/>
    <circle cx="12" cy="10" r="3" fill="white"/>
  </svg>`,className:"custom-div-icon",iconSize:[24,24],iconAnchor:[12,24]});Ie.Marker.prototype.options.icon=gt;function ft({address:t,lat:r,lon:u,onClose:i,routeInfo:a,userLocation:g}){let h=t,m="";if(t&&t.includes(",")){const p=t.split(",");h=p[0].trim(),m=p.slice(1).join(",").trim()}const N=r&&u?`https://www.google.com/maps/search/?api=1&query=${r},${u}`:"#";let o=null;if(a&&a.distanceMeters&&a.durationSeconds){const p=a.durationText||X(a.durationSeconds)||"--",y=a.distanceText||J(a.distanceMeters)||"--";o=`${p} ‚Ä¢ ${y}`}else if(a&&a.distance&&a.duration){const p=X(a.duration)||"--",y=J(a.distance)||"--";o=`${p} ‚Ä¢ ${y}`}else if(g&&r&&u){const y=(r-g[0])*Math.PI/180,c=(u-g[1])*Math.PI/180,M=Math.sin(y/2)*Math.sin(y/2)+Math.cos(g[0]*Math.PI/180)*Math.cos(r*Math.PI/180)*Math.sin(c/2)*Math.sin(c/2),F=6371*(2*Math.atan2(Math.sqrt(M),Math.sqrt(1-M))),ee=Math.round(F*1e3),S=ee>0?Math.round(F/40*3600):null,f=S?X(S):"--",x=J(ee);o=`${f} ‚Ä¢ ${x}`}return e.jsxs("div",{className:"bg-white/95 backdrop-blur-sm rounded-xl shadow-2xl p-4 min-w-[240px] max-w-[320px] border border-gray-100 relative z-50",onMouseDown:p=>p.stopPropagation(),onClick:p=>p.stopPropagation(),children:[e.jsx("button",{onClick:p=>{p.preventDefault(),p.stopPropagation(),i()},onMouseDown:p=>{p.preventDefault(),p.stopPropagation()},className:"absolute -top-2 -right-2 w-8 h-8 flex items-center justify-center bg-gray-800 text-white hover:bg-gray-900 rounded-full shadow-lg transition-all duration-200 hover:scale-105 z-50","aria-label":"Zatvori popup",title:"Zatvori",children:e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center shadow-lg",children:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2.5",children:[e.jsx("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0Z"}),e.jsx("circle",{cx:"12",cy:"10",r:"3"})]})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-base font-semibold text-gray-900 leading-tight",children:h}),m&&e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:m})]})]}),o&&e.jsx("div",{className:"flex items-center justify-center py-2 px-4 bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg border border-blue-100",children:e.jsx("div",{className:"text-lg font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:o})}),e.jsx("button",{onClick:()=>window.open(N,"_blank"),className:"w-full py-3 px-4 bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white font-semibold rounded-xl shadow-lg hover:shadow-xl transition-all duration-200 hover:scale-[1.02] active:scale-[0.98]",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2L4.5 20.29l.71.71L12 18l6.79 3 .71-.71z"})}),"Pokreni navigaciju"]})})]})]})}function vt({position:t}){return null}function bt({marker:t,onAddressSelect:r,routeInfo:u,userLocation:i}){var h,m,N;const a=d.useRef();if(d.useEffect(()=>{a.current&&t&&t.lat&&t.lon&&setTimeout(()=>{a.current.openPopup()},100)},[t==null?void 0:t.lat,t==null?void 0:t.lon]),!t||!t.lat||!t.lon)return null;const g=[t.lat,t.lon];return e.jsx(Xe,{position:g,ref:a,children:e.jsx(et,{autoPan:!0,autoClose:!1,closeOnClick:!1,children:e.jsx(ft,{address:((m=(h=t.data)==null?void 0:h.nameFormatted)==null?void 0:m.text)||((N=t.data)==null?void 0:N.name)||t.label||`${t.address||""}${t.city?`, ${t.city}`:""}`,lat:t.lat,lon:t.lon,routeInfo:u,userLocation:i,onClose:()=>{r&&r(null)}})})})}function wt({onAddressSelect:t,mapRef:r,selectedMarker:u,userLocation:i,routeInfo:a}){const g=d.useRef(),h=r||g,m=d.useCallback(N=>{h&&(h.current=N)},[h]);return e.jsx("div",{className:"relative w-full h-full bg-gray-100",children:e.jsx("div",{className:"w-full h-full",children:e.jsxs(Ze,{center:[47.0707,15.4395],zoom:8,className:"w-full h-full z-0",ref:m,maxZoom:18,minZoom:6,zoomControl:!1,attributionControl:!1,children:[e.jsx(Je,{url:"https://maps.wien.gv.at/basemap/geolandbasemap/normal/google3857/{z}/{y}/{x}.png",attribution:'Datenquelle: <a href="https://www.basemap.at">basemap.at</a>',maxZoom:19}),e.jsx(xt,{}),i&&e.jsx(vt,{position:i}),u&&e.jsx(bt,{marker:u,onAddressSelect:t,routeInfo:a,userLocation:i}),e.jsx(pt,{onAddressSelect:t})]})})})}const At=()=>{const t=qe(),r=d.useRef(null),u=d.useRef(null),[i,a]=d.useState("night"),[g,h]=d.useState(null),[m,N]=d.useState({address:"",city:"",lat:null,lon:null}),o={night:{background:"from-slate-900 via-blue-900 to-indigo-900",accent:"from-blue-400 to-purple-400"}};d.useEffect(()=>{a("night")},[]);const p=i==="night",y=typeof window<"u"?window.innerWidth<768:!1;return d.useEffect(()=>{const c=()=>{r.current&&typeof r.current.invalidateSize=="function"&&(console.log("üó∫Ô∏è Invalidating map size..."),r.current.invalidateSize())},M=setTimeout(c,500);return window.addEventListener("resize",c),()=>{clearTimeout(M),window.removeEventListener("resize",c)}},[]),d.useEffect(()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(c=>h([c.coords.latitude,c.coords.longitude]),c=>console.warn("Geolocation error:",c))},[]),e.jsxs("div",{className:`min-h-screen bg-gradient-to-br ${o[i].background} transition-all duration-1000`,children:[e.jsxs("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:[e.jsx(Y.div,{animate:{scale:[1,1.2,1],rotate:[0,90,0]},transition:{duration:20,repeat:1/0,ease:"linear"},className:`absolute top-20 left-10 w-96 h-96 bg-gradient-to-r ${o[i].accent} rounded-full mix-blend-multiply filter blur-3xl opacity-20`}),e.jsx(Y.div,{animate:{scale:[1.2,1,1.2],rotate:[90,0,90]},transition:{duration:25,repeat:1/0,ease:"linear"},className:`absolute bottom-20 right-10 w-96 h-96 bg-gradient-to-r ${o[i].accent} rounded-full mix-blend-multiply filter blur-3xl opacity-20`})]}),e.jsx(Y.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6},className:"relative z-10",children:e.jsx("div",{className:"flex items-center justify-between p-4 md:p-6",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(Y.button,{onClick:()=>t(-1),whileHover:{scale:1.05},whileTap:{scale:.95},className:`p-3 rounded-xl backdrop-blur-sm border transition-all duration-200 ${p?"bg-gray-800/90 border-gray-700 text-gray-100 hover:bg-gray-700/90":"bg-white/90 border-gray-200 text-gray-700 hover:bg-white/95"} shadow-lg hover:shadow-xl`,children:e.jsx(Te,{className:"w-6 h-6"})}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`p-3 rounded-xl bg-gradient-to-r ${o[i].accent} shadow-lg`,children:e.jsx(Ye,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:`text-2xl font-bold ${p?"text-white":"text-gray-900"}`,children:"Navigacija"}),e.jsx("p",{className:`text-sm ${p?"text-gray-400":"text-gray-600"}`,children:"Mapa dostave - Austrija"})]})]})]})})}),e.jsx(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:`relative z-10 ${y?"h-screen":"px-2 md:px-6 pb-2 md:pb-6"}`,children:e.jsx("div",{className:`${y?"h-full":`rounded-lg md:rounded-2xl backdrop-blur-sm border overflow-hidden shadow-2xl h-[calc(100vh-120px)] md:h-[calc(100vh-160px)] ${p?"bg-gray-800/90 border-gray-700":"bg-white/90 border-gray-200"}`}`,children:e.jsx(ht,{title:"Navigacija - Mapa dostave",mapRef:r,footerRef:u,className:"h-full w-full",style:{height:"100%",width:"100%"},address:(m==null?void 0:m.address)||"",city:(m==null?void 0:m.city)||"",selectedMarker:m,headerHeight:y?120:160,sidebarLayout:!y,hideSearchAndInfo:y,onNavigate:c=>{if(c&&typeof c=="object"&&typeof c.lat=="number"&&typeof c.lon=="number"){window.open(`https://www.google.com/maps/dir/?api=1&destination=${encodeURIComponent(`${c.lat},${c.lon}`)}&travelmode=driving`,"_blank");return}c&&window.open(`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(c)}`,"_blank")},onSearchSelect:c=>{console.log("üéØ Address selected:",c),N(c)},onLocateMe:h,children:e.jsx(wt,{onAddressSelect:c=>{console.log("üó∫Ô∏è MapView address select:",c),N(c)},mapRef:r,selectedMarker:m,userLocation:g,routeInfo:null})})})}),y&&e.jsx(Y.button,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.3,delay:.2},onClick:()=>t(-1),className:"fixed top-4 left-4 z-50 p-3 rounded-2xl bg-white/90 backdrop-blur-sm border border-gray-200/50 shadow-xl hover:shadow-2xl hover:scale-105 active:scale-95 transition-all duration-200",children:e.jsx(Te,{className:"w-6 h-6 text-gray-700"})})]})};export{At as default};

var ov=Object.defineProperty;var Ep=d=>{throw TypeError(d)};var lv=(d,e,t)=>e in d?ov(d,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):d[e]=t;var k=(d,e,t)=>lv(d,typeof e!="symbol"?e+"":e,t),wu=(d,e,t)=>e.has(d)||Ep("Cannot "+t);var n=(d,e,t)=>(wu(d,e,"read from private field"),t?t.call(d):e.get(d)),y=(d,e,t)=>e.has(d)?Ep("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(d):e.set(d,t),g=(d,e,t,s)=>(wu(d,e,"write to private field"),s?s.call(d,t):e.set(d,t),t),A=(d,e,t)=>(wu(d,e,"access private method"),t);var te=(d,e,t,s)=>({set _(i){g(d,e,i,t)},get _(){return n(d,e,s)}});import"./chunk-v5-1760936937048-BWTCnJR7.js";import"./chunk-v5-1760936937048-DzTHeiPn.js";import"./chunk-v5-1760936937048-BB3IoZy2.js";import"./chunk-v5-1760936937048-DUKVzXV1.js";var hv={34:(d,e,t)=>{var s=t(4901);d.exports=function(i){return typeof i=="object"?i!==null:s(i)}},81:(d,e,t)=>{var s=t(9565),i=t(9306),r=t(8551),a=t(6823),o=t(851),l=TypeError;d.exports=function(h,c){var u=arguments.length<2?o(h):c;if(i(u))return r(s(u,h));throw new l(a(h)+" is not iterable")}},116:(d,e,t)=>{var s=t(6518),i=t(9565),r=t(2652),a=t(9306),o=t(8551),l=t(1767),h=t(9539),c=t(4549),u=c("find",TypeError);s({target:"Iterator",proto:!0,real:!0,forced:u},{find:function(p){o(this);try{a(p)}catch(w){h(this,"throw",w)}if(u)return i(u,this,p);var v=l(this),m=0;return r(v,function(w,b){if(p(w,m++))return b(w)},{IS_RECORD:!0,INTERRUPTED:!0}).result}})},283:(d,e,t)=>{var s=t(9504),i=t(9039),r=t(4901),a=t(9297),o=t(3724),l=t(350).CONFIGURABLE,h=t(3706),c=t(1181),u=c.enforce,f=c.get,p=String,v=Object.defineProperty,m=s("".slice),w=s("".replace),b=s([].join),S=o&&!i(function(){return v(function(){},"length",{value:8}).length!==8}),E=String(String).split("String"),T=d.exports=function(x,C,R){m(p(C),0,7)==="Symbol("&&(C="["+w(p(C),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),R&&R.getter&&(C="get "+C),R&&R.setter&&(C="set "+C),(!a(x,"name")||l&&x.name!==C)&&(o?v(x,"name",{value:C,configurable:!0}):x.name=C),S&&R&&a(R,"arity")&&x.length!==R.arity&&v(x,"length",{value:R.arity});try{R&&a(R,"constructor")&&R.constructor?o&&v(x,"prototype",{writable:!1}):x.prototype&&(x.prototype=void 0)}catch{}var I=u(x);return a(I,"source")||(I.source=b(E,typeof C=="string"?C:"")),x};Function.prototype.toString=T(function(){return r(this)&&f(this).source||h(this)},"toString")},350:(d,e,t)=>{var s=t(3724),i=t(9297),r=Function.prototype,a=s&&Object.getOwnPropertyDescriptor,o=i(r,"name"),l=o&&(function(){}).name==="something",h=o&&(!s||s&&a(r,"name").configurable);d.exports={EXISTS:o,PROPER:l,CONFIGURABLE:h}},397:(d,e,t)=>{var s=t(7751);d.exports=s("document","documentElement")},421:d=>{d.exports={}},456:(d,e,t)=>{var s=t(6518),i=t(4576),r=t(9504),a=t(4154),o=t(5169),l=r(1.1.toString),h=i.Uint8Array,c=!h||!h.prototype.toHex||!function(){try{var u=new h([255,255,255,255,255,255,255,255]);return u.toHex()==="ffffffffffffffff"}catch{return!1}}();h&&s({target:"Uint8Array",proto:!0,forced:c},{toHex:function(){a(this),o(this.buffer);for(var f="",p=0,v=this.length;p<v;p++){var m=l(this[p],16);f+=m.length===1?"0"+m:m}return f}})},507:(d,e,t)=>{var s=t(9565);d.exports=function(i,r,a){for(var o=a?i:i.iterator,l=i.next,h,c;!(h=s(l,o)).done;)if(c=r(h.value),c!==void 0)return c}},531:(d,e,t)=>{var s=t(6518),i=t(9565),r=t(9306),a=t(8551),o=t(1767),l=t(8646),h=t(9462),c=t(9539),u=t(6395),f=t(684),p=t(4549),v=!u&&!f("flatMap",function(){}),m=!u&&!v&&p("flatMap",TypeError),w=u||v||m,b=h(function(){for(var S=this.iterator,E=this.mapper,T,x;;){if(x=this.inner)try{if(T=a(i(x.next,x.iterator)),!T.done)return T.value;this.inner=null}catch(C){c(S,"throw",C)}if(T=a(i(this.next,S)),this.done=!!T.done)return;try{this.inner=l(E(T.value,this.counter++),!1)}catch(C){c(S,"throw",C)}}});s({target:"Iterator",proto:!0,real:!0,forced:w},{flatMap:function(E){a(this);try{r(E)}catch(T){c(this,"throw",T)}return m?i(m,this,E):new b(o(this),{mapper:E,inner:null})}})},616:(d,e,t)=>{var s=t(9039);d.exports=!s(function(){var i=(function(){}).bind();return typeof i!="function"||i.hasOwnProperty("prototype")})},655:(d,e,t)=>{var s=t(6955),i=String;d.exports=function(r){if(s(r)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return i(r)}},679:(d,e,t)=>{var s=t(1625),i=TypeError;d.exports=function(r,a){if(s(a,r))return r;throw new i("Incorrect invocation")}},684:d=>{d.exports=function(e,t){var s=typeof Iterator=="function"&&Iterator.prototype[e];if(s)try{s.call({next:null},t).next()}catch{return!0}}},741:d=>{var e=Math.ceil,t=Math.floor;d.exports=Math.trunc||function(i){var r=+i;return(r>0?t:e)(r)}},757:(d,e,t)=>{var s=t(7751),i=t(4901),r=t(1625),a=t(7040),o=Object;d.exports=a?function(l){return typeof l=="symbol"}:function(l){var h=s("Symbol");return i(h)&&r(h.prototype,o(l))}},851:(d,e,t)=>{var s=t(6955),i=t(5966),r=t(4117),a=t(6269),o=t(8227),l=o("iterator");d.exports=function(h){if(!r(h))return i(h,l)||i(h,"@@iterator")||a[s(h)]}},944:d=>{var e=TypeError;d.exports=function(t){var s=t&&t.alphabet;if(s===void 0||s==="base64"||s==="base64url")return s||"base64";throw new e("Incorrect `alphabet` option")}},1072:(d,e,t)=>{var s=t(1828),i=t(8727);d.exports=Object.keys||function(a){return s(a,i)}},1103:d=>{d.exports=function(e){try{return{error:!1,value:e()}}catch(t){return{error:!0,value:t}}}},1108:(d,e,t)=>{var s=t(6955);d.exports=function(i){var r=s(i);return r==="BigInt64Array"||r==="BigUint64Array"}},1148:(d,e,t)=>{var s=t(6518),i=t(9565),r=t(2652),a=t(9306),o=t(8551),l=t(1767),h=t(9539),c=t(4549),u=c("every",TypeError);s({target:"Iterator",proto:!0,real:!0,forced:u},{every:function(p){o(this);try{a(p)}catch(w){h(this,"throw",w)}if(u)return i(u,this,p);var v=l(this),m=0;return!r(v,function(w,b){if(!p(w,m++))return b()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},1181:(d,e,t)=>{var s=t(8622),i=t(4576),r=t(34),a=t(6699),o=t(9297),l=t(7629),h=t(6119),c=t(421),u="Object already initialized",f=i.TypeError,p=i.WeakMap,v,m,w,b=function(x){return w(x)?m(x):v(x,{})},S=function(x){return function(C){var R;if(!r(C)||(R=m(C)).type!==x)throw new f("Incompatible receiver, "+x+" required");return R}};if(s||l.state){var E=l.state||(l.state=new p);E.get=E.get,E.has=E.has,E.set=E.set,v=function(x,C){if(E.has(x))throw new f(u);return C.facade=x,E.set(x,C),C},m=function(x){return E.get(x)||{}},w=function(x){return E.has(x)}}else{var T=h("state");c[T]=!0,v=function(x,C){if(o(x,T))throw new f(u);return C.facade=x,a(x,T,C),C},m=function(x){return o(x,T)?x[T]:{}},w=function(x){return o(x,T)}}d.exports={set:v,get:m,has:w,enforce:b,getterFor:S}},1291:(d,e,t)=>{var s=t(741);d.exports=function(i){var r=+i;return r!==r||r===0?0:s(r)}},1385:(d,e,t)=>{var s=t(9539);d.exports=function(i,r,a){for(var o=i.length-1;o>=0;o--)if(i[o]!==void 0)try{a=s(i[o].iterator,r,a)}catch(l){r="throw",a=l}if(r==="throw")throw a;return a}},1548:(d,e,t)=>{var s=t(4576),i=t(9039),r=t(9519),a=t(4215),o=s.structuredClone;d.exports=!!o&&!i(function(){if(a==="DENO"&&r>92||a==="NODE"&&r>94||a==="BROWSER"&&r>97)return!1;var l=new ArrayBuffer(8),h=o(l,{transfer:[l]});return l.byteLength!==0||h.byteLength!==8})},1549:(d,e,t)=>{t(6632)},1625:(d,e,t)=>{var s=t(9504);d.exports=s({}.isPrototypeOf)},1689:(d,e,t)=>{var s=t(6518),i=t(4576),r=t(8745),a=t(7680),o=t(6043),l=t(9306),h=t(1103),c=i.Promise,u=!1,f=!c||!c.try||h(function(){c.try(function(p){u=p===8},8)}).error||!u;s({target:"Promise",stat:!0,forced:f},{try:function(p){var v=arguments.length>1?a(arguments,1):[],m=o.f(this),w=h(function(){return r(l(p),void 0,v)});return(w.error?m.reject:m.resolve)(w.value),m.promise}})},1698:(d,e,t)=>{var s=t(6518),i=t(4204),r=t(9835),a=t(4916),o=!a("union")||!r("union");s({target:"Set",proto:!0,real:!0,forced:o},{union:i})},1701:(d,e,t)=>{var s=t(6518),i=t(9565),r=t(9306),a=t(8551),o=t(1767),l=t(9462),h=t(6319),c=t(9539),u=t(684),f=t(4549),p=t(6395),v=!p&&!u("map",function(){}),m=!p&&!v&&f("map",TypeError),w=p||v||m,b=l(function(){var S=this.iterator,E=a(i(this.next,S)),T=this.done=!!E.done;if(!T)return h(S,this.mapper,[E.value,this.counter++],!0)});s({target:"Iterator",proto:!0,real:!0,forced:w},{map:function(E){a(this);try{r(E)}catch(T){c(this,"throw",T)}return m?i(m,this,E):new b(o(this),{mapper:E})}})},1767:d=>{d.exports=function(e){return{iterator:e,next:e.next,done:!1}}},1828:(d,e,t)=>{var s=t(9504),i=t(9297),r=t(5397),a=t(9617).indexOf,o=t(421),l=s([].push);d.exports=function(h,c){var u=r(h),f=0,p=[],v;for(v in u)!i(o,v)&&i(u,v)&&l(p,v);for(;c.length>f;)i(u,v=c[f++])&&(~a(p,v)||l(p,v));return p}},2106:(d,e,t)=>{var s=t(283),i=t(4913);d.exports=function(r,a,o){return o.get&&s(o.get,a,{getter:!0}),o.set&&s(o.set,a,{setter:!0}),i.f(r,a,o)}},2140:(d,e,t)=>{var s=t(8227),i=s("toStringTag"),r={};r[i]="z",d.exports=String(r)==="[object z]"},2195:(d,e,t)=>{var s=t(9504),i=s({}.toString),r=s("".slice);d.exports=function(a){return r(i(a),8,-1)}},2211:(d,e,t)=>{var s=t(9039);d.exports=!s(function(){function i(){}return i.prototype.constructor=null,Object.getPrototypeOf(new i)!==i.prototype})},2303:(d,e,t)=>{var s=t(4576),i=t(9504),r=s.Uint8Array,a=s.SyntaxError,o=s.parseInt,l=Math.min,h=/[^\da-f]/i,c=i(h.exec),u=i("".slice);d.exports=function(f,p){var v=f.length;if(v%2!==0)throw new a("String should be an even number of characters");for(var m=p?l(p.length,v/2):v/2,w=p||new r(m),b=0,S=0;S<m;){var E=u(f,b,b+=2);if(c(h,E))throw new a("String should only contain hex characters");w[S++]=o(E,16)}return{bytes:w,read:b}}},2360:(d,e,t)=>{var s=t(8551),i=t(6801),r=t(8727),a=t(421),o=t(397),l=t(4055),h=t(6119),c=">",u="<",f="prototype",p="script",v=h("IE_PROTO"),m=function(){},w=function(x){return u+p+c+x+u+"/"+p+c},b=function(x){x.write(w("")),x.close();var C=x.parentWindow.Object;return x=null,C},S=function(){var x=l("iframe"),C="java"+p+":",R;return x.style.display="none",o.appendChild(x),x.src=String(C),R=x.contentWindow.document,R.open(),R.write(w("document.F=Object")),R.close(),R.F},E,T=function(){try{E=new ActiveXObject("htmlfile")}catch{}T=typeof document<"u"?document.domain&&E?b(E):S():b(E);for(var x=r.length;x--;)delete T[f][r[x]];return T()};a[v]=!0,d.exports=Object.create||function(C,R){var I;return C!==null?(m[f]=s(C),I=new m,m[f]=null,I[v]=C):I=T(),R===void 0?I:i.f(I,R)}},2475:(d,e,t)=>{var s=t(6518),i=t(8527),r=t(4916),a=!r("isSupersetOf",function(o){return!o});s({target:"Set",proto:!0,real:!0,forced:a},{isSupersetOf:i})},2489:(d,e,t)=>{var s=t(6518),i=t(9565),r=t(9306),a=t(8551),o=t(1767),l=t(9462),h=t(6319),c=t(6395),u=t(9539),f=t(684),p=t(4549),v=!c&&!f("filter",function(){}),m=!c&&!v&&p("filter",TypeError),w=c||v||m,b=l(function(){for(var S=this.iterator,E=this.predicate,T=this.next,x,C,R;;){if(x=a(i(T,S)),C=this.done=!!x.done,C)return;if(R=x.value,h(S,E,[R,this.counter++],!0))return R}});s({target:"Iterator",proto:!0,real:!0,forced:w},{filter:function(E){a(this);try{r(E)}catch(T){u(this,"throw",T)}return m?i(m,this,E):new b(o(this),{predicate:E})}})},2529:d=>{d.exports=function(e,t){return{value:e,done:t}}},2603:(d,e,t)=>{var s=t(655);d.exports=function(i,r){return i===void 0?arguments.length<2?"":r:s(i)}},2652:(d,e,t)=>{var s=t(6080),i=t(9565),r=t(8551),a=t(6823),o=t(4209),l=t(6198),h=t(1625),c=t(81),u=t(851),f=t(9539),p=TypeError,v=function(w,b){this.stopped=w,this.result=b},m=v.prototype;d.exports=function(w,b,S){var E=S&&S.that,T=!!(S&&S.AS_ENTRIES),x=!!(S&&S.IS_RECORD),C=!!(S&&S.IS_ITERATOR),R=!!(S&&S.INTERRUPTED),I=s(b,E),P,M,D,O,N,B,W,_=function(X){return P&&f(P,"normal"),new v(!0,X)},L=function(X){return T?(r(X),R?I(X[0],X[1],_):I(X[0],X[1])):R?I(X,_):I(X)};if(x)P=w.iterator;else if(C)P=w;else{if(M=u(w),!M)throw new p(a(w)+" is not iterable");if(o(M)){for(D=0,O=l(w);O>D;D++)if(N=L(w[D]),N&&h(m,N))return N;return new v(!1)}P=c(w,M)}for(B=x?w.next:P.next;!(W=i(B,P)).done;){try{N=L(W.value)}catch(X){f(P,"throw",X)}if(typeof N=="object"&&N&&h(m,N))return N}return new v(!1)}},2777:(d,e,t)=>{var s=t(9565),i=t(34),r=t(757),a=t(5966),o=t(4270),l=t(8227),h=TypeError,c=l("toPrimitive");d.exports=function(u,f){if(!i(u)||r(u))return u;var p=a(u,c),v;if(p){if(f===void 0&&(f="default"),v=s(p,u,f),!i(v)||r(v))return v;throw new h("Can't convert object to primitive value")}return f===void 0&&(f="number"),o(u,f)}},2787:(d,e,t)=>{var s=t(9297),i=t(4901),r=t(8981),a=t(6119),o=t(2211),l=a("IE_PROTO"),h=Object,c=h.prototype;d.exports=o?h.getPrototypeOf:function(u){var f=r(u);if(s(f,l))return f[l];var p=f.constructor;return i(p)&&f instanceof p?p.prototype:f instanceof h?c:null}},2796:(d,e,t)=>{var s=t(9039),i=t(4901),r=/#|\.prototype\./,a=function(u,f){var p=l[o(u)];return p===c?!0:p===h?!1:i(f)?s(f):!!f},o=a.normalize=function(u){return String(u).replace(r,".").toLowerCase()},l=a.data={},h=a.NATIVE="N",c=a.POLYFILL="P";d.exports=a},2804:d=>{var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=e+"+/",s=e+"-_",i=function(r){for(var a={},o=0;o<64;o++)a[r.charAt(o)]=o;return a};d.exports={i2c:t,c2i:i(t),i2cUrl:s,c2iUrl:i(s)}},2812:d=>{var e=TypeError;d.exports=function(t,s){if(t<s)throw new e("Not enough arguments");return t}},2839:(d,e,t)=>{var s=t(4576),i=s.navigator,r=i&&i.userAgent;d.exports=r?String(r):""},2967:(d,e,t)=>{var s=t(6706),i=t(34),r=t(7750),a=t(3506);d.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var o=!1,l={},h;try{h=s(Object.prototype,"__proto__","set"),h(l,[]),o=l instanceof Array}catch{}return function(u,f){return r(u),a(f),i(u)&&(o?h(u,f):u.__proto__=f),u}}():void 0)},3068:(d,e,t)=>{var s=t(6518),i=t(9504),r=t(2652),a=RangeError,o=TypeError,l=1/0,h=NaN,c=Math.abs,u=Math.pow,f=i([].push),p=u(2,1023),v=u(2,53)-1,m=Number.MAX_VALUE,w=u(2,971),b={},S={},E={},T={},x={},C=function(R,I){var P=R+I,M=I-(P-R);return{hi:P,lo:M}};s({target:"Math",stat:!0},{sumPrecise:function(I){var P=[],M=0,D=T;switch(r(I,function(H){if(++M>=v)throw new a("Maximum allowed index exceeded");if(typeof H!="number")throw new o("Value is not a number");D!==b&&(H!==H?D=b:H===l?D=D===S?b:E:H===-l?D=D===E?b:S:(H!==0||1/H===l)&&(D===T||D===x)&&(D=x,f(P,H)))}),D){case b:return h;case S:return-l;case E:return l;case T:return-0}for(var O=[],N=0,B,W,_,L,X,Z,pt=0;pt<P.length;pt++){B=P[pt];for(var $t=0,q=0;q<O.length;q++){if(W=O[q],c(B)<c(W)&&(Z=B,B=W,W=Z),_=C(B,W),L=_.hi,X=_.lo,c(L)===l){var ot=L===l?1:-1;N+=ot,B=B-ot*p-ot*p,c(B)<c(W)&&(Z=B,B=W,W=Z),_=C(B,W),L=_.hi,X=_.lo}X!==0&&(O[$t++]=X),B=L}O.length=$t,B!==0&&f(O,B)}var yt=O.length-1;if(L=0,X=0,N!==0){var Kt=yt>=0?O[yt]:0;if(yt--,c(N)>1||N>0&&Kt>0||N<0&&Kt<0)return N>0?l:-l;if(_=C(N*p,Kt/2),L=_.hi,X=_.lo,X*=2,c(2*L)===l)return L>0?L===p&&X===-(w/2)&&yt>=0&&O[yt]<0?m:l:L===-p&&X===w/2&&yt>=0&&O[yt]>0?-m:-l;X!==0&&(O[++yt]=X,X=0),L*=2}for(;yt>=0&&(_=C(L,O[yt--]),L=_.hi,X=_.lo,X===0););return yt>=0&&(X<0&&O[yt]<0||X>0&&O[yt]>0)&&(W=X*2,B=L+W,W===B-L&&(L=B)),L}})},3167:(d,e,t)=>{var s=t(4901),i=t(34),r=t(2967);d.exports=function(a,o,l){var h,c;return r&&s(h=o.constructor)&&h!==l&&i(c=h.prototype)&&c!==l.prototype&&r(a,c),a}},3238:(d,e,t)=>{var s=t(4576),i=t(7811),r=t(7394),a=s.DataView;d.exports=function(o){if(!i||r(o)!==0)return!1;try{return new a(o),!1}catch{return!0}}},3392:(d,e,t)=>{var s=t(9504),i=0,r=Math.random(),a=s(1.1.toString);d.exports=function(o){return"Symbol("+(o===void 0?"":o)+")_"+a(++i+r,36)}},3440:(d,e,t)=>{var s=t(7080),i=t(4402),r=t(9286),a=t(5170),o=t(3789),l=t(8469),h=t(507),c=i.has,u=i.remove;d.exports=function(p){var v=s(this),m=o(p),w=r(v);return a(v)<=m.size?l(v,function(b){m.includes(b)&&u(w,b)}):h(m.getIterator(),function(b){c(w,b)&&u(w,b)}),w}},3463:d=>{var e=TypeError;d.exports=function(t){if(typeof t=="string")return t;throw new e("Argument is not a string")}},3506:(d,e,t)=>{var s=t(3925),i=String,r=TypeError;d.exports=function(a){if(s(a))return a;throw new r("Can't set "+i(a)+" as a prototype")}},3579:(d,e,t)=>{var s=t(6518),i=t(9565),r=t(2652),a=t(9306),o=t(8551),l=t(1767),h=t(9539),c=t(4549),u=c("some",TypeError);s({target:"Iterator",proto:!0,real:!0,forced:u},{some:function(p){o(this);try{a(p)}catch(w){h(this,"throw",w)}if(u)return i(u,this,p);var v=l(this),m=0;return r(v,function(w,b){if(p(w,m++))return b()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},3650:(d,e,t)=>{var s=t(7080),i=t(4402),r=t(9286),a=t(3789),o=t(507),l=i.add,h=i.has,c=i.remove;d.exports=function(f){var p=s(this),v=a(f).getIterator(),m=r(p);return o(v,function(w){h(p,w)?c(m,w):l(m,w)}),m}},3706:(d,e,t)=>{var s=t(9504),i=t(4901),r=t(7629),a=s(Function.toString);i(r.inspectSource)||(r.inspectSource=function(o){return a(o)}),d.exports=r.inspectSource},3717:(d,e)=>{e.f=Object.getOwnPropertySymbols},3724:(d,e,t)=>{var s=t(9039);d.exports=!s(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})},3789:(d,e,t)=>{var s=t(9306),i=t(8551),r=t(9565),a=t(1291),o=t(1767),l="Invalid size",h=RangeError,c=TypeError,u=Math.max,f=function(p,v){this.set=p,this.size=u(v,0),this.has=s(p.has),this.keys=s(p.keys)};f.prototype={getIterator:function(){return o(i(r(this.keys,this.set)))},includes:function(p){return r(this.has,this.set,p)}},d.exports=function(p){i(p);var v=+p.size;if(v!==v)throw new c(l);var m=a(v);if(m<0)throw new h(l);return new f(p,m)}},3838:(d,e,t)=>{var s=t(7080),i=t(5170),r=t(8469),a=t(3789);d.exports=function(l){var h=s(this),c=a(l);return i(h)>c.size?!1:r(h,function(u){if(!c.includes(u))return!1},!0)!==!1}},3853:(d,e,t)=>{var s=t(6518),i=t(4449),r=t(4916),a=!r("isDisjointFrom",function(o){return!o});s({target:"Set",proto:!0,real:!0,forced:a},{isDisjointFrom:i})},3925:(d,e,t)=>{var s=t(34);d.exports=function(i){return s(i)||i===null}},3972:(d,e,t)=>{var s=t(34),i=String,r=TypeError;d.exports=function(a){if(a===void 0||s(a))return a;throw new r(i(a)+" is not an object or undefined")}},4055:(d,e,t)=>{var s=t(4576),i=t(34),r=s.document,a=i(r)&&i(r.createElement);d.exports=function(o){return a?r.createElement(o):{}}},4114:(d,e,t)=>{var s=t(6518),i=t(8981),r=t(6198),a=t(4527),o=t(6837),l=t(9039),h=l(function(){return[].push.call({length:4294967296},1)!==4294967297}),c=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(f){return f instanceof TypeError}},u=h||!c();s({target:"Array",proto:!0,arity:1,forced:u},{push:function(p){var v=i(this),m=r(v),w=arguments.length;o(m+w);for(var b=0;b<w;b++)v[m]=arguments[b],m++;return a(v,m),m}})},4117:d=>{d.exports=function(e){return e==null}},4149:d=>{var e=RangeError;d.exports=function(t){if(t===t)return t;throw new e("NaN is not allowed")}},4154:(d,e,t)=>{var s=t(6955),i=TypeError;d.exports=function(r){if(s(r)==="Uint8Array")return r;throw new i("Argument is not an Uint8Array")}},4204:(d,e,t)=>{var s=t(7080),i=t(4402).add,r=t(9286),a=t(3789),o=t(507);d.exports=function(h){var c=s(this),u=a(h).getIterator(),f=r(c);return o(u,function(p){i(f,p)}),f}},4209:(d,e,t)=>{var s=t(8227),i=t(6269),r=s("iterator"),a=Array.prototype;d.exports=function(o){return o!==void 0&&(i.Array===o||a[r]===o)}},4215:(d,e,t)=>{var s=t(4576),i=t(2839),r=t(2195),a=function(o){return i.slice(0,o.length)===o};d.exports=function(){return a("Bun/")?"BUN":a("Cloudflare-Workers")?"CLOUDFLARE":a("Deno/")?"DENO":a("Node.js/")?"NODE":s.Bun&&typeof Bun.version=="string"?"BUN":s.Deno&&typeof Deno.version=="object"?"DENO":r(s.process)==="process"?"NODE":s.window&&s.document?"BROWSER":"REST"}()},4226:(d,e,t)=>{var s=t(6518),i=t(4576),r=t(3463),a=t(4154),o=t(5169),l=t(2303);i.Uint8Array&&s({target:"Uint8Array",proto:!0},{setFromHex:function(c){a(this),r(c),o(this.buffer);var u=l(c,this).read;return{read:u,written:u/2}}})},4235:(d,e,t)=>{t(3068)},4270:(d,e,t)=>{var s=t(9565),i=t(4901),r=t(34),a=TypeError;d.exports=function(o,l){var h,c;if(l==="string"&&i(h=o.toString)&&!r(c=s(h,o))||i(h=o.valueOf)&&!r(c=s(h,o))||l!=="string"&&i(h=o.toString)&&!r(c=s(h,o)))return c;throw new a("Can't convert object to primitive value")}},4376:(d,e,t)=>{var s=t(2195);d.exports=Array.isArray||function(r){return s(r)==="Array"}},4402:(d,e,t)=>{var s=t(9504),i=Set.prototype;d.exports={Set,add:s(i.add),has:s(i.has),remove:s(i.delete),proto:i}},4449:(d,e,t)=>{var s=t(7080),i=t(4402).has,r=t(5170),a=t(3789),o=t(8469),l=t(507),h=t(9539);d.exports=function(u){var f=s(this),p=a(u);if(r(f)<=p.size)return o(f,function(m){if(p.includes(m))return!1},!0)!==!1;var v=p.getIterator();return l(v,function(m){if(i(f,m))return h(v,"normal",!1)})!==!1}},4483:(d,e,t)=>{var s=t(4576),i=t(9429),r=t(1548),a=s.structuredClone,o=s.ArrayBuffer,l=s.MessageChannel,h=!1,c,u,f,p;if(r)h=function(v){a(v,{transfer:[v]})};else if(o)try{l||(c=i("worker_threads"),c&&(l=c.MessageChannel)),l&&(u=new l,f=new o(2),p=function(v){u.port1.postMessage(null,[v])},f.byteLength===2&&(p(f),f.byteLength===0&&(h=p)))}catch{}d.exports=h},4495:(d,e,t)=>{var s=t(9519),i=t(9039),r=t(4576),a=r.String;d.exports=!!Object.getOwnPropertySymbols&&!i(function(){var o=Symbol("symbol detection");return!a(o)||!(Object(o)instanceof Symbol)||!Symbol.sham&&s&&s<41})},4527:(d,e,t)=>{var s=t(3724),i=t(4376),r=TypeError,a=Object.getOwnPropertyDescriptor,o=s&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(l){return l instanceof TypeError}}();d.exports=o?function(l,h){if(i(l)&&!a(l,"length").writable)throw new r("Cannot set read only .length");return l.length=h}:function(l,h){return l.length=h}},4549:(d,e,t)=>{var s=t(4576);d.exports=function(i,r){var a=s.Iterator,o=a&&a.prototype,l=o&&o[i],h=!1;if(l)try{l.call({next:function(){return{done:!0}},return:function(){h=!0}},-1)}catch(c){c instanceof r||(h=!1)}if(!h)return l}},4576:function(d){var e=function(t){return t&&t.Math===Math&&t};d.exports=e(typeof globalThis=="object"&&globalThis)||e(typeof window=="object"&&window)||e(typeof self=="object"&&self)||e(typeof global=="object"&&global)||e(typeof this=="object"&&this)||function(){return this}()||Function("return this")()},4603:(d,e,t)=>{var s=t(6840),i=t(9504),r=t(655),a=t(2812),o=URLSearchParams,l=o.prototype,h=i(l.append),c=i(l.delete),u=i(l.forEach),f=i([].push),p=new o("a=1&a=2&b=3");p.delete("a",1),p.delete("b",void 0),p+""!="a=2"&&s(l,"delete",function(v){var m=arguments.length,w=m<2?void 0:arguments[1];if(m&&w===void 0)return c(this,v);var b=[];u(this,function(P,M){f(b,{key:M,value:P})}),a(m,1);for(var S=r(v),E=r(w),T=0,x=0,C=!1,R=b.length,I;T<R;)I=b[T++],C||I.key===S?(C=!0,c(this,I.key)):x++;for(;x<R;)I=b[x++],I.key===S&&I.value===E||h(this,I.key,I.value)},{enumerable:!0,unsafe:!0})},4628:(d,e,t)=>{var s=t(6518),i=t(6043);s({target:"Promise",stat:!0},{withResolvers:function(){var a=i.f(this);return{promise:a.promise,resolve:a.resolve,reject:a.reject}}})},4644:(d,e,t)=>{var s=t(7811),i=t(3724),r=t(4576),a=t(4901),o=t(34),l=t(9297),h=t(6955),c=t(6823),u=t(6699),f=t(6840),p=t(2106),v=t(1625),m=t(2787),w=t(2967),b=t(8227),S=t(3392),E=t(1181),T=E.enforce,x=E.get,C=r.Int8Array,R=C&&C.prototype,I=r.Uint8ClampedArray,P=I&&I.prototype,M=C&&m(C),D=R&&m(R),O=Object.prototype,N=r.TypeError,B=b("toStringTag"),W=S("TYPED_ARRAY_TAG"),_="TypedArrayConstructor",L=s&&!!w&&h(r.opera)!=="Opera",X=!1,Z,pt,$t,q={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},ot={BigInt64Array:8,BigUint64Array:8},yt=function(Dt){if(!o(Dt))return!1;var Lt=h(Dt);return Lt==="DataView"||l(q,Lt)||l(ot,Lt)},Kt=function(K){var Dt=m(K);if(o(Dt)){var Lt=x(Dt);return Lt&&l(Lt,_)?Lt[_]:Kt(Dt)}},H=function(K){if(!o(K))return!1;var Dt=h(K);return l(q,Dt)||l(ot,Dt)},F=function(K){if(H(K))return K;throw new N("Target is not a typed array")},$=function(K){if(a(K)&&(!w||v(M,K)))return K;throw new N(c(K)+" is not a typed array constructor")},tt=function(K,Dt,Lt,bs){if(i){if(Lt)for(var Me in q){var ae=r[Me];if(ae&&l(ae.prototype,K))try{delete ae.prototype[K]}catch{try{ae.prototype[K]=Dt}catch{}}}(!D[K]||Lt)&&f(D,K,Lt?Dt:L&&R[K]||Dt,bs)}},gt=function(K,Dt,Lt){var bs,Me;if(i){if(w){if(Lt){for(bs in q)if(Me=r[bs],Me&&l(Me,K))try{delete Me[K]}catch{}}if(!M[K]||Lt)try{return f(M,K,Lt?Dt:L&&M[K]||Dt)}catch{}else return}for(bs in q)Me=r[bs],Me&&(!Me[K]||Lt)&&f(Me,K,Dt)}};for(Z in q)pt=r[Z],$t=pt&&pt.prototype,$t?T($t)[_]=pt:L=!1;for(Z in ot)pt=r[Z],$t=pt&&pt.prototype,$t&&(T($t)[_]=pt);if((!L||!a(M)||M===Function.prototype)&&(M=function(){throw new N("Incorrect invocation")},L))for(Z in q)r[Z]&&w(r[Z],M);if((!L||!D||D===O)&&(D=M.prototype,L))for(Z in q)r[Z]&&w(r[Z].prototype,D);if(L&&m(P)!==D&&w(P,D),i&&!l(D,B)){X=!0,p(D,B,{configurable:!0,get:function(){return o(this)?this[W]:void 0}});for(Z in q)r[Z]&&u(r[Z],W,Z)}d.exports={NATIVE_ARRAY_BUFFER_VIEWS:L,TYPED_ARRAY_TAG:X&&W,aTypedArray:F,aTypedArrayConstructor:$,exportTypedArrayMethod:tt,exportTypedArrayStaticMethod:gt,getTypedArrayConstructor:Kt,isView:yt,isTypedArray:H,TypedArray:M,TypedArrayPrototype:D}},4659:(d,e,t)=>{var s=t(3724),i=t(4913),r=t(6980);d.exports=function(a,o,l){s?i.f(a,o,r(0,l)):a[o]=l}},4901:d=>{var e=typeof document=="object"&&document.all;d.exports=typeof e>"u"&&e!==void 0?function(t){return typeof t=="function"||t===e}:function(t){return typeof t=="function"}},4913:(d,e,t)=>{var s=t(3724),i=t(5917),r=t(8686),a=t(8551),o=t(6969),l=TypeError,h=Object.defineProperty,c=Object.getOwnPropertyDescriptor,u="enumerable",f="configurable",p="writable";e.f=s?r?function(m,w,b){if(a(m),w=o(w),a(b),typeof m=="function"&&w==="prototype"&&"value"in b&&p in b&&!b[p]){var S=c(m,w);S&&S[p]&&(m[w]=b.value,b={configurable:f in b?b[f]:S[f],enumerable:u in b?b[u]:S[u],writable:!1})}return h(m,w,b)}:h:function(m,w,b){if(a(m),w=o(w),a(b),i)try{return h(m,w,b)}catch{}if("get"in b||"set"in b)throw new l("Accessors not supported");return"value"in b&&(m[w]=b.value),m}},4916:(d,e,t)=>{var s=t(7751),i=function(a){return{size:a,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},r=function(a){return{size:a,has:function(){return!0},keys:function(){throw new Error("e")}}};d.exports=function(a,o){var l=s("Set");try{new l()[a](i(0));try{return new l()[a](i(-1)),!1}catch{if(!o)return!0;try{return new l()[a](r(-1/0)),!1}catch{var h=new l;return h.add(1),h.add(2),o(h[a](r(1/0)))}}}catch{return!1}}},4972:(d,e,t)=>{var s=t(6518),i=t(9565),r=t(8551),a=t(1767),o=t(4149),l=t(9590),h=t(9462),c=t(9539),u=t(4549),f=t(6395),p=!f&&u("take",RangeError),v=h(function(){var m=this.iterator;if(!this.remaining--)return this.done=!0,c(m,"normal",void 0);var w=r(i(this.next,m)),b=this.done=!!w.done;if(!b)return w.value});s({target:"Iterator",proto:!0,real:!0,forced:f||p},{take:function(w){r(this);var b;try{b=l(o(+w))}catch(S){c(this,"throw",S)}return p?i(p,this,b):new v(a(this),{remaining:b})}})},4979:(d,e,t)=>{var s=t(6518),i=t(4576),r=t(7751),a=t(6980),o=t(4913).f,l=t(9297),h=t(679),c=t(3167),u=t(2603),f=t(5002),p=t(8574),v=t(3724),m=t(6395),w="DOMException",b=r("Error"),S=r(w),E=function(){h(this,T);var _=arguments.length,L=u(_<1?void 0:arguments[0]),X=u(_<2?void 0:arguments[1],"Error"),Z=new S(L,X),pt=new b(L);return pt.name=w,o(Z,"stack",a(1,p(pt.stack,1))),c(Z,this,E),Z},T=E.prototype=S.prototype,x="stack"in new b(w),C="stack"in new S(1,2),R=S&&v&&Object.getOwnPropertyDescriptor(i,w),I=!!R&&!(R.writable&&R.configurable),P=x&&!I&&!C;s({global:!0,constructor:!0,forced:m||P},{DOMException:P?E:S});var M=r(w),D=M.prototype;if(D.constructor!==M){m||o(D,"constructor",a(1,M));for(var O in f)if(l(f,O)){var N=f[O],B=N.s;l(M,B)||o(M,B,a(6,N.c))}}},5002:d=>{d.exports={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}}},5024:(d,e,t)=>{var s=t(6518),i=t(3650),r=t(9835),a=t(4916),o=!a("symmetricDifference")||!r("symmetricDifference");s({target:"Set",proto:!0,real:!0,forced:o},{symmetricDifference:i})},5031:(d,e,t)=>{var s=t(7751),i=t(9504),r=t(8480),a=t(3717),o=t(8551),l=i([].concat);d.exports=s("Reflect","ownKeys")||function(c){var u=r.f(o(c)),f=a.f;return f?l(u,f(c)):u}},5169:(d,e,t)=>{var s=t(3238),i=TypeError;d.exports=function(r){if(s(r))throw new i("ArrayBuffer is detached");return r}},5170:(d,e,t)=>{var s=t(6706),i=t(4402);d.exports=s(i.proto,"size","get")||function(r){return r.size}},5213:(d,e,t)=>{var s=t(6518),i=t(4576),r=t(5370),a=t(9143),o=i.Uint8Array,l=!o||!o.fromBase64||!function(){try{o.fromBase64("a");return}catch{}try{o.fromBase64("",null)}catch{return!0}}();o&&s({target:"Uint8Array",stat:!0,forced:l},{fromBase64:function(c){var u=a(c,arguments.length>1?arguments[1]:void 0,null,9007199254740991);return r(o,u.bytes)}})},5370:(d,e,t)=>{var s=t(6198);d.exports=function(i,r,a){for(var o=0,l=arguments.length>2?a:s(r),h=new i(l);l>o;)h[o]=r[o++];return h}},5397:(d,e,t)=>{var s=t(7055),i=t(7750);d.exports=function(r){return s(i(r))}},5610:(d,e,t)=>{var s=t(1291),i=Math.max,r=Math.min;d.exports=function(a,o){var l=s(a);return l<0?i(l+o,0):r(l,o)}},5623:(d,e,t)=>{t(456)},5636:(d,e,t)=>{var s=t(4576),i=t(9504),r=t(6706),a=t(7696),o=t(5169),l=t(7394),h=t(4483),c=t(1548),u=s.structuredClone,f=s.ArrayBuffer,p=s.DataView,v=Math.min,m=f.prototype,w=p.prototype,b=i(m.slice),S=r(m,"resizable","get"),E=r(m,"maxByteLength","get"),T=i(w.getInt8),x=i(w.setInt8);d.exports=(c||h)&&function(C,R,I){var P=l(C),M=R===void 0?P:a(R),D=!S||!S(C),O;if(o(C),c&&(C=u(C,{transfer:[C]}),P===M&&(I||D)))return C;if(P>=M&&(!I||D))O=b(C,0,M);else{var N=I&&!D&&E?{maxByteLength:E(C)}:void 0;O=new f(M,N);for(var B=new p(C),W=new p(O),_=v(M,P),L=0;L<_;L++)x(W,L,T(B,L))}return c||h(C),O}},5745:(d,e,t)=>{var s=t(7629);d.exports=function(i,r){return s[i]||(s[i]=r||{})}},5781:(d,e,t)=>{var s=t(6518),i=t(7751),r=t(2812),a=t(655),o=t(7416),l=i("URL");s({target:"URL",stat:!0,forced:!o},{parse:function(c){var u=r(arguments.length,1),f=a(c),p=u<2||arguments[1]===void 0?void 0:a(arguments[1]);try{return new l(f,p)}catch{return null}}})},5854:(d,e,t)=>{var s=t(2777),i=TypeError;d.exports=function(r){var a=s(r,"number");if(typeof a=="number")throw new i("Can't convert number to bigint");return BigInt(a)}},5876:(d,e,t)=>{var s=t(6518),i=t(3838),r=t(4916),a=!r("isSubsetOf",function(o){return o});s({target:"Set",proto:!0,real:!0,forced:a},{isSubsetOf:i})},5917:(d,e,t)=>{var s=t(3724),i=t(9039),r=t(4055);d.exports=!s&&!i(function(){return Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a!==7})},5966:(d,e,t)=>{var s=t(9306),i=t(4117);d.exports=function(r,a){var o=r[a];return i(o)?void 0:s(o)}},6043:(d,e,t)=>{var s=t(9306),i=TypeError,r=function(a){var o,l;this.promise=new a(function(h,c){if(o!==void 0||l!==void 0)throw new i("Bad Promise constructor");o=h,l=c}),this.resolve=s(o),this.reject=s(l)};d.exports.f=function(a){return new r(a)}},6080:(d,e,t)=>{var s=t(7476),i=t(9306),r=t(616),a=s(s.bind);d.exports=function(o,l){return i(o),l===void 0?o:r?a(o,l):function(){return o.apply(l,arguments)}}},6119:(d,e,t)=>{var s=t(5745),i=t(3392),r=s("keys");d.exports=function(a){return r[a]||(r[a]=i(a))}},6193:(d,e,t)=>{var s=t(4215);d.exports=s==="NODE"},6198:(d,e,t)=>{var s=t(8014);d.exports=function(i){return s(i.length)}},6269:d=>{d.exports={}},6279:(d,e,t)=>{var s=t(6840);d.exports=function(i,r,a){for(var o in r)s(i,o,r[o],a);return i}},6319:(d,e,t)=>{var s=t(8551),i=t(9539);d.exports=function(r,a,o,l){try{return l?a(s(o)[0],o[1]):a(o)}catch(h){i(r,"throw",h)}}},6395:d=>{d.exports=!1},6518:(d,e,t)=>{var s=t(4576),i=t(7347).f,r=t(6699),a=t(6840),o=t(9433),l=t(7740),h=t(2796);d.exports=function(c,u){var f=c.target,p=c.global,v=c.stat,m,w,b,S,E,T;if(p?w=s:v?w=s[f]||o(f,{}):w=s[f]&&s[f].prototype,w)for(b in u){if(E=u[b],c.dontCallGetSet?(T=i(w,b),S=T&&T.value):S=w[b],m=h(p?b:f+(v?".":"#")+b,c.forced),!m&&S!==void 0){if(typeof E==typeof S)continue;l(E,S)}(c.sham||S&&S.sham)&&r(E,"sham",!0),a(w,b,E,c)}}},6573:(d,e,t)=>{var s=t(3724),i=t(2106),r=t(3238),a=ArrayBuffer.prototype;s&&!("detached"in a)&&i(a,"detached",{configurable:!0,get:function(){return r(this)}})},6632:(d,e,t)=>{var s=t(6518),i=t(4576),r=t(9143),a=t(4154),o=i.Uint8Array,l=!o||!o.prototype.setFromBase64||!function(){var h=new o([255,255,255,255,255]);try{h.setFromBase64("",null);return}catch{}try{h.setFromBase64("a");return}catch{}try{h.setFromBase64("MjYyZg===")}catch{return h[0]===50&&h[1]===54&&h[2]===50&&h[3]===255&&h[4]===255}}();o&&s({target:"Uint8Array",proto:!0,forced:l},{setFromBase64:function(c){a(this);var u=r(c,arguments.length>1?arguments[1]:void 0,this,this.length);return{read:u.read,written:u.written}}})},6699:(d,e,t)=>{var s=t(3724),i=t(4913),r=t(6980);d.exports=s?function(a,o,l){return i.f(a,o,r(1,l))}:function(a,o,l){return a[o]=l,a}},6706:(d,e,t)=>{var s=t(9504),i=t(9306);d.exports=function(r,a,o){try{return s(i(Object.getOwnPropertyDescriptor(r,a)[o]))}catch{}}},6801:(d,e,t)=>{var s=t(3724),i=t(8686),r=t(4913),a=t(8551),o=t(5397),l=t(1072);e.f=s&&!i?Object.defineProperties:function(c,u){a(c);for(var f=o(u),p=l(u),v=p.length,m=0,w;v>m;)r.f(c,w=p[m++],f[w]);return c}},6823:d=>{var e=String;d.exports=function(t){try{return e(t)}catch{return"Object"}}},6837:d=>{var e=TypeError,t=9007199254740991;d.exports=function(s){if(s>t)throw e("Maximum allowed index exceeded");return s}},6840:(d,e,t)=>{var s=t(4901),i=t(4913),r=t(283),a=t(9433);d.exports=function(o,l,h,c){c||(c={});var u=c.enumerable,f=c.name!==void 0?c.name:l;if(s(h)&&r(h,f,c),c.global)u?o[l]=h:a(l,h);else{try{c.unsafe?o[l]&&(u=!0):delete o[l]}catch{}u?o[l]=h:i.f(o,l,{value:h,enumerable:!1,configurable:!c.nonConfigurable,writable:!c.nonWritable})}return o}},6955:(d,e,t)=>{var s=t(2140),i=t(4901),r=t(2195),a=t(8227),o=a("toStringTag"),l=Object,h=r(function(){return arguments}())==="Arguments",c=function(u,f){try{return u[f]}catch{}};d.exports=s?r:function(u){var f,p,v;return u===void 0?"Undefined":u===null?"Null":typeof(p=c(f=l(u),o))=="string"?p:h?r(f):(v=r(f))==="Object"&&i(f.callee)?"Arguments":v}},6969:(d,e,t)=>{var s=t(2777),i=t(757);d.exports=function(r){var a=s(r,"string");return i(a)?a:a+""}},6980:d=>{d.exports=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}}},7040:(d,e,t)=>{var s=t(4495);d.exports=s&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},7055:(d,e,t)=>{var s=t(9504),i=t(9039),r=t(2195),a=Object,o=s("".split);d.exports=i(function(){return!a("z").propertyIsEnumerable(0)})?function(l){return r(l)==="String"?o(l,""):a(l)}:a},7080:(d,e,t)=>{var s=t(4402).has;d.exports=function(i){return s(i),i}},7347:(d,e,t)=>{var s=t(3724),i=t(9565),r=t(8773),a=t(6980),o=t(5397),l=t(6969),h=t(9297),c=t(5917),u=Object.getOwnPropertyDescriptor;e.f=s?u:function(p,v){if(p=o(p),v=l(v),c)try{return u(p,v)}catch{}if(h(p,v))return a(!i(r.f,p,v),p[v])}},7394:(d,e,t)=>{var s=t(4576),i=t(6706),r=t(2195),a=s.ArrayBuffer,o=s.TypeError;d.exports=a&&i(a.prototype,"byteLength","get")||function(l){if(r(l)!=="ArrayBuffer")throw new o("ArrayBuffer expected");return l.byteLength}},7416:(d,e,t)=>{var s=t(9039),i=t(8227),r=t(3724),a=t(6395),o=i("iterator");d.exports=!s(function(){var l=new URL("b?a=1&b=2&c=3","https://a"),h=l.searchParams,c=new URLSearchParams("a=1&a=2&b=3"),u="";return l.pathname="c%20d",h.forEach(function(f,p){h.delete("b"),u+=p+f}),c.delete("a",2),c.delete("b",void 0),a&&(!l.toJSON||!c.has("a",1)||c.has("a",2)||!c.has("a",void 0)||c.has("b"))||!h.size&&(a||!r)||!h.sort||l.href!=="https://a/c%20d?a=1&c=3"||h.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!h[o]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("https://тест").host!=="xn--e1aybc"||new URL("https://a#б").hash!=="#%D0%B1"||u!=="a1c3"||new URL("https://x",void 0).host!=="x"})},7476:(d,e,t)=>{var s=t(2195),i=t(9504);d.exports=function(r){if(s(r)==="Function")return i(r)}},7566:(d,e,t)=>{var s=t(6840),i=t(9504),r=t(655),a=t(2812),o=URLSearchParams,l=o.prototype,h=i(l.getAll),c=i(l.has),u=new o("a=1");(u.has("a",2)||!u.has("a",void 0))&&s(l,"has",function(p){var v=arguments.length,m=v<2?void 0:arguments[1];if(v&&m===void 0)return c(this,p);var w=h(this,p);a(v,1);for(var b=r(m),S=0;S<w.length;)if(w[S++]===b)return!0;return!1},{enumerable:!0,unsafe:!0})},7588:(d,e,t)=>{var s=t(6518),i=t(9565),r=t(2652),a=t(9306),o=t(8551),l=t(1767),h=t(9539),c=t(4549),u=c("forEach",TypeError);s({target:"Iterator",proto:!0,real:!0,forced:u},{forEach:function(p){o(this);try{a(p)}catch(w){h(this,"throw",w)}if(u)return i(u,this,p);var v=l(this),m=0;r(v,function(w){p(w,m++)},{IS_RECORD:!0})}})},7629:(d,e,t)=>{var s=t(6395),i=t(4576),r=t(9433),a="__core-js_shared__",o=d.exports=i[a]||r(a,{});(o.versions||(o.versions=[])).push({version:"3.45.1",mode:s?"pure":"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.45.1/LICENSE",source:"https://github.com/zloirock/core-js"})},7642:(d,e,t)=>{var s=t(6518),i=t(3440),r=t(9039),a=t(4916),o=!a("difference",function(h){return h.size===0}),l=o||r(function(){var h={size:1,has:function(){return!0},keys:function(){var u=0;return{next:function(){var f=u++>1;return c.has(1)&&c.clear(),{done:f,value:2}}}}},c=new Set([1,2,3,4]);return c.difference(h).size!==3});s({target:"Set",proto:!0,real:!0,forced:l},{difference:i})},7657:(d,e,t)=>{var s=t(9039),i=t(4901),r=t(34),a=t(2360),o=t(2787),l=t(6840),h=t(8227),c=t(6395),u=h("iterator"),f=!1,p,v,m;[].keys&&(m=[].keys(),"next"in m?(v=o(o(m)),v!==Object.prototype&&(p=v)):f=!0);var w=!r(p)||s(function(){var b={};return p[u].call(b)!==b});w?p={}:c&&(p=a(p)),i(p[u])||l(p,u,function(){return this}),d.exports={IteratorPrototype:p,BUGGY_SAFARI_ITERATORS:f}},7680:(d,e,t)=>{var s=t(9504);d.exports=s([].slice)},7696:(d,e,t)=>{var s=t(1291),i=t(8014),r=RangeError;d.exports=function(a){if(a===void 0)return 0;var o=s(a),l=i(o);if(o!==l)throw new r("Wrong length or index");return l}},7740:(d,e,t)=>{var s=t(9297),i=t(5031),r=t(7347),a=t(4913);d.exports=function(o,l,h){for(var c=i(l),u=a.f,f=r.f,p=0;p<c.length;p++){var v=c[p];!s(o,v)&&!(h&&s(h,v))&&u(o,v,f(l,v))}}},7750:(d,e,t)=>{var s=t(4117),i=TypeError;d.exports=function(r){if(s(r))throw new i("Can't call method on "+r);return r}},7751:(d,e,t)=>{var s=t(4576),i=t(4901),r=function(a){return i(a)?a:void 0};d.exports=function(a,o){return arguments.length<2?r(s[a]):s[a]&&s[a][o]}},7811:d=>{d.exports=typeof ArrayBuffer<"u"&&typeof DataView<"u"},7936:(d,e,t)=>{var s=t(6518),i=t(5636);i&&s({target:"ArrayBuffer",proto:!0},{transferToFixedLength:function(){return i(this,arguments.length?arguments[0]:void 0,!1)}})},8004:(d,e,t)=>{var s=t(6518),i=t(9039),r=t(8750),a=t(4916),o=!a("intersection",function(l){return l.size===2&&l.has(1)&&l.has(2)})||i(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});s({target:"Set",proto:!0,real:!0,forced:o},{intersection:r})},8014:(d,e,t)=>{var s=t(1291),i=Math.min;d.exports=function(r){var a=s(r);return a>0?i(a,9007199254740991):0}},8100:(d,e,t)=>{var s=t(6518),i=t(5636);i&&s({target:"ArrayBuffer",proto:!0},{transfer:function(){return i(this,arguments.length?arguments[0]:void 0,!0)}})},8111:(d,e,t)=>{var s=t(6518),i=t(4576),r=t(679),a=t(8551),o=t(4901),l=t(2787),h=t(2106),c=t(4659),u=t(9039),f=t(9297),p=t(8227),v=t(7657).IteratorPrototype,m=t(3724),w=t(6395),b="constructor",S="Iterator",E=p("toStringTag"),T=TypeError,x=i[S],C=w||!o(x)||x.prototype!==v||!u(function(){x({})}),R=function(){if(r(this,v),l(this)===v)throw new T("Abstract class Iterator not directly constructable")},I=function(P,M){m?h(v,P,{configurable:!0,get:function(){return M},set:function(D){if(a(this),this===v)throw new T("You can't redefine this property");f(this,P)?this[P]=D:c(this,P,D)}}):v[P]=M};f(v,E)||I(E,S),(C||!f(v,b)||v[b]===Object)&&I(b,R),R.prototype=v,s({global:!0,constructor:!0,forced:C},{Iterator:R})},8227:(d,e,t)=>{var s=t(4576),i=t(5745),r=t(9297),a=t(3392),o=t(4495),l=t(7040),h=s.Symbol,c=i("wks"),u=l?h.for||h:h&&h.withoutSetter||a;d.exports=function(f){return r(c,f)||(c[f]=o&&r(h,f)?h[f]:u("Symbol."+f)),c[f]}},8235:(d,e,t)=>{var s=t(9504),i=t(9297),r=SyntaxError,a=parseInt,o=String.fromCharCode,l=s("".charAt),h=s("".slice),c=s(/./.exec),u={'\\"':'"',"\\\\":"\\","\\/":"/","\\b":"\b","\\f":"\f","\\n":`
`,"\\r":"\r","\\t":"	"},f=/^[\da-f]{4}$/i,p=/^[\u0000-\u001F]$/;d.exports=function(v,m){for(var w=!0,b="";m<v.length;){var S=l(v,m);if(S==="\\"){var E=h(v,m,m+2);if(i(u,E))b+=u[E],m+=2;else if(E==="\\u"){m+=2;var T=h(v,m,m+4);if(!c(f,T))throw new r("Bad Unicode escape at: "+m);b+=o(a(T,16)),m+=4}else throw new r('Unknown escape sequence: "'+E+'"')}else if(S==='"'){w=!1,m++;break}else{if(c(p,S))throw new r("Bad control character in string literal at: "+m);b+=S,m++}}if(w)throw new r("Unterminated string at: "+m);return{value:b,end:m}}},8237:(d,e,t)=>{var s=t(6518),i=t(2652),r=t(9306),a=t(8551),o=t(1767),l=t(9539),h=t(4549),c=t(8745),u=t(9039),f=TypeError,p=u(function(){[].keys().reduce(function(){},void 0)}),v=!p&&h("reduce",f);s({target:"Iterator",proto:!0,real:!0,forced:p||v},{reduce:function(w){a(this);try{r(w)}catch(x){l(this,"throw",x)}var b=arguments.length<2,S=b?void 0:arguments[1];if(v)return c(v,this,b?[w]:[w,S]);var E=o(this),T=0;if(i(E,function(x){b?(b=!1,S=x):S=w(S,x,T),T++},{IS_RECORD:!0}),b)throw new f("Reduce of empty iterator with no initial value");return S}})},8335:(d,e,t)=>{var s=t(6518),i=t(3724),r=t(4576),a=t(7751),o=t(9504),l=t(9565),h=t(4901),c=t(34),u=t(4376),f=t(9297),p=t(655),v=t(6198),m=t(4659),w=t(9039),b=t(8235),S=t(4495),E=r.JSON,T=r.Number,x=r.SyntaxError,C=E&&E.parse,R=a("Object","keys"),I=Object.getOwnPropertyDescriptor,P=o("".charAt),M=o("".slice),D=o(/./.exec),O=o([].push),N=/^\d$/,B=/^[1-9]$/,W=/^[\d-]$/,_=/^[\t\n\r ]$/,L=0,X=1,Z=function(H,F){H=p(H);var $=new ot(H,0),tt=$.parse(),gt=tt.value,K=$.skip(_,tt.end);if(K<H.length)throw new x('Unexpected extra character: "'+P(H,K)+'" after the parsed data at: '+K);return h(F)?pt({"":gt},"",F,tt):gt},pt=function(H,F,$,tt){var gt=H[F],K=tt&&gt===tt.value,Dt=K&&typeof tt.source=="string"?{source:tt.source}:{},Lt,bs,Me,ae,$a;if(c(gt)){var Au=u(gt),Wc=K?tt.nodes:Au?[]:{};if(Au)for(Lt=Wc.length,Me=v(gt),ae=0;ae<Me;ae++)$t(gt,ae,pt(gt,""+ae,$,ae<Lt?Wc[ae]:void 0));else for(bs=R(gt),Me=v(bs),ae=0;ae<Me;ae++)$a=bs[ae],$t(gt,$a,pt(gt,$a,$,f(Wc,$a)?Wc[$a]:void 0))}return l($,H,F,gt,Dt)},$t=function(H,F,$){if(i){var tt=I(H,F);if(tt&&!tt.configurable)return}$===void 0?delete H[F]:m(H,F,$)},q=function(H,F,$,tt){this.value=H,this.end=F,this.source=$,this.nodes=tt},ot=function(H,F){this.source=H,this.index=F};ot.prototype={fork:function(H){return new ot(this.source,H)},parse:function(){var H=this.source,F=this.skip(_,this.index),$=this.fork(F),tt=P(H,F);if(D(W,tt))return $.number();switch(tt){case"{":return $.object();case"[":return $.array();case'"':return $.string();case"t":return $.keyword(!0);case"f":return $.keyword(!1);case"n":return $.keyword(null)}throw new x('Unexpected character: "'+tt+'" at: '+F)},node:function(H,F,$,tt,gt){return new q(F,tt,H?null:M(this.source,$,tt),gt)},object:function(){for(var H=this.source,F=this.index+1,$=!1,tt={},gt={};F<H.length;){if(F=this.until(['"',"}"],F),P(H,F)==="}"&&!$){F++;break}var K=this.fork(F).string(),Dt=K.value;F=K.end,F=this.until([":"],F)+1,F=this.skip(_,F),K=this.fork(F).parse(),m(gt,Dt,K),m(tt,Dt,K.value),F=this.until([",","}"],K.end);var Lt=P(H,F);if(Lt===",")$=!0,F++;else if(Lt==="}"){F++;break}}return this.node(X,tt,this.index,F,gt)},array:function(){for(var H=this.source,F=this.index+1,$=!1,tt=[],gt=[];F<H.length;){if(F=this.skip(_,F),P(H,F)==="]"&&!$){F++;break}var K=this.fork(F).parse();if(O(gt,K),O(tt,K.value),F=this.until([",","]"],K.end),P(H,F)===",")$=!0,F++;else if(P(H,F)==="]"){F++;break}}return this.node(X,tt,this.index,F,gt)},string:function(){var H=this.index,F=b(this.source,this.index+1);return this.node(L,F.value,H,F.end)},number:function(){var H=this.source,F=this.index,$=F;if(P(H,$)==="-"&&$++,P(H,$)==="0")$++;else if(D(B,P(H,$)))$=this.skip(N,$+1);else throw new x("Failed to parse number at: "+$);if(P(H,$)==="."&&($=this.skip(N,$+1)),P(H,$)==="e"||P(H,$)==="E"){$++,(P(H,$)==="+"||P(H,$)==="-")&&$++;var tt=$;if($=this.skip(N,$),tt===$)throw new x("Failed to parse number's exponent value at: "+$)}return this.node(L,T(M(H,F,$)),F,$)},keyword:function(H){var F=""+H,$=this.index,tt=$+F.length;if(M(this.source,$,tt)!==F)throw new x("Failed to parse value at: "+$);return this.node(L,H,$,tt)},skip:function(H,F){for(var $=this.source;F<$.length&&D(H,P($,F));F++);return F},until:function(H,F){F=this.skip(_,F);for(var $=P(this.source,F),tt=0;tt<H.length;tt++)if(H[tt]===$)return F;throw new x('Unexpected character: "'+$+'" at: '+F)}};var yt=w(function(){var H="9007199254740993",F;return C(H,function($,tt,gt){F=gt.source}),F!==H}),Kt=S&&!w(function(){return 1/C("-0 	")!==-1/0});s({target:"JSON",stat:!0,forced:yt},{parse:function(F,$){return Kt&&!h($)?C(F):Z(F,$)}})},8469:(d,e,t)=>{var s=t(9504),i=t(507),r=t(4402),a=r.Set,o=r.proto,l=s(o.forEach),h=s(o.keys),c=h(new a).next;d.exports=function(u,f,p){return p?i({iterator:h(u),next:c},f):l(u,f)}},8480:(d,e,t)=>{var s=t(1828),i=t(8727),r=i.concat("length","prototype");e.f=Object.getOwnPropertyNames||function(o){return s(o,r)}},8527:(d,e,t)=>{var s=t(7080),i=t(4402).has,r=t(5170),a=t(3789),o=t(507),l=t(9539);d.exports=function(c){var u=s(this),f=a(c);if(r(u)<f.size)return!1;var p=f.getIterator();return o(p,function(v){if(!i(u,v))return l(p,"normal",!1)})!==!1}},8551:(d,e,t)=>{var s=t(34),i=String,r=TypeError;d.exports=function(a){if(s(a))return a;throw new r(i(a)+" is not an object")}},8574:(d,e,t)=>{var s=t(9504),i=Error,r=s("".replace),a=function(h){return String(new i(h).stack)}("zxcasd"),o=/\n\s*at [^:]*:[^\n]*/,l=o.test(a);d.exports=function(h,c){if(l&&typeof h=="string"&&!i.prepareStackTrace)for(;c--;)h=r(h,o,"");return h}},8622:(d,e,t)=>{var s=t(4576),i=t(4901),r=s.WeakMap;d.exports=i(r)&&/native code/.test(String(r))},8646:(d,e,t)=>{var s=t(9565),i=t(8551),r=t(1767),a=t(851);d.exports=function(o,l){(!l||typeof o!="string")&&i(o);var h=a(o);return r(i(h!==void 0?s(h,o):o))}},8686:(d,e,t)=>{var s=t(3724),i=t(9039);d.exports=s&&i(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})},8721:(d,e,t)=>{var s=t(3724),i=t(9504),r=t(2106),a=URLSearchParams.prototype,o=i(a.forEach);s&&!("size"in a)&&r(a,"size",{get:function(){var h=0;return o(this,function(){h++}),h},configurable:!0,enumerable:!0})},8727:d=>{d.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},8745:(d,e,t)=>{var s=t(616),i=Function.prototype,r=i.apply,a=i.call;d.exports=typeof Reflect=="object"&&Reflect.apply||(s?a.bind(r):function(){return a.apply(r,arguments)})},8750:(d,e,t)=>{var s=t(7080),i=t(4402),r=t(5170),a=t(3789),o=t(8469),l=t(507),h=i.Set,c=i.add,u=i.has;d.exports=function(p){var v=s(this),m=a(p),w=new h;return r(v)>m.size?l(m.getIterator(),function(b){u(v,b)&&c(w,b)}):o(v,function(b){m.includes(b)&&c(w,b)}),w}},8773:(d,e)=>{var t={}.propertyIsEnumerable,s=Object.getOwnPropertyDescriptor,i=s&&!t.call({1:2},1);e.f=i?function(a){var o=s(this,a);return!!o&&o.enumerable}:t},8981:(d,e,t)=>{var s=t(7750),i=Object;d.exports=function(r){return i(s(r))}},9039:d=>{d.exports=function(e){try{return!!e()}catch{return!0}}},9143:(d,e,t)=>{var s=t(4576),i=t(9504),r=t(3972),a=t(3463),o=t(9297),l=t(2804),h=t(944),c=t(5169),u=l.c2i,f=l.c2iUrl,p=s.SyntaxError,v=s.TypeError,m=i("".charAt),w=function(E,T){for(var x=E.length;T<x;T++){var C=m(E,T);if(C!==" "&&C!=="	"&&C!==`
`&&C!=="\f"&&C!=="\r")break}return T},b=function(E,T,x){var C=E.length;C<4&&(E+=C===2?"AA":"A");var R=(T[m(E,0)]<<18)+(T[m(E,1)]<<12)+(T[m(E,2)]<<6)+T[m(E,3)],I=[R>>16&255,R>>8&255,R&255];if(C===2){if(x&&I[1]!==0)throw new p("Extra bits");return[I[0]]}if(C===3){if(x&&I[2]!==0)throw new p("Extra bits");return[I[0],I[1]]}return I},S=function(E,T,x){for(var C=T.length,R=0;R<C;R++)E[x+R]=T[R];return x+C};d.exports=function(E,T,x,C){a(E),r(T);var R=h(T)==="base64"?u:f,I=T?T.lastChunkHandling:void 0;if(I===void 0&&(I="loose"),I!=="loose"&&I!=="strict"&&I!=="stop-before-partial")throw new v("Incorrect `lastChunkHandling` option");x&&c(x.buffer);var P=E.length,M=x||[],D=0,O=0,N="",B=0;if(C)for(;;){if(B=w(E,B),B===P){if(N.length>0){if(I==="stop-before-partial")break;if(I==="loose"){if(N.length===1)throw new p("Malformed padding: exactly one additional character");D=S(M,b(N,R,!1),D)}else throw new p("Missing padding")}O=P;break}var W=m(E,B);if(++B,W==="="){if(N.length<2)throw new p("Padding is too early");if(B=w(E,B),N.length===2){if(B===P){if(I==="stop-before-partial")break;throw new p("Malformed padding: only one =")}m(E,B)==="="&&(++B,B=w(E,B))}if(B<P)throw new p("Unexpected character after padding");D=S(M,b(N,R,I==="strict"),D),O=P;break}if(!o(R,W))throw new p("Unexpected character");var _=C-D;if(_===1&&N.length===2||_===2&&N.length===3||(N+=W,N.length===4&&(D=S(M,b(N,R,!1),D),N="",O=B,D===C)))break}return{bytes:M,read:O,written:D}}},9286:(d,e,t)=>{var s=t(4402),i=t(8469),r=s.Set,a=s.add;d.exports=function(o){var l=new r;return i(o,function(h){a(l,h)}),l}},9297:(d,e,t)=>{var s=t(9504),i=t(8981),r=s({}.hasOwnProperty);d.exports=Object.hasOwn||function(o,l){return r(i(o),l)}},9306:(d,e,t)=>{var s=t(4901),i=t(6823),r=TypeError;d.exports=function(a){if(s(a))return a;throw new r(i(a)+" is not a function")}},9314:(d,e,t)=>{var s=t(6518),i=t(9565),r=t(8551),a=t(1767),o=t(4149),l=t(9590),h=t(9539),c=t(9462),u=t(684),f=t(4549),p=t(6395),v=!p&&!u("drop",0),m=!p&&!v&&f("drop",RangeError),w=p||v||m,b=c(function(){for(var S=this.iterator,E=this.next,T,x;this.remaining;)if(this.remaining--,T=r(i(E,S)),x=this.done=!!T.done,x)return;if(T=r(i(E,S)),x=this.done=!!T.done,!x)return T.value});s({target:"Iterator",proto:!0,real:!0,forced:w},{drop:function(E){r(this);var T;try{T=l(o(+E))}catch(x){h(this,"throw",x)}return m?i(m,this,T):new b(a(this),{remaining:T})}})},9429:(d,e,t)=>{var s=t(4576),i=t(6193);d.exports=function(r){if(i){try{return s.process.getBuiltinModule(r)}catch{}try{return Function('return require("'+r+'")')()}catch{}}}},9432:(d,e,t)=>{t(5213)},9433:(d,e,t)=>{var s=t(4576),i=Object.defineProperty;d.exports=function(r,a){try{i(s,r,{value:a,configurable:!0,writable:!0})}catch{s[r]=a}return a}},9462:(d,e,t)=>{var s=t(9565),i=t(2360),r=t(6699),a=t(6279),o=t(8227),l=t(1181),h=t(5966),c=t(7657).IteratorPrototype,u=t(2529),f=t(9539),p=t(1385),v=o("toStringTag"),m="IteratorHelper",w="WrapForValidIterator",b="normal",S="throw",E=l.set,T=function(R){var I=l.getterFor(R?w:m);return a(i(c),{next:function(){var M=I(this);if(R)return M.nextHandler();if(M.done)return u(void 0,!0);try{var D=M.nextHandler();return M.returnHandlerResult?D:u(D,M.done)}catch(O){throw M.done=!0,O}},return:function(){var P=I(this),M=P.iterator;if(P.done=!0,R){var D=h(M,"return");return D?s(D,M):u(void 0,!0)}if(P.inner)try{f(P.inner.iterator,b)}catch(O){return f(M,S,O)}if(P.openIters)try{p(P.openIters,b)}catch(O){return f(M,S,O)}return M&&f(M,b),u(void 0,!0)}})},x=T(!0),C=T(!1);r(C,v,"Iterator Helper"),d.exports=function(R,I,P){var M=function(O,N){N?(N.iterator=O.iterator,N.next=O.next):N=O,N.type=I?w:m,N.returnHandlerResult=!!P,N.nextHandler=R,N.counter=0,N.done=!1,E(this,N)};return M.prototype=I?x:C,M}},9486:(d,e,t)=>{var s=t(6518),i=t(4576),r=t(9504),a=t(3972),o=t(4154),l=t(5169),h=t(2804),c=t(944),u=h.i2c,f=h.i2cUrl,p=r("".charAt),v=i.Uint8Array,m=!v||!v.prototype.toBase64||!function(){try{var w=new v;w.toBase64(null)}catch{return!0}}();v&&s({target:"Uint8Array",proto:!0,forced:m},{toBase64:function(){var b=o(this),S=arguments.length?a(arguments[0]):void 0,E=c(S)==="base64"?u:f,T=!!S&&!!S.omitPadding;l(this.buffer);for(var x="",C=0,R=b.length,I,P=function(M){return p(E,I>>6*M&63)};C+2<R;C+=3)I=(b[C]<<16)+(b[C+1]<<8)+b[C+2],x+=P(3)+P(2)+P(1)+P(0);return C+2===R?(I=(b[C]<<16)+(b[C+1]<<8),x+=P(3)+P(2)+P(1)+(T?"":"=")):C+1===R&&(I=b[C]<<16,x+=P(3)+P(2)+(T?"":"==")),x}})},9504:(d,e,t)=>{var s=t(616),i=Function.prototype,r=i.call,a=s&&i.bind.bind(r,r);d.exports=s?a:function(o){return function(){return r.apply(o,arguments)}}},9519:(d,e,t)=>{var s=t(4576),i=t(2839),r=s.process,a=s.Deno,o=r&&r.versions||a&&a.version,l=o&&o.v8,h,c;l&&(h=l.split("."),c=h[0]>0&&h[0]<4?1:+(h[0]+h[1])),!c&&i&&(h=i.match(/Edge\/(\d+)/),(!h||h[1]>=74)&&(h=i.match(/Chrome\/(\d+)/),h&&(c=+h[1]))),d.exports=c},9539:(d,e,t)=>{var s=t(9565),i=t(8551),r=t(5966);d.exports=function(a,o,l){var h,c;i(a);try{if(h=r(a,"return"),!h){if(o==="throw")throw l;return l}h=s(h,a)}catch(u){c=!0,h=u}if(o==="throw")throw l;if(c)throw h;return i(h),l}},9565:(d,e,t)=>{var s=t(616),i=Function.prototype.call;d.exports=s?i.bind(i):function(){return i.apply(i,arguments)}},9577:(d,e,t)=>{var s=t(9928),i=t(4644),r=t(1108),a=t(1291),o=t(5854),l=i.aTypedArray,h=i.getTypedArrayConstructor,c=i.exportTypedArrayMethod,u=function(){try{new Int8Array(1).with(2,{valueOf:function(){throw 8}})}catch(p){return p===8}}(),f=u&&function(){try{new Int8Array(1).with(-.5,1)}catch{return!0}}();c("with",function(p,v){var m=l(this),w=a(p),b=r(m)?o(v):+v;return s(m,h(m),w,b)},!u||f)},9590:(d,e,t)=>{var s=t(1291),i=RangeError;d.exports=function(r){var a=s(r);if(a<0)throw new i("The argument can't be less than 0");return a}},9617:(d,e,t)=>{var s=t(5397),i=t(5610),r=t(6198),a=function(o){return function(l,h,c){var u=s(l),f=r(u);if(f===0)return!o&&-1;var p=i(c,f),v;if(o&&h!==h){for(;f>p;)if(v=u[p++],v!==v)return!0}else for(;f>p;p++)if((o||p in u)&&u[p]===h)return o||p||0;return!o&&-1}};d.exports={includes:a(!0),indexOf:a(!1)}},9631:(d,e,t)=>{t(9486)},9797:(d,e,t)=>{t(4226)},9835:d=>{d.exports=function(e){try{var t=new Set,s={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return t.clear(),t.add(4),function(){return{done:!0}}}})}},i=t[e](s);return i.size===1&&i.values().next().value===4}catch{return!1}}},9928:(d,e,t)=>{var s=t(6198),i=t(1291),r=RangeError;d.exports=function(a,o,l,h){var c=s(a),u=i(l),f=u<0?c+u:u;if(f>=c||f<0)throw new r("Incorrect index");for(var p=new o(c),v=0;v<c;v++)p[v]=v===f?h:a[v];return p}}},Sp={};function nt(d){var e=Sp[d];if(e!==void 0)return e.exports;var t=Sp[d]={exports:{}};return hv[d].call(t.exports,t,t.exports,nt),t.exports}nt.d=(d,e)=>{for(var t in e)nt.o(e,t)&&!nt.o(d,t)&&Object.defineProperty(d,t,{enumerable:!0,get:e[t]})};nt.o=(d,e)=>Object.prototype.hasOwnProperty.call(d,e);nt(4114);nt(6573);nt(8100);nt(7936);nt(8111);nt(8237);nt(1689);nt(9577);nt(4235);nt(9432);nt(1549);nt(9797);nt(9631);nt(5623);nt(4979);nt(5781);const Be=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Du=[.001,0,0,.001,0,0],Eu=1.35,gs={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},bn={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},th="pdfjs_internal_editor_",st={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},ct={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},cv={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},pe={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},id={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Qt={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},za={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},pu={ERRORS:0,WARNINGS:1,INFOS:5},eh={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Xc={moveTo:0,lineTo:1,curveTo:2,closePath:3},dv={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let gu=pu.WARNINGS;function uv(d){Number.isInteger(d)&&(gu=d)}function fv(){return gu}function mu(d){gu>=pu.INFOS&&console.info(`Info: ${d}`)}function Q(d){gu>=pu.WARNINGS&&console.warn(`Warning: ${d}`)}function It(d){throw new Error(d)}function dt(d,e){d||It(e)}function pv(d){switch(d==null?void 0:d.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function qp(d,e=null,t=null){if(!d)return null;if(t&&typeof d=="string"){if(t.addDefaultProtocol&&d.startsWith("www.")){const i=d.match(/\./g);(i==null?void 0:i.length)>=2&&(d=`http://${d}`)}if(t.tryConvertEncoding)try{d=bv(d)}catch{}}const s=e?URL.parse(d,e):URL.parse(d);return pv(s)?s:null}function tg(d,e,t=!1){const s=URL.parse(d);return s?(s.hash=e,s.href):t&&qp(d,"http://example.com")?d.split("#",1)[0]+`${e?`#${e}`:""}`:""}function lt(d,e,t,s=!1){return Object.defineProperty(d,e,{value:t,enumerable:!s,configurable:!0,writable:!1}),t}const Ua=function(){function e(t,s){this.message=t,this.name=s}return e.prototype=new Error,e.constructor=e,e}();class xp extends Ua{constructor(e,t){super(e,"PasswordException"),this.code=t}}class Su extends Ua{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class Mu extends Ua{constructor(e){super(e,"InvalidPDFException")}}class Nd extends Ua{constructor(e,t,s){super(e,"ResponseException"),this.status=t,this.missing=s}}class gv extends Ua{constructor(e){super(e,"FormatError")}}class pr extends Ua{constructor(e){super(e,"AbortException")}}function eg(d){(typeof d!="object"||(d==null?void 0:d.length)===void 0)&&It("Invalid argument for bytesToString");const e=d.length,t=8192;if(e<t)return String.fromCharCode.apply(null,d);const s=[];for(let i=0;i<e;i+=t){const r=Math.min(i+t,e),a=d.subarray(i,r);s.push(String.fromCharCode.apply(null,a))}return s.join("")}function Uc(d){typeof d!="string"&&It("Invalid argument for stringToBytes");const e=d.length,t=new Uint8Array(e);for(let s=0;s<e;++s)t[s]=d.charCodeAt(s)&255;return t}function mv(d){return String.fromCharCode(d>>24&255,d>>16&255,d>>8&255,d&255)}function vv(){const d=new Uint8Array(4);return d[0]=1,new Uint32Array(d.buffer,0,1)[0]===1}function yv(){try{return new Function(""),!0}catch{return!1}}class Se{static get isLittleEndian(){return lt(this,"isLittleEndian",vv())}static get isEvalSupported(){return lt(this,"isEvalSupported",yv())}static get isOffscreenCanvasSupported(){return lt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return lt(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return lt(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){var e,t;return lt(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const xu=Array.from(Array(256).keys(),d=>d.toString(16).padStart(2,"0"));var pn,nd,Ou;class G{static makeHexColor(e,t,s){return`#${xu[e]}${xu[t]}${xu[s]}`}static domMatrixToTransform(e){return[e.a,e.b,e.c,e.d,e.e,e.f]}static scaleMinMax(e,t){let s;e[0]?(e[0]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[3],t[3]*=e[3]):(s=t[0],t[0]=t[1],t[1]=s,s=t[2],t[2]=t[3],t[3]=s,e[1]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static multiplyByDOMMatrix(e,t){return[e[0]*t.a+e[2]*t.b,e[1]*t.a+e[3]*t.b,e[0]*t.c+e[2]*t.d,e[1]*t.c+e[3]*t.d,e[0]*t.e+e[2]*t.f+e[4],e[1]*t.e+e[3]*t.f+e[5]]}static applyTransform(e,t,s=0){const i=e[s],r=e[s+1];e[s]=i*t[0]+r*t[2]+t[4],e[s+1]=i*t[1]+r*t[3]+t[5]}static applyTransformToBezier(e,t,s=0){const i=t[0],r=t[1],a=t[2],o=t[3],l=t[4],h=t[5];for(let c=0;c<6;c+=2){const u=e[s+c],f=e[s+c+1];e[s+c]=u*i+f*a+l,e[s+c+1]=u*r+f*o+h}}static applyInverseTransform(e,t){const s=e[0],i=e[1],r=t[0]*t[3]-t[1]*t[2];e[0]=(s*t[3]-i*t[2]+t[2]*t[5]-t[4]*t[3])/r,e[1]=(-s*t[1]+i*t[0]+t[4]*t[1]-t[5]*t[0])/r}static axialAlignedBoundingBox(e,t,s){const i=t[0],r=t[1],a=t[2],o=t[3],l=t[4],h=t[5],c=e[0],u=e[1],f=e[2],p=e[3];let v=i*c+l,m=v,w=i*f+l,b=w,S=o*u+h,E=S,T=o*p+h,x=T;if(r!==0||a!==0){const C=r*c,R=r*f,I=a*u,P=a*p;v+=I,b+=I,w+=P,m+=P,S+=C,x+=C,T+=R,E+=R}s[0]=Math.min(s[0],v,w,m,b),s[1]=Math.min(s[1],S,T,E,x),s[2]=Math.max(s[2],v,w,m,b),s[3]=Math.max(s[3],S,T,E,x)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const s=e[0],i=e[1],r=e[2],a=e[3],o=s**2+i**2,l=s*r+i*a,h=r**2+a**2,c=(o+h)/2,u=Math.sqrt(c**2-(o*h-l**2));t[0]=Math.sqrt(c+u||1),t[1]=Math.sqrt(c-u||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const s=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(s>i)return null;const r=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),a=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return r>a?null:[s,r,i,a]}static pointBoundingBox(e,t,s){s[0]=Math.min(s[0],e),s[1]=Math.min(s[1],t),s[2]=Math.max(s[2],e),s[3]=Math.max(s[3],t)}static rectBoundingBox(e,t,s,i,r){r[0]=Math.min(r[0],e,s),r[1]=Math.min(r[1],t,i),r[2]=Math.max(r[2],e,s),r[3]=Math.max(r[3],t,i)}static bezierBoundingBox(e,t,s,i,r,a,o,l,h){h[0]=Math.min(h[0],e,o),h[1]=Math.min(h[1],t,l),h[2]=Math.max(h[2],e,o),h[3]=Math.max(h[3],t,l),A(this,pn,Ou).call(this,e,s,r,o,t,i,a,l,3*(-e+3*(s-r)+o),6*(e-2*s+r),3*(s-e),h),A(this,pn,Ou).call(this,e,s,r,o,t,i,a,l,3*(-t+3*(i-a)+l),6*(t-2*i+a),3*(i-t),h)}}pn=new WeakSet,nd=function(e,t,s,i,r,a,o,l,h,c){if(h<=0||h>=1)return;const u=1-h,f=h*h,p=f*h,v=u*(u*(u*e+3*h*t)+3*f*s)+p*i,m=u*(u*(u*r+3*h*a)+3*f*o)+p*l;c[0]=Math.min(c[0],v),c[1]=Math.min(c[1],m),c[2]=Math.max(c[2],v),c[3]=Math.max(c[3],m)},Ou=function(e,t,s,i,r,a,o,l,h,c,u,f){if(Math.abs(h)<1e-12){Math.abs(c)>=1e-12&&A(this,pn,nd).call(this,e,t,s,i,r,a,o,l,-u/c,f);return}const p=c**2-4*u*h;if(p<0)return;const v=Math.sqrt(p),m=2*h;A(this,pn,nd).call(this,e,t,s,i,r,a,o,l,(-c+v)/m,f),A(this,pn,nd).call(this,e,t,s,i,r,a,o,l,(-c-v)/m,f)},y(G,pn);function bv(d){return decodeURIComponent(escape(d))}let Tu=null,Tp=null;function Av(d){return Tu||(Tu=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Tp=new Map([["ﬅ","ſt"]])),d.replaceAll(Tu,(e,t,s)=>t?t.normalize("NFKC"):Tp.get(s))}function sg(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const d=new Uint8Array(32);return crypto.getRandomValues(d),eg(d)}const ap="pdfjs_internal_id_";function wv(d,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[s,i,...r]=t;if(!d(s)&&!Number.isInteger(s)||!e(i))return!1;const a=r.length;let o=!0;switch(i.name){case"XYZ":if(a<2||a>3)return!1;break;case"Fit":case"FitB":return a===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(a>1)return!1;break;case"FitR":if(a!==4)return!1;o=!1;break;default:return!1}for(const l of r)if(!(typeof l=="number"||o&&l===null))return!1;return!0}function _e(d,e,t){return Math.min(Math.max(d,e),t)}function ig(d){return Uint8Array.prototype.toBase64?d.toBase64():btoa(eg(d))}function Ev(d){return Uint8Array.fromBase64?Uint8Array.fromBase64(d):Uc(atob(d))}typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(d){return d.reduce((e,t)=>e+t,0)});typeof AbortSignal.any!="function"&&(AbortSignal.any=function(d){const e=new AbortController,{signal:t}=e;for(const s of d)if(s.aborted)return e.abort(s.reason),t;for(const s of d)s.addEventListener("abort",()=>{e.abort(s.reason)},{signal:t});return t});nt(1701);nt(4603);nt(7566);nt(8721);class sh{static textContent(e){const t=[],s={items:t,styles:Object.create(null)};function i(r){var l;if(!r)return;let a=null;const o=r.name;if(o==="#text")a=r.value;else if(sh.shouldBuildText(o))(l=r==null?void 0:r.attributes)!=null&&l.textContent?a=r.attributes.textContent:r.value&&(a=r.value);else return;if(a!==null&&t.push({str:a}),!!r.children)for(const h of r.children)i(h)}return i(e),s}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}class ng{static setupStorage(e,t,s,i,r){const a=i.getValue(t,{value:null});switch(s.name){case"textarea":if(a.value!==null&&(e.textContent=a.value),r==="print")break;e.addEventListener("input",o=>{i.setValue(t,{value:o.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(a.value===s.attributes.xfaOn?e.setAttribute("checked",!0):a.value===s.attributes.xfaOff&&e.removeAttribute("checked"),r==="print")break;e.addEventListener("change",o=>{i.setValue(t,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&e.setAttribute("value",a.value),r==="print")break;e.addEventListener("input",o=>{i.setValue(t,{value:o.target.value})})}break;case"select":if(a.value!==null){e.setAttribute("value",a.value);for(const o of s.children)o.attributes.value===a.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}e.addEventListener("input",o=>{const l=o.target.options,h=l.selectedIndex===-1?"":l[l.selectedIndex].value;i.setValue(t,{value:h})});break}}static setAttributes({html:e,element:t,storage:s=null,intent:i,linkService:r}){const{attributes:a}=t,o=e instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${i}`);for(const[l,h]of Object.entries(a))if(h!=null)switch(l){case"class":h.length&&e.setAttribute(l,h.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",h);break;case"style":Object.assign(e.style,h);break;case"textContent":e.textContent=h;break;default:(!o||l!=="href"&&l!=="newWindow")&&e.setAttribute(l,h)}o&&r.addLinkAttributes(e,a.href,a.newWindow),s&&a.dataId&&this.setupStorage(e,a.dataId,t,s)}static render(e){var u,f;const t=e.annotationStorage,s=e.linkService,i=e.xfaHtml,r=e.intent||"display",a=document.createElement(i.name);i.attributes&&this.setAttributes({html:a,element:i,intent:r,linkService:s});const o=r!=="richText",l=e.div;if(l.append(a),e.viewport){const p=`matrix(${e.viewport.transform.join(",")})`;l.style.transform=p}o&&l.setAttribute("class","xfaLayer xfaFont");const h=[];if(i.children.length===0){if(i.value){const p=document.createTextNode(i.value);a.append(p),o&&sh.shouldBuildText(i.name)&&h.push(p)}return{textDivs:h}}const c=[[i,-1,a]];for(;c.length>0;){const[p,v,m]=c.at(-1);if(v+1===p.children.length){c.pop();continue}const w=p.children[++c.at(-1)[1]];if(w===null)continue;const{name:b}=w;if(b==="#text"){const E=document.createTextNode(w.value);h.push(E),m.append(E);continue}const S=(u=w==null?void 0:w.attributes)!=null&&u.xmlns?document.createElementNS(w.attributes.xmlns,b):document.createElement(b);if(m.append(S),w.attributes&&this.setAttributes({html:S,element:w,storage:t,intent:r,linkService:s}),((f=w.children)==null?void 0:f.length)>0)c.push([w,-1,S]);else if(w.value){const E=document.createTextNode(w.value);o&&sh.shouldBuildText(b)&&h.push(E),S.append(E)}}for(const p of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))p.setAttribute("readOnly",!0);return{textDivs:h}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const Ri="http://www.w3.org/2000/svg",wr=class wr{};k(wr,"CSS",96),k(wr,"PDF",72),k(wr,"PDF_TO_CSS_UNITS",wr.CSS/wr.PDF);let gr=wr;async function Hc(d,e="text"){if(Ll(d,document.baseURI)){const t=await fetch(d);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,s)=>{const i=new XMLHttpRequest;i.open("GET",d,!0),i.responseType=e,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(i.response);return}t(i.responseText);return}s(new Error(i.statusText))}},i.send(null)})}class $c{constructor({viewBox:e,userUnit:t,scale:s,rotation:i,offsetX:r=0,offsetY:a=0,dontFlip:o=!1}){this.viewBox=e,this.userUnit=t,this.scale=s,this.rotation=i,this.offsetX=r,this.offsetY=a,s*=t;const l=(e[2]+e[0])/2,h=(e[3]+e[1])/2;let c,u,f,p;switch(i%=360,i<0&&(i+=360),i){case 180:c=-1,u=0,f=0,p=1;break;case 90:c=0,u=1,f=1,p=0;break;case 270:c=0,u=-1,f=-1,p=0;break;case 0:c=1,u=0,f=0,p=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(f=-f,p=-p);let v,m,w,b;c===0?(v=Math.abs(h-e[1])*s+r,m=Math.abs(l-e[0])*s+a,w=(e[3]-e[1])*s,b=(e[2]-e[0])*s):(v=Math.abs(l-e[0])*s+r,m=Math.abs(h-e[1])*s+a,w=(e[2]-e[0])*s,b=(e[3]-e[1])*s),this.transform=[c*s,u*s,f*s,p*s,v-c*s*l-f*s*h,m-u*s*l-p*s*h],this.width=w,this.height=b}get rawDims(){const e=this.viewBox;return lt(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:s=this.offsetX,offsetY:i=this.offsetY,dontFlip:r=!1}={}){return new $c({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:r})}convertToViewportPoint(e,t){const s=[e,t];return G.applyTransform(s,this.transform),s}convertToViewportRectangle(e){const t=[e[0],e[1]];G.applyTransform(t,this.transform);const s=[e[2],e[3]];return G.applyTransform(s,this.transform),[t[0],t[1],s[0],s[1]]}convertToPdfPoint(e,t){const s=[e,t];return G.applyInverseTransform(s,this.transform),s}}class op extends Ua{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function vu(d){const e=d.length;let t=0;for(;t<e&&d[t].trim()==="";)t++;return d.substring(t,t+5).toLowerCase()==="data:"}function lp(d){return typeof d=="string"&&/\.pdf$/i.test(d)}function Sv(d){return[d]=d.split(/[#?]/,1),d.substring(d.lastIndexOf("/")+1)}function xv(d,e="document.pdf"){if(typeof d!="string")return e;if(vu(d))return Q('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const s=(o=>{try{return new URL(o)}catch{try{return new URL(decodeURIComponent(o))}catch{try{return new URL(o,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(o),"https://foo.bar")}catch{return null}}}}})(d);if(!s)return e;const i=o=>{try{let l=decodeURIComponent(o);return l.includes("/")?(l=l.split("/").at(-1),l.test(/^\.pdf$/i)?l:o):l}catch{return o}},r=/\.pdf$/i,a=s.pathname.split("/").at(-1);if(r.test(a))return i(a);if(s.searchParams.size>0){const o=Array.from(s.searchParams.values()).reverse();for(const h of o)if(r.test(h))return i(h);const l=Array.from(s.searchParams.keys()).reverse();for(const h of l)if(r.test(h))return i(h)}if(s.hash){const l=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(s.hash);if(l)return i(l[0])}return e}class Cp{constructor(){k(this,"started",Object.create(null));k(this,"times",[])}time(e){e in this.started&&Q(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Q(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:s}of this.times)t=Math.max(s.length,t);for(const{name:s,start:i,end:r}of this.times)e.push(`${s.padEnd(t)} ${r-i}ms
`);return e.join("")}}function Ll(d,e){const t=e?URL.parse(d,e):URL.parse(d);return(t==null?void 0:t.protocol)==="http:"||(t==null?void 0:t.protocol)==="https:"}function ks(d){d.preventDefault()}function Wt(d){d.preventDefault(),d.stopPropagation()}function Tv(d){console.log("Deprecated API usage: "+d)}var rh;class Bd{static toDateObject(e){if(e instanceof Date)return e;if(!e||typeof e!="string")return null;n(this,rh)||g(this,rh,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=n(this,rh).exec(e);if(!t)return null;const s=parseInt(t[1],10);let i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let r=parseInt(t[3],10);r=r>=1&&r<=31?r:1;let a=parseInt(t[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(t[5],10);o=o>=0&&o<=59?o:0;let l=parseInt(t[6],10);l=l>=0&&l<=59?l:0;const h=t[7]||"Z";let c=parseInt(t[8],10);c=c>=0&&c<=23?c:0;let u=parseInt(t[9],10)||0;return u=u>=0&&u<=59?u:0,h==="-"?(a+=c,o+=u):h==="+"&&(a-=c,o-=u),new Date(Date.UTC(s,i,r,a,o,l))}}rh=new WeakMap,y(Bd,rh);function Cv(d,{scale:e=1,rotation:t=0}){const{width:s,height:i}=d.attributes.style,r=[0,0,parseInt(s),parseInt(i)];return new $c({viewBox:r,userUnit:1,scale:e,rotation:t})}function jc(d){if(d.startsWith("#")){const e=parseInt(d.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return d.startsWith("rgb(")?d.slice(4,-1).split(",").map(e=>parseInt(e)):d.startsWith("rgba(")?d.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Q(`Not a valid color format: "${d}"`),[0,0,0])}function Rv(d){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of d.keys()){e.style.color=t;const s=window.getComputedStyle(e).color;d.set(t,jc(s))}e.remove()}function Ut(d){const{a:e,b:t,c:s,d:i,e:r,f:a}=d.getTransform();return[e,t,s,i,r,a]}function Zs(d){const{a:e,b:t,c:s,d:i,e:r,f:a}=d.getTransform().invertSelf();return[e,t,s,i,r,a]}function Na(d,e,t=!1,s=!0){if(e instanceof $c){const{pageWidth:i,pageHeight:r}=e.rawDims,{style:a}=d,o=Se.isCSSRoundSupported,l=`var(--total-scale-factor) * ${i}px`,h=`var(--total-scale-factor) * ${r}px`,c=o?`round(down, ${l}, var(--scale-round-x))`:`calc(${l})`,u=o?`round(down, ${h}, var(--scale-round-y))`:`calc(${h})`;!t||e.rotation%180===0?(a.width=c,a.height=u):(a.width=u,a.height=c)}s&&d.setAttribute("data-main-rotation",e.rotation)}class Ti{constructor(){const{pixelRatio:e}=Ti;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,s,i,r=-1){let a=1/0,o=1/0,l=1/0;s=Ti.capPixels(s,r),s>0&&(a=Math.sqrt(s/(e*t))),i!==-1&&(o=i/e,l=i/t);const h=Math.min(a,o,l);return this.sx>h||this.sy>h?(this.sx=h,this.sy=h,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const s=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,s):s}return e}}const Lu=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class Pv{static get isDarkMode(){var e;return lt(this,"isDarkMode",!!((e=window==null?void 0:window.matchMedia)!=null&&e.call(window,"(prefers-color-scheme: dark)").matches))}}class Iv{static get commentForegroundColor(){const e=document.createElement("span");e.classList.add("comment","sidebar");const{style:t}=e;t.width=t.height="0",t.display="none",t.color="var(--comment-fg-color)",document.body.append(e);const{color:s}=window.getComputedStyle(e);return e.remove(),lt(this,"commentForegroundColor",jc(s))}}function Dv(d,e,t,s){s=Math.min(Math.max(s??1,0),1);const i=255*(1-s);return d=Math.round(d*s+i),e=Math.round(e*s+i),t=Math.round(t*s+i),[d,e,t]}function Rp(d,e){const t=d[0]/255,s=d[1]/255,i=d[2]/255,r=Math.max(t,s,i),a=Math.min(t,s,i),o=(r+a)/2;if(r===a)e[0]=e[1]=0;else{const l=r-a;switch(e[1]=o<.5?l/(r+a):l/(2-r-a),r){case t:e[0]=((s-i)/l+(s<i?6:0))*60;break;case s:e[0]=((i-t)/l+2)*60;break;case i:e[0]=((t-s)/l+4)*60;break}}e[2]=o}function Fu(d,e){const t=d[0],s=d[1],i=d[2],r=(1-Math.abs(2*i-1))*s,a=r*(1-Math.abs(t/60%2-1)),o=i-r/2;switch(Math.floor(t/60)){case 0:e[0]=r+o,e[1]=a+o,e[2]=o;break;case 1:e[0]=a+o,e[1]=r+o,e[2]=o;break;case 2:e[0]=o,e[1]=r+o,e[2]=a+o;break;case 3:e[0]=o,e[1]=a+o,e[2]=r+o;break;case 4:e[0]=a+o,e[1]=o,e[2]=r+o;break;case 5:case 6:e[0]=r+o,e[1]=o,e[2]=a+o;break}}function Pp(d){return d<=.03928?d/12.92:((d+.055)/1.055)**2.4}function Ip(d,e,t){Fu(d,t),t.map(Pp);const s=.2126*t[0]+.7152*t[1]+.0722*t[2];Fu(e,t),t.map(Pp);const i=.2126*t[0]+.7152*t[1]+.0722*t[2];return s>i?(s+.05)/(i+.05):(i+.05)/(s+.05)}const Dp=new Map;function Mv(d,e){const t=d[0]+d[1]*256+d[2]*65536+e[0]*16777216+e[1]*4294967296+e[2]*1099511627776;let s=Dp.get(t);if(s)return s;const i=new Float32Array(9),r=i.subarray(0,3),a=i.subarray(3,6);Rp(d,a);const o=i.subarray(6,9);Rp(e,o);const l=o[2]<.5,h=l?12:4.5;if(a[2]=l?Math.sqrt(a[2]):1-Math.sqrt(1-a[2]),Ip(a,o,r)<h){let c,u;l?(c=a[2],u=1):(c=0,u=a[2]);const f=.005;for(;u-c>f;){const p=a[2]=(c+u)/2;l===Ip(a,o,r)<h?c=p:u=p}a[2]=l?u:c}return Fu(a,r),s=G.makeHexColor(Math.round(r[0]*255),Math.round(r[1]*255),Math.round(r[2]*255)),Dp.set(t,s),s}function rg({html:d,dir:e,className:t},s){const i=document.createDocumentFragment();if(typeof d=="string"){const r=document.createElement("p");r.dir=e||"auto";const a=d.split(/(?:\r\n?|\n)/);for(let o=0,l=a.length;o<l;++o){const h=a[o];r.append(document.createTextNode(h)),o<l-1&&r.append(document.createElement("br"))}i.append(r)}else ng.render({xfaHtml:d,div:i,intent:"richText"});i.firstChild.classList.add("richText",t),s.append(i)}nt(4972);nt(4628);nt(7642);nt(8004);nt(3853);nt(5876);nt(2475);nt(5024);nt(1698);nt(9314);nt(1148);nt(3579);nt(8335);var An,wn,Es,Ss,ah,En,io,no,oh,Kd,ag,Ee,og,lg,Ga,Fl;const Di=class Di{constructor(e){y(this,Ee);y(this,An,null);y(this,wn,null);y(this,Es);y(this,Ss,null);y(this,ah,null);y(this,En,null);y(this,io,null);y(this,no,null);g(this,Es,e),n(Di,oh)||g(Di,oh,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const e=g(this,An,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=n(this,Es)._uiManager._signal;t instanceof AbortSignal&&!t.aborted&&(e.addEventListener("contextmenu",ks,{signal:t}),e.addEventListener("pointerdown",A(Di,Kd,ag),{signal:t}));const s=g(this,Ss,document.createElement("div"));s.className="buttons",e.append(s);const i=n(this,Es).toolbarPosition;if(i){const{style:r}=e,a=n(this,Es)._uiManager.direction==="ltr"?1-i[0]:i[0];r.insetInlineEnd=`${100*a}%`,r.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return n(this,An)}hide(){var e;n(this,An).classList.add("hidden"),(e=n(this,wn))==null||e.hideDropdown()}show(){var e,t;n(this,An).classList.remove("hidden"),(e=n(this,ah))==null||e.shown(),(t=n(this,En))==null||t.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=n(this,Es),s=document.createElement("button");s.classList.add("basic","deleteButton"),s.tabIndex=0,s.setAttribute("data-l10n-id",n(Di,oh)[e]),A(this,Ee,Ga).call(this,s)&&s.addEventListener("click",i=>{t.delete()},{signal:t._signal}),n(this,Ss).append(s)}async addAltText(e){const t=await e.render();A(this,Ee,Ga).call(this,t),n(this,Ss).append(t,n(this,Ee,Fl)),g(this,ah,e)}addComment(e,t=null){if(n(this,En))return;const s=e.renderForToolbar();if(!s)return;A(this,Ee,Ga).call(this,s);const i=g(this,io,n(this,Ee,Fl));t?(n(this,Ss).insertBefore(s,t),n(this,Ss).insertBefore(i,t)):n(this,Ss).append(s,i),g(this,En,e),e.toolbar=this}addColorPicker(e){if(n(this,wn))return;g(this,wn,e);const t=e.renderButton();A(this,Ee,Ga).call(this,t),n(this,Ss).append(t,n(this,Ee,Fl))}async addEditSignatureButton(e){const t=g(this,no,await e.renderEditButton(n(this,Es)));A(this,Ee,Ga).call(this,t),n(this,Ss).append(t,n(this,Ee,Fl))}removeButton(e){var t,s;switch(e){case"comment":(t=n(this,En))==null||t.removeToolbarCommentButton(),g(this,En,null),(s=n(this,io))==null||s.remove(),g(this,io,null);break}}async addButton(e,t){switch(e){case"colorPicker":this.addColorPicker(t);break;case"altText":await this.addAltText(t);break;case"editSignature":await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break;case"comment":this.addComment(t);break}}async addButtonBefore(e,t,s){const i=n(this,Ss).querySelector(s);i&&e==="comment"&&this.addComment(t,i)}updateEditSignatureButton(e){n(this,no)&&(n(this,no).title=e)}remove(){var e;n(this,An).remove(),(e=n(this,wn))==null||e.destroy(),g(this,wn,null)}};An=new WeakMap,wn=new WeakMap,Es=new WeakMap,Ss=new WeakMap,ah=new WeakMap,En=new WeakMap,io=new WeakMap,no=new WeakMap,oh=new WeakMap,Kd=new WeakSet,ag=function(e){e.stopPropagation()},Ee=new WeakSet,og=function(e){n(this,Es)._focusEventsAllowed=!1,Wt(e)},lg=function(e){n(this,Es)._focusEventsAllowed=!0,Wt(e)},Ga=function(e){const t=n(this,Es)._uiManager._signal;return!(t instanceof AbortSignal)||t.aborted?!1:(e.addEventListener("focusin",A(this,Ee,og).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",A(this,Ee,lg).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",ks,{signal:t}),!0)},Fl=function(){const e=document.createElement("div");return e.className="divider",e},y(Di,Kd),y(Di,oh,null);let ku=Di;var lh,xr,Oi,mn,hg,cg,Nu;class Ov{constructor(e){y(this,mn);y(this,lh,null);y(this,xr,null);y(this,Oi);g(this,Oi,e)}show(e,t,s){const[i,r]=A(this,mn,cg).call(this,t,s),{style:a}=n(this,xr)||g(this,xr,A(this,mn,hg).call(this));e.append(n(this,xr)),a.insetInlineEnd=`${100*i}%`,a.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){n(this,xr).remove()}}lh=new WeakMap,xr=new WeakMap,Oi=new WeakMap,mn=new WeakSet,hg=function(){const e=g(this,xr,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar");const t=n(this,Oi)._signal;t instanceof AbortSignal&&!t.aborted&&e.addEventListener("contextmenu",ks,{signal:t});const s=g(this,lh,document.createElement("div"));return s.className="buttons",e.append(s),n(this,Oi).hasCommentManager()&&A(this,mn,Nu).call(this,"commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{n(this,Oi).commentSelection("floating_button")}),A(this,mn,Nu).call(this,"highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{n(this,Oi).highlightSelection("floating_button")}),e},cg=function(e,t){let s=0,i=0;for(const r of e){const a=r.y+r.height;if(a<s)continue;const o=r.x+(t?r.width:0);if(a>s){i=o,s=a;continue}t?o>i&&(i=o):o<i&&(i=o)}return[t?1-i:i,s]},Nu=function(e,t,s,i){const r=document.createElement("button");r.classList.add("basic",e),r.tabIndex=0,r.setAttribute("data-l10n-id",t);const a=document.createElement("span");r.append(a),a.className="visuallyHidden",a.setAttribute("data-l10n-id",s);const o=n(this,Oi)._signal;o instanceof AbortSignal&&!o.aborted&&(r.addEventListener("contextmenu",ks,{signal:o}),r.addEventListener("click",i,{signal:o})),n(this,lh).append(r)};function dg(d,e,t){for(const s of t)e.addEventListener(s,d[s].bind(d))}var Jd;class Lv{constructor(){y(this,Jd,0)}get id(){return`${th}${te(this,Jd)._++}`}}Jd=new WeakMap;var ro,hh,Te,ao,rd;const mp=class mp{constructor(){y(this,ao);y(this,ro,sg());y(this,hh,0);y(this,Te,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=e;const r=i.decode().then(()=>(s.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return lt(this,"_isSVGFittingCanvas",r)}async getFromFile(e){const{lastModified:t,name:s,size:i,type:r}=e;return A(this,ao,rd).call(this,`${t}_${s}_${i}_${r}`,e)}async getFromUrl(e){return A(this,ao,rd).call(this,e,e)}async getFromBlob(e,t){const s=await t;return A(this,ao,rd).call(this,e,s)}async getFromId(e){n(this,Te)||g(this,Te,new Map);const t=n(this,Te).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:s}=t;return delete t.blobPromise,this.getFromBlob(t.id,s)}return this.getFromUrl(t.url)}getFromCanvas(e,t){n(this,Te)||g(this,Te,new Map);let s=n(this,Te).get(e);if(s!=null&&s.bitmap)return s.refCounter+=1,s;const i=new OffscreenCanvas(t.width,t.height);return i.getContext("2d").drawImage(t,0,0),s={bitmap:i.transferToImageBitmap(),id:`image_${n(this,ro)}_${te(this,hh)._++}`,refCounter:1,isSvg:!1},n(this,Te).set(e,s),n(this,Te).set(s.id,s),s}getSvgUrl(e){const t=n(this,Te).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var i;n(this,Te)||g(this,Te,new Map);const t=n(this,Te).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:s}=t;if(!t.url&&!t.file){const r=new OffscreenCanvas(s.width,s.height);r.getContext("bitmaprenderer").transferFromImageBitmap(s),t.blobPromise=r.convertToBlob()}(i=s.close)==null||i.call(s),t.bitmap=null}isValidId(e){return e.startsWith(`image_${n(this,ro)}_`)}};ro=new WeakMap,hh=new WeakMap,Te=new WeakMap,ao=new WeakSet,rd=async function(e,t){n(this,Te)||g(this,Te,new Map);let s=n(this,Te).get(e);if(s===null)return null;if(s!=null&&s.bitmap)return s.refCounter+=1,s;try{s||(s={bitmap:null,id:`image_${n(this,ro)}_${te(this,hh)._++}`,refCounter:0,isSvg:!1});let i;if(typeof t=="string"?(s.url=t,i=await Hc(t,"blob")):t instanceof File?i=s.file=t:t instanceof Blob&&(i=t),i.type==="image/svg+xml"){const r=mp._isSVGFittingCanvas,a=new FileReader,o=new Image,l=new Promise((h,c)=>{o.onload=()=>{s.bitmap=o,s.isSvg=!0,h()},a.onload=async()=>{const u=s.svgUrl=a.result;o.src=await r?`${u}#svgView(preserveAspectRatio(none))`:u},o.onerror=a.onerror=c});a.readAsDataURL(i),await l}else s.bitmap=await createImageBitmap(i);s.refCounter=1}catch(i){Q(i),s=null}return n(this,Te).set(e,s),s&&n(this,Te).set(s.id,s),s};let Bu=mp;var Xt,Sn,ch,_t;class Fv{constructor(e=128){y(this,Xt,[]);y(this,Sn,!1);y(this,ch);y(this,_t,-1);g(this,ch,e)}add({cmd:e,undo:t,post:s,mustExec:i,type:r=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}){if(i&&e(),n(this,Sn))return;const l={cmd:e,undo:t,post:s,type:r};if(n(this,_t)===-1){n(this,Xt).length>0&&(n(this,Xt).length=0),g(this,_t,0),n(this,Xt).push(l);return}if(a&&n(this,Xt)[n(this,_t)].type===r){o&&(l.undo=n(this,Xt)[n(this,_t)].undo),n(this,Xt)[n(this,_t)]=l;return}const h=n(this,_t)+1;h===n(this,ch)?n(this,Xt).splice(0,1):(g(this,_t,h),h<n(this,Xt).length&&n(this,Xt).splice(h)),n(this,Xt).push(l)}undo(){if(n(this,_t)===-1)return;g(this,Sn,!0);const{undo:e,post:t}=n(this,Xt)[n(this,_t)];e(),t==null||t(),g(this,Sn,!1),g(this,_t,n(this,_t)-1)}redo(){if(n(this,_t)<n(this,Xt).length-1){g(this,_t,n(this,_t)+1),g(this,Sn,!0);const{cmd:e,post:t}=n(this,Xt)[n(this,_t)];e(),t==null||t(),g(this,Sn,!1)}}hasSomethingToUndo(){return n(this,_t)!==-1}hasSomethingToRedo(){return n(this,_t)<n(this,Xt).length-1}cleanType(e){if(n(this,_t)!==-1){for(let t=n(this,_t);t>=0;t--)if(n(this,Xt)[t].type!==e){n(this,Xt).splice(t+1,n(this,_t)-t),g(this,_t,t);return}n(this,Xt).length=0,g(this,_t,-1)}}destroy(){g(this,Xt,null)}}Xt=new WeakMap,Sn=new WeakMap,ch=new WeakMap,_t=new WeakMap;var Qd,ug;class zc{constructor(e){y(this,Qd);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Se.platform;for(const[s,i,r={}]of e)for(const a of s){const o=a.startsWith("mac+");t&&o?(this.callbacks.set(a.slice(4),{callback:i,options:r}),this.allKeys.add(a.split("+").at(-1))):!t&&!o&&(this.callbacks.set(a,{callback:i,options:r}),this.allKeys.add(a.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const s=this.callbacks.get(A(this,Qd,ug).call(this,t));if(!s)return;const{callback:i,options:{bubbles:r=!1,args:a=[],checker:o=null}}=s;o&&!o(e,t)||(i.bind(e,...a,t)(),r||Wt(t))}}Qd=new WeakSet,ug=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const Zd=class Zd{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return Rv(e),lt(this,"_colors",e)}convert(e){const t=jc(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[s,i]of this._colors)if(i.every((r,a)=>r===t[a]))return Zd._colorsMapping.get(s);return t}getHexCode(e){const t=this._colors.get(e);return t?G.makeHexColor(...t):e}};k(Zd,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let _u=Zd;var oo,Ze,lo,jt,ie,ho,xs,co,Ts,Ce,xn,Tn,uo,Cn,ei,Cs,Tr,dh,uh,fo,fh,si,Rn,po,Pn,ii,qd,In,go,ph,Dn,Cr,mo,Mn,gh,Zt,bt,Li,On,Ln,mh,vo,vh,Fn,ni,Fi,yh,bh,Rs,U,ad,Uu,fg,pg,kl,gg,mg,vg,Hu,yg,$u,ju,bg,Oe,Pi,Ag,wg,zu,Eg,Nl,Gu;const Za=class Za{constructor(e,t,s,i,r,a,o,l,h,c,u,f,p,v,m,w){y(this,U);y(this,oo,new AbortController);y(this,Ze,null);y(this,lo,null);y(this,jt,new Map);y(this,ie,new Map);y(this,ho,null);y(this,xs,null);y(this,co,null);y(this,Ts,new Fv);y(this,Ce,null);y(this,xn,null);y(this,Tn,null);y(this,uo,0);y(this,Cn,new Set);y(this,ei,null);y(this,Cs,null);y(this,Tr,new Set);k(this,"_editorUndoBar",null);y(this,dh,!1);y(this,uh,!1);y(this,fo,!1);y(this,fh,null);y(this,si,null);y(this,Rn,null);y(this,po,null);y(this,Pn,!1);y(this,ii,null);y(this,qd,new Lv);y(this,In,!1);y(this,go,!1);y(this,ph,!1);y(this,Dn,null);y(this,Cr,null);y(this,mo,null);y(this,Mn,null);y(this,gh,null);y(this,Zt,st.NONE);y(this,bt,new Set);y(this,Li,null);y(this,On,null);y(this,Ln,null);y(this,mh,null);y(this,vo,null);y(this,vh,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});y(this,Fn,[0,0]);y(this,ni,null);y(this,Fi,null);y(this,yh,null);y(this,bh,null);y(this,Rs,null);const b=this._signal=n(this,oo).signal;g(this,Fi,e),g(this,yh,t),g(this,bh,s),g(this,ho,i),g(this,Ce,r),g(this,On,a),g(this,vo,l),this._eventBus=o,o._on("editingaction",this.onEditingAction.bind(this),{signal:b}),o._on("pagechanging",this.onPageChanging.bind(this),{signal:b}),o._on("scalechanging",this.onScaleChanging.bind(this),{signal:b}),o._on("rotationchanging",this.onRotationChanging.bind(this),{signal:b}),o._on("setpreference",this.onSetPreference.bind(this),{signal:b}),o._on("switchannotationeditorparams",S=>this.updateParams(S.type,S.value),{signal:b}),window.addEventListener("pointerdown",()=>{g(this,go,!0)},{capture:!0,signal:b}),window.addEventListener("pointerup",()=>{g(this,go,!1)},{capture:!0,signal:b}),A(this,U,gg).call(this),A(this,U,bg).call(this),A(this,U,Hu).call(this),g(this,xs,l.annotationStorage),g(this,fh,l.filterFactory),g(this,Ln,h),g(this,po,c||null),g(this,dh,u),g(this,uh,f),g(this,fo,p),g(this,gh,v||null),this.viewParameters={realScale:gr.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=m||null,this._supportsPinchToZoom=w!==!1,r==null||r.setSidebarUiManager(this)}static get _keyboardManager(){const e=Za.prototype,t=a=>n(a,Fi).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),s=(a,{target:o})=>{if(o instanceof HTMLInputElement){const{type:l}=o;return l!=="text"&&l!=="number"}return!0},i=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return lt(this,"_keyboardManager",new zc([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],e.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:s}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&n(a,Fi).contains(o)&&!a.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&n(a,Fi).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}]]))}destroy(){var e,t,s,i,r,a,o,l,h;(e=n(this,Rs))==null||e.resolve(),g(this,Rs,null),(t=n(this,oo))==null||t.abort(),g(this,oo,null),this._signal=null;for(const c of n(this,ie).values())c.destroy();n(this,ie).clear(),n(this,jt).clear(),n(this,Tr).clear(),(s=n(this,Mn))==null||s.clear(),g(this,Ze,null),n(this,bt).clear(),n(this,Ts).destroy(),(i=n(this,ho))==null||i.destroy(),(r=n(this,Ce))==null||r.destroy(),(a=n(this,On))==null||a.destroy(),(o=n(this,ii))==null||o.hide(),g(this,ii,null),(l=n(this,mo))==null||l.destroy(),g(this,mo,null),g(this,lo,null),n(this,si)&&(clearTimeout(n(this,si)),g(this,si,null)),n(this,ni)&&(clearTimeout(n(this,ni)),g(this,ni,null)),(h=this._editorUndoBar)==null||h.destroy(),g(this,vo,null)}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return n(this,gh)}get useNewAltTextFlow(){return n(this,uh)}get useNewAltTextWhenAddingImage(){return n(this,fo)}get hcmFilter(){return lt(this,"hcmFilter",n(this,Ln)?n(this,fh).addHCMFilter(n(this,Ln).foreground,n(this,Ln).background):"none")}get direction(){return lt(this,"direction",getComputedStyle(n(this,Fi)).direction)}get _highlightColors(){return lt(this,"_highlightColors",n(this,po)?new Map(n(this,po).split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return lt(this,"highlightColors",null);const t=new Map,s=!!n(this,Ln);for(const[i,r]of e){const a=i.endsWith("_HCM");if(s&&a){t.set(i.replace("_HCM",""),r);continue}!s&&!a&&t.set(i,r)}return lt(this,"highlightColors",t)}get highlightColorNames(){return lt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),g(this,Tn,e)}setMainHighlightColorPicker(e){g(this,mo,e)}editAltText(e,t=!1){var s;(s=n(this,ho))==null||s.editAltText(this,e,t)}hasCommentManager(){return!!n(this,Ce)}editComment(e,t,s,i){var r;(r=n(this,Ce))==null||r.showDialog(this,e,t,s,i)}selectComment(e,t){const s=n(this,ie).get(e),i=s==null?void 0:s.getEditorByUID(t);i==null||i.toggleComment(!0,!0)}updateComment(e){var t;(t=n(this,Ce))==null||t.updateComment(e.getData())}updatePopupColor(e){var t;(t=n(this,Ce))==null||t.updatePopupColor(e)}removeComment(e){var t;(t=n(this,Ce))==null||t.removeComments([e.uid])}toggleComment(e,t,s=void 0){var i;(i=n(this,Ce))==null||i.toggleCommentPopup(e,t,s)}makeCommentColor(e,t){var s;return e&&((s=n(this,Ce))==null?void 0:s.makeCommentColor(e,t))||null}getCommentDialogElement(){var e;return((e=n(this,Ce))==null?void 0:e.dialogElement)||null}async waitForEditorsRendered(e){if(n(this,ie).has(e-1))return;const{resolve:t,promise:s}=Promise.withResolvers(),i=r=>{r.pageNumber===e&&(this._eventBus._off("editorsrendered",i),t())};this._eventBus.on("editorsrendered",i),await s}getSignature(e){var t;(t=n(this,On))==null||t.getSignature({uiManager:this,editor:e})}get signatureManager(){return n(this,On)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":g(this,fo,t);break}}onPageChanging({pageNumber:e}){g(this,uo,e-1)}focusMainContainer(){n(this,Fi).focus()}findParent(e,t){for(const s of n(this,ie).values()){const{x:i,y:r,width:a,height:o}=s.div.getBoundingClientRect();if(e>=i&&e<=i+a&&t>=r&&t<=r+o)return s}return null}disableUserSelect(e=!1){n(this,yh).classList.toggle("noUserSelect",e)}addShouldRescale(e){n(this,Tr).add(e)}removeShouldRescale(e){n(this,Tr).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*gr.PDF_TO_CSS_UNITS;for(const s of n(this,Tr))s.onScaleChanging();(t=n(this,Tn))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e="",t=!1){const s=document.getSelection();if(!s||s.isCollapsed)return;const{anchorNode:i,anchorOffset:r,focusNode:a,focusOffset:o}=s,l=s.toString(),c=A(this,U,ad).call(this,s).closest(".textLayer"),u=this.getSelectionBoxes(c);if(!u)return;s.empty();const f=A(this,U,Uu).call(this,c),p=n(this,Zt)===st.NONE,v=()=>{const m=f==null?void 0:f.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:u,anchorNode:i,anchorOffset:r,focusNode:a,focusOffset:o,text:l});p&&this.showAllEditors("highlight",!0,!0),t&&(m==null||m.editComment())};if(p){this.switchToMode(st.HIGHLIGHT,v);return}v()}commentSelection(e=""){this.highlightSelection(e,!0)}getAndRemoveDataFromAnnotationStorage(e){if(!n(this,xs))return null;const t=`${th}${e}`,s=n(this,xs).getRawValue(t);return s&&n(this,xs).remove(t),s}addToAnnotationStorage(e){!e.isEmpty()&&n(this,xs)&&!n(this,xs).has(e.id)&&n(this,xs).setValue(e.id,e)}a11yAlert(e,t=null){const s=n(this,bh);s&&(s.setAttribute("data-l10n-id",e),t?s.setAttribute("data-l10n-args",JSON.stringify(t)):s.removeAttribute("data-l10n-args"))}blur(){if(this.isShiftKeyDown=!1,n(this,Pn)&&(g(this,Pn,!1),A(this,U,kl).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of n(this,bt))if(t.div.contains(e)){g(this,Cr,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!n(this,Cr))return;const[e,t]=n(this,Cr);g(this,Cr,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){A(this,U,Hu).call(this),A(this,U,$u).call(this)}removeEditListeners(){A(this,U,yg).call(this),A(this,U,ju).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const s of n(this,Cs))if(s.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const s of n(this,Cs))if(s.isHandlingMimeForPasting(t.type)){s.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var s;if(e.preventDefault(),(s=n(this,Ze))==null||s.commitOrRemove(),!this.hasSelection)return;const t=[];for(const i of n(this,bt)){const r=i.serialize(!0);r&&t.push(r)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const r of t.items)for(const a of n(this,Cs))if(a.isHandlingMimeForPasting(r.type)){a.paste(r,this.currentLayer);return}let s=t.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(r){Q(`paste: "${r.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const i=this.currentLayer;try{const r=[];for(const l of s){const h=await i.deserialize(l);if(!h)return;r.push(h)}const a=()=>{for(const l of r)A(this,U,zu).call(this,l);A(this,U,Gu).call(this,r)},o=()=>{for(const l of r)l.remove()};this.addCommands({cmd:a,undo:o,mustExec:!0})}catch(r){Q(`paste: "${r.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),n(this,Zt)!==st.NONE&&!this.isEditorHandlingKeyboard&&Za._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,n(this,Pn)&&(g(this,Pn,!1),A(this,U,kl).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}setEditingState(e){e?(A(this,U,mg).call(this),A(this,U,$u).call(this),A(this,U,Oe).call(this,{isEditing:n(this,Zt)!==st.NONE,isEmpty:A(this,U,Nl).call(this),hasSomethingToUndo:n(this,Ts).hasSomethingToUndo(),hasSomethingToRedo:n(this,Ts).hasSomethingToRedo(),hasSelectedEditor:!1})):(A(this,U,vg).call(this),A(this,U,ju).call(this),A(this,U,Oe).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!n(this,Cs)){g(this,Cs,e);for(const t of n(this,Cs))A(this,U,Pi).call(this,t.defaultPropertiesToUpdate)}}getId(){return n(this,qd).id}get currentLayer(){return n(this,ie).get(n(this,uo))}getLayer(e){return n(this,ie).get(e)}get currentPageIndex(){return n(this,uo)}addLayer(e){n(this,ie).set(e.pageIndex,e),n(this,In)?e.enable():e.disable()}removeLayer(e){n(this,ie).delete(e.pageIndex)}async updateMode(e,t=null,s=!1,i=!1,r=!1){var a,o,l,h,c,u;if(n(this,Zt)!==e&&!(n(this,Rs)&&(await n(this,Rs).promise,!n(this,Rs)))){if(g(this,Rs,Promise.withResolvers()),(a=n(this,Tn))==null||a.commitOrRemove(),n(this,Zt)===st.POPUP&&((o=n(this,Ce))==null||o.hideSidebar()),(l=n(this,Ce))==null||l.destroyPopup(),g(this,Zt,e),e===st.NONE){this.setEditingState(!1),A(this,U,wg).call(this);for(const f of n(this,jt).values())f.hideStandaloneCommentButton();(h=this._editorUndoBar)==null||h.hide(),this.toggleComment(null),n(this,Rs).resolve();return}for(const f of n(this,jt).values())f.addStandaloneCommentButton();e===st.SIGNATURE&&await((c=n(this,On))==null?void 0:c.loadSignatures()),this.setEditingState(!0),await A(this,U,Ag).call(this),this.unselectAll();for(const f of n(this,ie).values())f.updateMode(e);if(e===st.POPUP){n(this,lo)||g(this,lo,await n(this,vo).getAnnotationsByType(new Set(n(this,Cs).map(v=>v._editorType))));const f=new Set,p=[];for(const v of n(this,jt).values()){const{annotationElementId:m,hasComment:w,deleted:b}=v;m&&f.add(m),w&&!b&&p.push(v.getData())}for(const v of n(this,lo)){const{id:m,popupRef:w,contentsObj:b}=v;w&&(b!=null&&b.str)&&!f.has(m)&&!n(this,Cn).has(m)&&p.push(v)}(u=n(this,Ce))==null||u.showSidebar(p)}if(!t){s&&this.addNewEditorFromKeyboard(),n(this,Rs).resolve();return}for(const f of n(this,jt).values())f.uid===t?(this.setSelected(f),r?f.editComment():i?f.enterInEditMode():f.focus()):f.unselect();n(this,Rs).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==n(this,Zt)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){if(n(this,Cs)){switch(e){case ct.CREATE:this.currentLayer.addNewEditor(t);return;case ct.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(n(this,mh)||g(this,mh,new Map)).set(e,t),this.showAllEditors("highlight",t);break}if(this.hasSelection)for(const s of n(this,bt))s.updateParams(e,t);else for(const s of n(this,Cs))s.updateDefaultParams(e,t)}}showAllEditors(e,t,s=!1){var r;for(const a of n(this,jt).values())a.editorType===e&&a.show(t);(((r=n(this,mh))==null?void 0:r.get(ct.HIGHLIGHT_SHOW_ALL))??!0)!==t&&A(this,U,Pi).call(this,[[ct.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(n(this,ph)!==e){g(this,ph,e);for(const t of n(this,ie).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}*getEditors(e){for(const t of n(this,jt).values())t.pageIndex===e&&(yield t)}getEditor(e){return n(this,jt).get(e)}addEditor(e){n(this,jt).set(e.id,e)}removeEditor(e){var t,s;e.div.contains(document.activeElement)&&(n(this,si)&&clearTimeout(n(this,si)),g(this,si,setTimeout(()=>{this.focusMainContainer(),g(this,si,null)},0))),n(this,jt).delete(e.id),e.annotationElementId&&((t=n(this,Mn))==null||t.delete(e.annotationElementId)),this.unselect(e),(!e.annotationElementId||!n(this,Cn).has(e.annotationElementId))&&((s=n(this,xs))==null||s.remove(e.id))}addDeletedAnnotationElement(e){n(this,Cn).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return n(this,Cn).has(e)}removeDeletedAnnotationElement(e){n(this,Cn).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){n(this,Ze)!==e&&(g(this,Ze,e),e&&A(this,U,Pi).call(this,e.propertiesToUpdate))}updateUI(e){n(this,U,Eg)===e&&A(this,U,Pi).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){A(this,U,Pi).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(n(this,bt).has(e)){n(this,bt).delete(e),e.unselect(),A(this,U,Oe).call(this,{hasSelectedEditor:this.hasSelection});return}n(this,bt).add(e),e.select(),A(this,U,Pi).call(this,e.propertiesToUpdate),A(this,U,Oe).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;this.updateToolbar({mode:e.mode,editId:e.id}),(t=n(this,Tn))==null||t.commitOrRemove();for(const s of n(this,bt))s!==e&&s.unselect();n(this,bt).clear(),n(this,bt).add(e),e.select(),A(this,U,Pi).call(this,e.propertiesToUpdate),A(this,U,Oe).call(this,{hasSelectedEditor:!0})}isSelected(e){return n(this,bt).has(e)}get firstSelectedEditor(){return n(this,bt).values().next().value}unselect(e){e.unselect(),n(this,bt).delete(e),A(this,U,Oe).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return n(this,bt).size!==0}get isEnterHandled(){return n(this,bt).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;n(this,Ts).undo(),A(this,U,Oe).call(this,{hasSomethingToUndo:n(this,Ts).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:A(this,U,Nl).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){n(this,Ts).redo(),A(this,U,Oe).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:n(this,Ts).hasSomethingToRedo(),isEmpty:A(this,U,Nl).call(this)})}addCommands(e){n(this,Ts).add(e),A(this,U,Oe).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:A(this,U,Nl).call(this)})}cleanUndoStack(e){n(this,Ts).cleanType(e)}delete(){var r;this.commitOrRemove();const e=(r=this.currentLayer)==null?void 0:r.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...n(this,bt)],s=()=>{var a;(a=this._editorUndoBar)==null||a.show(i,t.length===1?t[0].editorType:t.length);for(const o of t)o.remove()},i=()=>{for(const a of t)A(this,U,zu).call(this,a)};this.addCommands({cmd:s,undo:i,mustExec:!0})}commitOrRemove(){var e;(e=n(this,Ze))==null||e.commitOrRemove()}hasSomethingToControl(){return n(this,Ze)||this.hasSelection}selectAll(){for(const e of n(this,bt))e.commit();A(this,U,Gu).call(this,n(this,jt).values())}unselectAll(){var e;if(!(n(this,Ze)&&(n(this,Ze).commitOrRemove(),n(this,Zt)!==st.NONE))&&!((e=n(this,Tn))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of n(this,bt))t.unselect();n(this,bt).clear(),A(this,U,Oe).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;n(this,Fn)[0]+=e,n(this,Fn)[1]+=t;const[i,r]=n(this,Fn),a=[...n(this,bt)],o=1e3;n(this,ni)&&clearTimeout(n(this,ni)),g(this,ni,setTimeout(()=>{g(this,ni,null),n(this,Fn)[0]=n(this,Fn)[1]=0,this.addCommands({cmd:()=>{for(const l of a)n(this,jt).has(l.id)&&(l.translateInPage(i,r),l.translationDone())},undo:()=>{for(const l of a)n(this,jt).has(l.id)&&(l.translateInPage(-i,-r),l.translationDone())},mustExec:!1})},o));for(const l of a)l.translateInPage(e,t),l.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),g(this,ei,new Map);for(const e of n(this,bt))n(this,ei).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!n(this,ei))return!1;this.disableUserSelect(!1);const e=n(this,ei);g(this,ei,null);let t=!1;for(const[{x:i,y:r,pageIndex:a},o]of e)o.newX=i,o.newY=r,o.newPageIndex=a,t||(t=i!==o.savedX||r!==o.savedY||a!==o.savedPageIndex);if(!t)return!1;const s=(i,r,a,o)=>{if(n(this,jt).has(i.id)){const l=n(this,ie).get(o);l?i._setParentAndPosition(l,r,a):(i.pageIndex=o,i.x=r,i.y=a)}};return this.addCommands({cmd:()=>{for(const[i,{newX:r,newY:a,newPageIndex:o}]of e)s(i,r,a,o)},undo:()=>{for(const[i,{savedX:r,savedY:a,savedPageIndex:o}]of e)s(i,r,a,o)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(n(this,ei))for(const s of n(this,ei).keys())s.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||n(this,bt).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return n(this,Ze)===e}getActive(){return n(this,Ze)}getMode(){return n(this,Zt)}isEditingMode(){return n(this,Zt)!==st.NONE}get imageManager(){return lt(this,"imageManager",new Bu)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let h=0,c=t.rangeCount;h<c;h++)if(!e.contains(t.getRangeAt(h).commonAncestorContainer))return null;const{x:s,y:i,width:r,height:a}=e.getBoundingClientRect();let o;switch(e.getAttribute("data-main-rotation")){case"90":o=(h,c,u,f)=>({x:(c-i)/a,y:1-(h+u-s)/r,width:f/a,height:u/r});break;case"180":o=(h,c,u,f)=>({x:1-(h+u-s)/r,y:1-(c+f-i)/a,width:u/r,height:f/a});break;case"270":o=(h,c,u,f)=>({x:1-(c+f-i)/a,y:(h-s)/r,width:f/a,height:u/r});break;default:o=(h,c,u,f)=>({x:(h-s)/r,y:(c-i)/a,width:u/r,height:f/a});break}const l=[];for(let h=0,c=t.rangeCount;h<c;h++){const u=t.getRangeAt(h);if(!u.collapsed)for(const{x:f,y:p,width:v,height:m}of u.getClientRects())v===0||m===0||l.push(o(f,p,v,m))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:e,id:t}){(n(this,co)||g(this,co,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=n(this,co))==null||t.delete(e)}renderAnnotationElement(e){var i;const t=(i=n(this,co))==null?void 0:i.get(e.data.id);if(!t)return;const s=n(this,xs).getRawValue(t);s&&(n(this,Zt)===st.NONE&&!s.hasBeenModified||s.renderAnnotationElement(e))}setMissingCanvas(e,t,s){var r;const i=(r=n(this,Mn))==null?void 0:r.get(e);i&&(i.setCanvas(t,s),n(this,Mn).delete(e))}addMissingCanvas(e,t){(n(this,Mn)||g(this,Mn,new Map)).set(e,t)}};oo=new WeakMap,Ze=new WeakMap,lo=new WeakMap,jt=new WeakMap,ie=new WeakMap,ho=new WeakMap,xs=new WeakMap,co=new WeakMap,Ts=new WeakMap,Ce=new WeakMap,xn=new WeakMap,Tn=new WeakMap,uo=new WeakMap,Cn=new WeakMap,ei=new WeakMap,Cs=new WeakMap,Tr=new WeakMap,dh=new WeakMap,uh=new WeakMap,fo=new WeakMap,fh=new WeakMap,si=new WeakMap,Rn=new WeakMap,po=new WeakMap,Pn=new WeakMap,ii=new WeakMap,qd=new WeakMap,In=new WeakMap,go=new WeakMap,ph=new WeakMap,Dn=new WeakMap,Cr=new WeakMap,mo=new WeakMap,Mn=new WeakMap,gh=new WeakMap,Zt=new WeakMap,bt=new WeakMap,Li=new WeakMap,On=new WeakMap,Ln=new WeakMap,mh=new WeakMap,vo=new WeakMap,vh=new WeakMap,Fn=new WeakMap,ni=new WeakMap,Fi=new WeakMap,yh=new WeakMap,bh=new WeakMap,Rs=new WeakMap,U=new WeakSet,ad=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},Uu=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const s of n(this,ie).values())if(s.hasTextLayer(e))return s;return null},fg=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const s=A(this,U,ad).call(this,e).closest(".textLayer"),i=this.getSelectionBoxes(s);i&&(n(this,ii)||g(this,ii,new Ov(this)),n(this,ii).show(s,i,this.direction==="ltr"))},pg=function(){var r,a,o;const e=document.getSelection();if(!e||e.isCollapsed){n(this,Li)&&((r=n(this,ii))==null||r.hide(),g(this,Li,null),A(this,U,Oe).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===n(this,Li))return;const i=A(this,U,ad).call(this,e).closest(".textLayer");if(!i){n(this,Li)&&((a=n(this,ii))==null||a.hide(),g(this,Li,null),A(this,U,Oe).call(this,{hasSelectedText:!1}));return}if((o=n(this,ii))==null||o.hide(),g(this,Li,t),A(this,U,Oe).call(this,{hasSelectedText:!0}),!(n(this,Zt)!==st.HIGHLIGHT&&n(this,Zt)!==st.NONE)&&(n(this,Zt)===st.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),g(this,Pn,this.isShiftKeyDown),!this.isShiftKeyDown)){const l=n(this,Zt)===st.HIGHLIGHT?A(this,U,Uu).call(this,i):null;if(l==null||l.toggleDrawing(),n(this,go)){const h=new AbortController,c=this.combinedSignal(h),u=f=>{f.type==="pointerup"&&f.button!==0||(h.abort(),l==null||l.toggleDrawing(!0),f.type==="pointerup"&&A(this,U,kl).call(this,"main_toolbar"))};window.addEventListener("pointerup",u,{signal:c}),window.addEventListener("blur",u,{signal:c})}else l==null||l.toggleDrawing(!0),A(this,U,kl).call(this,"main_toolbar")}},kl=function(e=""){n(this,Zt)===st.HIGHLIGHT?this.highlightSelection(e):n(this,dh)&&A(this,U,fg).call(this)},gg=function(){document.addEventListener("selectionchange",A(this,U,pg).bind(this),{signal:this._signal})},mg=function(){if(n(this,Rn))return;g(this,Rn,new AbortController);const e=this.combinedSignal(n(this,Rn));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},vg=function(){var e;(e=n(this,Rn))==null||e.abort(),g(this,Rn,null)},Hu=function(){if(n(this,Dn))return;g(this,Dn,new AbortController);const e=this.combinedSignal(n(this,Dn));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},yg=function(){var e;(e=n(this,Dn))==null||e.abort(),g(this,Dn,null)},$u=function(){if(n(this,xn))return;g(this,xn,new AbortController);const e=this.combinedSignal(n(this,xn));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},ju=function(){var e;(e=n(this,xn))==null||e.abort(),g(this,xn,null)},bg=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},Oe=function(e){Object.entries(e).some(([s,i])=>n(this,vh)[s]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(n(this,vh),e)}),n(this,Zt)===st.HIGHLIGHT&&e.hasSelectedEditor===!1&&A(this,U,Pi).call(this,[[ct.HIGHLIGHT_FREE,!0]]))},Pi=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},Ag=async function(){if(!n(this,In)){g(this,In,!0);const e=[];for(const t of n(this,ie).values())e.push(t.enable());await Promise.all(e);for(const t of n(this,jt).values())t.enable()}},wg=function(){if(this.unselectAll(),n(this,In)){g(this,In,!1);for(const e of n(this,ie).values())e.disable();for(const e of n(this,jt).values())e.disable()}},zu=function(e){const t=n(this,ie).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},Eg=function(){let e=null;for(e of n(this,bt));return e},Nl=function(){if(n(this,jt).size===0)return!0;if(n(this,jt).size===1)for(const e of n(this,jt).values())return e.isEmpty();return!1},Gu=function(e){for(const t of n(this,bt))t.unselect();n(this,bt).clear();for(const t of e)t.isEmpty()||(n(this,bt).add(t),t.select());A(this,U,Oe).call(this,{hasSelectedEditor:this.hasSelection})},k(Za,"TRANSLATE_SMALL",1),k(Za,"TRANSLATE_BIG",10);let Ba=Za;var oe,ri,_s,yo,ai,qe,bo,oi,ze,ki,Rr,li,kn,Js,Bl,od;const Le=class Le{constructor(e){y(this,Js);y(this,oe,null);y(this,ri,!1);y(this,_s,null);y(this,yo,null);y(this,ai,null);y(this,qe,null);y(this,bo,!1);y(this,oi,null);y(this,ze,null);y(this,ki,null);y(this,Rr,null);y(this,li,!1);g(this,ze,e),g(this,li,e._uiManager.useNewAltTextFlow),n(Le,kn)||g(Le,kn,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){Le._l10n??(Le._l10n=e)}async render(){const e=g(this,_s,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=g(this,yo,document.createElement("span"));e.append(t),n(this,li)?(e.classList.add("new"),e.setAttribute("data-l10n-id",n(Le,kn).missing),t.setAttribute("data-l10n-id",n(Le,kn)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=n(this,ze)._uiManager._signal;e.addEventListener("contextmenu",ks,{signal:s}),e.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:s});const i=r=>{r.preventDefault(),n(this,ze)._uiManager.editAltText(n(this,ze)),n(this,li)&&n(this,ze)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:n(this,Js,Bl)}})};return e.addEventListener("click",i,{capture:!0,signal:s}),e.addEventListener("keydown",r=>{r.target===e&&r.key==="Enter"&&(g(this,bo,!0),i(r))},{signal:s}),await A(this,Js,od).call(this),e}finish(){n(this,_s)&&(n(this,_s).focus({focusVisible:n(this,bo)}),g(this,bo,!1))}isEmpty(){return n(this,li)?n(this,oe)===null:!n(this,oe)&&!n(this,ri)}hasData(){return n(this,li)?n(this,oe)!==null||!!n(this,ki):this.isEmpty()}get guessedText(){return n(this,ki)}async setGuessedText(e){n(this,oe)===null&&(g(this,ki,e),g(this,Rr,await Le._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),A(this,Js,od).call(this))}toggleAltTextBadge(e=!1){var t;if(!n(this,li)||n(this,oe)){(t=n(this,oi))==null||t.remove(),g(this,oi,null);return}if(!n(this,oi)){const s=g(this,oi,document.createElement("div"));s.className="noAltTextBadge",n(this,ze).div.append(s)}n(this,oi).classList.toggle("hidden",!e)}serialize(e){let t=n(this,oe);return!e&&n(this,ki)===t&&(t=n(this,Rr)),{altText:t,decorative:n(this,ri),guessedText:n(this,ki),textWithDisclaimer:n(this,Rr)}}get data(){return{altText:n(this,oe),decorative:n(this,ri)}}set data({altText:e,decorative:t,guessedText:s,textWithDisclaimer:i,cancel:r=!1}){s&&(g(this,ki,s),g(this,Rr,i)),!(n(this,oe)===e&&n(this,ri)===t)&&(r||(g(this,oe,e),g(this,ri,t)),A(this,Js,od).call(this))}toggle(e=!1){n(this,_s)&&(!e&&n(this,qe)&&(clearTimeout(n(this,qe)),g(this,qe,null)),n(this,_s).disabled=!e)}shown(){n(this,ze)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:n(this,Js,Bl)}})}destroy(){var e,t;(e=n(this,_s))==null||e.remove(),g(this,_s,null),g(this,yo,null),g(this,ai,null),(t=n(this,oi))==null||t.remove(),g(this,oi,null)}};oe=new WeakMap,ri=new WeakMap,_s=new WeakMap,yo=new WeakMap,ai=new WeakMap,qe=new WeakMap,bo=new WeakMap,oi=new WeakMap,ze=new WeakMap,ki=new WeakMap,Rr=new WeakMap,li=new WeakMap,kn=new WeakMap,Js=new WeakSet,Bl=function(){return n(this,oe)&&"added"||n(this,oe)===null&&this.guessedText&&"review"||"missing"},od=async function(){var i,r,a;const e=n(this,_s);if(!e)return;if(n(this,li)){if(e.classList.toggle("done",!!n(this,oe)),e.setAttribute("data-l10n-id",n(Le,kn)[n(this,Js,Bl)]),(i=n(this,yo))==null||i.setAttribute("data-l10n-id",n(Le,kn)[`${n(this,Js,Bl)}-label`]),!n(this,oe)){(r=n(this,ai))==null||r.remove();return}}else{if(!n(this,oe)&&!n(this,ri)){e.classList.remove("done"),(a=n(this,ai))==null||a.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=n(this,ai);if(!t){g(this,ai,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${n(this,ze).id}`;const o=100,l=n(this,ze)._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(n(this,qe)),g(this,qe,null)},{once:!0}),e.addEventListener("mouseenter",()=>{g(this,qe,setTimeout(()=>{g(this,qe,null),n(this,ai).classList.add("show"),n(this,ze)._reportTelemetry({action:"alt_text_tooltip"})},o))},{signal:l}),e.addEventListener("mouseleave",()=>{var h;n(this,qe)&&(clearTimeout(n(this,qe)),g(this,qe,null)),(h=n(this,ai))==null||h.classList.remove("show")},{signal:l})}n(this,ri)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=n(this,oe)),t.parentNode||e.append(t);const s=n(this,ze).getElementForAltText();s==null||s.setAttribute("aria-describedby",t.id)},y(Le,kn,null),k(Le,"_l10n",null);let _d=Le;var ge,Ps,Pr,Mt,Ah,Ir,Us,Dr,Mr,Or,wh,Vu;class Yc{constructor(e){y(this,wh);y(this,ge,null);y(this,Ps,null);y(this,Pr,!1);y(this,Mt,null);y(this,Ah,null);y(this,Ir,null);y(this,Us,null);y(this,Dr,null);y(this,Mr,!1);y(this,Or,null);g(this,Mt,e)}renderForToolbar(){const e=g(this,Ps,document.createElement("button"));return e.className="comment",A(this,wh,Vu).call(this,e,!1)}renderForStandalone(){const e=g(this,ge,document.createElement("button"));e.className="annotationCommentButton";const t=n(this,Mt).commentButtonPosition;if(t){const{style:s}=e;s.insetInlineEnd=`calc(${100*(n(this,Mt)._uiManager.direction==="ltr"?1-t[0]:t[0])}% - var(--comment-button-dim))`,s.top=`calc(${100*t[1]}% - var(--comment-button-dim))`;const i=n(this,Mt).commentButtonColor;i&&(s.backgroundColor=i)}return A(this,wh,Vu).call(this,e,!0)}focusButton(){setTimeout(()=>{var e;(e=n(this,ge)??n(this,Ps))==null||e.focus()},0)}onUpdatedColor(){if(!n(this,ge))return;const e=n(this,Mt).commentButtonColor;e&&(n(this,ge).style.backgroundColor=e),n(this,Mt)._uiManager.updatePopupColor(n(this,Mt))}get commentButtonWidth(){var e;return(((e=n(this,ge))==null?void 0:e.getBoundingClientRect().width)??0)/n(this,Mt).parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(n(this,Or))return n(this,Or);if(!n(this,ge))return null;const{x:e,y:t,height:s}=n(this,ge).getBoundingClientRect(),{x:i,y:r,width:a,height:o}=n(this,Mt).parent.boundingClientRect;return[(e-i)/a,(t+s-r)/o]}set commentPopupPositionInLayer(e){g(this,Or,e)}hasDefaultPopupPosition(){return n(this,Or)===null}removeStandaloneCommentButton(){var e;(e=n(this,ge))==null||e.remove(),g(this,ge,null)}removeToolbarCommentButton(){var e;(e=n(this,Ps))==null||e.remove(),g(this,Ps,null)}setCommentButtonStates({selected:e,hasPopup:t}){n(this,ge)&&(n(this,ge).classList.toggle("selected",e),n(this,ge).ariaExpanded=t)}edit(e){const t=this.commentPopupPositionInLayer;let s,i;if(t)[s,i]=t;else{[s,i]=n(this,Mt).commentButtonPosition;const{width:c,height:u,x:f,y:p}=n(this,Mt);s=f+s*c,i=p+i*u}const r=n(this,Mt).parent.boundingClientRect,{x:a,y:o,width:l,height:h}=r;n(this,Mt)._uiManager.editComment(n(this,Mt),a+s*l,o+i*h,{...e,parentDimensions:r})}finish(){n(this,Ps)&&(n(this,Ps).focus({focusVisible:n(this,Pr)}),g(this,Pr,!1))}isDeleted(){return n(this,Mr)||n(this,Us)===""}isEmpty(){return n(this,Us)===null}hasBeenEdited(){return this.isDeleted()||n(this,Us)!==n(this,Ah)}serialize(){return this.data}get data(){return{text:n(this,Us),richText:n(this,Ir),date:n(this,Dr),deleted:this.isDeleted()}}set data(e){if(e!==n(this,Us)&&g(this,Ir,null),e===null){g(this,Us,""),g(this,Mr,!0);return}g(this,Us,e),g(this,Dr,new Date),g(this,Mr,!1)}setInitialText(e,t=null){g(this,Ah,e),this.data=e,g(this,Dr,null),g(this,Ir,t)}shown(){}destroy(){var e,t;(e=n(this,Ps))==null||e.remove(),g(this,Ps,null),(t=n(this,ge))==null||t.remove(),g(this,ge,null),g(this,Us,""),g(this,Ir,null),g(this,Dr,null),g(this,Mt,null),g(this,Pr,!1),g(this,Mr,!1)}}ge=new WeakMap,Ps=new WeakMap,Pr=new WeakMap,Mt=new WeakMap,Ah=new WeakMap,Ir=new WeakMap,Us=new WeakMap,Dr=new WeakMap,Mr=new WeakMap,Or=new WeakMap,wh=new WeakSet,Vu=function(e,t){if(!n(this,Mt)._uiManager.hasCommentManager())return null;e.tabIndex="0",e.ariaHasPopup="dialog",t?(e.ariaControls="commentPopup",e.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(e.ariaControlsElements=[n(this,Mt)._uiManager.getCommentDialogElement()],e.setAttribute("data-l10n-id","pdfjs-editor-edit-comment-button"));const s=n(this,Mt)._uiManager._signal;if(!(s instanceof AbortSignal)||s.aborted)return e;e.addEventListener("contextmenu",ks,{signal:s}),t&&(e.addEventListener("focusin",r=>{n(this,Mt)._focusEventsAllowed=!1,Wt(r)},{capture:!0,signal:s}),e.addEventListener("focusout",r=>{n(this,Mt)._focusEventsAllowed=!0,Wt(r)},{capture:!0,signal:s})),e.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:s});const i=r=>{r.preventDefault(),e===n(this,Ps)?this.edit():n(this,Mt).toggleComment(!0)};return e.addEventListener("click",i,{capture:!0,signal:s}),e.addEventListener("keydown",r=>{r.target===e&&r.key==="Enter"&&(g(this,Pr,!0),i(r))},{signal:s}),e.addEventListener("pointerenter",()=>{n(this,Mt).toggleComment(!1,!0)},{signal:s}),e.addEventListener("pointerleave",()=>{n(this,Mt).toggleComment(!1,!1)},{signal:s}),e};var Ao,Lr,Eh,Sh,xh,Th,Ch,Ni,Fr,Bi,kr,_i,mr,Sg,xg,Tg;const vp=class vp{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:s=null,onPinchStart:i=null,onPinching:r=null,onPinchEnd:a=null,signal:o}){y(this,mr);y(this,Ao);y(this,Lr,!1);y(this,Eh,null);y(this,Sh);y(this,xh);y(this,Th);y(this,Ch);y(this,Ni,null);y(this,Fr);y(this,Bi,null);y(this,kr);y(this,_i,null);g(this,Ao,e),g(this,Eh,s),g(this,Sh,t),g(this,xh,i),g(this,Th,r),g(this,Ch,a),g(this,kr,new AbortController),g(this,Fr,AbortSignal.any([o,n(this,kr).signal])),e.addEventListener("touchstart",A(this,mr,Sg).bind(this),{passive:!1,signal:n(this,Fr)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Ti.pixelRatio}destroy(){var e,t;(e=n(this,kr))==null||e.abort(),g(this,kr,null),(t=n(this,Ni))==null||t.abort(),g(this,Ni,null)}};Ao=new WeakMap,Lr=new WeakMap,Eh=new WeakMap,Sh=new WeakMap,xh=new WeakMap,Th=new WeakMap,Ch=new WeakMap,Ni=new WeakMap,Fr=new WeakMap,Bi=new WeakMap,kr=new WeakMap,_i=new WeakMap,mr=new WeakSet,Sg=function(e){var i,r,a;if((i=n(this,Sh))!=null&&i.call(this))return;if(e.touches.length===1){if(n(this,Ni))return;const o=g(this,Ni,new AbortController),l=AbortSignal.any([n(this,Fr),o.signal]),h=n(this,Ao),c={capture:!0,signal:l,passive:!1},u=f=>{var p;f.pointerType==="touch"&&((p=n(this,Ni))==null||p.abort(),g(this,Ni,null))};h.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(Wt(f),u(f))},c),h.addEventListener("pointerup",u,c),h.addEventListener("pointercancel",u,c);return}if(!n(this,_i)){g(this,_i,new AbortController);const o=AbortSignal.any([n(this,Fr),n(this,_i).signal]),l=n(this,Ao),h={signal:o,capture:!1,passive:!1};l.addEventListener("touchmove",A(this,mr,xg).bind(this),h);const c=A(this,mr,Tg).bind(this);l.addEventListener("touchend",c,h),l.addEventListener("touchcancel",c,h),h.capture=!0,l.addEventListener("pointerdown",Wt,h),l.addEventListener("pointermove",Wt,h),l.addEventListener("pointercancel",Wt,h),l.addEventListener("pointerup",Wt,h),(r=n(this,xh))==null||r.call(this)}if(Wt(e),e.touches.length!==2||(a=n(this,Eh))!=null&&a.call(this)){g(this,Bi,null);return}let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]),g(this,Bi,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:s.screenX,touch1Y:s.screenY})},xg=function(e){var T;if(!n(this,Bi)||e.touches.length!==2)return;Wt(e);let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]);const{screenX:i,screenY:r}=t,{screenX:a,screenY:o}=s,l=n(this,Bi),{touch0X:h,touch0Y:c,touch1X:u,touch1Y:f}=l,p=u-h,v=f-c,m=a-i,w=o-r,b=Math.hypot(m,w)||1,S=Math.hypot(p,v)||1;if(!n(this,Lr)&&Math.abs(S-b)<=vp.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(l.touch0X=i,l.touch0Y=r,l.touch1X=a,l.touch1Y=o,!n(this,Lr)){g(this,Lr,!0);return}const E=[(i+a)/2,(r+o)/2];(T=n(this,Th))==null||T.call(this,E,S,b)},Tg=function(e){var t;e.touches.length>=2||(n(this,_i)&&(n(this,_i).abort(),g(this,_i,null),(t=n(this,Ch))==null||t.call(this)),n(this,Bi)&&(Wt(e),g(this,Bi,null),g(this,Lr,!1)))};let Ud=vp;var Nr,Hs,Nt,Ct,Ui,wo,Nn,Rh,me,Br,Hi,hi,Bn,Ph,_r,ts,Ih,Ur,$i,ci,Eo,So,Is,Hr,Dh,tu,J,Wu,Mh,Xu,ld,Cg,Rg,Yu,hd,Ku,Pg,Ig,Dg,Ju,Mg,Qu,Og,Lg,Fg,Zu,_l;const et=class et{constructor(e){y(this,J);y(this,Nr,null);y(this,Hs,null);y(this,Nt,null);y(this,Ct,null);y(this,Ui,null);y(this,wo,!1);y(this,Nn,null);y(this,Rh,"");y(this,me,null);y(this,Br,null);y(this,Hi,null);y(this,hi,null);y(this,Bn,null);y(this,Ph,"");y(this,_r,!1);y(this,ts,null);y(this,Ih,!1);y(this,Ur,!1);y(this,$i,!1);y(this,ci,null);y(this,Eo,0);y(this,So,0);y(this,Is,null);y(this,Hr,null);k(this,"isSelected",!1);k(this,"_isCopy",!1);k(this,"_editToolbar",null);k(this,"_initialOptions",Object.create(null));k(this,"_initialData",null);k(this,"_isVisible",!0);k(this,"_uiManager",null);k(this,"_focusEventsAllowed",!0);y(this,Dh,!1);y(this,tu,et._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null,this.creationDate=e.creationDate||new Date,this.modificationDate=e.modificationDate||null;const{rotation:t,rawDims:{pageWidth:s,pageHeight:i,pageX:r,pageY:a}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,i],this.pageTranslation=[r,a];const[o,l]=this.parentDimensions;this.x=e.x/o,this.y=e.y/l,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=et.prototype._resizeWithKeyboard,t=Ba.TRANSLATE_SMALL,s=Ba.TRANSLATE_BIG;return lt(this,"_resizerKeyboardManager",new zc([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,s]}],[["Escape","mac+Escape"],et.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return lt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new kv({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(et._l10n??(et._l10n=e),et._l10nResizer||(et._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),et._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);et._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){It("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return n(this,Dh)}set _isDraggable(e){var t;g(this,Dh,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=n(this,tu)}setParent(e){var t;e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):(A(this,J,_l).call(this),(t=n(this,hi))==null||t.remove(),g(this,hi,null)),this.parent=e}focusin(e){this._focusEventsAllowed&&(n(this,_r)?g(this,_r,!1):this.parent.setSelected(this))}focusout(e){var s;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(s=this.parent)!=null&&s.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,s,i){const[r,a]=this.parentDimensions;[s,i]=this.screenToPageTranslation(s,i),this.x=(e+s)/r,this.y=(t+i)/a,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[s,i]=this.parentDimensions;this.setAt(e*s,t*i,this.width*s,this.height*i),this._onTranslated()}translate(e,t){A(this,J,Wu).call(this,this.parentDimensions,e,t)}translateInPage(e,t){n(this,ts)||g(this,ts,[this.x,this.y,this.width,this.height]),A(this,J,Wu).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){n(this,ts)||g(this,ts,[this.x,this.y,this.width,this.height]);const{div:s,parentDimensions:[i,r]}=this;if(this.x+=e/i,this.y+=t/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:u,y:f}=this.div.getBoundingClientRect();this.parent.findNewParent(this,u,f)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:o}=this;const[l,h]=this.getBaseTranslation();a+=l,o+=h;const{style:c}=s;c.left=`${(100*a).toFixed(2)}%`,c.top=`${(100*o).toFixed(2)}%`,this._onTranslating(a,o),s.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!n(this,ts)&&(n(this,ts)[0]!==this.x||n(this,ts)[1]!==this.y)}get _hasBeenResized(){return!!n(this,ts)&&(n(this,ts)[2]!==this.width||n(this,ts)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:s}=et,i=s/e,r=s/t;switch(this.rotation){case 90:return[-i,r];case 180:return[i,r];case 270:return[i,-r];default:return[-i,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[s,i]}=this;let{x:r,y:a,width:o,height:l}=this;if(o*=s,l*=i,r*=s,a*=i,this._mustFixPosition)switch(e){case 0:r=_e(r,0,s-o),a=_e(a,0,i-l);break;case 90:r=_e(r,0,s-l),a=_e(a,o,i);break;case 180:r=_e(r,o,s),a=_e(a,l,i);break;case 270:r=_e(r,l,s),a=_e(a,0,i-o);break}this.x=r/=s,this.y=a/=i;const[h,c]=this.getBaseTranslation();r+=h,a+=c,t.left=`${(100*r).toFixed(2)}%`,t.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var s;return A(s=et,Mh,Xu).call(s,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var s;return A(s=et,Mh,Xu).call(s,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,s]}=this;return[t*e,s*e]}setDims(){const{div:{style:e},width:t,height:s}=this;e.width=`${(100*t).toFixed(2)}%`,e.height=`${(100*s).toFixed(2)}%`}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=n(this,Nt))==null||e.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||n(this,Ur))return this._editToolbar;this._editToolbar=new ku(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,s]of e)await this._editToolbar.addButton(t,s);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){var e;(e=this._editToolbar)==null||e.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){var e;(e=this._editToolbar)==null||e.removeButton("comment")}removeEditToolbar(){var e,t;(e=this._editToolbar)==null||e.remove(),this._editToolbar=null,(t=n(this,Nt))==null||t.destroy()}addContainer(e){var s;const t=(s=this._editToolbar)==null?void 0:s.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return n(this,Nt)||(_d.initialize(et._l10n),g(this,Nt,new _d(this)),n(this,Nr)&&(n(this,Nt).data=n(this,Nr),g(this,Nr,null))),n(this,Nt)}get altTextData(){var e;return(e=n(this,Nt))==null?void 0:e.data}set altTextData(e){n(this,Nt)&&(n(this,Nt).data=e)}get guessedAltText(){var e;return(e=n(this,Nt))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=n(this,Nt))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=n(this,Nt))==null?void 0:t.serialize(e)}hasAltText(){return!!n(this,Nt)&&!n(this,Nt).isEmpty()}hasAltTextData(){var e;return((e=n(this,Nt))==null?void 0:e.hasData())??!1}focusCommentButton(){var e;(e=n(this,Ct))==null||e.focusButton()}addCommentButton(){return n(this,Ct)||g(this,Ct,new Yc(this))}addStandaloneCommentButton(){if(n(this,Ui)){this._uiManager.isEditingMode()&&n(this,Ui).classList.remove("hidden");return}this.hasComment&&(g(this,Ui,n(this,Ct).renderForStandalone()),this.div.append(n(this,Ui)))}removeStandaloneCommentButton(){n(this,Ct).removeStandaloneCommentButton(),g(this,Ui,null)}hideStandaloneCommentButton(){var e;(e=n(this,Ui))==null||e.classList.add("hidden")}get comment(){const{data:{richText:e,text:t,date:s,deleted:i}}=n(this,Ct);return{text:t,richText:e,date:s,deleted:i,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(e){n(this,Ct)||g(this,Ct,new Yc(this)),n(this,Ct).data=e,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:e,popupRef:t,richText:s}){if(!t||(n(this,Ct)||g(this,Ct,new Yc(this)),n(this,Ct).setInitialText(e,s),!this.annotationElementId))return;const i=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);i&&this.updateFromAnnotationLayer(i)}get hasEditedComment(){var e;return(e=n(this,Ct))==null?void 0:e.hasBeenEdited()}get hasDeletedComment(){var e;return(e=n(this,Ct))==null?void 0:e.isDeleted()}get hasComment(){return!!n(this,Ct)&&!n(this,Ct).isEmpty()&&!n(this,Ct).isDeleted()}async editComment(e){n(this,Ct)||g(this,Ct,new Yc(this)),n(this,Ct).edit(e)}toggleComment(e,t=void 0){this.hasComment&&this._uiManager.toggleComment(this,e,t)}setSelectedCommentButton(e){n(this,Ct).setSelectedButton(e)}addComment(e){if(this.hasEditedComment){const[,,,i]=e.rect,[r]=this.pageDimensions,[a]=this.pageTranslation,o=a+r+1,l=i-100,h=o+180;e.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[o,l,h,i]}}}updateFromAnnotationLayer({popup:{contents:e,deleted:t}}){n(this,Ct).data=t?null:e}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){var a;const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=n(this,wo)?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),A(this,J,Qu).call(this);const[t,s]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*s/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/s).toFixed(2)}%`);const[i,r]=this.getInitialTranslation();return this.translate(i,r),dg(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(n(this,Hr)||g(this,Hr,new Ud({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:A(this,J,Pg).bind(this),onPinching:A(this,J,Ig).bind(this),onPinchEnd:A(this,J,Dg).bind(this),signal:this._uiManager._signal}))),this.addStandaloneCommentButton(),(a=this._uiManager._editorUndoBar)==null||a.hide(),e}pointerdown(e){const{isMac:t}=Se.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(g(this,_r,!0),this._isDraggable){A(this,J,Mg).call(this,e);return}A(this,J,Ju).call(this,e)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){n(this,ci)&&clearTimeout(n(this,ci)),g(this,ci,setTimeout(()=>{var e;g(this,ci,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,s){e.changeParent(this),this.x=t,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,s=this.rotation){const i=this.parentScale,[r,a]=this.pageDimensions,[o,l]=this.pageTranslation,h=e/i,c=t/i,u=this.x*r,f=this.y*a,p=this.width*r,v=this.height*a;switch(s){case 0:return[u+h+o,a-f-c-v+l,u+h+p+o,a-f-c+l];case 90:return[u+c+o,a-f+h+l,u+c+v+o,a-f+h+p+l];case 180:return[u-h-p+o,a-f+c+l,u-h+o,a-f+c+v+l];case 270:return[u-c-v+o,a-f-h-p+l,u-c+o,a-f-h+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[s,i,r,a]=e,o=r-s,l=a-i;switch(this.rotation){case 0:return[s,t-a,o,l];case 90:return[s,t-i,l,o];case 180:return[r,t-i,o,l];case 270:return[r,t-a,l,o];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&et._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){var e;(e=n(this,Ct))==null||e.onUpdatedColor()}getData(){const{comment:{text:e,color:t,date:s,opacity:i,deleted:r,richText:a},uid:o,pageIndex:l,creationDate:h,modificationDate:c}=this;return{id:o,pageIndex:l,rect:this.getPDFRect(),richText:a,contentsObj:{str:e},creationDate:h,modificationDate:s||c,popupRef:!r,color:t,opacity:i}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),g(this,Ur,!0),!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),g(this,Ur,!1),!0):!1}isInEditMode(){return n(this,Ur)}shouldGetKeyboardEvents(){return n(this,$i)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:s,right:i}=this.getClientDimensions(),{innerHeight:r,innerWidth:a}=window;return t<a&&i>0&&e<r&&s>0}rebuild(){A(this,J,Qu).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){var s;return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:((s=this._initialData)==null?void 0:s.popupRef)||""}}static async deserialize(e,t,s){const i=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:s,annotationElementId:e.annotationElementId,creationDate:e.creationDate,modificationDate:e.modificationDate});i.rotation=e.rotation,g(i,Nr,e.accessibilityData),i._isCopy=e.isCopy||!1;const[r,a]=i.pageDimensions,[o,l,h,c]=i.getRectInCurrentCoords(e.rect,a);return i.x=o/r,i.y=l/a,i.width=h/r,i.height=c/a,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t;if((e=n(this,Bn))==null||e.abort(),g(this,Bn,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),n(this,ci)&&(clearTimeout(n(this,ci)),g(this,ci,null)),A(this,J,_l).call(this),this.removeEditToolbar(),n(this,Is)){for(const s of n(this,Is).values())clearTimeout(s);g(this,Is,null)}this.parent=null,(t=n(this,Hr))==null||t.destroy(),g(this,Hr,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(A(this,J,Cg).call(this),n(this,me).classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[e,t]}=this,[s,i,r,a]=this.getPDFRect();return[et._round(s+(r-s)*e),et._round(i+(a-i)*(1-t))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return n(this,Ct).commentPopupPositionInLayer}set commentPopupPosition(e){n(this,Ct).commentPopupPositionInLayer=e}hasDefaultPopupPosition(){return n(this,Ct).hasDefaultPopupPosition()}get commentButtonWidth(){return n(this,Ct).commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(e){n(this,Ct).setCommentButtonStates(e)}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),g(this,Hi,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=n(this,me).children;if(!n(this,Hs)){g(this,Hs,Array.from(t));const a=A(this,J,Og).bind(this),o=A(this,J,Lg).bind(this),l=this._uiManager._signal;for(const h of n(this,Hs)){const c=h.getAttribute("data-resizer-name");h.setAttribute("role","spinbutton"),h.addEventListener("keydown",a,{signal:l}),h.addEventListener("blur",o,{signal:l}),h.addEventListener("focus",A(this,J,Fg).bind(this,c),{signal:l}),h.setAttribute("data-l10n-id",et._l10nResizer[c])}}const s=n(this,Hs)[0];let i=0;for(const a of t){if(a===s)break;i++}const r=(360-this.rotation+this.parentRotation)%360/90*(n(this,Hs).length/4);if(r!==i){if(r<i)for(let o=0;o<i-r;o++)n(this,me).append(n(this,me).firstChild);else if(r>i)for(let o=0;o<r-i;o++)n(this,me).firstChild.before(n(this,me).lastChild);let a=0;for(const o of t){const h=n(this,Hs)[a++].getAttribute("data-resizer-name");o.setAttribute("data-l10n-id",et._l10nResizer[h])}}A(this,J,Zu).call(this,0),g(this,$i,!0),n(this,me).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){n(this,$i)&&A(this,J,Ku).call(this,n(this,Ph),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){A(this,J,_l).call(this),this.div.focus()}select(){var e,t,s;if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var i,r;(i=this.div)!=null&&i.classList.contains("selectedEditor")&&((r=this._editToolbar)==null||r.show())});return}(t=this._editToolbar)==null||t.show(),(s=n(this,Nt))==null||s.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>{var e;return(e=this.div)==null?void 0:e.focus({preventScroll:!0})},0)}unselect(){var e,t,s,i,r;this.isSelected&&(this.isSelected=!1,(e=n(this,me))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(s=this.div)!=null&&s.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(i=this._editToolbar)==null||i.hide(),(r=n(this,Nt))==null||r.toggleAltTextBadge(!0),this.hasComment&&this._uiManager.toggleComment(this,!1,!1))}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){e.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return n(this,Ih)}set isEditing(e){g(this,Ih,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){n(this,Is)||g(this,Is,new Map);const{action:s}=e;let i=n(this,Is).get(s);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(e),n(this,Is).delete(s),n(this,Is).size===0&&g(this,Is,null)},et._telemetryTimeout),n(this,Is).set(s,i);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),g(this,wo,!1)}disable(){this.div&&(this.div.tabIndex=-1),g(this,wo,!0)}updateFakeAnnotationElement(e){if(!n(this,hi)&&!this.deleted){g(this,hi,e.addFakeAnnotation(this));return}if(this.deleted){n(this,hi).remove(),g(this,hi,null);return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&n(this,hi).updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const s=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),s.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};Nr=new WeakMap,Hs=new WeakMap,Nt=new WeakMap,Ct=new WeakMap,Ui=new WeakMap,wo=new WeakMap,Nn=new WeakMap,Rh=new WeakMap,me=new WeakMap,Br=new WeakMap,Hi=new WeakMap,hi=new WeakMap,Bn=new WeakMap,Ph=new WeakMap,_r=new WeakMap,ts=new WeakMap,Ih=new WeakMap,Ur=new WeakMap,$i=new WeakMap,ci=new WeakMap,Eo=new WeakMap,So=new WeakMap,Is=new WeakMap,Hr=new WeakMap,Dh=new WeakMap,tu=new WeakMap,J=new WeakSet,Wu=function([e,t],s,i){[s,i]=this.screenToPageTranslation(s,i),this.x+=s/e,this.y+=i/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},Mh=new WeakSet,Xu=function(e,t,s){switch(s){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},ld=function(e){switch(e){case 90:{const[t,s]=this.pageDimensions;return[0,-t/s,s/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,s]=this.pageDimensions;return[0,t/s,-s/t,0]}default:return[1,0,0,1]}},Cg=function(){if(n(this,me))return;g(this,me,document.createElement("div")),n(this,me).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const s of e){const i=document.createElement("div");n(this,me).append(i),i.classList.add("resizer",s),i.setAttribute("data-resizer-name",s),i.addEventListener("pointerdown",A(this,J,Rg).bind(this,s),{signal:t}),i.addEventListener("contextmenu",ks,{signal:t}),i.tabIndex=-1}this.div.prepend(n(this,me))},Rg=function(e,t){var c;t.preventDefault();const{isMac:s}=Se.platform;if(t.button!==0||t.ctrlKey&&s)return;(c=n(this,Nt))==null||c.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,g(this,Br,[t.screenX,t.screenY]);const r=new AbortController,a=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",A(this,J,Ku).bind(this,e),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",Wt,{passive:!1,signal:a}),window.addEventListener("contextmenu",ks,{signal:a}),g(this,Hi,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const o=this.parent.div.style.cursor,l=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const h=()=>{var u;r.abort(),this.parent.togglePointerEvents(!0),(u=n(this,Nt))==null||u.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=o,this.div.style.cursor=l,A(this,J,hd).call(this)};window.addEventListener("pointerup",h,{signal:a}),window.addEventListener("blur",h,{signal:a})},Yu=function(e,t,s,i){this.width=s,this.height=i,this.x=e,this.y=t,this.setDims(),this.fixAndSetPosition(),this._onResized()},hd=function(){if(!n(this,Hi))return;const{savedX:e,savedY:t,savedWidth:s,savedHeight:i}=n(this,Hi);g(this,Hi,null);const r=this.x,a=this.y,o=this.width,l=this.height;r===e&&a===t&&o===s&&l===i||this.addCommands({cmd:A(this,J,Yu).bind(this,r,a,o,l),undo:A(this,J,Yu).bind(this,e,t,s,i),mustExec:!0})},Ku=function(e,t){const[s,i]=this.parentDimensions,r=this.x,a=this.y,o=this.width,l=this.height,h=et.MIN_SIZE/s,c=et.MIN_SIZE/i,u=A(this,J,ld).call(this,this.rotation),f=(_,L)=>[u[0]*_+u[2]*L,u[1]*_+u[3]*L],p=A(this,J,ld).call(this,360-this.rotation),v=(_,L)=>[p[0]*_+p[2]*L,p[1]*_+p[3]*L];let m,w,b=!1,S=!1;switch(e){case"topLeft":b=!0,m=(_,L)=>[0,0],w=(_,L)=>[_,L];break;case"topMiddle":m=(_,L)=>[_/2,0],w=(_,L)=>[_/2,L];break;case"topRight":b=!0,m=(_,L)=>[_,0],w=(_,L)=>[0,L];break;case"middleRight":S=!0,m=(_,L)=>[_,L/2],w=(_,L)=>[0,L/2];break;case"bottomRight":b=!0,m=(_,L)=>[_,L],w=(_,L)=>[0,0];break;case"bottomMiddle":m=(_,L)=>[_/2,L],w=(_,L)=>[_/2,0];break;case"bottomLeft":b=!0,m=(_,L)=>[0,L],w=(_,L)=>[_,0];break;case"middleLeft":S=!0,m=(_,L)=>[0,L/2],w=(_,L)=>[_,L/2];break}const E=m(o,l),T=w(o,l);let x=f(...T);const C=et._round(r+x[0]),R=et._round(a+x[1]);let I=1,P=1,M,D;if(t.fromKeyboard)({deltaX:M,deltaY:D}=t);else{const{screenX:_,screenY:L}=t,[X,Z]=n(this,Br);[M,D]=this.screenToPageTranslation(_-X,L-Z),n(this,Br)[0]=_,n(this,Br)[1]=L}if([M,D]=v(M/s,D/i),b){const _=Math.hypot(o,l);I=P=Math.max(Math.min(Math.hypot(T[0]-E[0]-M,T[1]-E[1]-D)/_,1/o,1/l),h/o,c/l)}else S?I=_e(Math.abs(T[0]-E[0]-M),h,1)/o:P=_e(Math.abs(T[1]-E[1]-D),c,1)/l;const O=et._round(o*I),N=et._round(l*P);x=f(...w(O,N));const B=C-x[0],W=R-x[1];n(this,ts)||g(this,ts,[this.x,this.y,this.width,this.height]),this.width=O,this.height=N,this.x=B,this.y=W,this.setDims(),this.fixAndSetPosition(),this._onResizing()},Pg=function(){var e;g(this,Hi,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=n(this,Nt))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},Ig=function(e,t,s){let r=.7*(s/t)+1-.7;if(r===1)return;const a=A(this,J,ld).call(this,this.rotation),o=(C,R)=>[a[0]*C+a[2]*R,a[1]*C+a[3]*R],[l,h]=this.parentDimensions,c=this.x,u=this.y,f=this.width,p=this.height,v=et.MIN_SIZE/l,m=et.MIN_SIZE/h;r=Math.max(Math.min(r,1/f,1/p),v/f,m/p);const w=et._round(f*r),b=et._round(p*r);if(w===f&&b===p)return;n(this,ts)||g(this,ts,[c,u,f,p]);const S=o(f/2,p/2),E=et._round(c+S[0]),T=et._round(u+S[1]),x=o(w/2,b/2);this.x=E-x[0],this.y=T-x[1],this.width=w,this.height=b,this.setDims(),this.fixAndSetPosition(),this._onResizing()},Dg=function(){var e;(e=n(this,Nt))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),A(this,J,hd).call(this)},Ju=function(e){const{isMac:t}=Se.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},Mg=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let s=!1;const i=new AbortController,r=this._uiManager.combinedSignal(i),a={capture:!0,passive:!1,signal:r},o=h=>{i.abort(),g(this,Nn,null),g(this,_r,!1),this._uiManager.endDragSession()||A(this,J,Ju).call(this,h),s&&this._onStopDragging()};t&&(g(this,Eo,e.clientX),g(this,So,e.clientY),g(this,Nn,e.pointerId),g(this,Rh,e.pointerType),window.addEventListener("pointermove",h=>{s||(s=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:c,clientY:u,pointerId:f}=h;if(f!==n(this,Nn)){Wt(h);return}const[p,v]=this.screenToPageTranslation(c-n(this,Eo),u-n(this,So));g(this,Eo,c),g(this,So,u),this._uiManager.dragSelectedEditors(p,v)},a),window.addEventListener("touchmove",Wt,a),window.addEventListener("pointerdown",h=>{h.pointerType===n(this,Rh)&&(n(this,Hr)||h.isPrimary)&&o(h),Wt(h)},a));const l=h=>{if(!n(this,Nn)||n(this,Nn)===h.pointerId){o(h);return}Wt(h)};window.addEventListener("pointerup",l,{signal:r}),window.addEventListener("blur",l,{signal:r})},Qu=function(){if(n(this,Bn)||!this.div)return;g(this,Bn,new AbortController);const e=this._uiManager.combinedSignal(n(this,Bn));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},Og=function(e){et._resizerKeyboardManager.exec(this,e)},Lg=function(e){var t;n(this,$i)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==n(this,me)&&A(this,J,_l).call(this)},Fg=function(e){g(this,Ph,n(this,$i)?e:"")},Zu=function(e){if(n(this,Hs))for(const t of n(this,Hs))t.tabIndex=e},_l=function(){g(this,$i,!1),A(this,J,Zu).call(this,-1),A(this,J,hd).call(this)},y(et,Mh),k(et,"_l10n",null),k(et,"_l10nResizer",null),k(et,"_borderLineWidth",-1),k(et,"_colorManager",new _u),k(et,"_zIndex",1),k(et,"_telemetryTimeout",1e3);let Ot=et;class kv extends Ot{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Mp=3285377520,As=4294901760,qs=65535;class kg{constructor(e){this.h1=e?e&4294967295:Mp,this.h2=e?e&4294967295:Mp}update(e){let t,s;if(typeof e=="string"){t=new Uint8Array(e.length*2),s=0;for(let m=0,w=e.length;m<w;m++){const b=e.charCodeAt(m);b<=255?t[s++]=b:(t[s++]=b>>>8,t[s++]=b&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),s=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=s>>2,r=s-i*4,a=new Uint32Array(t.buffer,0,i);let o=0,l=0,h=this.h1,c=this.h2;const u=3432918353,f=461845907,p=u&qs,v=f&qs;for(let m=0;m<i;m++)m&1?(o=a[m],o=o*u&As|o*p&qs,o=o<<15|o>>>17,o=o*f&As|o*v&qs,h^=o,h=h<<13|h>>>19,h=h*5+3864292196):(l=a[m],l=l*u&As|l*p&qs,l=l<<15|l>>>17,l=l*f&As|l*v&qs,c^=l,c=c<<13|c>>>19,c=c*5+3864292196);switch(o=0,r){case 3:o^=t[i*4+2]<<16;case 2:o^=t[i*4+1]<<8;case 1:o^=t[i*4],o=o*u&As|o*p&qs,o=o<<15|o>>>17,o=o*f&As|o*v&qs,i&1?h^=o:c^=o}this.h1=h,this.h2=c}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&As|e*36045&qs,t=t*4283543511&As|((t<<16|e>>>16)*2950163797&As)>>>16,e^=t>>>1,e=e*444984403&As|e*60499&qs,t=t*3301882366&As|((t<<16|e>>>16)*3120437893&As)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const qu=Object.freeze({map:null,hash:"",transfer:void 0});var $r,jr,ji,ve,eu,Ng;class hp{constructor(){y(this,eu);y(this,$r,!1);y(this,jr,null);y(this,ji,null);y(this,ve,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const s=n(this,ve).get(e);return s===void 0?t:Object.assign(t,s)}getRawValue(e){return n(this,ve).get(e)}remove(e){const t=n(this,ve).get(e);if(t!==void 0&&(t instanceof Ot&&n(this,ji).delete(t.annotationElementId),n(this,ve).delete(e),n(this,ve).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const s of n(this,ve).values())if(s instanceof Ot)return;this.onAnnotationEditor(null)}}setValue(e,t){const s=n(this,ve).get(e);let i=!1;if(s!==void 0)for(const[r,a]of Object.entries(t))s[r]!==a&&(i=!0,s[r]=a);else i=!0,n(this,ve).set(e,t);i&&A(this,eu,Ng).call(this),t instanceof Ot&&((n(this,ji)||g(this,ji,new Map)).set(t.annotationElementId,t),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type))}has(e){return n(this,ve).has(e)}get size(){return n(this,ve).size}resetModified(){n(this,$r)&&(g(this,$r,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new Bg(this)}get serializable(){if(n(this,ve).size===0)return qu;const e=new Map,t=new kg,s=[],i=Object.create(null);let r=!1;for(const[a,o]of n(this,ve)){const l=o instanceof Ot?o.serialize(!1,i):o;l&&(e.set(a,l),t.update(`${a}:${JSON.stringify(l)}`),r||(r=!!l.bitmap))}if(r)for(const a of e.values())a.bitmap&&s.push(a.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:s}:qu}get editorStats(){let e=null;const t=new Map;let s=0,i=0;for(const r of n(this,ve).values()){if(!(r instanceof Ot)){r.popup&&(r.popup.deleted?i+=1:s+=1);continue}r.isCommentDeleted?i+=1:r.hasEditedComment&&(s+=1);const a=r.telemetryFinalData;if(!a)continue;const{type:o}=a;t.has(o)||t.set(o,Object.getPrototypeOf(r).constructor),e||(e=Object.create(null));const l=e[o]||(e[o]=new Map);for(const[h,c]of Object.entries(a)){if(h==="type")continue;let u=l.get(h);u||(u=new Map,l.set(h,u));const f=u.get(c)??0;u.set(c,f+1)}}if((i>0||s>0)&&(e||(e=Object.create(null)),e.comments={deleted:i,edited:s}),!e)return null;for(const[r,a]of t)e[r]=a.computeTelemetryFinalData(e[r]);return e}resetModifiedIds(){g(this,jr,null)}updateEditor(e,t){var i;const s=(i=n(this,ji))==null?void 0:i.get(e);return s?(s.updateFromAnnotationLayer(t),!0):!1}getEditor(e){var t;return((t=n(this,ji))==null?void 0:t.get(e))||null}get modifiedIds(){if(n(this,jr))return n(this,jr);const e=[];if(n(this,ji))for(const t of n(this,ji).values())t.serialize()&&e.push(t.annotationElementId);return g(this,jr,{ids:new Set(e),hash:e.join(",")})}[Symbol.iterator](){return n(this,ve).entries()}}$r=new WeakMap,jr=new WeakMap,ji=new WeakMap,ve=new WeakMap,eu=new WeakSet,Ng=function(){n(this,$r)||(g(this,$r,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var Oh;class Bg extends hp{constructor(t){super();y(this,Oh);const{map:s,hash:i,transfer:r}=t.serializable,a=structuredClone(s,r?{transfer:r}:null);g(this,Oh,{map:a,hash:i,transfer:r})}get print(){It("Should not call PrintAnnotationStorage.print")}get serializable(){return n(this,Oh)}get modifiedIds(){return lt(this,"modifiedIds",{ids:new Set,hash:""})}}Oh=new WeakMap;var xo;class Nv{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){y(this,xo,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),n(this,xo).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:s}){if(!(!e||n(this,xo).has(e.loadedName))){if(dt(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:r,style:a}=e,o=new FontFace(i,r,a);this.addNativeFontFace(o);try{await o.load(),n(this,xo).add(i),s==null||s(e)}catch{Q(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(o)}return}It("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const s=e.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(i){throw Q(`Failed to load font '${s.family}': '${i}'.`),e.disableFontFace=!0,i}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const i=this._queueLoadingCallback(s);this._prepareFontLoadEvent(e,i)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return lt(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return lt(this,"isSyncFontLoadingSupported",Be||Se.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(dt(!i.done,"completeRequest() cannot be called twice."),i.done=!0;s.length>0&&s[0].done;){const r=s.shift();setTimeout(r.callback,0)}}const{loadingRequests:s}=this,i={done:!1,complete:t,callback:e};return s.push(i),i}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return lt(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function s(T,x){return T.charCodeAt(x)<<24|T.charCodeAt(x+1)<<16|T.charCodeAt(x+2)<<8|T.charCodeAt(x+3)&255}function i(T,x,C,R){const I=T.substring(0,x),P=T.substring(x+C);return I+R+P}let r,a;const o=this._document.createElement("canvas");o.width=1,o.height=1;const l=o.getContext("2d");let h=0;function c(T,x){if(++h>30){Q("Load test font never loaded."),x();return}if(l.font="30px "+T,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){x();return}setTimeout(c.bind(null,T,x))}const u=`lt${Date.now()}${this.loadTestFontId++}`;let f=this._loadTestFont;f=i(f,976,u.length,u);const v=16,m=1482184792;let w=s(f,v);for(r=0,a=u.length-3;r<a;r+=4)w=w-m+s(u,r)|0;r<u.length&&(w=w-m+s(u+"XXX",r)|0),f=i(f,v,4,mv(w));const b=`url(data:font/opentype;base64,${btoa(f)});`,S=`@font-face {font-family:"${u}";src:${b}}`;this.insertRule(S);const E=this._document.createElement("div");E.style.visibility="hidden",E.style.width=E.style.height="10px",E.style.position="absolute",E.style.top=E.style.left="0px";for(const T of[e.loadedName,u]){const x=this._document.createElement("span");x.textContent="Hi",x.style.fontFamily=T,E.append(x)}this._document.body.append(E),c(u,()=>{E.remove(),t.complete()})}}xo=new WeakMap;var wt;class Bv{constructor(e,t=null,s,i){y(this,wt);this.compiledGlyphs=Object.create(null),g(this,wt,e),this._inspectFont=t,s&&Object.assign(this,s),i&&(this.charProcOperatorList=i)}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const s={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(s.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,s)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var s;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${ig(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${e}}`}return(s=this._inspectFont)==null||s.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const s=this.loadedName+"_path_"+t;let i;try{i=e.get(s)}catch(a){Q(`getPathGenerator - ignoring character: "${a}".`)}const r=new Path2D(i||"");return this.fontExtraProperties||e.delete(s),this.compiledGlyphs[t]=r}get black(){return n(this,wt).black}get bold(){return n(this,wt).bold}get disableFontFace(){return n(this,wt).disableFontFace??!1}get fontExtraProperties(){return n(this,wt).fontExtraProperties??!1}get isInvalidPDFjsFont(){return n(this,wt).isInvalidPDFjsFont}get isType3Font(){return n(this,wt).isType3Font}get italic(){return n(this,wt).italic}get missingFile(){return n(this,wt).missingFile}get remeasure(){return n(this,wt).remeasure}get vertical(){return n(this,wt).vertical}get ascent(){return n(this,wt).ascent}get defaultWidth(){return n(this,wt).defaultWidth}get descent(){return n(this,wt).descent}get bbox(){return n(this,wt).bbox}get fontMatrix(){return n(this,wt).fontMatrix}get fallbackName(){return n(this,wt).fallbackName}get loadedName(){return n(this,wt).loadedName}get mimetype(){return n(this,wt).mimetype}get name(){return n(this,wt).name}get data(){return n(this,wt).data}clearData(){n(this,wt).clearData()}get cssFontInfo(){return n(this,wt).cssFontInfo}get systemFontInfo(){return n(this,wt).systemFontInfo}get defaultVMetrics(){return n(this,wt).defaultVMetrics}}wt=new WeakMap;function _v(d){if(d instanceof URL)return d.href;if(typeof d=="string"){if(Be)return d;const e=URL.parse(d,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function Uv(d){if(Be&&typeof Buffer<"u"&&d instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(d instanceof Uint8Array&&d.byteLength===d.buffer.byteLength)return d;if(typeof d=="string")return Uc(d);if(d instanceof ArrayBuffer||ArrayBuffer.isView(d)||typeof d=="object"&&!isNaN(d==null?void 0:d.length))return new Uint8Array(d);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Kc(d){if(typeof d!="string")return null;if(d.endsWith("/"))return d;throw new Error(`Invalid factory url: "${d}" must include trailing slash.`)}const tf=d=>typeof d=="object"&&Number.isInteger(d==null?void 0:d.num)&&d.num>=0&&Number.isInteger(d==null?void 0:d.gen)&&d.gen>=0,Hv=d=>typeof d=="object"&&typeof(d==null?void 0:d.name)=="string",$v=wv.bind(null,tf,Hv);var zi,su;class jv{constructor(){y(this,zi,new Map);y(this,su,Promise.resolve())}postMessage(e,t){const s={data:structuredClone(e,t?{transfer:t}:null)};n(this,su).then(()=>{for(const[i]of n(this,zi))i.call(this,s)})}addEventListener(e,t,s=null){let i=null;if((s==null?void 0:s.signal)instanceof AbortSignal){const{signal:r}=s;if(r.aborted){Q("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(e,t);i=()=>r.removeEventListener("abort",a),r.addEventListener("abort",a)}n(this,zi).set(t,i)}removeEventListener(e,t){const s=n(this,zi).get(t);s==null||s(),n(this,zi).delete(t)}terminate(){for(const[,e]of n(this,zi))e==null||e();n(this,zi).clear()}}zi=new WeakMap,su=new WeakMap;const Jc={DATA:1,ERROR:2},Jt={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Op(){}function $e(d){if(d instanceof pr||d instanceof Mu||d instanceof xp||d instanceof Nd||d instanceof Su)return d;switch(d instanceof Error||typeof d=="object"&&d!==null||It('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),d.name){case"AbortException":return new pr(d.message);case"InvalidPDFException":return new Mu(d.message);case"PasswordException":return new xp(d.message,d.code);case"ResponseException":return new Nd(d.message,d.status,d.missing);case"UnknownErrorException":return new Su(d.message,d.details)}return new Su(d.message,d.toString())}var To,Fs,_g,Ug,Hg,cd;class Ul{constructor(e,t,s){y(this,Fs);y(this,To,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",A(this,Fs,_g).bind(this),{signal:n(this,To).signal})}on(e,t){const s=this.actionHandler;if(s[e])throw new Error(`There is already an actionName called "${e}"`);s[e]=t}send(e,t,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},s)}sendWithPromise(e,t,s){const i=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[i]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},s)}catch(a){r.reject(a)}return r.promise}sendWithStream(e,t,s,i){const r=this.streamId++,a=this.sourceName,o=this.targetName,l=this.comObj;return new ReadableStream({start:h=>{const c=Promise.withResolvers();return this.streamControllers[r]={controller:h,startCall:c,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:a,targetName:o,action:e,streamId:r,data:t,desiredSize:h.desiredSize},i),c.promise},pull:h=>{const c=Promise.withResolvers();return this.streamControllers[r].pullCall=c,l.postMessage({sourceName:a,targetName:o,stream:Jt.PULL,streamId:r,desiredSize:h.desiredSize}),c.promise},cancel:h=>{dt(h instanceof Error,"cancel must have a valid reason");const c=Promise.withResolvers();return this.streamControllers[r].cancelCall=c,this.streamControllers[r].isClosed=!0,l.postMessage({sourceName:a,targetName:o,stream:Jt.CANCEL,streamId:r,reason:$e(h)}),c.promise}},s)}destroy(){var e;(e=n(this,To))==null||e.abort(),g(this,To,null)}}To=new WeakMap,Fs=new WeakSet,_g=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){A(this,Fs,Hg).call(this,e);return}if(e.callback){const s=e.callbackId,i=this.callbackCapabilities[s];if(!i)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],e.callback===Jc.DATA)i.resolve(e.data);else if(e.callback===Jc.ERROR)i.reject($e(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const s=this.sourceName,i=e.sourceName,r=this.comObj;Promise.try(t,e.data).then(function(a){r.postMessage({sourceName:s,targetName:i,callback:Jc.DATA,callbackId:e.callbackId,data:a})},function(a){r.postMessage({sourceName:s,targetName:i,callback:Jc.ERROR,callbackId:e.callbackId,reason:$e(a)})});return}if(e.streamId){A(this,Fs,Ug).call(this,e);return}t(e.data)},Ug=function(e){const t=e.streamId,s=this.sourceName,i=e.sourceName,r=this.comObj,a=this,o=this.actionHandler[e.action],l={enqueue(h,c=1,u){if(this.isCancelled)return;const f=this.desiredSize;this.desiredSize-=c,f>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:s,targetName:i,stream:Jt.ENQUEUE,streamId:t,chunk:h},u)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:i,stream:Jt.CLOSE,streamId:t}),delete a.streamSinks[t])},error(h){dt(h instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:i,stream:Jt.ERROR,streamId:t,reason:$e(h)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[t]=l,Promise.try(o,e.data,l).then(function(){r.postMessage({sourceName:s,targetName:i,stream:Jt.START_COMPLETE,streamId:t,success:!0})},function(h){r.postMessage({sourceName:s,targetName:i,stream:Jt.START_COMPLETE,streamId:t,reason:$e(h)})})},Hg=function(e){const t=e.streamId,s=this.sourceName,i=e.sourceName,r=this.comObj,a=this.streamControllers[t],o=this.streamSinks[t];switch(e.stream){case Jt.START_COMPLETE:e.success?a.startCall.resolve():a.startCall.reject($e(e.reason));break;case Jt.PULL_COMPLETE:e.success?a.pullCall.resolve():a.pullCall.reject($e(e.reason));break;case Jt.PULL:if(!o){r.postMessage({sourceName:s,targetName:i,stream:Jt.PULL_COMPLETE,streamId:t,success:!0});break}o.desiredSize<=0&&e.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=e.desiredSize,Promise.try(o.onPull||Op).then(function(){r.postMessage({sourceName:s,targetName:i,stream:Jt.PULL_COMPLETE,streamId:t,success:!0})},function(h){r.postMessage({sourceName:s,targetName:i,stream:Jt.PULL_COMPLETE,streamId:t,reason:$e(h)})});break;case Jt.ENQUEUE:if(dt(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(e.chunk);break;case Jt.CLOSE:if(dt(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),A(this,Fs,cd).call(this,a,t);break;case Jt.ERROR:dt(a,"error should have stream controller"),a.controller.error($e(e.reason)),A(this,Fs,cd).call(this,a,t);break;case Jt.CANCEL_COMPLETE:e.success?a.cancelCall.resolve():a.cancelCall.reject($e(e.reason)),A(this,Fs,cd).call(this,a,t);break;case Jt.CANCEL:if(!o)break;const l=$e(e.reason);Promise.try(o.onCancel||Op,l).then(function(){r.postMessage({sourceName:s,targetName:i,stream:Jt.CANCEL_COMPLETE,streamId:t,success:!0})},function(h){r.postMessage({sourceName:s,targetName:i,stream:Jt.CANCEL_COMPLETE,streamId:t,reason:$e(h)})}),o.sinkCapability.reject(l),o.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},cd=async function(e,t){var s,i,r;await Promise.allSettled([(s=e.startCall)==null?void 0:s.promise,(i=e.pullCall)==null?void 0:i.promise,(r=e.cancelCall)==null?void 0:r.promise]),delete this.streamControllers[t]};var Lh;class $g{constructor({enableHWA:e=!1}){y(this,Lh,!1);g(this,Lh,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(e,t);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!n(this,Lh)})}}reset(e,t,s){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||s<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=s}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){It("Abstract method `_createCanvas` called.")}}Lh=new WeakMap;class zv extends $g{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const s=this._document.createElement("canvas");return s.width=e,s.height=t,s}}class jg{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){It("Abstract method `_fetch` called.")}}class Lp extends jg{async _fetch(e){const t=await Hc(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):Uc(t)}}nt(2489);class zg{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,s,i,r){return"none"}destroy(e=!1){}}var zr,Co,Gi,Vi,Re,Gr,Vr,j,xe,Hl,Va,dd,Wa,Gg,ef,Xa,$l,jl,sf,zl;class Gv extends zg{constructor({docId:t,ownerDocument:s=globalThis.document}){super();y(this,j);y(this,zr);y(this,Co);y(this,Gi);y(this,Vi);y(this,Re);y(this,Gr);y(this,Vr,0);g(this,Vi,t),g(this,Re,s)}addFilter(t){if(!t)return"none";let s=n(this,j,xe).get(t);if(s)return s;const[i,r,a]=A(this,j,dd).call(this,t),o=t.length===1?i:`${i}${r}${a}`;if(s=n(this,j,xe).get(o),s)return n(this,j,xe).set(t,s),s;const l=`g_${n(this,Vi)}_transfer_map_${te(this,Vr)._++}`,h=A(this,j,Wa).call(this,l);n(this,j,xe).set(t,h),n(this,j,xe).set(o,h);const c=A(this,j,Xa).call(this,l);return A(this,j,jl).call(this,i,r,a,c),h}addHCMFilter(t,s){var v;const i=`${t}-${s}`,r="base";let a=n(this,j,Hl).get(r);if((a==null?void 0:a.key)===i||(a?((v=a.filter)==null||v.remove(),a.key=i,a.url="none",a.filter=null):(a={key:i,url:"none",filter:null},n(this,j,Hl).set(r,a)),!t||!s))return a.url;const o=A(this,j,zl).call(this,t);t=G.makeHexColor(...o);const l=A(this,j,zl).call(this,s);if(s=G.makeHexColor(...l),n(this,j,Va).style.color="",t==="#000000"&&s==="#ffffff"||t===s)return a.url;const h=new Array(256);for(let m=0;m<=255;m++){const w=m/255;h[m]=w<=.03928?w/12.92:((w+.055)/1.055)**2.4}const c=h.join(","),u=`g_${n(this,Vi)}_hcm_filter`,f=a.filter=A(this,j,Xa).call(this,u);A(this,j,jl).call(this,c,c,c,f),A(this,j,ef).call(this,f);const p=(m,w)=>{const b=o[m]/255,S=l[m]/255,E=new Array(w+1);for(let T=0;T<=w;T++)E[T]=b+T/w*(S-b);return E.join(",")};return A(this,j,jl).call(this,p(0,5),p(1,5),p(2,5),f),a.url=A(this,j,Wa).call(this,u),a.url}addAlphaFilter(t){let s=n(this,j,xe).get(t);if(s)return s;const[i]=A(this,j,dd).call(this,[t]),r=`alpha_${i}`;if(s=n(this,j,xe).get(r),s)return n(this,j,xe).set(t,s),s;const a=`g_${n(this,Vi)}_alpha_map_${te(this,Vr)._++}`,o=A(this,j,Wa).call(this,a);n(this,j,xe).set(t,o),n(this,j,xe).set(r,o);const l=A(this,j,Xa).call(this,a);return A(this,j,sf).call(this,i,l),o}addLuminosityFilter(t){let s=n(this,j,xe).get(t||"luminosity");if(s)return s;let i,r;if(t?([i]=A(this,j,dd).call(this,[t]),r=`luminosity_${i}`):r="luminosity",s=n(this,j,xe).get(r),s)return n(this,j,xe).set(t,s),s;const a=`g_${n(this,Vi)}_luminosity_map_${te(this,Vr)._++}`,o=A(this,j,Wa).call(this,a);n(this,j,xe).set(t,o),n(this,j,xe).set(r,o);const l=A(this,j,Xa).call(this,a);return A(this,j,Gg).call(this,l),t&&A(this,j,sf).call(this,i,l),o}addHighlightHCMFilter(t,s,i,r,a){var S;const o=`${s}-${i}-${r}-${a}`;let l=n(this,j,Hl).get(t);if((l==null?void 0:l.key)===o||(l?((S=l.filter)==null||S.remove(),l.key=o,l.url="none",l.filter=null):(l={key:o,url:"none",filter:null},n(this,j,Hl).set(t,l)),!s||!i))return l.url;const[h,c]=[s,i].map(A(this,j,zl).bind(this));let u=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),f=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),[p,v]=[r,a].map(A(this,j,zl).bind(this));f<u&&([u,f,p,v]=[f,u,v,p]),n(this,j,Va).style.color="";const m=(E,T,x)=>{const C=new Array(256),R=(f-u)/x,I=E/255,P=(T-E)/(255*x);let M=0;for(let D=0;D<=x;D++){const O=Math.round(u+D*R),N=I+D*P;for(let B=M;B<=O;B++)C[B]=N;M=O+1}for(let D=M;D<256;D++)C[D]=C[M-1];return C.join(",")},w=`g_${n(this,Vi)}_hcm_${t}_filter`,b=l.filter=A(this,j,Xa).call(this,w);return A(this,j,ef).call(this,b),A(this,j,jl).call(this,m(p[0],v[0],5),m(p[1],v[1],5),m(p[2],v[2],5),b),l.url=A(this,j,Wa).call(this,w),l.url}destroy(t=!1){var s,i,r,a;t&&((s=n(this,Gr))!=null&&s.size)||((i=n(this,Gi))==null||i.parentNode.parentNode.remove(),g(this,Gi,null),(r=n(this,Co))==null||r.clear(),g(this,Co,null),(a=n(this,Gr))==null||a.clear(),g(this,Gr,null),g(this,Vr,0))}}zr=new WeakMap,Co=new WeakMap,Gi=new WeakMap,Vi=new WeakMap,Re=new WeakMap,Gr=new WeakMap,Vr=new WeakMap,j=new WeakSet,xe=function(){return n(this,Co)||g(this,Co,new Map)},Hl=function(){return n(this,Gr)||g(this,Gr,new Map)},Va=function(){if(!n(this,Gi)){const t=n(this,Re).createElement("div"),{style:s}=t;s.visibility="hidden",s.contain="strict",s.width=s.height=0,s.position="absolute",s.top=s.left=0,s.zIndex=-1;const i=n(this,Re).createElementNS(Ri,"svg");i.setAttribute("width",0),i.setAttribute("height",0),g(this,Gi,n(this,Re).createElementNS(Ri,"defs")),t.append(i),i.append(n(this,Gi)),n(this,Re).body.append(t)}return n(this,Gi)},dd=function(t){if(t.length===1){const h=t[0],c=new Array(256);for(let f=0;f<256;f++)c[f]=h[f]/255;const u=c.join(",");return[u,u,u]}const[s,i,r]=t,a=new Array(256),o=new Array(256),l=new Array(256);for(let h=0;h<256;h++)a[h]=s[h]/255,o[h]=i[h]/255,l[h]=r[h]/255;return[a.join(","),o.join(","),l.join(",")]},Wa=function(t){if(n(this,zr)===void 0){g(this,zr,"");const s=n(this,Re).URL;s!==n(this,Re).baseURI&&(vu(s)?Q('#createUrl: ignore "data:"-URL for performance reasons.'):g(this,zr,tg(s,"")))}return`url(${n(this,zr)}#${t})`},Gg=function(t){const s=n(this,Re).createElementNS(Ri,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(s)},ef=function(t){const s=n(this,Re).createElementNS(Ri,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(s)},Xa=function(t){const s=n(this,Re).createElementNS(Ri,"filter");return s.setAttribute("color-interpolation-filters","sRGB"),s.setAttribute("id",t),n(this,j,Va).append(s),s},$l=function(t,s,i){const r=n(this,Re).createElementNS(Ri,s);r.setAttribute("type","discrete"),r.setAttribute("tableValues",i),t.append(r)},jl=function(t,s,i,r){const a=n(this,Re).createElementNS(Ri,"feComponentTransfer");r.append(a),A(this,j,$l).call(this,a,"feFuncR",t),A(this,j,$l).call(this,a,"feFuncG",s),A(this,j,$l).call(this,a,"feFuncB",i)},sf=function(t,s){const i=n(this,Re).createElementNS(Ri,"feComponentTransfer");s.append(i),A(this,j,$l).call(this,i,"feFuncA",t)},zl=function(t){return n(this,j,Va).style.color=t,jc(getComputedStyle(n(this,j,Va)).getPropertyValue("color"))};class Vg{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){It("Abstract method `_fetch` called.")}}class Fp extends Vg{async _fetch(e){const t=await Hc(e,"arraybuffer");return new Uint8Array(t)}}class Wg{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){It("Abstract method `_fetch` called.")}}class kp extends Wg{async _fetch(e){const t=await Hc(e,"arraybuffer");return new Uint8Array(t)}}var Qp;if(Be){let d;try{const e=process.getBuiltinModule("module").createRequire(import.meta.url);try{d=e("@napi-rs/canvas")}catch(t){Q(`Cannot load "@napi-rs/canvas" package: "${t}".`)}}catch(e){Q(`Cannot access the \`require\` function: "${e}".`)}globalThis.DOMMatrix||(d!=null&&d.DOMMatrix?globalThis.DOMMatrix=d.DOMMatrix:Q("Cannot polyfill `DOMMatrix`, rendering may be broken.")),globalThis.ImageData||(d!=null&&d.ImageData?globalThis.ImageData=d.ImageData:Q("Cannot polyfill `ImageData`, rendering may be broken.")),globalThis.Path2D||(d!=null&&d.Path2D?globalThis.Path2D=d.Path2D:Q("Cannot polyfill `Path2D`, rendering may be broken.")),(Qp=globalThis.navigator)!=null&&Qp.language||(globalThis.navigator={language:"en-US",platform:"",userAgent:""})}async function cp(d){const t=await process.getBuiltinModule("fs").promises.readFile(d);return new Uint8Array(t)}class Vv extends zg{}class Wv extends $g{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class Xv extends jg{async _fetch(e){return cp(e)}}class Yv extends Vg{async _fetch(e){return cp(e)}}class Kv extends Wg{async _fetch(e){return cp(e)}}nt(7588);const ja="__forcedDependency",{floor:Np,ceil:Bp}=Math;function Qc(d,e,t,s,i,r){d[e*4+0]=Math.min(d[e*4+0],t),d[e*4+1]=Math.min(d[e*4+1],s),d[e*4+2]=Math.max(d[e*4+2],i),d[e*4+3]=Math.max(d[e*4+3],r)}const nf=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];var Ro,_n;class Jv{constructor(e,t){y(this,Ro);y(this,_n);g(this,Ro,e),g(this,_n,t)}get length(){return n(this,Ro).length}isEmpty(e){return n(this,Ro)[e]===nf}minX(e){return n(this,_n)[e*4+0]/256}minY(e){return n(this,_n)[e*4+1]/256}maxX(e){return(n(this,_n)[e*4+2]+1)/256}maxY(e){return(n(this,_n)[e*4+3]+1)/256}}Ro=new WeakMap,_n=new WeakMap;const Zc=(d,e)=>{if(!d)return;let t=d.get(e);return t||(t={dependencies:new Set,isRenderingOperation:!1},d.set(e,t)),t};var Ge,Ve,Wr,$s,Xr,Wi,At,Et,Xi,We,Fh,Po,Yr,Kr,Yi,Pe,di,kh,rf;class Qv{constructor(e,t,s=!1){y(this,kh);y(this,Ge,{__proto__:null});y(this,Ve,{__proto__:null,transform:[],moveText:[],sameLineText:[],[ja]:[]});y(this,Wr,new Map);y(this,$s,[]);y(this,Xr,[]);y(this,Wi,[[1,0,0,1,0,0]]);y(this,At,[-1/0,-1/0,1/0,1/0]);y(this,Et,new Float64Array([1/0,1/0,-1/0,-1/0]));y(this,Xi,-1);y(this,We,new Set);y(this,Fh,new Map);y(this,Po,new Map);y(this,Yr);y(this,Kr);y(this,Yi);y(this,Pe);y(this,di);g(this,Yr,e.width),g(this,Kr,e.height),A(this,kh,rf).call(this,t),s&&g(this,di,new Map)}growOperationsCount(e){e>=n(this,Pe).length&&A(this,kh,rf).call(this,e,n(this,Pe))}save(e){return g(this,Ge,{__proto__:n(this,Ge)}),g(this,Ve,{__proto__:n(this,Ve),transform:{__proto__:n(this,Ve).transform},moveText:{__proto__:n(this,Ve).moveText},sameLineText:{__proto__:n(this,Ve).sameLineText},[ja]:{__proto__:n(this,Ve)[ja]}}),g(this,At,{__proto__:n(this,At)}),n(this,$s).push(e),this}restore(e){var i;const t=Object.getPrototypeOf(n(this,Ge));if(t===null)return this;g(this,Ge,t),g(this,Ve,Object.getPrototypeOf(n(this,Ve))),g(this,At,Object.getPrototypeOf(n(this,At)));const s=n(this,$s).pop();return s!==void 0&&((i=Zc(n(this,di),e))==null||i.dependencies.add(s),n(this,Pe)[e]=n(this,Pe)[s]),this}recordOpenMarker(e){return n(this,$s).push(e),this}getOpenMarker(){return n(this,$s).length===0?null:n(this,$s).at(-1)}recordCloseMarker(e){var s;const t=n(this,$s).pop();return t!==void 0&&((s=Zc(n(this,di),e))==null||s.dependencies.add(t),n(this,Pe)[e]=n(this,Pe)[t]),this}beginMarkedContent(e){return n(this,Xr).push(e),this}endMarkedContent(e){var s;const t=n(this,Xr).pop();return t!==void 0&&((s=Zc(n(this,di),e))==null||s.dependencies.add(t),n(this,Pe)[e]=n(this,Pe)[t]),this}pushBaseTransform(e){return n(this,Wi).push(G.multiplyByDOMMatrix(n(this,Wi).at(-1),e.getTransform())),this}popBaseTransform(){return n(this,Wi).length>1&&n(this,Wi).pop(),this}recordSimpleData(e,t){return n(this,Ge)[e]=t,this}recordIncrementalData(e,t){return n(this,Ve)[e].push(t),this}resetIncrementalData(e,t){return n(this,Ve)[e].length=0,this}recordNamedData(e,t){return n(this,Wr).set(e,t),this}recordSimpleDataFromNamed(e,t,s){n(this,Ge)[e]=n(this,Wr).get(t)??s}recordFutureForcedDependency(e,t){return this.recordIncrementalData(ja,t),this}inheritSimpleDataAsFutureForcedDependencies(e){for(const t of e)t in n(this,Ge)&&this.recordFutureForcedDependency(t,n(this,Ge)[t]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const e of n(this,We))this.recordFutureForcedDependency(ja,e);return this}resetBBox(e){return n(this,Xi)!==e&&(g(this,Xi,e),n(this,Et)[0]=1/0,n(this,Et)[1]=1/0,n(this,Et)[2]=-1/0,n(this,Et)[3]=-1/0),this}recordClipBox(e,t,s,i,r,a){const o=G.multiplyByDOMMatrix(n(this,Wi).at(-1),t.getTransform()),l=[1/0,1/0,-1/0,-1/0];G.axialAlignedBoundingBox([s,r,i,a],o,l);const h=G.intersect(n(this,At),l);return h?(n(this,At)[0]=h[0],n(this,At)[1]=h[1],n(this,At)[2]=h[2],n(this,At)[3]=h[3]):(n(this,At)[0]=n(this,At)[1]=1/0,n(this,At)[2]=n(this,At)[3]=-1/0),this}recordBBox(e,t,s,i,r,a){const o=n(this,At);if(o[0]===1/0)return this;const l=G.multiplyByDOMMatrix(n(this,Wi).at(-1),t.getTransform());if(o[0]===-1/0)return G.axialAlignedBoundingBox([s,r,i,a],l,n(this,Et)),this;const h=[1/0,1/0,-1/0,-1/0];return G.axialAlignedBoundingBox([s,r,i,a],l,h),n(this,Et)[0]=Math.min(n(this,Et)[0],Math.max(h[0],o[0])),n(this,Et)[1]=Math.min(n(this,Et)[1],Math.max(h[1],o[1])),n(this,Et)[2]=Math.max(n(this,Et)[2],Math.min(h[2],o[2])),n(this,Et)[3]=Math.max(n(this,Et)[3],Math.min(h[3],o[3])),this}recordCharacterBBox(e,t,s,i=1,r=0,a=0,o){const l=s.bbox;let h,c;if(l&&(h=l[2]!==l[0]&&l[3]!==l[1]&&n(this,Po).get(s),h!==!1&&(c=[0,0,0,0],G.axialAlignedBoundingBox(l,s.fontMatrix,c),(i!==1||r!==0||a!==0)&&G.scaleMinMax([i,0,0,-i,r,a],c),h)))return this.recordBBox(e,t,c[0],c[2],c[1],c[3]);if(!o)return this.recordFullPageBBox(e);const u=o();return l&&c&&h===void 0&&(h=c[0]<=r-u.actualBoundingBoxLeft&&c[2]>=r+u.actualBoundingBoxRight&&c[1]<=a-u.actualBoundingBoxAscent&&c[3]>=a+u.actualBoundingBoxDescent,n(this,Po).set(s,h),h)?this.recordBBox(e,t,c[0],c[2],c[1],c[3]):this.recordBBox(e,t,r-u.actualBoundingBoxLeft,r+u.actualBoundingBoxRight,a-u.actualBoundingBoxAscent,a+u.actualBoundingBoxDescent)}recordFullPageBBox(e){return n(this,Et)[0]=Math.max(0,n(this,At)[0]),n(this,Et)[1]=Math.max(0,n(this,At)[1]),n(this,Et)[2]=Math.min(n(this,Yr),n(this,At)[2]),n(this,Et)[3]=Math.min(n(this,Kr),n(this,At)[3]),this}getSimpleIndex(e){return n(this,Ge)[e]}recordDependencies(e,t){const s=n(this,We),i=n(this,Ge),r=n(this,Ve);for(const a of t)a in n(this,Ge)?s.add(i[a]):a in r&&r[a].forEach(s.add,s);return this}recordNamedDependency(e,t){return n(this,Wr).has(t)&&n(this,We).add(n(this,Wr).get(t)),this}recordOperation(e,t=!1){if(this.recordDependencies(e,[ja]),n(this,di)){const s=Zc(n(this,di),e),{dependencies:i}=s;n(this,We).forEach(i.add,i),n(this,$s).forEach(i.add,i),n(this,Xr).forEach(i.add,i),i.delete(e),s.isRenderingOperation=!0}if(n(this,Xi)===e){const s=Np(n(this,Et)[0]*256/n(this,Yr)),i=Np(n(this,Et)[1]*256/n(this,Kr)),r=Bp(n(this,Et)[2]*256/n(this,Yr)),a=Bp(n(this,Et)[3]*256/n(this,Kr));Qc(n(this,Yi),e,s,i,r,a);for(const o of n(this,We))o!==e&&Qc(n(this,Yi),o,s,i,r,a);for(const o of n(this,$s))o!==e&&Qc(n(this,Yi),o,s,i,r,a);for(const o of n(this,Xr))o!==e&&Qc(n(this,Yi),o,s,i,r,a);t||(n(this,We).clear(),g(this,Xi,-1))}return this}recordShowTextOperation(e,t=!1){const s=Array.from(n(this,We));this.recordOperation(e,t),this.recordIncrementalData("sameLineText",e);for(const i of s)this.recordIncrementalData("sameLineText",i);return this}bboxToClipBoxDropOperation(e,t=!1){return n(this,Xi)===e&&(g(this,Xi,-1),n(this,At)[0]=Math.max(n(this,At)[0],n(this,Et)[0]),n(this,At)[1]=Math.max(n(this,At)[1],n(this,Et)[1]),n(this,At)[2]=Math.min(n(this,At)[2],n(this,Et)[2]),n(this,At)[3]=Math.min(n(this,At)[3],n(this,Et)[3]),t||n(this,We).clear()),this}_takePendingDependencies(){const e=n(this,We);return g(this,We,new Set),e}_extractOperation(e){const t=n(this,Fh).get(e);return n(this,Fh).delete(e),t}_pushPendingDependencies(e){for(const t of e)n(this,We).add(t)}take(){return n(this,Po).clear(),new Jv(n(this,Pe),n(this,Yi))}takeDebugMetadata(){return n(this,di)}}Ge=new WeakMap,Ve=new WeakMap,Wr=new WeakMap,$s=new WeakMap,Xr=new WeakMap,Wi=new WeakMap,At=new WeakMap,Et=new WeakMap,Xi=new WeakMap,We=new WeakMap,Fh=new WeakMap,Po=new WeakMap,Yr=new WeakMap,Kr=new WeakMap,Yi=new WeakMap,Pe=new WeakMap,di=new WeakMap,kh=new WeakSet,rf=function(e,t){const s=new ArrayBuffer(e*4);g(this,Yi,new Uint8ClampedArray(s)),g(this,Pe,new Uint32Array(s)),t&&t.length>0?(n(this,Pe).set(t),n(this,Pe).fill(nf,t.length)):n(this,Pe).fill(nf)};var Rt,zt,js,Io,Do;const yp=class yp{constructor(e,t,s){y(this,Rt);y(this,zt);y(this,js);y(this,Io,0);y(this,Do,0);if(e instanceof yp&&n(e,js)===!!s)return e;g(this,Rt,e),g(this,zt,t),g(this,js,!!s)}growOperationsCount(){throw new Error("Unreachable")}save(e){return te(this,Do)._++,n(this,Rt).save(n(this,zt)),this}restore(e){return n(this,Do)>0&&(n(this,Rt).restore(n(this,zt)),te(this,Do)._--),this}recordOpenMarker(e){return te(this,Io)._++,this}getOpenMarker(){return n(this,Io)>0?n(this,zt):n(this,Rt).getOpenMarker()}recordCloseMarker(e){return te(this,Io)._--,this}beginMarkedContent(e){return this}endMarkedContent(e){return this}pushBaseTransform(e){return n(this,Rt).pushBaseTransform(e),this}popBaseTransform(){return n(this,Rt).popBaseTransform(),this}recordSimpleData(e,t){return n(this,Rt).recordSimpleData(e,n(this,zt)),this}recordIncrementalData(e,t){return n(this,Rt).recordIncrementalData(e,n(this,zt)),this}resetIncrementalData(e,t){return n(this,Rt).resetIncrementalData(e,n(this,zt)),this}recordNamedData(e,t){return this}recordSimpleDataFromNamed(e,t,s){return n(this,Rt).recordSimpleDataFromNamed(e,t,n(this,zt)),this}recordFutureForcedDependency(e,t){return n(this,Rt).recordFutureForcedDependency(e,n(this,zt)),this}inheritSimpleDataAsFutureForcedDependencies(e){return n(this,Rt).inheritSimpleDataAsFutureForcedDependencies(e),this}inheritPendingDependenciesAsFutureForcedDependencies(){return n(this,Rt).inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(e){return n(this,js)||n(this,Rt).resetBBox(n(this,zt)),this}recordClipBox(e,t,s,i,r,a){return n(this,js)||n(this,Rt).recordClipBox(n(this,zt),t,s,i,r,a),this}recordBBox(e,t,s,i,r,a){return n(this,js)||n(this,Rt).recordBBox(n(this,zt),t,s,i,r,a),this}recordCharacterBBox(e,t,s,i,r,a,o){return n(this,js)||n(this,Rt).recordCharacterBBox(n(this,zt),t,s,i,r,a,o),this}recordFullPageBBox(e){return n(this,js)||n(this,Rt).recordFullPageBBox(n(this,zt)),this}getSimpleIndex(e){return n(this,Rt).getSimpleIndex(e)}recordDependencies(e,t){return n(this,Rt).recordDependencies(n(this,zt),t),this}recordNamedDependency(e,t){return n(this,Rt).recordNamedDependency(n(this,zt),t),this}recordOperation(e){return n(this,Rt).recordOperation(n(this,zt),!0),this}recordShowTextOperation(e){return n(this,Rt).recordShowTextOperation(n(this,zt),!0),this}bboxToClipBoxDropOperation(e){return n(this,js)||n(this,Rt).bboxToClipBoxDropOperation(n(this,zt),!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}};Rt=new WeakMap,zt=new WeakMap,js=new WeakMap,Io=new WeakMap,Do=new WeakMap;let Hd=yp;const ws={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},Ae={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function af(d,e){if(!e)return;const t=e[2]-e[0],s=e[3]-e[1],i=new Path2D;i.rect(e[0],e[1],t,s),d.clip(i)}class dp{isModifyingCurrentTransform(){return!1}getPattern(){It("Abstract method `getPattern` called.")}}class Zv extends dp{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)t.addColorStop(s[0],s[1]);return t}getPattern(e,t,s,i){let r;if(i===Ae.STROKE||i===Ae.FILL){const a=t.current.getClippedPathBoundingBox(i,Ut(e))||[0,0,0,0],o=Math.ceil(a[2]-a[0])||1,l=Math.ceil(a[3]-a[1])||1,h=t.cachedCanvases.getCanvas("pattern",o,l),c=h.context;c.clearRect(0,0,c.canvas.width,c.canvas.height),c.beginPath(),c.rect(0,0,c.canvas.width,c.canvas.height),c.translate(-a[0],-a[1]),s=G.transform(s,[1,0,0,1,a[0],a[1]]),c.transform(...t.baseTransform),this.matrix&&c.transform(...this.matrix),af(c,this._bbox),c.fillStyle=this._createGradient(c),c.fill(),r=e.createPattern(h.canvas,"no-repeat");const u=new DOMMatrix(s);r.setTransform(u)}else af(e,this._bbox),r=this._createGradient(e);return r}}function Cu(d,e,t,s,i,r,a,o){const l=e.coords,h=e.colors,c=d.data,u=d.width*4;let f;l[t+1]>l[s+1]&&(f=t,t=s,s=f,f=r,r=a,a=f),l[s+1]>l[i+1]&&(f=s,s=i,i=f,f=a,a=o,o=f),l[t+1]>l[s+1]&&(f=t,t=s,s=f,f=r,r=a,a=f);const p=(l[t]+e.offsetX)*e.scaleX,v=(l[t+1]+e.offsetY)*e.scaleY,m=(l[s]+e.offsetX)*e.scaleX,w=(l[s+1]+e.offsetY)*e.scaleY,b=(l[i]+e.offsetX)*e.scaleX,S=(l[i+1]+e.offsetY)*e.scaleY;if(v>=S)return;const E=h[r],T=h[r+1],x=h[r+2],C=h[a],R=h[a+1],I=h[a+2],P=h[o],M=h[o+1],D=h[o+2],O=Math.round(v),N=Math.round(S);let B,W,_,L,X,Z,pt,$t;for(let q=O;q<=N;q++){if(q<w){const F=q<v?0:(v-q)/(v-w);B=p-(p-m)*F,W=E-(E-C)*F,_=T-(T-R)*F,L=x-(x-I)*F}else{let F;q>S?F=1:w===S?F=0:F=(w-q)/(w-S),B=m-(m-b)*F,W=C-(C-P)*F,_=R-(R-M)*F,L=I-(I-D)*F}let ot;q<v?ot=0:q>S?ot=1:ot=(v-q)/(v-S),X=p-(p-b)*ot,Z=E-(E-P)*ot,pt=T-(T-M)*ot,$t=x-(x-D)*ot;const yt=Math.round(Math.min(B,X)),Kt=Math.round(Math.max(B,X));let H=u*q+yt*4;for(let F=yt;F<=Kt;F++)ot=(B-F)/(B-X),ot<0?ot=0:ot>1&&(ot=1),c[H++]=W-(W-Z)*ot|0,c[H++]=_-(_-pt)*ot|0,c[H++]=L-(L-$t)*ot|0,c[H++]=255}}function qv(d,e,t){const s=e.coords,i=e.colors;let r,a;switch(e.type){case"lattice":const o=e.verticesPerRow,l=Math.floor(s.length/o)-1,h=o-1;for(r=0;r<l;r++){let c=r*o;for(let u=0;u<h;u++,c++)Cu(d,t,s[c],s[c+1],s[c+o],i[c],i[c+1],i[c+o]),Cu(d,t,s[c+o+1],s[c+1],s[c+o],i[c+o+1],i[c+1],i[c+o])}break;case"triangles":for(r=0,a=s.length;r<a;r+=3)Cu(d,t,s[r],s[r+1],s[r+2],i[r],i[r+1],i[r+2]);break;default:throw new Error("illegal figure")}}class ty extends dp{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,s){const o=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),h=Math.ceil(this._bounds[2])-o,c=Math.ceil(this._bounds[3])-l,u=Math.min(Math.ceil(Math.abs(h*e[0]*1.1)),3e3),f=Math.min(Math.ceil(Math.abs(c*e[1]*1.1)),3e3),p=h/u,v=c/f,m={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-l,scaleX:1/p,scaleY:1/v},w=u+2*2,b=f+2*2,S=s.getCanvas("mesh",w,b),E=S.context,T=E.createImageData(u,f);if(t){const C=T.data;for(let R=0,I=C.length;R<I;R+=4)C[R]=t[0],C[R+1]=t[1],C[R+2]=t[2],C[R+3]=255}for(const C of this._figures)qv(T,C,m);return E.putImageData(T,2,2),{canvas:S.canvas,offsetX:o-2*p,offsetY:l-2*v,scaleX:p,scaleY:v}}isModifyingCurrentTransform(){return!0}getPattern(e,t,s,i){af(e,this._bbox);const r=new Float32Array(2);if(i===Ae.SHADING)G.singularValueDecompose2dScale(Ut(e),r);else if(this.matrix){G.singularValueDecompose2dScale(this.matrix,r);const[o,l]=r;G.singularValueDecompose2dScale(t.baseTransform,r),r[0]*=o,r[1]*=l}else G.singularValueDecompose2dScale(t.baseTransform,r);const a=this._createMeshCanvas(r,i===Ae.SHADING?null:this._background,t.cachedCanvases);return i!==Ae.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(a.offsetX,a.offsetY),e.scale(a.scaleX,a.scaleY),e.createPattern(a.canvas,"no-repeat")}}class ey extends dp{getPattern(){return"hotpink"}}function sy(d){switch(d[0]){case"RadialAxial":return new Zv(d);case"Mesh":return new ty(d);case"Dummy":return new ey}throw new Error(`Unknown IR type: ${d[0]}`)}const _p={COLORED:1,UNCOLORED:2},iu=class iu{constructor(e,t,s,i){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=s,this.baseTransform=i}createPatternCanvas(e,t){var Z,pt;const{bbox:s,operatorList:i,paintType:r,tilingType:a,color:o,canvasGraphicsFactory:l}=this;let{xstep:h,ystep:c}=this;h=Math.abs(h),c=Math.abs(c),mu("TilingType: "+a);const u=s[0],f=s[1],p=s[2],v=s[3],m=p-u,w=v-f,b=new Float32Array(2);G.singularValueDecompose2dScale(this.matrix,b);const[S,E]=b;G.singularValueDecompose2dScale(this.baseTransform,b);const T=S*b[0],x=E*b[1];let C=m,R=w,I=!1,P=!1;const M=Math.ceil(h*T),D=Math.ceil(c*x),O=Math.ceil(m*T),N=Math.ceil(w*x);M>=O?C=h:I=!0,D>=N?R=c:P=!0;const B=this.getSizeAndScale(C,this.ctx.canvas.width,T),W=this.getSizeAndScale(R,this.ctx.canvas.height,x),_=e.cachedCanvases.getCanvas("pattern",B.size,W.size),L=_.context,X=l.createCanvasGraphics(L,t);if(X.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(X,r,o),L.translate(-B.scale*u,-W.scale*f),X.transform(0,B.scale,0,0,W.scale,0,0),L.save(),(Z=X.dependencyTracker)==null||Z.save(),this.clipBbox(X,u,f,p,v),X.baseTransform=Ut(X.ctx),X.executeOperatorList(i),X.endDrawing(),(pt=X.dependencyTracker)==null||pt.restore(),L.restore(),I||P){const $t=_.canvas;I&&(C=h),P&&(R=c);const q=this.getSizeAndScale(C,this.ctx.canvas.width,T),ot=this.getSizeAndScale(R,this.ctx.canvas.height,x),yt=q.size,Kt=ot.size,H=e.cachedCanvases.getCanvas("pattern-workaround",yt,Kt),F=H.context,$=I?Math.floor(m/h):0,tt=P?Math.floor(w/c):0;for(let gt=0;gt<=$;gt++)for(let K=0;K<=tt;K++)F.drawImage($t,yt*gt,Kt*K,yt,Kt,0,0,yt,Kt);return{canvas:H.canvas,scaleX:q.scale,scaleY:ot.scale,offsetX:u,offsetY:f}}return{canvas:_.canvas,scaleX:B.scale,scaleY:W.scale,offsetX:u,offsetY:f}}getSizeAndScale(e,t,s){const i=Math.max(iu.MAX_PATTERN_SIZE,t);let r=Math.ceil(e*s);return r>=i?r=i:s=r/e,{scale:s,size:r}}clipBbox(e,t,s,i,r){const a=i-t,o=r-s;e.ctx.rect(t,s,a,o),G.axialAlignedBoundingBox([t,s,i,r],Ut(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,s){const i=e.ctx,r=e.current;switch(t){case _p.COLORED:const{fillStyle:a,strokeStyle:o}=this.ctx;i.fillStyle=r.fillColor=a,i.strokeStyle=r.strokeColor=o;break;case _p.UNCOLORED:i.fillStyle=i.strokeStyle=s,r.fillColor=r.strokeColor=s;break;default:throw new gv(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,s,i,r){let a=s;i!==Ae.SHADING&&(a=G.transform(a,t.baseTransform),this.matrix&&(a=G.transform(a,this.matrix)));const o=this.createPatternCanvas(t,r);let l=new DOMMatrix(a);l=l.translate(o.offsetX,o.offsetY),l=l.scale(1/o.scaleX,1/o.scaleY);const h=e.createPattern(o.canvas,"repeat");return h.setTransform(l),h}};k(iu,"MAX_PATTERN_SIZE",3e3);let of=iu;function iy({src:d,srcPos:e=0,dest:t,width:s,height:i,nonBlackColor:r=4294967295,inverseDecode:a=!1}){const o=Se.isLittleEndian?4278190080:255,[l,h]=a?[r,o]:[o,r],c=s>>3,u=s&7,f=d.length;t=new Uint32Array(t.buffer);let p=0;for(let v=0;v<i;v++){for(const w=e+c;e<w;e++){const b=e<f?d[e]:255;t[p++]=b&128?h:l,t[p++]=b&64?h:l,t[p++]=b&32?h:l,t[p++]=b&16?h:l,t[p++]=b&8?h:l,t[p++]=b&4?h:l,t[p++]=b&2?h:l,t[p++]=b&1?h:l}if(u===0)continue;const m=e<f?d[e++]:255;for(let w=0;w<u;w++)t[p++]=m&1<<7-w?h:l}return{srcPos:e,destPos:p}}const Up=16,Hp=100,ny=15,$p=10,Je=16,Ru=new DOMMatrix,ms=new Float32Array(2),Qa=new Float32Array([1/0,1/0,-1/0,-1/0]);function ry(d,e){if(d._removeMirroring)throw new Error("Context is already forwarding operations.");d.__originalSave=d.save,d.__originalRestore=d.restore,d.__originalRotate=d.rotate,d.__originalScale=d.scale,d.__originalTranslate=d.translate,d.__originalTransform=d.transform,d.__originalSetTransform=d.setTransform,d.__originalResetTransform=d.resetTransform,d.__originalClip=d.clip,d.__originalMoveTo=d.moveTo,d.__originalLineTo=d.lineTo,d.__originalBezierCurveTo=d.bezierCurveTo,d.__originalRect=d.rect,d.__originalClosePath=d.closePath,d.__originalBeginPath=d.beginPath,d._removeMirroring=()=>{d.save=d.__originalSave,d.restore=d.__originalRestore,d.rotate=d.__originalRotate,d.scale=d.__originalScale,d.translate=d.__originalTranslate,d.transform=d.__originalTransform,d.setTransform=d.__originalSetTransform,d.resetTransform=d.__originalResetTransform,d.clip=d.__originalClip,d.moveTo=d.__originalMoveTo,d.lineTo=d.__originalLineTo,d.bezierCurveTo=d.__originalBezierCurveTo,d.rect=d.__originalRect,d.closePath=d.__originalClosePath,d.beginPath=d.__originalBeginPath,delete d._removeMirroring},d.save=function(){e.save(),this.__originalSave()},d.restore=function(){e.restore(),this.__originalRestore()},d.translate=function(t,s){e.translate(t,s),this.__originalTranslate(t,s)},d.scale=function(t,s){e.scale(t,s),this.__originalScale(t,s)},d.transform=function(t,s,i,r,a,o){e.transform(t,s,i,r,a,o),this.__originalTransform(t,s,i,r,a,o)},d.setTransform=function(t,s,i,r,a,o){e.setTransform(t,s,i,r,a,o),this.__originalSetTransform(t,s,i,r,a,o)},d.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},d.rotate=function(t){e.rotate(t),this.__originalRotate(t)},d.clip=function(t){e.clip(t),this.__originalClip(t)},d.moveTo=function(t,s){e.moveTo(t,s),this.__originalMoveTo(t,s)},d.lineTo=function(t,s){e.lineTo(t,s),this.__originalLineTo(t,s)},d.bezierCurveTo=function(t,s,i,r,a,o){e.bezierCurveTo(t,s,i,r,a,o),this.__originalBezierCurveTo(t,s,i,r,a,o)},d.rect=function(t,s,i,r){e.rect(t,s,i,r),this.__originalRect(t,s,i,r)},d.closePath=function(){e.closePath(),this.__originalClosePath()},d.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class ay{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,s){let i;return this.cache[e]!==void 0?(i=this.cache[e],this.canvasFactory.reset(i,t,s)):(i=this.canvasFactory.create(t,s),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function qc(d,e,t,s,i,r,a,o,l,h){const[c,u,f,p,v,m]=Ut(d);if(u===0&&f===0){const S=a*c+v,E=Math.round(S),T=o*p+m,x=Math.round(T),C=(a+l)*c+v,R=Math.abs(Math.round(C)-E)||1,I=(o+h)*p+m,P=Math.abs(Math.round(I)-x)||1;return d.setTransform(Math.sign(c),0,0,Math.sign(p),E,x),d.drawImage(e,t,s,i,r,0,0,R,P),d.setTransform(c,u,f,p,v,m),[R,P]}if(c===0&&p===0){const S=o*f+v,E=Math.round(S),T=a*u+m,x=Math.round(T),C=(o+h)*f+v,R=Math.abs(Math.round(C)-E)||1,I=(a+l)*u+m,P=Math.abs(Math.round(I)-x)||1;return d.setTransform(0,Math.sign(u),Math.sign(f),0,E,x),d.drawImage(e,t,s,i,r,0,0,P,R),d.setTransform(c,u,f,p,v,m),[P,R]}d.drawImage(e,t,s,i,r,a,o,l,h);const w=Math.hypot(c,u),b=Math.hypot(f,p);return[w*l,b*h]}class jp{constructor(e,t,s){k(this,"alphaIsShape",!1);k(this,"fontSize",0);k(this,"fontSizeScale",1);k(this,"textMatrix",null);k(this,"textMatrixScale",1);k(this,"fontMatrix",Du);k(this,"leading",0);k(this,"x",0);k(this,"y",0);k(this,"lineX",0);k(this,"lineY",0);k(this,"charSpacing",0);k(this,"wordSpacing",0);k(this,"textHScale",1);k(this,"textRenderingMode",pe.FILL);k(this,"textRise",0);k(this,"fillColor","#000000");k(this,"strokeColor","#000000");k(this,"patternFill",!1);k(this,"patternStroke",!1);k(this,"fillAlpha",1);k(this,"strokeAlpha",1);k(this,"lineWidth",1);k(this,"activeSMask",null);k(this,"transferMaps","none");s==null||s(this),this.clipBox=new Float32Array([0,0,e,t]),this.minMax=Qa.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=Ae.FILL,t=null){const s=this.minMax.slice();if(e===Ae.STROKE){t||It("Stroke bounding box must include transform."),G.singularValueDecompose2dScale(t,ms);const i=ms[0]*this.lineWidth/2,r=ms[1]*this.lineWidth/2;s[0]-=i,s[1]-=r,s[2]+=i,s[3]+=r}return s}updateClipFromPath(){const e=G.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(Qa,0)}getClippedPathBoundingBox(e=Ae.FILL,t=null){return G.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function zp(d,e){if(e instanceof ImageData){d.putImageData(e,0,0);return}const t=e.height,s=e.width,i=t%Je,r=(t-i)/Je,a=i===0?r:r+1,o=d.createImageData(s,Je);let l=0,h;const c=e.data,u=o.data;let f,p,v,m;if(e.kind===id.GRAYSCALE_1BPP){const w=c.byteLength,b=new Uint32Array(u.buffer,0,u.byteLength>>2),S=b.length,E=s+7>>3,T=4294967295,x=Se.isLittleEndian?4278190080:255;for(f=0;f<a;f++){for(v=f<r?Je:i,h=0,p=0;p<v;p++){const C=w-l;let R=0;const I=C>E?s:C*8-7,P=I&-8;let M=0,D=0;for(;R<P;R+=8)D=c[l++],b[h++]=D&128?T:x,b[h++]=D&64?T:x,b[h++]=D&32?T:x,b[h++]=D&16?T:x,b[h++]=D&8?T:x,b[h++]=D&4?T:x,b[h++]=D&2?T:x,b[h++]=D&1?T:x;for(;R<I;R++)M===0&&(D=c[l++],M=128),b[h++]=D&M?T:x,M>>=1}for(;h<S;)b[h++]=0;d.putImageData(o,0,f*Je)}}else if(e.kind===id.RGBA_32BPP){for(p=0,m=s*Je*4,f=0;f<r;f++)u.set(c.subarray(l,l+m)),l+=m,d.putImageData(o,0,p),p+=Je;f<a&&(m=s*i*4,u.set(c.subarray(l,l+m)),d.putImageData(o,0,p))}else if(e.kind===id.RGB_24BPP)for(v=Je,m=s*v,f=0;f<a;f++){for(f>=r&&(v=i,m=s*v),h=0,p=m;p--;)u[h++]=c[l++],u[h++]=c[l++],u[h++]=c[l++],u[h++]=255;d.putImageData(o,0,f*Je)}else throw new Error(`bad image kind: ${e.kind}`)}function Gp(d,e){if(e.bitmap){d.drawImage(e.bitmap,0,0);return}const t=e.height,s=e.width,i=t%Je,r=(t-i)/Je,a=i===0?r:r+1,o=d.createImageData(s,Je);let l=0;const h=e.data,c=o.data;for(let u=0;u<a;u++){const f=u<r?Je:i;({srcPos:l}=iy({src:h,srcPos:l,dest:c,width:s,height:f,nonBlackColor:0})),d.putImageData(o,0,u*Je)}}function Il(d,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of t)d[s]!==void 0&&(e[s]=d[s]);d.setLineDash!==void 0&&(e.setLineDash(d.getLineDash()),e.lineDashOffset=d.lineDashOffset)}function td(d){d.strokeStyle=d.fillStyle="#000000",d.fillRule="nonzero",d.globalAlpha=1,d.lineWidth=1,d.lineCap="butt",d.lineJoin="miter",d.miterLimit=10,d.globalCompositeOperation="source-over",d.font="10px sans-serif",d.setLineDash!==void 0&&(d.setLineDash([]),d.lineDashOffset=0);const{filter:e}=d;e!=="none"&&e!==""&&(d.filter="none")}function Vp(d,e){if(e)return!0;G.singularValueDecompose2dScale(d,ms);const t=Math.fround(Ti.pixelRatio*gr.PDF_TO_CSS_UNITS);return ms[0]<=t&&ms[1]<=t}const oy=["butt","round","square"],ly=["miter","round","bevel"],hy={},Wp={};var Qs,lf,hf,cf;const bp=class bp{constructor(e,t,s,i,r,{optionalContentConfig:a,markedContentStack:o=null},l,h,c){y(this,Qs);this.ctx=e,this.current=new jp(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=s,this.canvasFactory=i,this.filterFactory=r,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=a,this.cachedCanvases=new ay(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=h,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=c??null}getObject(e,t,s=null){var i;return typeof t=="string"?((i=this.dependencyTracker)==null||i.recordNamedDependency(e,t),t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t)):s}beginDrawing({transform:e,viewport:t,transparency:s=!1,background:i=null}){const r=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,r,a),this.ctx.fillStyle=o,s){const l=this.cachedCanvases.getCanvas("transparent",r,a);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...Ut(this.compositeCtx))}this.ctx.save(),td(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Ut(this.ctx)}executeOperatorList(e,t,s,i,r){var b;const a=e.argsArray,o=e.fnArray;let l=t||0;const h=a.length;if(h===l)return l;const c=h-l>$p&&typeof s=="function",u=c?Date.now()+ny:0;let f=0;const p=this.commonObjs,v=this.objs;let m,w;for(;;){if(i!==void 0&&l===i.nextBreakPoint)return i.breakIt(l,s),l;if(!r||r(l))if(m=o[l],w=a[l]??null,m!==eh.dependency)w===null?this[m](l):this[m](l,...w);else for(const S of w){(b=this.dependencyTracker)==null||b.recordNamedData(S,l);const E=S.startsWith("g_")?p:v;if(!E.has(S))return E.get(S,s),l}if(l++,l===h)return l;if(c&&++f>$p){if(Date.now()>u)return s(),l;f=0}}}endDrawing(){A(this,Qs,lf).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),A(this,Qs,hf).call(this)}_scaleImage(e,t){const s=e.width??e.displayWidth,i=e.height??e.displayHeight;let r=Math.max(Math.hypot(t[0],t[1]),1),a=Math.max(Math.hypot(t[2],t[3]),1),o=s,l=i,h="prescale1",c,u;for(;r>2&&o>1||a>2&&l>1;){let f=o,p=l;r>2&&o>1&&(f=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),r/=o/f),a>2&&l>1&&(p=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,a/=l/p),c=this.cachedCanvases.getCanvas(h,f,p),u=c.context,u.clearRect(0,0,f,p),u.drawImage(e,0,0,o,l,0,0,f,p),e=c.canvas,o=f,l=p,h=h==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:o,paintHeight:l}}_createMaskCanvas(e,t){var M,D;const s=this.ctx,{width:i,height:r}=t,a=this.current.fillColor,o=this.current.patternFill,l=Ut(s);let h,c,u,f;if((t.bitmap||t.data)&&t.count>1){const O=t.bitmap||t.data.buffer;c=JSON.stringify(o?l:[l.slice(0,4),a]),h=this._cachedBitmapsMap.get(O),h||(h=new Map,this._cachedBitmapsMap.set(O,h));const N=h.get(c);if(N&&!o){const B=Math.round(Math.min(l[0],l[2])+l[4]),W=Math.round(Math.min(l[1],l[3])+l[5]);return(M=this.dependencyTracker)==null||M.recordDependencies(e,ws.transformAndFill),{canvas:N,offsetX:B,offsetY:W}}u=N}u||(f=this.cachedCanvases.getCanvas("maskCanvas",i,r),Gp(f.context,t));let p=G.transform(l,[1/i,0,0,-1/r,0,0]);p=G.transform(p,[1,0,0,1,0,-r]);const v=Qa.slice();G.axialAlignedBoundingBox([0,0,i,r],p,v);const[m,w,b,S]=v,E=Math.round(b-m)||1,T=Math.round(S-w)||1,x=this.cachedCanvases.getCanvas("fillCanvas",E,T),C=x.context,R=m,I=w;C.translate(-R,-I),C.transform(...p),u||(u=this._scaleImage(f.canvas,Zs(C)),u=u.img,h&&o&&h.set(c,u)),C.imageSmoothingEnabled=Vp(Ut(C),t.interpolate),qc(C,u,0,0,u.width,u.height,0,0,i,r),C.globalCompositeOperation="source-in";const P=G.transform(Zs(C),[1,0,0,1,-R,-I]);return C.fillStyle=o?a.getPattern(s,this,P,Ae.FILL,e):a,C.fillRect(0,0,i,r),h&&!o&&(this.cachedCanvases.delete("fillCanvas"),h.set(c,x.canvas)),(D=this.dependencyTracker)==null||D.recordDependencies(e,ws.transformAndFill),{canvas:x.canvas,offsetX:Math.round(R),offsetY:Math.round(I)}}setLineWidth(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("lineWidth",e),t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("lineCap",e),this.ctx.lineCap=oy[t]}setLineJoin(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("lineJoin",e),this.ctx.lineJoin=ly[t]}setMiterLimit(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("miterLimit",e),this.ctx.miterLimit=t}setDash(e,t,s){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("dash",e);const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(t),i.lineDashOffset=s)}setRenderingIntent(e,t){}setFlatness(e,t){}setGState(e,t){var s,i,r,a,o;for(const[l,h]of t)switch(l){case"LW":this.setLineWidth(e,h);break;case"LC":this.setLineCap(e,h);break;case"LJ":this.setLineJoin(e,h);break;case"ML":this.setMiterLimit(e,h);break;case"D":this.setDash(e,h[0],h[1]);break;case"RI":this.setRenderingIntent(e,h);break;case"FL":this.setFlatness(e,h);break;case"Font":this.setFont(e,h[0],h[1]);break;case"CA":(s=this.dependencyTracker)==null||s.recordSimpleData("strokeAlpha",e),this.current.strokeAlpha=h;break;case"ca":(i=this.dependencyTracker)==null||i.recordSimpleData("fillAlpha",e),this.ctx.globalAlpha=this.current.fillAlpha=h;break;case"BM":(r=this.dependencyTracker)==null||r.recordSimpleData("globalCompositeOperation",e),this.ctx.globalCompositeOperation=h;break;case"SMask":(a=this.dependencyTracker)==null||a.recordSimpleData("SMask",e),this.current.activeSMask=h?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":(o=this.dependencyTracker)==null||o.recordSimpleData("filter",e),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(h);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(e){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,s=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,r=this.cachedCanvases.getCanvas(i,t,s);this.suspendedCtx=this.ctx;const a=this.ctx=r.context;a.setTransform(this.suspendedCtx.getTransform()),Il(this.suspendedCtx,a),ry(a,this.suspendedCtx),this.setGState(e,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Il(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,s,i){const r=i[0],a=i[1],o=i[2]-r,l=i[3]-a;o===0||l===0||(this.genericComposeSMask(t.context,s,o,l,t.subtype,t.backdrop,t.transferMap,r,a,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(s.canvas,0,0),e.restore())}genericComposeSMask(e,t,s,i,r,a,o,l,h,c,u){let f=e.canvas,p=l-c,v=h-u;if(a)if(p<0||v<0||p+s>f.width||v+i>f.height){const w=this.cachedCanvases.getCanvas("maskExtension",s,i),b=w.context;b.drawImage(f,-p,-v),b.globalCompositeOperation="destination-atop",b.fillStyle=a,b.fillRect(0,0,s,i),b.globalCompositeOperation="source-over",f=w.canvas,p=v=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const w=new Path2D;w.rect(p,v,s,i),e.clip(w),e.globalCompositeOperation="destination-atop",e.fillStyle=a,e.fillRect(p,v,s,i),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),r==="Alpha"&&o?t.filter=this.filterFactory.addAlphaFilter(o):r==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(o));const m=new Path2D;m.rect(l,h,s,i),t.clip(m),t.globalCompositeOperation="destination-in",t.drawImage(f,p,v,s,i,l,h,s,i),t.restore()}save(e){var s;this.inSMaskMode&&Il(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone(),(s=this.dependencyTracker)==null||s.save(e)}restore(e){var t;if((t=this.dependencyTracker)==null||t.restore(e),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&Il(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,s,i,r,a,o){var l;(l=this.dependencyTracker)==null||l.recordIncrementalData("transform",e),this.ctx.transform(t,s,i,r,a,o),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,s,i){let[r]=s;if(!i){r||(r=s[0]=new Path2D),this[t](e,r);return}if(this.dependencyTracker!==null){const a=t===eh.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(e).recordBBox(e,this.ctx,i[0]-a,i[2]+a,i[1]-a,i[3]+a).recordDependencies(e,["transform"])}if(!(r instanceof Path2D)){const a=s[0]=new Path2D;for(let o=0,l=r.length;o<l;)switch(r[o++]){case Xc.moveTo:a.moveTo(r[o++],r[o++]);break;case Xc.lineTo:a.lineTo(r[o++],r[o++]);break;case Xc.curveTo:a.bezierCurveTo(r[o++],r[o++],r[o++],r[o++],r[o++],r[o++]);break;case Xc.closePath:a.closePath();break;default:Q(`Unrecognized drawing path operator: ${r[o-1]}`);break}r=a}G.axialAlignedBoundingBox(i,Ut(this.ctx),this.current.minMax),this[t](e,r),this._pathStartIdx=e}closePath(e){this.ctx.closePath()}stroke(e,t,s=!0){var a;const i=this.ctx,r=this.current.strokeColor;if(i.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof r=="object"&&(r!=null&&r.getPattern)){const o=r.isModifyingCurrentTransform()?i.getTransform():null;if(i.save(),i.strokeStyle=r.getPattern(i,this,Zs(i),Ae.STROKE,e),o){const l=new Path2D;l.addPath(t,i.getTransform().invertSelf().multiplySelf(o)),t=l}this.rescaleAndStroke(t,!1),i.restore()}else this.rescaleAndStroke(t,!0);(a=this.dependencyTracker)==null||a.recordDependencies(e,ws.stroke),s&&this.consumePath(e,t,this.current.getClippedPathBoundingBox(Ae.STROKE,Ut(this.ctx))),i.globalAlpha=this.current.fillAlpha}closeStroke(e,t){this.stroke(e,t)}fill(e,t,s=!0){var h,c,u;const i=this.ctx,r=this.current.fillColor,a=this.current.patternFill;let o=!1;if(a){const f=r.isModifyingCurrentTransform()?i.getTransform():null;if((h=this.dependencyTracker)==null||h.save(e),i.save(),i.fillStyle=r.getPattern(i,this,Zs(i),Ae.FILL,e),f){const p=new Path2D;p.addPath(t,i.getTransform().invertSelf().multiplySelf(f)),t=p}o=!0}const l=this.current.getClippedPathBoundingBox();this.contentVisible&&l!==null&&(this.pendingEOFill?(i.fill(t,"evenodd"),this.pendingEOFill=!1):i.fill(t)),(c=this.dependencyTracker)==null||c.recordDependencies(e,ws.fill),o&&(i.restore(),(u=this.dependencyTracker)==null||u.restore(e)),s&&this.consumePath(e,t,l)}eoFill(e,t){this.pendingEOFill=!0,this.fill(e,t)}fillStroke(e,t){this.fill(e,t,!1),this.stroke(e,t,!1),this.consumePath(e,t)}eoFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}closeFillStroke(e,t){this.fillStroke(e,t)}closeEOFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}endPath(e,t){this.consumePath(e,t)}rawFillPath(e,t){var s;this.ctx.fill(t),(s=this.dependencyTracker)==null||s.recordDependencies(e,ws.rawFillPath).recordOperation(e)}clip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=hy}eoClip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=Wp}beginText(e){var t;this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,(t=this.dependencyTracker)==null||t.recordOpenMarker(e).resetIncrementalData("sameLineText").resetIncrementalData("moveText",e)}endText(e){const t=this.pendingTextPaths,s=this.ctx;if(this.dependencyTracker){const{dependencyTracker:i}=this;t!==void 0&&i.recordFutureForcedDependency("textClip",i.getOpenMarker()).recordFutureForcedDependency("textClip",e),i.recordCloseMarker(e)}if(t!==void 0){const i=new Path2D,r=s.getTransform().invertSelf();for(const{transform:a,x:o,y:l,fontSize:h,path:c}of t)c&&i.addPath(c,new DOMMatrix(a).preMultiplySelf(r).translate(o,l).scale(h,-h));s.clip(i)}delete this.pendingTextPaths}setCharSpacing(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("charSpacing",e),this.current.charSpacing=t}setWordSpacing(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("wordSpacing",e),this.current.wordSpacing=t}setHScale(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("hScale",e),this.current.textHScale=t/100}setLeading(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("leading",e),this.current.leading=-t}setFont(e,t,s){var u,f;(u=this.dependencyTracker)==null||u.recordSimpleData("font",e).recordSimpleDataFromNamed("fontObj",t,e);const i=this.commonObjs.get(t),r=this.current;if(!i)throw new Error(`Can't find font for ${t}`);if(r.fontMatrix=i.fontMatrix||Du,(r.fontMatrix[0]===0||r.fontMatrix[3]===0)&&Q("Invalid font matrix for font "+t),s<0?(s=-s,r.fontDirection=-1):r.fontDirection=1,this.current.font=i,this.current.fontSize=s,i.isType3Font)return;const a=i.loadedName||"sans-serif",o=((f=i.systemFontInfo)==null?void 0:f.css)||`"${a}", ${i.fallbackName}`;let l="normal";i.black?l="900":i.bold&&(l="bold");const h=i.italic?"italic":"normal";let c=s;s<Up?c=Up:s>Hp&&(c=Hp),this.current.fontSizeScale=s/c,this.ctx.font=`${h} ${l} ${c}px ${o}`}setTextRenderingMode(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("textRenderingMode",e),this.current.textRenderingMode=t}setTextRise(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("textRise",e),this.current.textRise=t}moveText(e,t,s){var i;(i=this.dependencyTracker)==null||i.resetIncrementalData("sameLineText").recordIncrementalData("moveText",e),this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=s}setLeadingMoveText(e,t,s){this.setLeading(e,-s),this.moveText(e,t,s)}setTextMatrix(e,t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("textMatrix",e);const{current:s}=this;s.textMatrix=t,s.textMatrixScale=Math.hypot(t[0],t[1]),s.x=s.lineX=0,s.y=s.lineY=0}nextLine(e){var t;this.moveText(e,0,this.current.leading),(t=this.dependencyTracker)==null||t.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??e)}paintChar(e,t,s,i,r,a){var b,S,E,T;const o=this.ctx,l=this.current,h=l.font,c=l.textRenderingMode,u=l.fontSize/l.fontSizeScale,f=c&pe.FILL_STROKE_MASK,p=!!(c&pe.ADD_TO_PATH_FLAG),v=l.patternFill&&!h.missingFile,m=l.patternStroke&&!h.missingFile;let w;if((h.disableFontFace||p||v||m)&&!h.missingFile&&(w=h.getPathGenerator(this.commonObjs,t)),w&&(h.disableFontFace||v||m)){o.save(),o.translate(s,i),o.scale(u,-u),(b=this.dependencyTracker)==null||b.recordCharacterBBox(e,o,h);let x;if(f===pe.FILL||f===pe.FILL_STROKE)if(r){x=o.getTransform(),o.setTransform(...r);const C=A(this,Qs,cf).call(this,w,x,r);o.fill(C)}else o.fill(w);if(f===pe.STROKE||f===pe.FILL_STROKE)if(a){x||(x=o.getTransform()),o.setTransform(...a);const{a:C,b:R,c:I,d:P}=x,M=G.inverseTransform(a),D=G.transform([C,R,I,P,0,0],M);G.singularValueDecompose2dScale(D,ms),o.lineWidth*=Math.max(ms[0],ms[1])/u,o.stroke(A(this,Qs,cf).call(this,w,x,a))}else o.lineWidth/=u,o.stroke(w);o.restore()}else(f===pe.FILL||f===pe.FILL_STROKE)&&(o.fillText(t,s,i),(S=this.dependencyTracker)==null||S.recordCharacterBBox(e,o,h,u,s,i,()=>o.measureText(t))),(f===pe.STROKE||f===pe.FILL_STROKE)&&(this.dependencyTracker&&((E=this.dependencyTracker)==null||E.recordCharacterBBox(e,o,h,u,s,i,()=>o.measureText(t)).recordDependencies(e,ws.stroke)),o.strokeText(t,s,i));p&&((this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Ut(o),x:s,y:i,fontSize:u,path:w}),(T=this.dependencyTracker)==null||T.recordCharacterBBox(e,o,h,u,s,i))}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let s=!1;for(let i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){s=!0;break}return lt(this,"isFontSubpixelAAEnabled",s)}showText(e,t){var I,P,M,D;this.dependencyTracker&&(this.dependencyTracker.recordDependencies(e,ws.showText).resetBBox(e),this.current.textRenderingMode&pe.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",e).inheritPendingDependenciesAsFutureForcedDependencies());const s=this.current,i=s.font;if(i.isType3Font){this.showType3Text(e,t),(I=this.dependencyTracker)==null||I.recordShowTextOperation(e);return}const r=s.fontSize;if(r===0){(P=this.dependencyTracker)==null||P.recordOperation(e);return}const a=this.ctx,o=s.fontSizeScale,l=s.charSpacing,h=s.wordSpacing,c=s.fontDirection,u=s.textHScale*c,f=t.length,p=i.vertical,v=p?1:-1,m=i.defaultVMetrics,w=r*s.fontMatrix[0],b=s.textRenderingMode===pe.FILL&&!i.disableFontFace&&!s.patternFill;a.save(),s.textMatrix&&a.transform(...s.textMatrix),a.translate(s.x,s.y+s.textRise),c>0?a.scale(u,-1):a.scale(u,1);let S,E;if(s.patternFill){a.save();const O=s.fillColor.getPattern(a,this,Zs(a),Ae.FILL,e);S=Ut(a),a.restore(),a.fillStyle=O}if(s.patternStroke){a.save();const O=s.strokeColor.getPattern(a,this,Zs(a),Ae.STROKE,e);E=Ut(a),a.restore(),a.strokeStyle=O}let T=s.lineWidth;const x=s.textMatrixScale;if(x===0||T===0){const O=s.textRenderingMode&pe.FILL_STROKE_MASK;(O===pe.STROKE||O===pe.FILL_STROKE)&&(T=this.getSinglePixelWidth())}else T/=x;if(o!==1&&(a.scale(o,o),T/=o),a.lineWidth=T,i.isInvalidPDFjsFont){const O=[];let N=0;for(const W of t)O.push(W.unicode),N+=W.width;const B=O.join("");if(a.fillText(B,0,0),this.dependencyTracker!==null){const W=a.measureText(B);this.dependencyTracker.recordBBox(e,this.ctx,-W.actualBoundingBoxLeft,W.actualBoundingBoxRight,-W.actualBoundingBoxAscent,W.actualBoundingBoxDescent).recordShowTextOperation(e)}s.x+=N*w*u,a.restore(),this.compose();return}let C=0,R;for(R=0;R<f;++R){const O=t[R];if(typeof O=="number"){C+=v*O*r/1e3;continue}let N=!1;const B=(O.isSpace?h:0)+l,W=O.fontChar,_=O.accent;let L,X,Z=O.width;if(p){const q=O.vmetric||m,ot=-(O.vmetric?q[1]:Z*.5)*w,yt=q[2]*w;Z=q?-q[0]:Z,L=ot/o,X=(C+yt)/o}else L=C/o,X=0;let pt;if(i.remeasure&&Z>0){pt=a.measureText(W);const q=pt.width*1e3/r*o;if(Z<q&&this.isFontSubpixelAAEnabled){const ot=Z/q;N=!0,a.save(),a.scale(ot,1),L/=ot}else Z!==q&&(L+=(Z-q)/2e3*r/o)}if(this.contentVisible&&(O.isInFont||i.missingFile)){if(b&&!_)a.fillText(W,L,X),(M=this.dependencyTracker)==null||M.recordCharacterBBox(e,a,pt?{bbox:null}:i,r/o,L,X,()=>pt??a.measureText(W));else if(this.paintChar(e,W,L,X,S,E),_){const q=L+r*_.offset.x/o,ot=X-r*_.offset.y/o;this.paintChar(e,_.fontChar,q,ot,S,E)}}const $t=p?Z*w-B*c:Z*w+B*c;C+=$t,N&&a.restore()}p?s.y-=C:s.x+=C*u,a.restore(),this.compose(),(D=this.dependencyTracker)==null||D.recordShowTextOperation(e)}showType3Text(e,t){const s=this.ctx,i=this.current,r=i.font,a=i.fontSize,o=i.fontDirection,l=r.vertical?1:-1,h=i.charSpacing,c=i.wordSpacing,u=i.textHScale*o,f=i.fontMatrix||Du,p=t.length,v=i.textRenderingMode===pe.INVISIBLE;let m,w,b,S;if(v||a===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,s.save(),i.textMatrix&&s.transform(...i.textMatrix),s.translate(i.x,i.y+i.textRise),s.scale(u,o);const E=this.dependencyTracker;for(this.dependencyTracker=E?new Hd(E,e):null,m=0;m<p;++m){if(w=t[m],typeof w=="number"){S=l*w*a/1e3,this.ctx.translate(S,0),i.x+=S*u;continue}const T=(w.isSpace?c:0)+h,x=r.charProcOperatorList[w.operatorListId];x?this.contentVisible&&(this.save(),s.scale(a,a),s.transform(...f),this.executeOperatorList(x),this.restore()):Q(`Type3 character "${w.operatorListId}" is not available.`);const C=[w.width,0];G.applyTransform(C,f),b=C[0]*a+T,s.translate(b,0),i.x+=b*u}s.restore(),E&&(this.dependencyTracker=E)}setCharWidth(e,t,s){}setCharWidthAndBounds(e,t,s,i,r,a,o){var h;const l=new Path2D;l.rect(i,r,a-i,o-r),this.ctx.clip(l),(h=this.dependencyTracker)==null||h.recordBBox(e,this.ctx,i,a,r,o).recordClipBox(e,this.ctx,i,a,r,o),this.endPath(e)}getColorN_Pattern(e,t){let s;if(t[0]==="TilingPattern"){const i=this.baseTransform||Ut(this.ctx),r={createCanvasGraphics:(a,o)=>new bp(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new Hd(this.dependencyTracker,o,!0):null)};s=new of(t,this.ctx,r,i)}else s=this._getPattern(e,t[1],t[2]);return s}setStrokeColorN(e,...t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("strokeColor",e),this.current.strokeColor=this.getColorN_Pattern(e,t),this.current.patternStroke=!0}setFillColorN(e,...t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("fillColor",e),this.current.fillColor=this.getColorN_Pattern(e,t),this.current.patternFill=!0}setStrokeRGBColor(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t,s=null){let i;return this.cachedPatterns.has(t)?i=this.cachedPatterns.get(t):(i=sy(this.getObject(e,t)),this.cachedPatterns.set(t,i)),s&&(i.matrix=s),i}shadingFill(e,t){var a;if(!this.contentVisible)return;const s=this.ctx;this.save(e);const i=this._getPattern(e,t);s.fillStyle=i.getPattern(s,this,Zs(s),Ae.SHADING,e);const r=Zs(s);if(r){const{width:o,height:l}=s.canvas,h=Qa.slice();G.axialAlignedBoundingBox([0,0,o,l],r,h);const[c,u,f,p]=h;this.ctx.fillRect(c,u,f-c,p-u)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);(a=this.dependencyTracker)==null||a.resetBBox(e).recordFullPageBBox(e).recordDependencies(e,ws.transform).recordDependencies(e,ws.fill).recordOperation(e),this.compose(this.current.getClippedPathBoundingBox()),this.restore(e)}beginInlineImage(){It("Should not call beginInlineImage")}beginImageData(){It("Should not call beginImageData")}paintFormXObjectBegin(e,t,s){var i;if(this.contentVisible&&(this.save(e),this.baseTransformStack.push(this.baseTransform),t&&this.transform(e,...t),this.baseTransform=Ut(this.ctx),s)){G.axialAlignedBoundingBox(s,this.baseTransform,this.current.minMax);const[r,a,o,l]=s,h=new Path2D;h.rect(r,a,o-r,l-a),this.ctx.clip(h),(i=this.dependencyTracker)==null||i.recordClipBox(e,this.ctx,r,o,a,l),this.endPath(e)}}paintFormXObjectEnd(e){this.contentVisible&&(this.restore(e),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e,t){var E;if(!this.contentVisible)return;this.save(e),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const s=this.ctx;t.isolated||mu("TODO: Support non-isolated groups."),t.knockout&&Q("Knockout groups not supported.");const i=Ut(s);if(t.matrix&&s.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let r=Qa.slice();G.axialAlignedBoundingBox(t.bbox,Ut(s),r);const a=[0,0,s.canvas.width,s.canvas.height];r=G.intersect(r,a)||[0,0,0,0];const o=Math.floor(r[0]),l=Math.floor(r[1]),h=Math.max(Math.ceil(r[2])-o,1),c=Math.max(Math.ceil(r[3])-l,1);this.current.startNewPathAndClipBox([0,0,h,c]);let u="groupAt"+this.groupLevel;t.smask&&(u+="_smask_"+this.smaskCounter++%2);const f=this.cachedCanvases.getCanvas(u,h,c),p=f.context;p.translate(-o,-l),p.transform(...i);let v=new Path2D;const[m,w,b,S]=t.bbox;if(v.rect(m,w,b-m,S-w),t.matrix){const T=new Path2D;T.addPath(v,new DOMMatrix(t.matrix)),v=T}p.clip(v),t.smask&&this.smaskStack.push({canvas:f.canvas,context:p,offsetX:o,offsetY:l,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}),(!t.smask||this.dependencyTracker)&&(s.setTransform(1,0,0,1,0,0),s.translate(o,l),s.save()),Il(s,p),this.ctx=p,(E=this.dependencyTracker)==null||E.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(s),this.setGState(e,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(s),this.groupLevel++}endGroup(e,t){var r;if(!this.contentVisible)return;this.groupLevel--;const s=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,(r=this.dependencyTracker)==null||r.popBaseTransform(),t.smask)this.tempSMask=this.smaskStack.pop(),this.restore(e),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const a=Ut(this.ctx);this.restore(e),this.ctx.save(),this.ctx.setTransform(...a);const o=Qa.slice();G.axialAlignedBoundingBox([0,0,s.canvas.width,s.canvas.height],a,o),this.ctx.drawImage(s.canvas,0,0),this.ctx.restore(),this.compose(o)}}beginAnnotation(e,t,s,i,r,a){if(A(this,Qs,lf).call(this),td(this.ctx),this.ctx.save(),this.save(e),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),s){const o=s[2]-s[0],l=s[3]-s[1];if(a&&this.annotationCanvasMap){i=i.slice(),i[4]-=s[0],i[5]-=s[1],s=s.slice(),s[0]=s[1]=0,s[2]=o,s[3]=l,G.singularValueDecompose2dScale(Ut(this.ctx),ms);const{viewportScale:h}=this,c=Math.ceil(o*this.outputScaleX*h),u=Math.ceil(l*this.outputScaleY*h);this.annotationCanvas=this.canvasFactory.create(c,u);const{canvas:f,context:p}=this.annotationCanvas;this.annotationCanvasMap.set(t,f),this.annotationCanvas.savedCtx=this.ctx,this.ctx=p,this.ctx.save(),this.ctx.setTransform(ms[0],0,0,-ms[1],0,l*ms[1]),td(this.ctx)}else{td(this.ctx),this.endPath(e);const h=new Path2D;h.rect(s[0],s[1],o,l),this.ctx.clip(h)}}this.current=new jp(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(e,...i),this.transform(e,...r)}endAnnotation(e){this.annotationCanvas&&(this.ctx.restore(),A(this,Qs,hf).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e,t){var o;if(!this.contentVisible)return;const s=t.count;t=this.getObject(e,t.data,t),t.count=s;const i=this.ctx,r=this._createMaskCanvas(e,t),a=r.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(a,r.offsetX,r.offsetY),(o=this.dependencyTracker)==null||o.resetBBox(e).recordBBox(e,this.ctx,r.offsetX,r.offsetX+a.width,r.offsetY,r.offsetY+a.height).recordOperation(e),i.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,s,i=0,r=0,a,o){var u,f,p;if(!this.contentVisible)return;t=this.getObject(e,t.data,t);const l=this.ctx;l.save();const h=Ut(l);l.transform(s,i,r,a,0,0);const c=this._createMaskCanvas(e,t);l.setTransform(1,0,0,1,c.offsetX-h[4],c.offsetY-h[5]),(u=this.dependencyTracker)==null||u.resetBBox(e);for(let v=0,m=o.length;v<m;v+=2){const w=G.transform(h,[s,i,r,a,o[v],o[v+1]]);l.drawImage(c.canvas,w[4],w[5]),(f=this.dependencyTracker)==null||f.recordBBox(e,this.ctx,w[4],w[4]+c.canvas.width,w[5],w[5]+c.canvas.height)}l.restore(),this.compose(),(p=this.dependencyTracker)==null||p.recordOperation(e)}paintImageMaskXObjectGroup(e,t){var a,o,l;if(!this.contentVisible)return;const s=this.ctx,i=this.current.fillColor,r=this.current.patternFill;(a=this.dependencyTracker)==null||a.resetBBox(e).recordDependencies(e,ws.transformAndFill);for(const h of t){const{data:c,width:u,height:f,transform:p}=h,v=this.cachedCanvases.getCanvas("maskCanvas",u,f),m=v.context;m.save();const w=this.getObject(e,c,h);Gp(m,w),m.globalCompositeOperation="source-in",m.fillStyle=r?i.getPattern(m,this,Zs(s),Ae.FILL,e):i,m.fillRect(0,0,u,f),m.restore(),s.save(),s.transform(...p),s.scale(1,-1),qc(s,v.canvas,0,0,u,f,0,-1,1,1),(o=this.dependencyTracker)==null||o.recordBBox(e,s,0,u,0,f),s.restore()}this.compose(),(l=this.dependencyTracker)==null||l.recordOperation(e)}paintImageXObject(e,t){if(!this.contentVisible)return;const s=this.getObject(e,t);if(!s){Q("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e,s)}paintImageXObjectRepeat(e,t,s,i,r){if(!this.contentVisible)return;const a=this.getObject(e,t);if(!a){Q("Dependent image isn't ready yet");return}const o=a.width,l=a.height,h=[];for(let c=0,u=r.length;c<u;c+=2)h.push({transform:[s,0,0,i,r[c],r[c+1]],x:0,y:0,w:o,h:l});this.paintInlineImageXObjectGroup(e,a,h)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:s,height:i}=e,r=this.cachedCanvases.getCanvas("inlineImage",s,i),a=r.context;return a.filter=this.current.transferMaps,a.drawImage(t,0,0),a.filter="none",r.canvas}paintInlineImageXObject(e,t){var h;if(!this.contentVisible)return;const s=t.width,i=t.height,r=this.ctx;this.save(e);const{filter:a}=r;a!=="none"&&a!==""&&(r.filter="none"),r.scale(1/s,-1/i);let o;if(t.bitmap)o=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)o=t;else{const u=this.cachedCanvases.getCanvas("inlineImage",s,i).context;zp(u,t),o=this.applyTransferMapsToCanvas(u)}const l=this._scaleImage(o,Zs(r));r.imageSmoothingEnabled=Vp(Ut(r),t.interpolate),(h=this.dependencyTracker)==null||h.resetBBox(e).recordBBox(e,r,0,s,-i,0).recordDependencies(e,ws.imageXObject).recordOperation(e),qc(r,l.img,0,0,l.paintWidth,l.paintHeight,0,-i,s,i),this.compose(),this.restore(e)}paintInlineImageXObjectGroup(e,t,s){var a,o,l;if(!this.contentVisible)return;const i=this.ctx;let r;if(t.bitmap)r=t.bitmap;else{const h=t.width,c=t.height,f=this.cachedCanvases.getCanvas("inlineImage",h,c).context;zp(f,t),r=this.applyTransferMapsToCanvas(f)}(a=this.dependencyTracker)==null||a.resetBBox(e);for(const h of s)i.save(),i.transform(...h.transform),i.scale(1,-1),qc(i,r,h.x,h.y,h.w,h.h,0,-1,1,1),(o=this.dependencyTracker)==null||o.recordBBox(e,i,0,1,-1,0),i.restore();(l=this.dependencyTracker)==null||l.recordOperation(e),this.compose()}paintSolidColorImageMask(e){var t;this.contentVisible&&((t=this.dependencyTracker)==null||t.resetBBox(e).recordBBox(e,this.ctx,0,1,0,1).recordDependencies(e,ws.fill).recordOperation(e),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e,t){}markPointProps(e,t,s){}beginMarkedContent(e,t){var s;(s=this.dependencyTracker)==null||s.beginMarkedContent(e),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t,s){var i;(i=this.dependencyTracker)==null||i.beginMarkedContent(e),t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(s)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(e){var t;(t=this.dependencyTracker)==null||t.endMarkedContent(e),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(e){}endCompat(e){}consumePath(e,t,s){var a,o;const i=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(s);const r=this.ctx;this.pendingClip?(i||(this.pendingClip===Wp?r.clip(t,"evenodd"):r.clip(t)),this.pendingClip=null,(a=this.dependencyTracker)==null||a.bboxToClipBoxDropOperation(e).recordFutureForcedDependency("clipPath",e)):(o=this.dependencyTracker)==null||o.recordOperation(e),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Ut(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),s=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(s,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:s,c:i,d:r}=this.ctx.getTransform();let a,o;if(s===0&&i===0){const l=Math.abs(t),h=Math.abs(r);if(l===h)if(e===0)a=o=1/l;else{const c=l*e;a=o=c<1?1/c:1}else if(e===0)a=1/l,o=1/h;else{const c=l*e,u=h*e;a=c<1?1/c:1,o=u<1?1/u:1}}else{const l=Math.abs(t*r-s*i),h=Math.hypot(t,s),c=Math.hypot(i,r);if(e===0)a=c/l,o=h/l;else{const u=e*l;a=c>u?c/u:1,o=h>u?h/u:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:s,current:{lineWidth:i}}=this,[r,a]=this.getScaleForStroking();if(r===a){s.lineWidth=(i||1)*r,s.stroke(e);return}const o=s.getLineDash();t&&s.save(),s.scale(r,a),Ru.a=1/r,Ru.d=1/a;const l=new Path2D;if(l.addPath(e,Ru),o.length>0){const h=Math.max(r,a);s.setLineDash(o.map(c=>c/h)),s.lineDashOffset/=h}s.lineWidth=i||1,s.stroke(l),t&&s.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};Qs=new WeakSet,lf=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},hf=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},cf=function(e,t,s){const i=new Path2D;return i.addPath(e,new DOMMatrix(s).invertSelf().multiplySelf(t)),i};let so=bp;for(const d in eh)so.prototype[d]!==void 0&&(so.prototype[eh[d]]=so.prototype[d]);var Mo,Oo,Nh,Lo,ud;const qa=class qa{constructor(e){y(this,Lo);y(this,Mo);y(this,Oo);y(this,Nh);g(this,Mo,e),g(this,Oo,new DataView(n(this,Mo))),g(this,Nh,new TextDecoder)}static write(e){const t=new TextEncoder,s={};let i=0;for(const h of qa.strings){const c=t.encode(e[h]);s[h]=c,i+=4+c.length}const r=new ArrayBuffer(i),a=new Uint8Array(r),o=new DataView(r);let l=0;for(const h of qa.strings){const c=s[h],u=c.length;o.setUint32(l,u),a.set(c,l+4),l+=4+u}return dt(l===r.byteLength,"CssFontInfo.write: Buffer overflow"),r}get fontFamily(){return A(this,Lo,ud).call(this,0)}get fontWeight(){return A(this,Lo,ud).call(this,1)}get italicAngle(){return A(this,Lo,ud).call(this,2)}};Mo=new WeakMap,Oo=new WeakMap,Nh=new WeakMap,Lo=new WeakSet,ud=function(e){dt(e<qa.strings.length,"Invalid string index");let t=0;for(let i=0;i<e;i++)t+=n(this,Oo).getUint32(t)+4;const s=n(this,Oo).getUint32(t);return n(this,Nh).decode(new Uint8Array(n(this,Mo),t+4,s))},k(qa,"strings",["fontFamily","fontWeight","italicAngle"]);let $d=qa;var Un,ui,Jr,Qr,Gl;const to=class to{constructor(e){y(this,Qr);y(this,Un);y(this,ui);y(this,Jr);g(this,Un,e),g(this,ui,new DataView(n(this,Un))),g(this,Jr,new TextDecoder)}static write(e){const t=new TextEncoder,s={};let i=0;for(const f of to.strings){const p=t.encode(e[f]);s[f]=p,i+=4+p.length}i+=4;let r,a,o=1+i;e.style&&(r=t.encode(e.style.style),a=t.encode(e.style.weight),o+=4+r.length+4+a.length);const l=new ArrayBuffer(o),h=new Uint8Array(l),c=new DataView(l);let u=0;c.setUint8(u++,e.guessFallback?1:0),c.setUint32(u,0),u+=4,i=0;for(const f of to.strings){const p=s[f],v=p.length;i+=4+v,c.setUint32(u,v),h.set(p,u+4),u+=4+v}return c.setUint32(u-i-4,i),e.style&&(c.setUint32(u,r.length),h.set(r,u+4),u+=4+r.length,c.setUint32(u,a.length),h.set(a,u+4),u+=4+a.length),dt(u<=l.byteLength,"SubstitionInfo.write: Buffer overflow"),l.transferToFixedLength(u)}get guessFallback(){return n(this,ui).getUint8(0)!==0}get css(){return A(this,Qr,Gl).call(this,0)}get loadedName(){return A(this,Qr,Gl).call(this,1)}get baseFontName(){return A(this,Qr,Gl).call(this,2)}get src(){return A(this,Qr,Gl).call(this,3)}get style(){let e=1;e+=4+n(this,ui).getUint32(e);const t=n(this,ui).getUint32(e),s=n(this,Jr).decode(new Uint8Array(n(this,Un),e+4,t));e+=4+t;const i=n(this,ui).getUint32(e),r=n(this,Jr).decode(new Uint8Array(n(this,Un),e+4,i));return{style:s,weight:r}}};Un=new WeakMap,ui=new WeakMap,Jr=new WeakMap,Qr=new WeakSet,Gl=function(e){dt(e<to.strings.length,"Invalid string index");let t=5;for(let i=0;i<e;i++)t+=n(this,ui).getUint32(t)+4;const s=n(this,ui).getUint32(t);return n(this,Jr).decode(new Uint8Array(n(this,Un),t+4,s))},k(to,"strings",["css","loadedName","baseFontName","src"]);let jd=to;var Fo,ko,No,Bo,es,fi,Bh,St,Vt,Ns,fd,Vl;const it=class it{constructor({data:e,extra:t}){y(this,Vt);y(this,fi);y(this,Bh);y(this,St);g(this,fi,e),g(this,Bh,new TextDecoder),g(this,St,new DataView(n(this,fi))),t&&Object.assign(this,t)}get black(){return A(this,Vt,Ns).call(this,0)}get bold(){return A(this,Vt,Ns).call(this,1)}get disableFontFace(){return A(this,Vt,Ns).call(this,2)}get fontExtraProperties(){return A(this,Vt,Ns).call(this,3)}get isInvalidPDFjsFont(){return A(this,Vt,Ns).call(this,4)}get isType3Font(){return A(this,Vt,Ns).call(this,5)}get italic(){return A(this,Vt,Ns).call(this,6)}get missingFile(){return A(this,Vt,Ns).call(this,7)}get remeasure(){return A(this,Vt,Ns).call(this,8)}get vertical(){return A(this,Vt,Ns).call(this,9)}get ascent(){return A(this,Vt,fd).call(this,0)}get defaultWidth(){return A(this,Vt,fd).call(this,1)}get descent(){return A(this,Vt,fd).call(this,2)}get bbox(){let e=n(it,ko);if(n(this,St).getUint8(e)===0)return;e+=1;const s=[];for(let i=0;i<4;i++)s.push(n(this,St).getInt16(e,!0)),e+=2;return s}get fontMatrix(){let e=n(it,No);if(n(this,St).getUint8(e)===0)return;e+=1;const s=[];for(let i=0;i<6;i++)s.push(n(this,St).getFloat64(e,!0)),e+=8;return s}get defaultVMetrics(){let e=n(it,Bo);if(n(this,St).getUint8(e)===0)return;e+=1;const s=[];for(let i=0;i<3;i++)s.push(n(this,St).getInt16(e,!0)),e+=2;return s}get fallbackName(){return A(this,Vt,Vl).call(this,0)}get loadedName(){return A(this,Vt,Vl).call(this,1)}get mimetype(){return A(this,Vt,Vl).call(this,2)}get name(){return A(this,Vt,Vl).call(this,3)}get data(){let e=n(it,es);const t=n(this,St).getUint32(e);e+=4+t;const s=n(this,St).getUint32(e);e+=4+s;const i=n(this,St).getUint32(e);e+=4+i;const r=n(this,St).getUint32(e);if(r!==0)return new Uint8Array(n(this,fi),e+4,r)}clearData(){let e=n(it,es);const t=n(this,St).getUint32(e);e+=4+t;const s=n(this,St).getUint32(e);e+=4+s;const i=n(this,St).getUint32(e);e+=4+i;const r=n(this,St).getUint32(e);new Uint8Array(n(this,fi),e+4,r).fill(0),n(this,St).setUint32(e,0)}get cssFontInfo(){let e=n(it,es);const t=n(this,St).getUint32(e);e+=4+t;const s=n(this,St).getUint32(e);e+=4+s;const i=n(this,St).getUint32(e);if(i===0)return null;const r=new Uint8Array(i);return r.set(new Uint8Array(n(this,fi),e+4,i)),new $d(r.buffer)}get systemFontInfo(){let e=n(it,es);const t=n(this,St).getUint32(e);e+=4+t;const s=n(this,St).getUint32(e);if(s===0)return null;const i=new Uint8Array(s);return i.set(new Uint8Array(n(this,fi),e+4,s)),new jd(i.buffer)}static write(e){const t=e.systemFontInfo?jd.write(e.systemFontInfo):null,s=e.cssFontInfo?$d.write(e.cssFontInfo):null,i=new TextEncoder,r={};let a=0;for(const m of it.strings)r[m]=i.encode(e[m]),a+=4+r[m].length;const o=n(it,es)+4+a+4+(t?t.byteLength:0)+4+(s?s.byteLength:0)+4+(e.data?e.data.length:0),l=new ArrayBuffer(o),h=new Uint8Array(l),c=new DataView(l);let u=0;const f=it.bools.length;let p=0,v=0;for(let m=0;m<f;m++){const w=e[it.bools[m]];p|=(w===void 0?0:w?2:1)<<v,v+=2,(v===8||m===f-1)&&(c.setUint8(u++,p),p=0,v=0)}dt(u===n(it,Fo),"FontInfo.write: Boolean properties offset mismatch");for(const m of it.numbers)c.setFloat64(u,e[m]),u+=8;if(dt(u===n(it,ko),"FontInfo.write: Number properties offset mismatch"),e.bbox){c.setUint8(u++,4);for(const m of e.bbox)c.setInt16(u,m,!0),u+=2}else c.setUint8(u++,0),u+=2*4;if(dt(u===n(it,No),"FontInfo.write: BBox properties offset mismatch"),e.fontMatrix){c.setUint8(u++,6);for(const m of e.fontMatrix)c.setFloat64(u,m,!0),u+=8}else c.setUint8(u++,0),u+=8*6;if(dt(u===n(it,Bo),"FontInfo.write: FontMatrix properties offset mismatch"),e.defaultVMetrics){c.setUint8(u++,1);for(const m of e.defaultVMetrics)c.setInt16(u,m,!0),u+=2}else c.setUint8(u++,0),u+=3*2;dt(u===n(it,es),"FontInfo.write: DefaultVMetrics properties offset mismatch"),c.setUint32(n(it,es),0),u+=4;for(const m of it.strings){const w=r[m],b=w.length;c.setUint32(u,b),h.set(w,u+4),u+=4+b}if(c.setUint32(n(it,es),u-n(it,es)-4),!t)c.setUint32(u,0),u+=4;else{const m=t.byteLength;c.setUint32(u,m),dt(u+4+m<=l.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),h.set(new Uint8Array(t),u+4),u+=4+m}if(!s)c.setUint32(u,0),u+=4;else{const m=s.byteLength;c.setUint32(u,m),dt(u+4+m<=l.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),h.set(new Uint8Array(s),u+4),u+=4+m}return e.data===void 0?(c.setUint32(u,0),u+=4):(c.setUint32(u,e.data.length),h.set(e.data,u+4),u+=4+e.data.length),dt(u<=l.byteLength,"FontInfo.write: Buffer overflow"),l.transferToFixedLength(u)}};Fo=new WeakMap,ko=new WeakMap,No=new WeakMap,Bo=new WeakMap,es=new WeakMap,fi=new WeakMap,Bh=new WeakMap,St=new WeakMap,Vt=new WeakSet,Ns=function(e){dt(e<it.bools.length,"Invalid boolean index");const t=Math.floor(e/4),s=e*2%8,i=n(this,St).getUint8(t)>>s&3;return i===0?void 0:i===2},fd=function(e){return dt(e<it.numbers.length,"Invalid number index"),n(this,St).getFloat64(n(it,Fo)+e*8)},Vl=function(e){dt(e<it.strings.length,"Invalid string index");let t=n(it,es)+4;for(let r=0;r<e;r++)t+=n(this,St).getUint32(t)+4;const s=n(this,St).getUint32(t),i=new Uint8Array(s);return i.set(new Uint8Array(n(this,fi),t+4,s)),n(this,Bh).decode(i)},k(it,"bools",["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"]),k(it,"numbers",["ascent","defaultWidth","descent"]),k(it,"strings",["fallbackName","loadedName","mimetype","name"]),y(it,Fo,Math.ceil(it.bools.length*2/8)),y(it,ko,n(it,Fo)+it.numbers.length*8),y(it,No,n(it,ko)+1+2*4),y(it,Bo,n(it,No)+1+8*6),y(it,es,n(it,Bo)+1+2*3);let df=it;var _h,Uh;class xi{static get workerPort(){return n(this,_h)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");g(this,_h,e)}static get workerSrc(){return n(this,Uh)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");g(this,Uh,e)}}_h=new WeakMap,Uh=new WeakMap,y(xi,_h,null),y(xi,Uh,"");var _o,Hh;class cy{constructor({parsedData:e,rawData:t}){y(this,_o);y(this,Hh);g(this,_o,e),g(this,Hh,t)}getRaw(){return n(this,Hh)}get(e){return n(this,_o).get(e)??null}[Symbol.iterator](){return n(this,_o).entries()}}_o=new WeakMap,Hh=new WeakMap;const Ya=Symbol("INTERNAL");var $h,jh,zh,Uo;class dy{constructor(e,{name:t,intent:s,usage:i,rbGroups:r}){y(this,$h,!1);y(this,jh,!1);y(this,zh,!1);y(this,Uo,!0);g(this,$h,!!(e&gs.DISPLAY)),g(this,jh,!!(e&gs.PRINT)),this.name=t,this.intent=s,this.usage=i,this.rbGroups=r}get visible(){if(n(this,zh))return n(this,Uo);if(!n(this,Uo))return!1;const{print:e,view:t}=this.usage;return n(this,$h)?(t==null?void 0:t.viewState)!=="OFF":n(this,jh)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,s=!1){e!==Ya&&It("Internal method `_setVisible` called."),g(this,zh,s),g(this,Uo,t)}}$h=new WeakMap,jh=new WeakMap,zh=new WeakMap,Uo=new WeakMap;var Hn,xt,Ho,$o,Gh,uf;class uy{constructor(e,t=gs.DISPLAY){y(this,Gh);y(this,Hn,null);y(this,xt,new Map);y(this,Ho,null);y(this,$o,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,g(this,$o,e.order);for(const s of e.groups)n(this,xt).set(s.id,new dy(t,s));if(e.baseState==="OFF")for(const s of n(this,xt).values())s._setVisible(Ya,!1);for(const s of e.on)n(this,xt).get(s)._setVisible(Ya,!0);for(const s of e.off)n(this,xt).get(s)._setVisible(Ya,!1);g(this,Ho,this.getHash())}}isVisible(e){if(n(this,xt).size===0)return!0;if(!e)return mu("Optional content group not defined."),!0;if(e.type==="OCG")return n(this,xt).has(e.id)?n(this,xt).get(e.id).visible:(Q(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return A(this,Gh,uf).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!n(this,xt).has(t))return Q(`Optional content group not found: ${t}`),!0;if(n(this,xt).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!n(this,xt).has(t))return Q(`Optional content group not found: ${t}`),!0;if(!n(this,xt).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!n(this,xt).has(t))return Q(`Optional content group not found: ${t}`),!0;if(!n(this,xt).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!n(this,xt).has(t))return Q(`Optional content group not found: ${t}`),!0;if(n(this,xt).get(t).visible)return!1}return!0}return Q(`Unknown optional content policy ${e.policy}.`),!0}return Q(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,s=!0){var r;const i=n(this,xt).get(e);if(!i){Q(`Optional content group not found: ${e}`);return}if(s&&t&&i.rbGroups.length)for(const a of i.rbGroups)for(const o of a)o!==e&&((r=n(this,xt).get(o))==null||r._setVisible(Ya,!1,!0));i._setVisible(Ya,!!t,!0),g(this,Hn,null)}setOCGState({state:e,preserveRB:t}){let s;for(const i of e){switch(i){case"ON":case"OFF":case"Toggle":s=i;continue}const r=n(this,xt).get(i);if(r)switch(s){case"ON":this.setVisibility(i,!0,t);break;case"OFF":this.setVisibility(i,!1,t);break;case"Toggle":this.setVisibility(i,!r.visible,t);break}}g(this,Hn,null)}get hasInitialVisibility(){return n(this,Ho)===null||this.getHash()===n(this,Ho)}getOrder(){return n(this,xt).size?n(this,$o)?n(this,$o).slice():[...n(this,xt).keys()]:null}getGroup(e){return n(this,xt).get(e)||null}getHash(){if(n(this,Hn)!==null)return n(this,Hn);const e=new kg;for(const[t,s]of n(this,xt))e.update(`${t}:${s.visible}`);return g(this,Hn,e.hexdigest())}[Symbol.iterator](){return n(this,xt).entries()}}Hn=new WeakMap,xt=new WeakMap,Ho=new WeakMap,$o=new WeakMap,Gh=new WeakSet,uf=function(e){const t=e.length;if(t<2)return!0;const s=e[0];for(let i=1;i<t;i++){const r=e[i];let a;if(Array.isArray(r))a=A(this,Gh,uf).call(this,r);else if(n(this,xt).has(r))a=n(this,xt).get(r).visible;else return Q(`Optional content group not found: ${r}`),!0;switch(s){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return s==="And"};class fy{constructor(e,{disableRange:t=!1,disableStream:s=!1}){dt(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:r,progressiveDone:a,contentDispositionFilename:o}=e;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=o,(r==null?void 0:r.length)>0){const l=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!s,this._isRangeSupported=!t,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((l,h)=>{this._onReceiveData({begin:l,chunk:h})}),e.addProgressListener((l,h)=>{this._onProgress({loaded:l,total:h})}),e.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const s=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const i=this._rangeReaders.some(function(r){return r._begin!==e?!1:(r._enqueue(s),!0)});dt(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,s,i,r;e.total===void 0?(s=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||s.call(t,{loaded:e.loaded}):(r=(i=this._fullRequestReader)==null?void 0:i.onProgress)==null||r.call(i,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){dt(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new py(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new gy(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeReaders.slice(0))s.cancel(e);this._pdfDataRangeTransport.abort()}}class py{constructor(e,t,s=!1,i=null){this._stream=e,this._done=s||!1,this._filename=lp(i)?i:null,this._queuedChunks=t||[],this._loaded=0;for(const r of this._queuedChunks)this._loaded+=r.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class gy{constructor(e,t,s){this._stream=e,this._begin=t,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function my(d){let e=!0,t=s("filename\\*","i").exec(d);if(t){t=t[1];let c=o(t);return c=unescape(c),c=l(c),c=h(c),r(c)}if(t=a(d),t){const c=h(t);return r(c)}if(t=s("filename","i").exec(d),t){t=t[1];let c=o(t);return c=h(c),r(c)}function s(c,u){return new RegExp("(?:^|;)\\s*"+c+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',u)}function i(c,u){if(c){if(!/^[\x00-\xFF]+$/.test(u))return u;try{const f=new TextDecoder(c,{fatal:!0}),p=Uc(u);u=f.decode(p),e=!1}catch{}}return u}function r(c){return e&&/[\x80-\xff]/.test(c)&&(c=i("utf-8",c),e&&(c=i("iso-8859-1",c))),c}function a(c){const u=[];let f;const p=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(f=p.exec(c))!==null;){let[,m,w,b]=f;if(m=parseInt(m,10),m in u){if(m===0)break;continue}u[m]=[w,b]}const v=[];for(let m=0;m<u.length&&m in u;++m){let[w,b]=u[m];b=o(b),w&&(b=unescape(b),m===0&&(b=l(b))),v.push(b)}return v.join("")}function o(c){if(c.startsWith('"')){const u=c.slice(1).split('\\"');for(let f=0;f<u.length;++f){const p=u[f].indexOf('"');p!==-1&&(u[f]=u[f].slice(0,p),u.length=f+1),u[f]=u[f].replaceAll(/\\(.)/g,"$1")}c=u.join('"')}return c}function l(c){const u=c.indexOf("'");if(u===-1)return c;const f=c.slice(0,u),v=c.slice(u+1).replace(/^[^']*'/,"");return i(f,v)}function h(c){return!c.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(c)?c:c.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(u,f,p,v){if(p==="q"||p==="Q")return v=v.replaceAll("_"," "),v=v.replaceAll(/=([0-9a-fA-F]{2})/g,function(m,w){return String.fromCharCode(parseInt(w,16))}),i(f,v);try{v=atob(v)}catch{}return i(f,v)})}return""}function Xg(d,e){const t=new Headers;if(!d||!e||typeof e!="object")return t;for(const s in e){const i=e[s];i!==void 0&&t.append(s,i)}return t}function yu(d){var e;return((e=URL.parse(d))==null?void 0:e.origin)??null}function Yg({responseHeaders:d,isHttp:e,rangeChunkSize:t,disableRange:s}){const i={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(d.get("Content-Length"),10);return!Number.isInteger(r)||(i.suggestedLength=r,r<=2*t)||s||!e||d.get("Accept-Ranges")!=="bytes"||(d.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function Kg(d){const e=d.get("Content-Disposition");if(e){let t=my(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(lp(t))return t}return null}function Gc(d,e){return new Nd(`Unexpected server response (${d}) while retrieving PDF "${e}".`,d,d===404||d===0&&e.startsWith("file:"))}function Jg(d){return d===200||d===206}function Qg(d,e,t){return{method:"GET",headers:d,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function Zg(d){return d instanceof Uint8Array?d.buffer:d instanceof ArrayBuffer?d:(Q(`getArrayBuffer - unexpected data format: ${d}`),new Uint8Array(d).buffer)}class vy{constructor(e){k(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=Xg(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return dt(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new yy(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new by(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class yy{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const s=new Headers(e.headers),i=t.url;fetch(i,Qg(s,this._withCredentials,this._abortController)).then(r=>{if(e._responseOrigin=yu(r.url),!Jg(r.status))throw Gc(r.status,i);this._reader=r.body.getReader(),this._headersCapability.resolve();const a=r.headers,{allowRangeRequests:o,suggestedLength:l}=Yg({responseHeaders:a,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=l||this._contentLength,this._filename=Kg(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new pr("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:Zg(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class by{constructor(e,t,s){this._stream=e,this._reader=null,this._loaded=0;const i=e.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const r=new Headers(e.headers);r.append("Range",`bytes=${t}-${s-1}`);const a=i.url;fetch(a,Qg(r,this._withCredentials,this._abortController)).then(o=>{const l=yu(o.url);if(l!==e._responseOrigin)throw new Error(`Expected range response-origin "${l}" to match "${e._responseOrigin}".`);if(!Jg(o.status))throw Gc(o.status,a);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:Zg(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const Pu=200,Iu=206;function Ay(d){const e=d.response;return typeof e!="string"?e:Uc(e).buffer}class wy{constructor({url:e,httpHeaders:t,withCredentials:s}){k(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=Xg(this.isHttp,t),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,s=this.currXhrId++,i=this.pendingRequests[s]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[r,a]of this.headers)t.setRequestHeader(r,a);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),i.expectedStatus=Iu):i.expectedStatus=Pu,t.responseType="arraybuffer",dt(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,s),t.onprogress=this.onProgress.bind(this,s),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),s}onProgress(e,t){var i;const s=this.pendingRequests[e];s&&((i=s.onProgress)==null||i.call(s,t))}onStateChange(e,t){const s=this.pendingRequests[e];if(!s)return;const i=s.xhr;if(i.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),i.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],i.status===0&&this.isHttp){s.onError(i.status);return}const r=i.status||Pu;if(!(r===Pu&&s.expectedStatus===Iu)&&r!==s.expectedStatus){s.onError(i.status);return}const o=Ay(i);if(r===Iu){const l=i.getResponseHeader("Content-Range"),h=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);h?s.onDone({begin:parseInt(h[1],10),chunk:o}):(Q('Missing or invalid "Content-Range" header.'),s.onError(0))}else o?s.onDone({begin:0,chunk:o}):s.onError(i.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class Ey{constructor(e){this._source=e,this._manager=new wy(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return dt(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new Sy(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const s=new xy(this._manager,e,t);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class Sy{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=yu(t.responseURL);const s=t.getAllResponseHeaders(),i=new Headers(s?s.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(o=>{const[l,...h]=o.split(": ");return[l,h.join(": ")]}):[]),{allowRangeRequests:r,suggestedLength:a}=Yg({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=Kg(i),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=Gc(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class xy{constructor(e,t,s){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:s,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=yu((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=Gc(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const Ty=/^[a-z][a-z0-9\-+.]+:/i;function Cy(d){if(Ty.test(d))return new URL(d);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(d))}class Ry{constructor(e){this.source=e,this.url=Cy(e.url),dt(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return dt(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new Py(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new Iy(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class Py{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=Gc(0,this._url.href)),this._storedError=i,this._headersCapability.reject(i)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new pr("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class Iy{constructor(e,t,s){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=e.source;this._isStreamingSupported=!i.disableStream;const r=process.getBuiltinModule("fs");this._setReadableStream(r.createReadStream(this._url,{start:t,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const Dl=Symbol("INITIAL_DATA");var ss,Vh,ff;class qg{constructor(){y(this,Vh);y(this,ss,Object.create(null))}get(e,t=null){if(t){const i=A(this,Vh,ff).call(this,e);return i.promise.then(()=>t(i.data)),null}const s=n(this,ss)[e];if(!s||s.data===Dl)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return s.data}has(e){const t=n(this,ss)[e];return!!t&&t.data!==Dl}delete(e){const t=n(this,ss)[e];return!t||t.data===Dl?!1:(delete n(this,ss)[e],!0)}resolve(e,t=null){const s=A(this,Vh,ff).call(this,e);s.data=t,s.resolve()}clear(){var e;for(const t in n(this,ss)){const{data:s}=n(this,ss)[t];(e=s==null?void 0:s.bitmap)==null||e.close()}g(this,ss,Object.create(null))}*[Symbol.iterator](){for(const e in n(this,ss)){const{data:t}=n(this,ss)[e];t!==Dl&&(yield[e,t])}}}ss=new WeakMap,Vh=new WeakSet,ff=function(e){var t;return(t=n(this,ss))[e]||(t[e]={...Promise.withResolvers(),data:Dl})};const Dy=1e5,Xp=30;var Zp,$n,Xe,Wh,Xh,Zr,Ki,Yh,Kh,qr,jo,zo,jn,Go,Jh,Vo,ta,Qh,Zh,Wo,ea,qh,zn,Xo,vn,tm,em,pf,ys,pd,gf,sm,im;const ee=class ee{constructor({textContentSource:e,container:t,viewport:s}){y(this,vn);y(this,$n,Promise.withResolvers());y(this,Xe,null);y(this,Wh,!1);y(this,Xh,!!((Zp=globalThis.FontInspector)!=null&&Zp.enabled));y(this,Zr,null);y(this,Ki,null);y(this,Yh,0);y(this,Kh,0);y(this,qr,null);y(this,jo,null);y(this,zo,0);y(this,jn,0);y(this,Go,Object.create(null));y(this,Jh,[]);y(this,Vo,null);y(this,ta,[]);y(this,Qh,new WeakMap);y(this,Zh,null);var l;if(e instanceof ReadableStream)g(this,Vo,e);else if(typeof e=="object")g(this,Vo,new ReadableStream({start(h){h.enqueue(e),h.close()}}));else throw new Error('No "textContentSource" parameter specified.');g(this,Xe,g(this,jo,t)),g(this,jn,s.scale*Ti.pixelRatio),g(this,zo,s.rotation),g(this,Ki,{div:null,properties:null,ctx:null});const{pageWidth:i,pageHeight:r,pageX:a,pageY:o}=s.rawDims;g(this,Zh,[1,0,0,-1,-a,o+r]),g(this,Kh,i),g(this,Yh,r),A(l=ee,ys,sm).call(l),Na(t,s),n(this,$n).promise.finally(()=>{n(ee,Xo).delete(this),g(this,Ki,null),g(this,Go,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=Se.platform;return lt(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{n(this,qr).read().then(({value:t,done:s})=>{if(s){n(this,$n).resolve();return}n(this,Zr)??g(this,Zr,t.lang),Object.assign(n(this,Go),t.styles),A(this,vn,tm).call(this,t.items),e()},n(this,$n).reject)};return g(this,qr,n(this,Vo).getReader()),n(ee,Xo).add(this),e(),n(this,$n).promise}update({viewport:e,onBefore:t=null}){var r;const s=e.scale*Ti.pixelRatio,i=e.rotation;if(i!==n(this,zo)&&(t==null||t(),g(this,zo,i),Na(n(this,jo),{rotation:i})),s!==n(this,jn)){t==null||t(),g(this,jn,s);const a={div:null,properties:null,ctx:A(r=ee,ys,pd).call(r,n(this,Zr))};for(const o of n(this,ta))a.properties=n(this,Qh).get(o),a.div=o,A(this,vn,pf).call(this,a)}}cancel(){var t;const e=new pr("TextLayer task cancelled.");(t=n(this,qr))==null||t.cancel(e).catch(()=>{}),g(this,qr,null),n(this,$n).reject(e)}get textDivs(){return n(this,ta)}get textContentItemsStr(){return n(this,Jh)}static cleanup(){if(!(n(this,Xo).size>0)){n(this,Wo).clear();for(const{canvas:e}of n(this,ea).values())e.remove();n(this,ea).clear()}}};$n=new WeakMap,Xe=new WeakMap,Wh=new WeakMap,Xh=new WeakMap,Zr=new WeakMap,Ki=new WeakMap,Yh=new WeakMap,Kh=new WeakMap,qr=new WeakMap,jo=new WeakMap,zo=new WeakMap,jn=new WeakMap,Go=new WeakMap,Jh=new WeakMap,Vo=new WeakMap,ta=new WeakMap,Qh=new WeakMap,Zh=new WeakMap,Wo=new WeakMap,ea=new WeakMap,qh=new WeakMap,zn=new WeakMap,Xo=new WeakMap,vn=new WeakSet,tm=function(e){var i,r;if(n(this,Wh))return;(r=n(this,Ki)).ctx??(r.ctx=A(i=ee,ys,pd).call(i,n(this,Zr)));const t=n(this,ta),s=n(this,Jh);for(const a of e){if(t.length>Dy){Q("Ignoring additional textDivs for performance reasons."),g(this,Wh,!0);return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const o=n(this,Xe);g(this,Xe,document.createElement("span")),n(this,Xe).classList.add("markedContent"),a.id&&n(this,Xe).setAttribute("id",`${a.id}`),o.append(n(this,Xe))}else a.type==="endMarkedContent"&&g(this,Xe,n(this,Xe).parentNode);continue}s.push(a.str),A(this,vn,em).call(this,a)}},em=function(e){var m;const t=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};n(this,ta).push(t);const i=G.transform(n(this,Zh),e.transform);let r=Math.atan2(i[1],i[0]);const a=n(this,Go)[e.fontName];a.vertical&&(r+=Math.PI/2);let o=n(this,Xh)&&a.fontSubstitution||a.fontFamily;o=ee.fontFamilyMap.get(o)||o;const l=Math.hypot(i[2],i[3]),h=l*A(m=ee,ys,im).call(m,o,a,n(this,Zr));let c,u;r===0?(c=i[4],u=i[5]-h):(c=i[4]+h*Math.sin(r),u=i[5]-h*Math.cos(r));const f="calc(var(--total-scale-factor) *",p=t.style;n(this,Xe)===n(this,jo)?(p.left=`${(100*c/n(this,Kh)).toFixed(2)}%`,p.top=`${(100*u/n(this,Yh)).toFixed(2)}%`):(p.left=`${f}${c.toFixed(2)}px)`,p.top=`${f}${u.toFixed(2)}px)`),p.fontSize=`${f}${(n(ee,zn)*l).toFixed(2)}px)`,p.fontFamily=o,s.fontSize=l,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,n(this,Xh)&&(t.dataset.fontName=a.fontSubstitutionLoadedName||e.fontName),r!==0&&(s.angle=r*(180/Math.PI));let v=!1;if(e.str.length>1)v=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const w=Math.abs(e.transform[0]),b=Math.abs(e.transform[3]);w!==b&&Math.max(w,b)/Math.min(w,b)>1.5&&(v=!0)}if(v&&(s.canvasWidth=a.vertical?e.height:e.width),n(this,Qh).set(t,s),n(this,Ki).div=t,n(this,Ki).properties=s,A(this,vn,pf).call(this,n(this,Ki)),s.hasText&&n(this,Xe).append(t),s.hasEOL){const w=document.createElement("br");w.setAttribute("role","presentation"),n(this,Xe).append(w)}},pf=function(e){var o;const{div:t,properties:s,ctx:i}=e,{style:r}=t;let a="";if(n(ee,zn)>1&&(a=`scale(${1/n(ee,zn)})`),s.canvasWidth!==0&&s.hasText){const{fontFamily:l}=r,{canvasWidth:h,fontSize:c}=s;A(o=ee,ys,gf).call(o,i,c*n(this,jn),l);const{width:u}=i.measureText(t.textContent);u>0&&(a=`scaleX(${h*n(this,jn)/u}) ${a}`)}s.angle!==0&&(a=`rotate(${s.angle}deg) ${a}`),a.length>0&&(r.transform=a)},ys=new WeakSet,pd=function(e=null){let t=n(this,ea).get(e||(e=""));if(!t){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=e,document.body.append(s),t=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),n(this,ea).set(e,t),n(this,qh).set(t,{size:0,family:""})}return t},gf=function(e,t,s){const i=n(this,qh).get(e);t===i.size&&s===i.family||(e.font=`${t}px ${s}`,i.size=t,i.family=s)},sm=function(){if(n(this,zn)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),g(this,zn,e.getBoundingClientRect().height),e.remove()},im=function(e,t,s){const i=n(this,Wo).get(e);if(i)return i;const r=A(this,ys,pd).call(this,s);r.canvas.width=r.canvas.height=Xp,A(this,ys,gf).call(this,r,Xp,e);const a=r.measureText(""),o=a.fontBoundingBoxAscent,l=Math.abs(a.fontBoundingBoxDescent);r.canvas.width=r.canvas.height=0;let h=.8;return o?h=o/(o+l):(Se.platform.isFirefox&&Q("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?h=t.ascent:t.descent&&(h=1+t.descent)),n(this,Wo).set(e,h),h},y(ee,ys),y(ee,Wo,new Map),y(ee,ea,new Map),y(ee,qh,new WeakMap),y(ee,zn,null),y(ee,Xo,new Set);let ih=ee;const My=100;function nm(d={}){typeof d=="string"||d instanceof URL?d={url:d}:(d instanceof ArrayBuffer||ArrayBuffer.isView(d))&&(d={data:d});const e=new mf,{docId:t}=e,s=d.url?_v(d.url):null,i=d.data?Uv(d.data):null,r=d.httpHeaders||null,a=d.withCredentials===!0,o=d.password??null,l=d.range instanceof rm?d.range:null,h=Number.isInteger(d.rangeChunkSize)&&d.rangeChunkSize>0?d.rangeChunkSize:2**16;let c=d.worker instanceof nh?d.worker:null;const u=d.verbosity,f=typeof d.docBaseUrl=="string"&&!vu(d.docBaseUrl)?d.docBaseUrl:null,p=Kc(d.cMapUrl),v=d.cMapPacked!==!1,m=d.CMapReaderFactory||(Be?Xv:Lp),w=Kc(d.iccUrl),b=Kc(d.standardFontDataUrl),S=d.StandardFontDataFactory||(Be?Yv:Fp),E=Kc(d.wasmUrl),T=d.WasmFactory||(Be?Kv:kp),x=d.stopAtErrors!==!0,C=Number.isInteger(d.maxImageSize)&&d.maxImageSize>-1?d.maxImageSize:-1,R=d.isEvalSupported!==!1,I=typeof d.isOffscreenCanvasSupported=="boolean"?d.isOffscreenCanvasSupported:!Be,P=typeof d.isImageDecoderSupported=="boolean"?d.isImageDecoderSupported:!Be&&(Se.platform.isFirefox||!globalThis.chrome),M=Number.isInteger(d.canvasMaxAreaInBytes)?d.canvasMaxAreaInBytes:-1,D=typeof d.disableFontFace=="boolean"?d.disableFontFace:Be,O=d.fontExtraProperties===!0,N=d.enableXfa===!0,B=d.ownerDocument||globalThis.document,W=d.disableRange===!0,_=d.disableStream===!0,L=d.disableAutoFetch===!0,X=d.pdfBug===!0,Z=d.CanvasFactory||(Be?Wv:zv),pt=d.FilterFactory||(Be?Vv:Gv),$t=d.enableHWA===!0,q=d.useWasm!==!1,ot=l?l.length:d.length??NaN,yt=typeof d.useSystemFonts=="boolean"?d.useSystemFonts:!Be&&!D,Kt=typeof d.useWorkerFetch=="boolean"?d.useWorkerFetch:!!(m===Lp&&S===Fp&&T===kp&&p&&b&&E&&Ll(p,document.baseURI)&&Ll(b,document.baseURI)&&Ll(E,document.baseURI)),H=null;uv(u);const F={canvasFactory:new Z({ownerDocument:B,enableHWA:$t}),filterFactory:new pt({docId:t,ownerDocument:B}),cMapReaderFactory:Kt?null:new m({baseUrl:p,isCompressed:v}),standardFontDataFactory:Kt?null:new S({baseUrl:b}),wasmFactory:Kt?null:new T({baseUrl:E})};c||(c=nh.create({verbosity:u,port:xi.workerPort}),e._worker=c);const $={docId:t,apiVersion:"5.4.296",data:i,password:o,disableAutoFetch:L,rangeChunkSize:h,length:ot,docBaseUrl:f,enableXfa:N,evaluatorOptions:{maxImageSize:C,disableFontFace:D,ignoreErrors:x,isEvalSupported:R,isOffscreenCanvasSupported:I,isImageDecoderSupported:P,canvasMaxAreaInBytes:M,fontExtraProperties:O,useSystemFonts:yt,useWasm:q,useWorkerFetch:Kt,cMapUrl:p,iccUrl:w,standardFontDataUrl:b,wasmUrl:E}},tt={ownerDocument:B,pdfBug:X,styleElement:H,loadingParams:{disableAutoFetch:L,enableXfa:N}};return c.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(c.destroyed)throw new Error("Worker was destroyed");const gt=c.messageHandler.sendWithPromise("GetDocRequest",$,i?[i.buffer]:null);let K;if(l)K=new fy(l,{disableRange:W,disableStream:_});else if(!i){if(!s)throw new Error("getDocument - no `url` parameter provided.");const Dt=Ll(s)?vy:Be?Ry:Ey;K=new Dt({url:s,length:ot,httpHeaders:r,withCredentials:a,rangeChunkSize:h,disableRange:W,disableStream:_})}return gt.then(Dt=>{if(e.destroyed)throw new Error("Loading aborted");if(c.destroyed)throw new Error("Worker was destroyed");const Lt=new Ul(t,Dt,c.port),bs=new Fy(Lt,e,K,tt,F,$t);e._transport=bs,Lt.send("Ready",null)})}).catch(e._capability.reject),e}var nu;const ru=class ru{constructor(){k(this,"_capability",Promise.withResolvers());k(this,"_transport",null);k(this,"_worker",null);k(this,"docId",`d${te(ru,nu)._++}`);k(this,"destroyed",!1);k(this,"onPassword",null);k(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var e,t,s,i;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(r){throw(s=this._worker)!=null&&s.port&&delete this._worker._pendingDestroy,r}this._transport=null,(i=this._worker)==null||i.destroy(),this._worker=null}async getData(){return this._transport.getData()}};nu=new WeakMap,y(ru,nu,0);let mf=ru;var sa,tc,ec,sc,ic;class rm{constructor(e,t,s=!1,i=null){y(this,sa,Promise.withResolvers());y(this,tc,[]);y(this,ec,[]);y(this,sc,[]);y(this,ic,[]);this.length=e,this.initialData=t,this.progressiveDone=s,this.contentDispositionFilename=i}addRangeListener(e){n(this,ic).push(e)}addProgressListener(e){n(this,sc).push(e)}addProgressiveReadListener(e){n(this,ec).push(e)}addProgressiveDoneListener(e){n(this,tc).push(e)}onDataRange(e,t){for(const s of n(this,ic))s(e,t)}onDataProgress(e,t){n(this,sa).promise.then(()=>{for(const s of n(this,sc))s(e,t)})}onDataProgressiveRead(e){n(this,sa).promise.then(()=>{for(const t of n(this,ec))t(e)})}onDataProgressiveDone(){n(this,sa).promise.then(()=>{for(const e of n(this,tc))e()})}transportReady(){n(this,sa).resolve()}requestDataRange(e,t){It("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}sa=new WeakMap,tc=new WeakMap,ec=new WeakMap,sc=new WeakMap,ic=new WeakMap;class Oy{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return lt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(e,t){return this._transport.getAnnotationsByType(e,t)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var Ji,ia,Wl;class Ly{constructor(e,t,s,i=!1){y(this,ia);y(this,Ji,!1);this._pageIndex=e,this._pageInfo=t,this._transport=s,this._stats=i?new Cp:null,this._pdfBug=i,this.commonObjs=s.commonObjs,this.objs=new qg,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:s=0,offsetY:i=0,dontFlip:r=!1}={}){return new $c({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:r})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return lt(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,canvas:t=e.canvas,viewport:s,intent:i="display",annotationMode:r=bn.ENABLE,transform:a=null,background:o=null,optionalContentConfigPromise:l=null,annotationCanvasMap:h=null,pageColors:c=null,printAnnotationStorage:u=null,isEditing:f=!1,recordOperations:p=!1,operationsFilter:v=null}){var P,M,D;(P=this._stats)==null||P.time("Overall");const m=this._transport.getRenderingIntent(i,r,u,f),{renderingIntent:w,cacheKey:b}=m;g(this,Ji,!1),l||(l=this._transport.getOptionalContentConfig(w));let S=this._intentStates.get(b);S||(S=Object.create(null),this._intentStates.set(b,S)),S.streamReaderCancelTimeout&&(clearTimeout(S.streamReaderCancelTimeout),S.streamReaderCancelTimeout=null);const E=!!(w&gs.PRINT);S.displayReadyCapability||(S.displayReadyCapability=Promise.withResolvers(),S.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(M=this._stats)==null||M.time("Page Request"),this._pumpOperatorList(m));const T=!!(this._pdfBug&&((D=globalThis.StepperManager)!=null&&D.enabled)),x=!this.recordedBBoxes&&(p||T),C=O=>{var N,B;if(S.renderTasks.delete(R),x){const W=(N=R.gfx)==null?void 0:N.dependencyTracker.take();W&&(R.stepper&&R.stepper.setOperatorBBoxes(W,R.gfx.dependencyTracker.takeDebugMetadata()),p&&(this.recordedBBoxes=W))}E&&g(this,Ji,!0),A(this,ia,Wl).call(this),O?(R.capability.reject(O),this._abortOperatorList({intentState:S,reason:O instanceof Error?O:new Error(O)})):R.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(B=globalThis.Stats)!=null&&B.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},R=new vf({callback:C,params:{canvas:t,canvasContext:e,dependencyTracker:x?new Qv(t,S.operatorList.length,T):null,viewport:s,transform:a,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:h,operatorList:S.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!E,pdfBug:this._pdfBug,pageColors:c,enableHWA:this._transport.enableHWA,operationsFilter:v});(S.renderTasks||(S.renderTasks=new Set)).add(R);const I=R.task;return Promise.all([S.displayReadyCapability.promise,l]).then(([O,N])=>{var B;if(this.destroyed){C();return}if((B=this._stats)==null||B.time("Rendering"),!(N.renderingIntent&w))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");R.initializeGraphics({transparency:O,optionalContentConfig:N}),R.operatorListChanged()}).catch(C),I}getOperatorList({intent:e="display",annotationMode:t=bn.ENABLE,printAnnotationStorage:s=null,isEditing:i=!1}={}){var h;function r(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(l))}const a=this._transport.getRenderingIntent(e,t,s,i,!0);let o=this._intentStates.get(a.cacheKey);o||(o=Object.create(null),this._intentStates.set(a.cacheKey,o));let l;return o.opListReadCapability||(l=Object.create(null),l.operatorListChanged=r,o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||(o.renderTasks=new Set)).add(l),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(h=this._stats)==null||h.time("Page Request"),this._pumpOperatorList(a)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>sh.textContent(s));const t=this.streamTextContent(e);return new Promise(function(s,i){function r(){a.read().then(function({value:l,done:h}){if(h){s(o);return}o.lang??(o.lang=l.lang),Object.assign(o.styles,l.styles),o.items.push(...l.items),r()},i)}const a=t.getReader(),o={items:[],styles:Object.create(null),lang:null};r()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const s of t.renderTasks)e.push(s.completed),s.cancel();return this.objs.clear(),g(this,Ji,!1),Promise.all(e)}cleanup(e=!1){g(this,Ji,!0);const t=A(this,ia,Wl).call(this);return e&&t&&this._stats&&(this._stats=new Cp),t}_startRenderPage(e,t){var i,r;const s=this._intentStates.get(t);s&&((i=this._stats)==null||i.timeEnd("Page Request"),(r=s.displayReadyCapability)==null||r.resolve(e))}_renderPageChunk(e,t){for(let s=0,i=e.length;s<i;s++)t.operatorList.fnArray.push(e.fnArray[s]),t.operatorList.argsArray.push(e.argsArray[s]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const s of t.renderTasks)s.operatorListChanged();e.lastChunk&&A(this,ia,Wl).call(this)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:s,modifiedIds:i}){const{map:r,transfer:a}=s,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:r,modifiedIds:i},a).getReader(),h=this._intentStates.get(t);h.streamReader=l;const c=()=>{l.read().then(({value:u,done:f})=>{if(f){h.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(u,h),c())},u=>{if(h.streamReader=null,!this._transport.destroyed){if(h.operatorList){h.operatorList.lastChunk=!0;for(const f of h.renderTasks)f.operatorListChanged();A(this,ia,Wl).call(this)}if(h.displayReadyCapability)h.displayReadyCapability.reject(u);else if(h.opListReadCapability)h.opListReadCapability.reject(u);else throw u}})};c()}_abortOperatorList({intentState:e,reason:t,force:s=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!s){if(e.renderTasks.size>0)return;if(t instanceof op){let i=My;t.extraDelay>0&&t.extraDelay<1e3&&(i+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},i);return}}if(e.streamReader.cancel(new pr(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[i,r]of this._intentStates)if(r===e){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}Ji=new WeakMap,ia=new WeakSet,Wl=function(){if(!n(this,Ji)||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),g(this,Ji,!1),!0};var Gn,zs,Qi,na,au,ra,aa,Ue,gd,am,om,Xl,Yo,md;const kt=class kt{constructor({name:e=null,port:t=null,verbosity:s=fv()}={}){y(this,Ue);y(this,Gn,Promise.withResolvers());y(this,zs,null);y(this,Qi,null);y(this,na,null);if(this.name=e,this.destroyed=!1,this.verbosity=s,t){if(n(kt,aa).has(t))throw new Error("Cannot use more than one PDFWorker per port.");n(kt,aa).set(t,this),A(this,Ue,am).call(this,t)}else A(this,Ue,om).call(this)}get promise(){return n(this,Gn).promise}get port(){return n(this,Qi)}get messageHandler(){return n(this,zs)}destroy(){var e,t;this.destroyed=!0,(e=n(this,na))==null||e.terminate(),g(this,na,null),n(kt,aa).delete(n(this,Qi)),g(this,Qi,null),(t=n(this,zs))==null||t.destroy(),g(this,zs,null)}static create(e){const t=n(this,aa).get(e==null?void 0:e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new kt(e)}static get workerSrc(){if(xi.workerSrc)return xi.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return lt(this,"_setupFakeWorkerGlobal",(async()=>n(this,Yo,md)?n(this,Yo,md):(await import(this.workerSrc)).WorkerMessageHandler)())}};Gn=new WeakMap,zs=new WeakMap,Qi=new WeakMap,na=new WeakMap,au=new WeakMap,ra=new WeakMap,aa=new WeakMap,Ue=new WeakSet,gd=function(){n(this,Gn).resolve(),n(this,zs).send("configure",{verbosity:this.verbosity})},am=function(e){g(this,Qi,e),g(this,zs,new Ul("main","worker",e)),n(this,zs).on("ready",()=>{}),A(this,Ue,gd).call(this)},om=function(){if(n(kt,ra)||n(kt,Yo,md)){A(this,Ue,Xl).call(this);return}let{workerSrc:e}=kt;try{kt._isSameOrigin(window.location,e)||(e=kt._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),s=new Ul("main","worker",t),i=()=>{r.abort(),s.destroy(),t.terminate(),this.destroyed?n(this,Gn).reject(new Error("Worker was destroyed")):A(this,Ue,Xl).call(this)},r=new AbortController;t.addEventListener("error",()=>{n(this,na)||i()},{signal:r.signal}),s.on("test",o=>{if(r.abort(),this.destroyed||!o){i();return}g(this,zs,s),g(this,Qi,t),g(this,na,t),A(this,Ue,gd).call(this)}),s.on("ready",o=>{if(r.abort(),this.destroyed){i();return}try{a()}catch{A(this,Ue,Xl).call(this)}});const a=()=>{const o=new Uint8Array;s.send("test",o,[o.buffer])};a();return}catch{mu("The worker has been disabled.")}A(this,Ue,Xl).call(this)},Xl=function(){n(kt,ra)||(Q("Setting up fake worker."),g(kt,ra,!0)),kt._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){n(this,Gn).reject(new Error("Worker was destroyed"));return}const t=new jv;g(this,Qi,t);const s=`fake${te(kt,au)._++}`,i=new Ul(s+"_worker",s,t);e.setup(i,t),g(this,zs,new Ul(s,s+"_worker",t)),A(this,Ue,gd).call(this)}).catch(e=>{n(this,Gn).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},Yo=new WeakSet,md=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},y(kt,Yo),y(kt,au,0),y(kt,ra,!1),y(kt,aa,new WeakMap),Be&&(g(kt,ra,!0),xi.workerSrc||(xi.workerSrc="./pdf.worker.mjs")),kt._isSameOrigin=(e,t)=>{const s=URL.parse(e);if(!(s!=null&&s.origin)||s.origin==="null")return!1;const i=new URL(t,s);return s.origin===i.origin},kt._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},kt.fromPort=e=>{if(Tv("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return kt.create(e)};let nh=kt;var Zi,pi,Ko,Jo,qi,oa,Yl;class Fy{constructor(e,t,s,i,r,a){y(this,oa);y(this,Zi,new Map);y(this,pi,new Map);y(this,Ko,new Map);y(this,Jo,new Map);y(this,qi,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new qg,this.fontLoader=new Nv({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.wasmFactory=r.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=a,this.setupMessageHandler()}get annotationStorage(){return lt(this,"annotationStorage",new hp)}getRenderingIntent(e,t=bn.ENABLE,s=null,i=!1,r=!1){let a=gs.DISPLAY,o=qu;switch(e){case"any":a=gs.ANY;break;case"display":break;case"print":a=gs.PRINT;break;default:Q(`getRenderingIntent - invalid intent: ${e}`)}const l=a&gs.PRINT&&s instanceof Bg?s:this.annotationStorage;switch(t){case bn.DISABLE:a+=gs.ANNOTATIONS_DISABLE;break;case bn.ENABLE:break;case bn.ENABLE_FORMS:a+=gs.ANNOTATIONS_FORMS;break;case bn.ENABLE_STORAGE:a+=gs.ANNOTATIONS_STORAGE,o=l.serializable;break;default:Q(`getRenderingIntent - invalid annotationMode: ${t}`)}i&&(a+=gs.IS_EDITING),r&&(a+=gs.OPLIST);const{ids:h,hash:c}=l.modifiedIds,u=[a,o.hash,c];return{renderingIntent:a,cacheKey:u.join("_"),annotationStorageSerializable:o,modifiedIds:h}}destroy(){var s;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(s=n(this,qi))==null||s.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const i of n(this,pi).values())e.push(i._destroy());n(this,pi).clear(),n(this,Ko).clear(),n(this,Jo).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var i,r;this.commonObjs.clear(),this.fontLoader.clear(),n(this,Zi).clear(),this.filterFactory.destroy(),ih.cleanup(),(i=this._networkStream)==null||i.cancelAllRequests(new pr("Worker was terminated.")),(r=this.messageHandler)==null||r.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(s,i)=>{dt(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=r=>{this._lastProgress={loaded:r.loaded,total:r.total}},i.onPull=()=>{this._fullReader.read().then(function({value:r,done:a}){if(a){i.close();return}dt(r instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{i.error(r)})},i.onCancel=r=>{this._fullReader.cancel(r),i.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("ReaderHeadersReady",async s=>{var o;await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:r,contentLength:a}=this._fullReader;return(!i||!r)&&(this._lastProgress&&((o=t.onProgress)==null||o.call(t,this._lastProgress)),this._fullReader.onProgress=l=>{var h;(h=t.onProgress)==null||h.call(t,{loaded:l.loaded,total:l.total})}),{isStreamingSupported:i,isRangeSupported:r,contentLength:a}}),e.on("GetRangeReader",(s,i)=>{dt(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const r=this._networkStream.getRangeReader(s.begin,s.end);if(!r){i.close();return}i.onPull=()=>{r.read().then(function({value:a,done:o}){if(o){i.close();return}dt(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{i.error(a)})},i.onCancel=a=>{r.cancel(a),i.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,t._capability.resolve(new Oy(s,this))}),e.on("DocException",s=>{t._capability.reject($e(s))}),e.on("PasswordRequest",s=>{g(this,qi,Promise.withResolvers());try{if(!t.onPassword)throw $e(s);const i=r=>{r instanceof Error?n(this,qi).reject(r):n(this,qi).resolve({password:r})};t.onPassword(i,s.code)}catch(i){n(this,qi).reject(i)}return n(this,qi).promise}),e.on("DataLoaded",s=>{var i;(i=t.onProgress)==null||i.call(t,{loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),e.on("StartRenderPage",s=>{if(this.destroyed)return;n(this,pi).get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),e.on("commonobj",([s,i,r])=>{var a;if(this.destroyed||this.commonObjs.has(s))return null;switch(i){case"Font":if("error"in r){const u=r.error;Q(`Error during font loading: ${u}`),this.commonObjs.resolve(s,u);break}const o=new df(r),l=this._params.pdfBug&&((a=globalThis.FontInspector)!=null&&a.enabled)?(u,f)=>globalThis.FontInspector.fontAdded(u,f):null,h=new Bv(o,l,r.extra,r.charProcOperatorList);this.fontLoader.bind(h).catch(()=>e.sendWithPromise("FontFallback",{id:s})).finally(()=>{!h.fontExtraProperties&&h.data&&h.clearData(),this.commonObjs.resolve(s,h)});break;case"CopyLocalImage":const{imageRef:c}=r;dt(c,"The imageRef must be defined.");for(const u of n(this,pi).values())for(const[,f]of u.objs)if((f==null?void 0:f.ref)===c)return f.dataLen?(this.commonObjs.resolve(s,structuredClone(f)),f.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(s,r);break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),e.on("obj",([s,i,r,a])=>{var l;if(this.destroyed)return;const o=n(this,pi).get(i);if(!o.objs.has(s)){if(o._intentStates.size===0){(l=a==null?void 0:a.bitmap)==null||l.close();return}switch(r){case"Image":case"Pattern":o.objs.resolve(s,a);break;default:throw new Error(`Got unknown object type ${r}`)}}}),e.on("DocProgress",s=>{var i;this.destroyed||(i=t.onProgress)==null||i.call(t,{loaded:s.loaded,total:s.total})}),e.on("FetchBinaryData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");const i=this[s.type];if(!i)throw new Error(`${s.type} not initialized, see the \`useWorkerFetch\` parameter.`);return i.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var s;this.annotationStorage.size<=0&&Q("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((s=this._fullReader)==null?void 0:s.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,s=n(this,Ko).get(t);if(s)return s;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(r=>{if(this.destroyed)throw new Error("Transport destroyed");r.refStr&&n(this,Jo).set(r.refStr,e);const a=new Ly(t,r,this,this._params.pdfBug);return n(this,pi).set(t,a),a});return n(this,Ko).set(t,i),i}getPageIndex(e){return tf(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return A(this,oa,Yl).call(this,"GetFieldObjects")}hasJSActions(){return A(this,oa,Yl).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(e,t){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:e,pageIndexesToSkip:t})}getDocJSActions(){return A(this,oa,Yl).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return A(this,oa,Yl).call(this,"GetOptionalContentConfig").then(t=>new uy(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=n(this,Zi).get(e);if(t)return t;const s=this.messageHandler.sendWithPromise(e,null).then(i=>{var r,a;return{info:i[0],metadata:i[1]?new cy(i[1]):null,contentDispositionFilename:((r=this._fullReader)==null?void 0:r.filename)??null,contentLength:((a=this._fullReader)==null?void 0:a.contentLength)??null}});return n(this,Zi).set(e,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of n(this,pi).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),n(this,Zi).clear(),this.filterFactory.destroy(!0),ih.cleanup()}}cachedPageNumber(e){if(!tf(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return n(this,Jo).get(t)??null}}Zi=new WeakMap,pi=new WeakMap,Ko=new WeakMap,Jo=new WeakMap,qi=new WeakMap,oa=new WeakSet,Yl=function(e,t=null){const s=n(this,Zi).get(e);if(s)return s;const i=this.messageHandler.sendWithPromise(e,t);return n(this,Zi).set(e,i),i};var Vn;class ky{constructor(e){y(this,Vn,null);k(this,"onContinue",null);k(this,"onError",null);g(this,Vn,e)}get promise(){return n(this,Vn).capability.promise}cancel(e=0){n(this,Vn).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=n(this,Vn).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=n(this,Vn);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}Vn=new WeakMap;var Wn,la;const Er=class Er{constructor({callback:e,params:t,objs:s,commonObjs:i,annotationCanvasMap:r,operatorList:a,pageIndex:o,canvasFactory:l,filterFactory:h,useRequestAnimationFrame:c=!1,pdfBug:u=!1,pageColors:f=null,enableHWA:p=!1,operationsFilter:v=null}){y(this,Wn,null);this.callback=e,this.params=t,this.objs=s,this.commonObjs=i,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=l,this.filterFactory=h,this._pdfBug=u,this.pageColors=f,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=c===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new ky(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvas,this._canvasContext=t.canvas?null:t.canvasContext,this._enableHWA=p,this._dependencyTracker=t.dependencyTracker,this._operationsFilter=v}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var l,h;if(this.cancelled)return;if(this._canvas){if(n(Er,la).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");n(Er,la).add(this._canvas)}this._pdfBug&&((l=globalThis.StepperManager)!=null&&l.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:s,transform:i,background:r,dependencyTracker:a}=this.params,o=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new so(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors,a),this.gfx.beginDrawing({transform:i,viewport:s,transparency:e,background:r}),this.operatorListIdx=0,this.graphicsReady=!0,(h=this.graphicsReadyCallback)==null||h.call(this)}cancel(e=null,t=0){var s,i,r;this.running=!1,this.cancelled=!0,(s=this.gfx)==null||s.endDrawing(),n(this,Wn)&&(window.cancelAnimationFrame(n(this,Wn)),g(this,Wn,null)),n(Er,la).delete(this._canvas),e||(e=new op(`Rendering cancelled, page ${this._pageIndex+1}`,t)),this.callback(e),(r=(i=this.task).onError)==null||r.call(i,e)}operatorListChanged(){var e,t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.gfx.dependencyTracker)==null||e.growOperationsCount(this.operatorList.fnArray.length),(t=this.stepper)==null||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?g(this,Wn,window.requestAnimationFrame(()=>{g(this,Wn,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),n(Er,la).delete(this._canvas),this.callback())))}};Wn=new WeakMap,la=new WeakMap,y(Er,la,new WeakSet);let vf=Er;const Ny="5.4.296",By="f56dc8601";var is,ha,Qo,ne,nc,Zo,tn,rc,Xn,Gs,ac,Tt,yf,bf,Af,yr,lm,yn;const je=class je{constructor({editor:e=null,uiManager:t=null}){y(this,Tt);y(this,is,null);y(this,ha,null);y(this,Qo);y(this,ne,null);y(this,nc,!1);y(this,Zo,!1);y(this,tn,null);y(this,rc);y(this,Xn,null);y(this,Gs,null);var s,i;e?(g(this,Zo,!1),g(this,tn,e)):g(this,Zo,!0),g(this,Gs,(e==null?void 0:e._uiManager)||t),g(this,rc,n(this,Gs)._eventBus),g(this,Qo,((s=e==null?void 0:e.color)==null?void 0:s.toUpperCase())||((i=n(this,Gs))==null?void 0:i.highlightColors.values().next().value)||"#FFFF98"),n(je,ac)||g(je,ac,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return lt(this,"_keyboardManager",new zc([[["Escape","mac+Escape"],je.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],je.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],je.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],je.prototype._moveToPrevious],[["Home","mac+Home"],je.prototype._moveToBeginning],[["End","mac+End"],je.prototype._moveToEnd]]))}renderButton(){const e=g(this,is,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",n(this,tn)&&(e.ariaControls=`${n(this,tn).id}_colorpicker_dropdown`);const t=n(this,Gs)._signal;e.addEventListener("click",A(this,Tt,yr).bind(this),{signal:t}),e.addEventListener("keydown",A(this,Tt,Af).bind(this),{signal:t});const s=g(this,ha,document.createElement("span"));return s.className="swatch",s.ariaHidden="true",s.style.backgroundColor=n(this,Qo),e.append(s),e}renderMainDropdown(){const e=g(this,ne,A(this,Tt,yf).call(this));return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}_colorSelectFromKeyboard(e){if(e.target===n(this,is)){A(this,Tt,yr).call(this,e);return}const t=e.target.getAttribute("data-color");t&&A(this,Tt,bf).call(this,t,e)}_moveToNext(e){var t,s;if(!n(this,Tt,yn)){A(this,Tt,yr).call(this,e);return}if(e.target===n(this,is)){(t=n(this,ne).firstChild)==null||t.focus();return}(s=e.target.nextSibling)==null||s.focus()}_moveToPrevious(e){var t,s;if(e.target===((t=n(this,ne))==null?void 0:t.firstChild)||e.target===n(this,is)){n(this,Tt,yn)&&this._hideDropdownFromKeyboard();return}n(this,Tt,yn)||A(this,Tt,yr).call(this,e),(s=e.target.previousSibling)==null||s.focus()}_moveToBeginning(e){var t;if(!n(this,Tt,yn)){A(this,Tt,yr).call(this,e);return}(t=n(this,ne).firstChild)==null||t.focus()}_moveToEnd(e){var t;if(!n(this,Tt,yn)){A(this,Tt,yr).call(this,e);return}(t=n(this,ne).lastChild)==null||t.focus()}hideDropdown(){var e,t;(e=n(this,ne))==null||e.classList.add("hidden"),n(this,is).ariaExpanded="false",(t=n(this,Xn))==null||t.abort(),g(this,Xn,null)}_hideDropdownFromKeyboard(){var e;if(!n(this,Zo)){if(!n(this,Tt,yn)){(e=n(this,tn))==null||e.unselect();return}this.hideDropdown(),n(this,is).focus({preventScroll:!0,focusVisible:n(this,nc)})}}updateColor(e){if(n(this,ha)&&(n(this,ha).style.backgroundColor=e),!n(this,ne))return;const t=n(this,Gs).highlightColors.values();for(const s of n(this,ne).children)s.ariaSelected=t.next().value===e.toUpperCase()}destroy(){var e,t;(e=n(this,is))==null||e.remove(),g(this,is,null),g(this,ha,null),(t=n(this,ne))==null||t.remove(),g(this,ne,null)}};is=new WeakMap,ha=new WeakMap,Qo=new WeakMap,ne=new WeakMap,nc=new WeakMap,Zo=new WeakMap,tn=new WeakMap,rc=new WeakMap,Xn=new WeakMap,Gs=new WeakMap,ac=new WeakMap,Tt=new WeakSet,yf=function(){const e=document.createElement("div"),t=n(this,Gs)._signal;e.addEventListener("contextmenu",ks,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),n(this,tn)&&(e.id=`${n(this,tn).id}_colorpicker_dropdown`);for(const[s,i]of n(this,Gs).highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",i),r.title=s,r.setAttribute("data-l10n-id",n(je,ac)[s]);const a=document.createElement("span");r.append(a),a.className="swatch",a.style.backgroundColor=i,r.ariaSelected=i===n(this,Qo),r.addEventListener("click",A(this,Tt,bf).bind(this,i),{signal:t}),e.append(r)}return e.addEventListener("keydown",A(this,Tt,Af).bind(this),{signal:t}),e},bf=function(e,t){t.stopPropagation(),n(this,rc).dispatch("switchannotationeditorparams",{source:this,type:ct.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)},Af=function(e){je._keyboardManager.exec(this,e)},yr=function(e){if(n(this,Tt,yn)){this.hideDropdown();return}if(g(this,nc,e.detail===0),n(this,Xn)||(g(this,Xn,new AbortController),window.addEventListener("pointerdown",A(this,Tt,lm).bind(this),{signal:n(this,Gs).combinedSignal(n(this,Xn))})),n(this,is).ariaExpanded="true",n(this,ne)){n(this,ne).classList.remove("hidden");return}const t=g(this,ne,A(this,Tt,yf).call(this));n(this,is).append(t)},lm=function(e){var t;(t=n(this,ne))!=null&&t.contains(e.target)||this.hideDropdown()},yn=function(){return n(this,ne)&&!n(this,ne).classList.contains("hidden")},y(je,ac,null);let zd=je;var gi,oc,qo,lc;const Sr=class Sr{constructor(e){y(this,gi,null);y(this,oc,null);y(this,qo,null);g(this,oc,e),g(this,qo,e._uiManager),n(Sr,lc)||g(Sr,lc,Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"}))}renderButton(){if(n(this,gi))return n(this,gi);const{editorType:e,colorType:t,colorValue:s}=n(this,oc),i=g(this,gi,document.createElement("input"));return i.type="color",i.value=s||"#000000",i.className="basicColorPicker",i.tabIndex=0,i.setAttribute("data-l10n-id",n(Sr,lc)[e]),i.addEventListener("input",()=>{n(this,qo).updateParams(t,i.value)},{signal:n(this,qo)._signal}),i}update(e){n(this,gi)&&(n(this,gi).value=e)}destroy(){var e;(e=n(this,gi))==null||e.remove(),g(this,gi,null)}hideDropdown(){}};gi=new WeakMap,oc=new WeakMap,qo=new WeakMap,lc=new WeakMap,y(Sr,lc,null);let Gd=Sr;nt(116);nt(531);function Yp(d){return Math.floor(Math.max(0,Math.min(1,d))*255).toString(16).padStart(2,"0")}function Ml(d){return Math.max(0,Math.min(255,255*d))}class Kp{static CMYK_G([e,t,s,i]){return["G",1-Math.min(1,.3*e+.59*s+.11*t+i)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=Ml(e),[e,e,e]}static G_HTML([e]){const t=Yp(e);return`#${t}${t}${t}`}static RGB_G([e,t,s]){return["G",.3*e+.59*t+.11*s]}static RGB_rgb(e){return e.map(Ml)}static RGB_HTML(e){return`#${e.map(Yp).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,s,i]){return["RGB",1-Math.min(1,e+i),1-Math.min(1,s+i),1-Math.min(1,t+i)]}static CMYK_rgb([e,t,s,i]){return[Ml(1-Math.min(1,e+i)),Ml(1-Math.min(1,s+i)),Ml(1-Math.min(1,t+i))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,s]){const i=1-e,r=1-t,a=1-s,o=Math.min(i,r,a);return["CMYK",i,r,a,o]}}class _y{create(e,t,s=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),s||(i.setAttribute("width",`${e}px`),i.setAttribute("height",`${t}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${e} ${t}`),i}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){It("Abstract method `_createSVG` called.")}}class Vd extends _y{_createSVG(e){return document.createElementNS(Ri,e)}}const Uy=9,_a=new WeakSet,Hy=new Date().getTimezoneOffset()*60*1e3;class Jp{static create(e){switch(e.data.annotationType){case Qt.LINK:return new up(e);case Qt.TEXT:return new jy(e);case Qt.WIDGET:switch(e.data.fieldType){case"Tx":return new zy(e);case"Btn":return e.data.radioButton?new dm(e):e.data.checkBox?new Vy(e):new Wy(e);case"Ch":return new Xy(e);case"Sig":return new Gy(e)}return new Ha(e);case Qt.POPUP:return new Ef(e);case Qt.FREETEXT:return new mm(e);case Qt.LINE:return new Ky(e);case Qt.SQUARE:return new Jy(e);case Qt.CIRCLE:return new Qy(e);case Qt.POLYLINE:return new vm(e);case Qt.CARET:return new qy(e);case Qt.INK:return new fp(e);case Qt.POLYGON:return new Zy(e);case Qt.HIGHLIGHT:return new ym(e);case Qt.UNDERLINE:return new tb(e);case Qt.SQUIGGLY:return new eb(e);case Qt.STRIKEOUT:return new sb(e);case Qt.STAMP:return new bm(e);case Qt.FILEATTACHMENT:return new ib(e);default:return new Ht(e)}}}var ca,tl,Ds,hc,wf;const Ap=class Ap{constructor(e,{isRenderable:t=!1,ignoreBorder:s=!1,createQuadrilaterals:i=!1}={}){y(this,hc);y(this,ca,null);y(this,tl,!1);y(this,Ds,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableComment=e.enableComment,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(s)),i&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e!=null&&e.str||t!=null&&t.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Ap._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){var s;const{data:e}=this,t=(s=this.annotationStorage)==null?void 0:s.getEditor(e.id);return t?t.getData():e}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){var o;const e=(o=this.annotationStorage)==null?void 0:o.getEditor(this.data.id);if(e)return e.commentButtonPositionInPage;const{quadPoints:t,inkLists:s,rect:i}=this.data;let r=-1/0,a=-1/0;if((t==null?void 0:t.length)>=8){for(let l=0;l<t.length;l+=8)t[l+1]>a?(a=t[l+1],r=t[l+2]):t[l+1]===a&&(r=Math.max(r,t[l+2]));return[r,a]}if((s==null?void 0:s.length)>=1){for(const l of s)for(let h=0,c=l.length;h<c;h+=2)l[h+1]>a?(a=l[h+1],r=l[h]):l[h+1]===a&&(r=Math.max(r,l[h]));if(r!==1/0)return[r,a]}return i?[i[2],i[3]]:null}_normalizePoint(e){const{page:{view:t},viewport:{rawDims:{pageWidth:s,pageHeight:i,pageX:r,pageY:a}}}=this.parent;return e[1]=t[3]-e[1]+t[1],e[0]=100*(e[0]-r)/s,e[1]=100*(e[1]-a)/i,e}get commentText(){var t,s,i;const{data:e}=this;return((s=(t=this.annotationStorage.getRawValue(`${th}${e.id}`))==null?void 0:t.popup)==null?void 0:s.contents)||((i=e.contentsObj)==null?void 0:i.str)||""}set commentText(e){const{data:t}=this,s={deleted:!e,contents:e||""};this.annotationStorage.updateEditor(t.id,{popup:s})||this.annotationStorage.setValue(`${th}${t.id}`,{id:t.id,annotationType:t.annotationType,pageIndex:this.parent.page._pageIndex,popup:s,popupRef:t.popupRef,modificationDate:new Date}),e||this.removePopup()}removePopup(){var e,t;(t=((e=n(this,Ds))==null?void 0:e.popup)||this.popup)==null||t.remove(),g(this,Ds,this.popup=null)}updateEdited(e){var r;if(!this.container)return;e.rect&&(n(this,ca)||g(this,ca,{rect:this.data.rect.slice(0)}));const{rect:t,popup:s}=e;t&&A(this,hc,wf).call(this,t);let i=((r=n(this,Ds))==null?void 0:r.popup)||this.popup;!i&&(s!=null&&s.text)&&(this._createPopup(s),i=n(this,Ds).popup),i&&(i.updateEdited(e),s!=null&&s.deleted&&(i.remove(),g(this,Ds,null),this.popup=null))}resetEdited(){var e;n(this,ca)&&(A(this,hc,wf).call(this,n(this,ca).rect),(e=n(this,Ds))==null||e.popup.resetEdited(),g(this,ca,null))}_createContainer(e){const{data:t,parent:{page:s,viewport:i}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",t.id),!(this instanceof Ha)&&!(this instanceof up)&&(r.tabIndex=0);const{style:a}=r;if(a.zIndex=this.parent.zIndex,this.parent.zIndex+=2,t.alternativeText&&(r.title=t.alternativeText),t.noRotate&&r.classList.add("norotate"),!t.rect||this instanceof Ef){const{rotation:m}=t;return!t.hasOwnCanvas&&m!==0&&this.setRotation(m,r),r}const{width:o,height:l}=this;if(!e&&t.borderStyle.width>0){a.borderWidth=`${t.borderStyle.width}px`;const m=t.borderStyle.horizontalCornerRadius,w=t.borderStyle.verticalCornerRadius;if(m>0||w>0){const S=`calc(${m}px * var(--total-scale-factor)) / calc(${w}px * var(--total-scale-factor))`;a.borderRadius=S}else if(this instanceof dm){const S=`calc(${o}px * var(--total-scale-factor)) / calc(${l}px * var(--total-scale-factor))`;a.borderRadius=S}switch(t.borderStyle.style){case za.SOLID:a.borderStyle="solid";break;case za.DASHED:a.borderStyle="dashed";break;case za.BEVELED:Q("Unimplemented border style: beveled");break;case za.INSET:Q("Unimplemented border style: inset");break;case za.UNDERLINE:a.borderBottomStyle="solid";break}const b=t.borderColor||null;b?(g(this,tl,!0),a.borderColor=G.makeHexColor(b[0]|0,b[1]|0,b[2]|0)):a.borderWidth=0}const h=G.normalizeRect([t.rect[0],s.view[3]-t.rect[1]+s.view[1],t.rect[2],s.view[3]-t.rect[3]+s.view[1]]),{pageWidth:c,pageHeight:u,pageX:f,pageY:p}=i.rawDims;a.left=`${100*(h[0]-f)/c}%`,a.top=`${100*(h[1]-p)/u}%`;const{rotation:v}=t;return t.hasOwnCanvas||v===0?(a.width=`${100*o/c}%`,a.height=`${100*l/u}%`):this.setRotation(v,r),r}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:i}=this.parent.viewport.rawDims;let{width:r,height:a}=this;e%180!==0&&([r,a]=[a,r]),t.style.width=`${100*r/s}%`,t.style.height=`${100*a/i}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,s,i)=>{const r=i.detail[t],a=r[0],o=r.slice(1);i.target.style[s]=Kp[`${a}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[s]:Kp[`${a}_rgb`](o)})};return lt(this,"_commonActions",{display:t=>{const{display:s}=t.detail,i=s%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:s===1||s===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:s}=t.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const s=t.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(e,t){const s=this._commonActions;for(const i of Object.keys(t.detail)){const r=e[i]||s[i];r==null||r(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const s=this._commonActions;for(const[i,r]of Object.entries(t)){const a=s[i];if(a){const o={detail:{[i]:r},target:e};a(o),delete t[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,s,i,r]=this.data.rect.map(m=>Math.fround(m));if(e.length===8){const[m,w,b,S]=e.subarray(2,6);if(i===m&&r===w&&t===b&&s===S)return}const{style:a}=this.container;let o;if(n(this,tl)){const{borderColor:m,borderWidth:w}=a;a.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${m}" stroke-width="${w}">`],this.container.classList.add("hasBorder")}const l=i-t,h=r-s,{svgFactory:c}=this,u=c.createElement("svg");u.classList.add("quadrilateralsContainer"),u.setAttribute("width",0),u.setAttribute("height",0),u.role="none";const f=c.createElement("defs");u.append(f);const p=c.createElement("clipPath"),v=`clippath_${this.data.id}`;p.setAttribute("id",v),p.setAttribute("clipPathUnits","objectBoundingBox"),f.append(p);for(let m=2,w=e.length;m<w;m+=8){const b=e[m],S=e[m+1],E=e[m+2],T=e[m+3],x=c.createElement("rect"),C=(E-t)/l,R=(r-S)/h,I=(b-E)/l,P=(S-T)/h;x.setAttribute("x",C),x.setAttribute("y",R),x.setAttribute("width",I),x.setAttribute("height",P),p.append(x),o==null||o.push(`<rect vector-effect="non-scaling-stroke" x="${C}" y="${R}" width="${I}" height="${P}"/>`)}n(this,tl)&&(o.push("</g></svg>')"),a.backgroundImage=o.join("")),this.container.append(u),this.container.style.clipPath=`url(#${v})`}_createPopup(e=null){const{data:t}=this;let s,i;e?(s={str:e.text},i=e.date):(s=t.contentsObj,i=t.modificationDate);const r=g(this,Ds,new Ef({data:{color:t.color,titleObj:t.titleObj,modificationDate:i,contentsObj:s,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]}));this.parent._commentManager||this.parent.div.append(r.render())}get hasPopupElement(){return!!(n(this,Ds)||this.popup||this.data.popupRef)}get extraPopupElement(){return n(this,Ds)}render(){It("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const s=[];if(this._fieldObjects){const i=this._fieldObjects[e];if(i)for(const{page:r,id:a,exportValues:o}of i){if(r===-1||a===t)continue;const l=typeof o=="string"?o:null,h=document.querySelector(`[data-element-id="${a}"]`);if(h&&!_a.has(h)){Q(`_getElementsByName - element not allowed: ${a}`);continue}s.push({id:a,exportValue:l,domElement:h})}return s}for(const i of document.getElementsByName(e)){const{exportValue:r}=i,a=i.getAttribute("data-element-id");a!==t&&_a.has(i)&&s.push({id:a,exportValue:r,domElement:i})}return s}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var s;(s=this.linkService.eventBus)==null||s.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};ca=new WeakMap,tl=new WeakMap,Ds=new WeakMap,hc=new WeakSet,wf=function(e){const{container:{style:t},data:{rect:s,rotation:i},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:a,pageX:o,pageY:l}}}}=this;s==null||s.splice(0,4,...e),t.left=`${100*(e[0]-o)/r}%`,t.top=`${100*(a-e[3]+l)/a}%`,i===0?(t.width=`${100*(e[2]-e[0])/r}%`,t.height=`${100*(e[3]-e[1])/a}%`):this.setRotation(i)};let Ht=Ap;class $y extends Ht{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.editor=e.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:e}=this;e.hasComment&&(this._createPopup(e.comment),this.extraPopupElement.popup.renderCommentButton())}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(e){this.editor.comment=e,e||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.container.remove(),this.container=null,this.removePopup()}}var vs,br,hm,cm;class up extends Ht{constructor(t,s=null){super(t,{isRenderable:!0,ignoreBorder:!!(s!=null&&s.ignoreBorder),createQuadrilaterals:!0});y(this,vs);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:s}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let r=!1;return t.url?(s.addLinkAttributes(i,t.url,t.newWindow),r=!0):t.action?(this._bindNamedAction(i,t.action,t.overlaidText),r=!0):t.attachment?(A(this,vs,hm).call(this,i,t.attachment,t.overlaidText,t.attachmentDest),r=!0):t.setOCGState?(A(this,vs,cm).call(this,i,t.setOCGState,t.overlaidText),r=!0):t.dest?(this._bindLink(i,t.dest,t.overlaidText),r=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),r=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(i,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&this.container.append(i),this.container}_bindLink(t,s,i=""){t.href=this.linkService.getDestinationHash(s),t.onclick=()=>(s&&this.linkService.goToDestination(s),!1),(s||s==="")&&A(this,vs,br).call(this),i&&(t.title=i)}_bindNamedAction(t,s,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(s),!1),i&&(t.title=i),A(this,vs,br).call(this)}_bindJSAction(t,s){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(s.actions)){const a=i.get(r);a&&(t[a]=()=>{var o;return(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s.id,name:r}}),!1})}s.overlaidText&&(t.title=s.overlaidText),t.onclick||(t.onclick=()=>!1),A(this,vs,br).call(this)}_bindResetFormAction(t,s){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),A(this,vs,br).call(this),!this._fieldObjects){Q('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{var u;i==null||i();const{fields:r,refs:a,include:o}=s,l=[];if(r.length!==0||a.length!==0){const f=new Set(a);for(const p of r){const v=this._fieldObjects[p]||[];for(const{id:m}of v)f.add(m)}for(const p of Object.values(this._fieldObjects))for(const v of p)f.has(v.id)===o&&l.push(v)}else for(const f of Object.values(this._fieldObjects))l.push(...f);const h=this.annotationStorage,c=[];for(const f of l){const{id:p}=f;switch(c.push(p),f.type){case"text":{const m=f.defaultValue||"";h.setValue(p,{value:m});break}case"checkbox":case"radiobutton":{const m=f.defaultValue===f.exportValues;h.setValue(p,{value:m});break}case"combobox":case"listbox":{const m=f.defaultValue||"";h.setValue(p,{value:m});break}default:continue}const v=document.querySelector(`[data-element-id="${p}"]`);if(v){if(!_a.has(v)){Q(`_bindResetFormAction - element not allowed: ${p}`);continue}}else continue;v.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((u=this.linkService.eventBus)==null||u.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:c,name:"ResetForm"}})),!1}}}vs=new WeakSet,br=function(){this.container.setAttribute("data-internal-link","")},hm=function(t,s,i="",r=null){t.href=this.linkService.getAnchorUrl(""),s.description?t.title=s.description:i&&(t.title=i),t.onclick=()=>{var a;return(a=this.downloadManager)==null||a.openOrDownloadData(s.content,s.filename,r),!1},A(this,vs,br).call(this)},cm=function(t,s,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(s),!1),i&&(t.title=i),A(this,vs,br).call(this)};class jy extends Ht{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class Ha extends Ht{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Se.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,s,i,r){s.includes("mouse")?e.addEventListener(s,a=>{var o;(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):e.addEventListener(s,a=>{var o;if(s==="blur"){if(!t.focused||!a.relatedTarget)return;t.focused=!1}else if(s==="focus"){if(t.focused)return;t.focused=!0}r&&((o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(a)}}))})}_setEventListeners(e,t,s,i){var r,a,o;for(const[l,h]of s)(h==="Action"||(r=this.data.actions)!=null&&r[h])&&((h==="Focus"||h==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,l,h,i),h==="Focus"&&!((a=this.data.actions)!=null&&a.Blur)?this._setEventListener(e,t,"blur","Blur",null):h==="Blur"&&!((o=this.data.actions)!=null&&o.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":G.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||Uy,r=e.style;let a;const o=2,l=h=>Math.round(10*h)/10;if(this.data.multiLine){const h=Math.abs(this.data.rect[3]-this.data.rect[1]-o),c=Math.round(h/(Eu*i))||1,u=h/c;a=Math.min(i,l(u/Eu))}else{const h=Math.abs(this.data.rect[3]-this.data.rect[1]-o);a=Math.min(i,l(h/Eu))}r.fontSize=`calc(${a}px * var(--total-scale-factor))`,r.color=G.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(r.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class zy extends Ha{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,s,i){const r=this.annotationStorage;for(const a of this._getElementsByName(e.name,e.id))a.domElement&&(a.domElement[t]=s),r.setValue(a.id,{[i]:s})}render(){var i,r;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const a=e.getValue(t,{value:this.data.fieldValue});let o=a.value||"";const l=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;l&&o.length>l&&(o=o.slice(0,l));let h=a.formattedValue||((i=this.data.textContent)==null?void 0:i.join(`
`))||null;h&&this.data.comb&&(h=h.replaceAll(/\s+/g,""));const c={userValue:o,formattedValue:h,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=h??o,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type=this.data.password?"password":"text",s.setAttribute("value",h??o),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),_a.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=0;const{datetimeFormat:u,datetimeType:f,timeStep:p}=this.data,v=!!f&&this.enableScripting;u&&(s.title=u),this._setRequired(s,this.data.required),l&&(s.maxLength=l),s.addEventListener("input",w=>{e.setValue(t,{value:w.target.value}),this.setPropertyOnSiblings(s,"value",w.target.value,"value"),c.formattedValue=null}),s.addEventListener("resetform",w=>{const b=this.data.defaultFieldValue??"";s.value=c.userValue=b,c.formattedValue=null});let m=w=>{const{formattedValue:b}=c;b!=null&&(w.target.value=b),w.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",b=>{var E;if(c.focused)return;const{target:S}=b;if(v&&(S.type=f,p&&(S.step=p)),c.userValue){const T=c.userValue;if(v)if(f==="time"){const x=new Date(T),C=[x.getHours(),x.getMinutes(),x.getSeconds()];S.value=C.map(R=>R.toString().padStart(2,"0")).join(":")}else S.value=new Date(T-Hy).toISOString().split(f==="date"?"T":".",1)[0];else S.value=T}c.lastCommittedValue=S.value,c.commitKey=1,(E=this.data.actions)!=null&&E.Focus||(c.focused=!0)}),s.addEventListener("updatefromsandbox",b=>{this.showElementAndHideCanvas(b.target);const S={value(E){c.userValue=E.detail.value??"",v||e.setValue(t,{value:c.userValue.toString()}),E.target.value=c.userValue},formattedValue(E){const{formattedValue:T}=E.detail;c.formattedValue=T,T!=null&&E.target!==document.activeElement&&(E.target.value=T);const x={formattedValue:T};v&&(x.value=T),e.setValue(t,x)},selRange(E){E.target.setSelectionRange(...E.detail.selRange)},charLimit:E=>{var R;const{charLimit:T}=E.detail,{target:x}=E;if(T===0){x.removeAttribute("maxLength");return}x.setAttribute("maxLength",T);let C=c.userValue;!C||C.length<=T||(C=C.slice(0,T),x.value=c.userValue=C,e.setValue(t,{value:C}),(R=this.linkService.eventBus)==null||R.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:C,willCommit:!0,commitKey:1,selStart:x.selectionStart,selEnd:x.selectionEnd}}))}};this._dispatchEventFromSandbox(S,b)}),s.addEventListener("keydown",b=>{var T;c.commitKey=1;let S=-1;if(b.key==="Escape"?S=0:b.key==="Enter"&&!this.data.multiLine?S=2:b.key==="Tab"&&(c.commitKey=3),S===-1)return;const{value:E}=b.target;c.lastCommittedValue!==E&&(c.lastCommittedValue=E,c.userValue=E,(T=this.linkService.eventBus)==null||T.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:E,willCommit:!0,commitKey:S,selStart:b.target.selectionStart,selEnd:b.target.selectionEnd}}))});const w=m;m=null,s.addEventListener("blur",b=>{var T,x;if(!c.focused||!b.relatedTarget)return;(T=this.data.actions)!=null&&T.Blur||(c.focused=!1);const{target:S}=b;let{value:E}=S;if(v){if(E&&f==="time"){const C=E.split(":").map(R=>parseInt(R,10));E=new Date(2e3,0,1,C[0],C[1],C[2]||0).valueOf(),S.step=""}else E.includes("T")||(E=`${E}T00:00`),E=new Date(E).valueOf();S.type="text"}c.userValue=E,c.lastCommittedValue!==E&&((x=this.linkService.eventBus)==null||x.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:E,willCommit:!0,commitKey:c.commitKey,selStart:b.target.selectionStart,selEnd:b.target.selectionEnd}})),w(b)}),(r=this.data.actions)!=null&&r.Keystroke&&s.addEventListener("beforeinput",b=>{var P;c.lastCommittedValue=null;const{data:S,target:E}=b,{value:T,selectionStart:x,selectionEnd:C}=E;let R=x,I=C;switch(b.inputType){case"deleteWordBackward":{const M=T.substring(0,x).match(/\w*[^\w]*$/);M&&(R-=M[0].length);break}case"deleteWordForward":{const M=T.substring(x).match(/^[^\w]*\w*/);M&&(I+=M[0].length);break}case"deleteContentBackward":x===C&&(R-=1);break;case"deleteContentForward":x===C&&(I+=1);break}b.preventDefault(),(P=this.linkService.eventBus)==null||P.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:T,change:S||"",willCommit:!1,selStart:R,selEnd:I}})}),this._setEventListeners(s,c,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],b=>b.target.value)}if(m&&s.addEventListener("blur",m),this.data.comb){const b=(this.data.rect[2]-this.data.rect[0])/l;s.classList.add("comb"),s.style.letterSpacing=`calc(${b}px * var(--total-scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class Gy extends Ha{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class Vy extends Ha{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.exportValue===t.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",e.setValue(s,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return _a.add(r),r.setAttribute("data-element-id",s),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=t.fieldName,i&&r.setAttribute("checked",!0),r.setAttribute("exportValue",t.exportValue),r.tabIndex=0,r.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const h of this._getElementsByName(o,s)){const c=l&&h.exportValue===t.exportValue;h.domElement&&(h.domElement.checked=c),e.setValue(h.id,{value:c})}e.setValue(s,{value:l})}),r.addEventListener("resetform",a=>{const o=t.defaultFieldValue||"Off";a.target.checked=o===t.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",a=>{const o={value(l){l.target.checked=l.detail.value!=="Off",e.setValue(s,{value:l.target.checked})}};this._dispatchEventFromSandbox(o,a)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class dm extends Ha{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.fieldValue===t.buttonValue}).value;if(typeof i=="string"&&(i=i!==t.buttonValue,e.setValue(s,{value:i})),i)for(const a of this._getElementsByName(t.fieldName,s))e.setValue(a.id,{value:!1});const r=document.createElement("input");if(_a.add(r),r.setAttribute("data-element-id",s),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=t.fieldName,i&&r.setAttribute("checked",!0),r.tabIndex=0,r.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const h of this._getElementsByName(o,s))e.setValue(h.id,{value:!1});e.setValue(s,{value:l})}),r.addEventListener("resetform",a=>{const o=t.defaultFieldValue;a.target.checked=o!=null&&o===t.buttonValue}),this.enableScripting&&this.hasJSActions){const a=t.buttonValue;r.addEventListener("updatefromsandbox",o=>{const l={value:h=>{const c=a===h.detail.value;for(const u of this._getElementsByName(h.target.name)){const f=c&&u.id===s;u.domElement&&(u.domElement.checked=f),e.setValue(u.id,{value:f})}}};this._dispatchEventFromSandbox(l,o)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class Wy extends up{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),e}}class Xy extends Ha{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,s=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");_a.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=0;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",c=>{const u=this.data.defaultFieldValue;for(const f of i.options)f.selected=f.value===u});for(const c of this.data.options){const u=document.createElement("option");u.textContent=c.displayValue,u.value=c.exportValue,s.value.includes(c.exportValue)&&(u.setAttribute("selected",!0),r=!1),i.append(u)}let a=null;if(r){const c=document.createElement("option");c.value=" ",c.setAttribute("hidden",!0),c.setAttribute("selected",!0),i.prepend(c),a=()=>{c.remove(),i.removeEventListener("input",a),a=null},i.addEventListener("input",a)}const o=c=>{const u=c?"value":"textContent",{options:f,multiple:p}=i;return p?Array.prototype.filter.call(f,v=>v.selected).map(v=>v[u]):f.selectedIndex===-1?null:f[f.selectedIndex][u]};let l=o(!1);const h=c=>{const u=c.target.options;return Array.prototype.map.call(u,f=>({displayValue:f.textContent,exportValue:f.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",c=>{const u={value(f){a==null||a();const p=f.detail.value,v=new Set(Array.isArray(p)?p:[p]);for(const m of i.options)m.selected=v.has(m.value);e.setValue(t,{value:o(!0)}),l=o(!1)},multipleSelection(f){i.multiple=!0},remove(f){const p=i.options,v=f.detail.remove;p[v].selected=!1,i.remove(v),p.length>0&&Array.prototype.findIndex.call(p,w=>w.selected)===-1&&(p[0].selected=!0),e.setValue(t,{value:o(!0),items:h(f)}),l=o(!1)},clear(f){for(;i.length!==0;)i.remove(0);e.setValue(t,{value:null,items:[]}),l=o(!1)},insert(f){const{index:p,displayValue:v,exportValue:m}=f.detail.insert,w=i.children[p],b=document.createElement("option");b.textContent=v,b.value=m,w?w.before(b):i.append(b),e.setValue(t,{value:o(!0),items:h(f)}),l=o(!1)},items(f){const{items:p}=f.detail;for(;i.length!==0;)i.remove(0);for(const v of p){const{displayValue:m,exportValue:w}=v,b=document.createElement("option");b.textContent=m,b.value=w,i.append(b)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:o(!0),items:h(f)}),l=o(!1)},indices(f){const p=new Set(f.detail.indices);for(const v of f.target.options)v.selected=p.has(v.index);e.setValue(t,{value:o(!0)}),l=o(!1)},editable(f){f.target.disabled=!f.detail.editable}};this._dispatchEventFromSandbox(u,c)}),i.addEventListener("input",c=>{var p;const u=o(!0),f=o(!1);e.setValue(t,{value:u}),c.preventDefault(),(p=this.linkService.eventBus)==null||p.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:l,change:f,changeEx:u,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],c=>c.target.value)):i.addEventListener("input",function(c){e.setValue(t,{value:o(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}var cc,Sf;class Ef extends Ht{constructor(t){const{data:s,elements:i,parent:r}=t,a=!!r._commentManager;super(t,{isRenderable:!a&&Ht._hasPopupData(s)});y(this,cc);if(this.elements=i,a&&Ht._hasPopupData(s)){const o=this.popup=A(this,cc,Sf).call(this);for(const l of i)l.popup=o}else this.popup=null}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const s=this.popup=A(this,cc,Sf).call(this),i=[];for(const r of this.elements)r.popup=s,r.container.ariaHasPopup="dialog",i.push(r.data.id),r.addHighlightArea();return this.container.setAttribute("aria-controls",i.map(r=>`${ap}${r}`).join(",")),this.container}}cc=new WeakSet,Sf=function(){return new Yy({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})};var ns,Yn,ou,lu,el,sl,Gt,mi,Kn,da,il,nl,vi,rs,en,sn,le,nn,Jn,dc,rn,rl,ua,Qn,Ie,Zn,at,vd,xf,Tf,Cf,yd,Rf,um,fm,pm,gm,bd,Ad,Pf;class Yy{constructor({container:e,color:t,elements:s,titleObj:i,modificationDate:r,contentsObj:a,richText:o,parent:l,rect:h,parentRect:c,open:u,commentManager:f=null}){y(this,at);y(this,ns,null);y(this,Yn,A(this,at,pm).bind(this));y(this,ou,A(this,at,Pf).bind(this));y(this,lu,A(this,at,Ad).bind(this));y(this,el,A(this,at,bd).bind(this));y(this,sl,null);y(this,Gt,null);y(this,mi,null);y(this,Kn,null);y(this,da,null);y(this,il,null);y(this,nl,null);y(this,vi,!1);y(this,rs,null);y(this,en,null);y(this,sn,null);y(this,le,null);y(this,nn,null);y(this,Jn,null);y(this,dc,null);y(this,rn,null);y(this,rl,null);y(this,ua,null);y(this,Qn,!1);y(this,Ie,null);y(this,Zn,null);g(this,Gt,e),g(this,rl,i),g(this,mi,a),g(this,rn,o),g(this,il,l),g(this,sl,t),g(this,dc,h),g(this,nl,c),g(this,da,s),g(this,ns,f),g(this,Ie,s[0]),g(this,Kn,Bd.toDateObject(r)),this.trigger=s.flatMap(p=>p.getElementsToTriggerPopup()),f?this.renderCommentButton():(A(this,at,vd).call(this),n(this,Gt).hidden=!0,u&&A(this,at,bd).call(this))}renderCommentButton(){if(n(this,le)||(n(this,nn)||A(this,at,xf).call(this),!n(this,nn)))return;const{signal:e}=g(this,en,new AbortController),t=!!n(this,Ie).extraPopupElement,s=()=>{n(this,ns).toggleCommentPopup(this,!0,void 0,!t)},i=()=>{n(this,ns).toggleCommentPopup(this,!1,!0,!t)},r=()=>{n(this,ns).toggleCommentPopup(this,!1,!1)};if(t){g(this,le,n(this,Ie).container);for(const a of this.trigger)a.ariaHasPopup="dialog",a.ariaControls="commentPopup",a.addEventListener("keydown",n(this,Yn),{signal:e}),a.addEventListener("click",s,{signal:e}),a.addEventListener("pointerenter",i,{signal:e}),a.addEventListener("pointerleave",r,{signal:e}),a.classList.add("popupTriggerArea")}else{const a=g(this,le,document.createElement("button"));a.className="annotationCommentButton";const o=n(this,Ie).container;a.style.zIndex=o.style.zIndex+1,a.tabIndex=0,a.ariaHasPopup="dialog",a.ariaControls="commentPopup",a.setAttribute("data-l10n-id","pdfjs-show-comment-button"),A(this,at,Cf).call(this),A(this,at,Tf).call(this),a.addEventListener("keydown",n(this,Yn),{signal:e}),a.addEventListener("click",s,{signal:e}),a.addEventListener("pointerenter",i,{signal:e}),a.addEventListener("pointerleave",r,{signal:e}),o.after(a)}}get commentButtonColor(){const{color:e,opacity:t}=n(this,Ie).commentData;return e?n(this,il)._commentManager.makeCommentColor(e,t):null}focusCommentButton(){setTimeout(()=>{var e;(e=n(this,le))==null||e.focus()},0)}getData(){const{richText:e,color:t,opacity:s,creationDate:i,modificationDate:r}=n(this,Ie).commentData;return{contentsObj:{str:this.comment},richText:e,color:t,opacity:s,creationDate:i,modificationDate:r}}get elementBeforePopup(){return n(this,le)}get comment(){return n(this,Zn)||g(this,Zn,n(this,Ie).commentText),n(this,Zn)}set comment(e){e!==this.comment&&(n(this,Ie).commentText=g(this,Zn,e))}get parentBoundingClientRect(){return n(this,Ie).layer.getBoundingClientRect()}setCommentButtonStates({selected:e,hasPopup:t}){n(this,le)&&(n(this,le).classList.toggle("selected",e),n(this,le).ariaExpanded=t)}setSelectedCommentButton(e){n(this,le).classList.toggle("selected",e)}get commentPopupPosition(){if(n(this,Jn))return n(this,Jn);const{x:e,y:t,height:s}=n(this,le).getBoundingClientRect(),{x:i,y:r,width:a,height:o}=n(this,Ie).layer.getBoundingClientRect();return[(e-i)/a,(t+s-r)/o]}set commentPopupPosition(e){g(this,Jn,e)}hasDefaultPopupPosition(){return n(this,Jn)===null}get commentButtonPosition(){return n(this,nn)}get commentButtonWidth(){return n(this,le).getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(e){const[t,s]=n(this,Jn)||this.commentButtonPosition.map(h=>h/100),i=this.parentBoundingClientRect,{x:r,y:a,width:o,height:l}=i;n(this,ns).showDialog(null,this,r+t*o,a+s*l,{...e,parentDimensions:i})}render(){var s,i;if(n(this,rs))return;const e=g(this,rs,document.createElement("div"));if(e.className="popup",n(this,sl)){const r=e.style.outlineColor=G.makeHexColor(...n(this,sl));e.style.backgroundColor=`color-mix(in srgb, ${r} 30%, white)`}const t=document.createElement("span");if(t.className="header",(s=n(this,rl))!=null&&s.str){const r=document.createElement("span");r.className="title",t.append(r),{dir:r.dir,str:r.textContent}=n(this,rl)}if(e.append(t),n(this,Kn)){const r=document.createElement("time");r.className="popupDate",r.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),r.setAttribute("data-l10n-args",JSON.stringify({dateObj:n(this,Kn).valueOf()})),r.dateTime=n(this,Kn).toISOString(),t.append(r)}rg({html:n(this,at,yd)||n(this,mi).str,dir:(i=n(this,mi))==null?void 0:i.dir,className:"popupContent"},e),n(this,Gt).append(e)}updateEdited({rect:e,popup:t,deleted:s}){var i;if(n(this,ns)){s?(this.remove(),g(this,Zn,null)):t&&(t.deleted?this.remove():(A(this,at,Cf).call(this),g(this,Zn,t.text))),e&&(g(this,nn,null),A(this,at,xf).call(this),A(this,at,Tf).call(this));return}if(s||t!=null&&t.deleted){this.remove();return}A(this,at,vd).call(this),n(this,ua)||g(this,ua,{contentsObj:n(this,mi),richText:n(this,rn)}),e&&g(this,sn,null),t&&t.text&&(g(this,rn,A(this,at,fm).call(this,t.text)),g(this,Kn,Bd.toDateObject(t.date)),g(this,mi,null)),(i=n(this,rs))==null||i.remove(),g(this,rs,null)}resetEdited(){var e;n(this,ua)&&({contentsObj:te(this,mi)._,richText:te(this,rn)._}=n(this,ua),g(this,ua,null),(e=n(this,rs))==null||e.remove(),g(this,rs,null),g(this,sn,null))}remove(){var e,t,s;if((e=n(this,en))==null||e.abort(),g(this,en,null),(t=n(this,rs))==null||t.remove(),g(this,rs,null),g(this,Qn,!1),g(this,vi,!1),(s=n(this,le))==null||s.remove(),g(this,le,null),this.trigger)for(const i of this.trigger)i.classList.remove("popupTriggerArea")}forceHide(){g(this,Qn,this.isVisible),n(this,Qn)&&(n(this,Gt).hidden=!0)}maybeShow(){n(this,ns)||(A(this,at,vd).call(this),n(this,Qn)&&(n(this,rs)||A(this,at,Ad).call(this),g(this,Qn,!1),n(this,Gt).hidden=!1))}get isVisible(){return n(this,ns)?!1:n(this,Gt).hidden===!1}}ns=new WeakMap,Yn=new WeakMap,ou=new WeakMap,lu=new WeakMap,el=new WeakMap,sl=new WeakMap,Gt=new WeakMap,mi=new WeakMap,Kn=new WeakMap,da=new WeakMap,il=new WeakMap,nl=new WeakMap,vi=new WeakMap,rs=new WeakMap,en=new WeakMap,sn=new WeakMap,le=new WeakMap,nn=new WeakMap,Jn=new WeakMap,dc=new WeakMap,rn=new WeakMap,rl=new WeakMap,ua=new WeakMap,Qn=new WeakMap,Ie=new WeakMap,Zn=new WeakMap,at=new WeakSet,vd=function(){var t;if(n(this,en))return;g(this,en,new AbortController);const{signal:e}=n(this,en);for(const s of this.trigger)s.addEventListener("click",n(this,el),{signal:e}),s.addEventListener("pointerenter",n(this,lu),{signal:e}),s.addEventListener("pointerleave",n(this,ou),{signal:e}),s.classList.add("popupTriggerArea");for(const s of n(this,da))(t=s.container)==null||t.addEventListener("keydown",n(this,Yn),{signal:e})},xf=function(){const e=n(this,da).find(t=>t.hasCommentButton);e&&g(this,nn,e._normalizePoint(e.commentButtonPosition))},Tf=function(){if(n(this,Ie).extraPopupElement&&!n(this,Ie).editor)return;this.renderCommentButton();const[e,t]=n(this,nn),{style:s}=n(this,le);s.left=`calc(${e}%)`,s.top=`calc(${t}% - var(--comment-button-dim))`},Cf=function(){n(this,Ie).extraPopupElement||(this.renderCommentButton(),n(this,le).style.backgroundColor=this.commentButtonColor||"")},yd=function(){const e=n(this,rn),t=n(this,mi);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&n(this,rn).html||null},Rf=function(){var e,t,s;return((s=(t=(e=n(this,at,yd))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.fontSize)||0},um=function(){var e,t,s;return((s=(t=(e=n(this,at,yd))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.color)||null},fm=function(e){const t=[],s={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},i={style:{color:n(this,at,um),fontSize:n(this,at,Rf)?`calc(${n(this,at,Rf)}px * var(--total-scale-factor))`:""}};for(const r of e.split(`
`))t.push({name:"span",value:r,attributes:i});return s},pm=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&n(this,vi))&&A(this,at,bd).call(this)},gm=function(){if(n(this,sn)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:s,pageX:i,pageY:r}}}=n(this,il);let a=!!n(this,nl),o=a?n(this,nl):n(this,dc);for(const v of n(this,da))if(!o||G.intersect(v.data.rect,o)!==null){o=v.data.rect,a=!0;break}const l=G.normalizeRect([o[0],e[3]-o[1]+e[1],o[2],e[3]-o[3]+e[1]]),c=a?o[2]-o[0]+5:0,u=l[0]+c,f=l[1];g(this,sn,[100*(u-i)/t,100*(f-r)/s]);const{style:p}=n(this,Gt);p.left=`${n(this,sn)[0]}%`,p.top=`${n(this,sn)[1]}%`},bd=function(){if(n(this,ns)){n(this,ns).toggleCommentPopup(this,!1);return}g(this,vi,!n(this,vi)),n(this,vi)?(A(this,at,Ad).call(this),n(this,Gt).addEventListener("click",n(this,el)),n(this,Gt).addEventListener("keydown",n(this,Yn))):(A(this,at,Pf).call(this),n(this,Gt).removeEventListener("click",n(this,el)),n(this,Gt).removeEventListener("keydown",n(this,Yn)))},Ad=function(){n(this,rs)||this.render(),this.isVisible?n(this,vi)&&n(this,Gt).classList.add("focused"):(A(this,at,gm).call(this),n(this,Gt).hidden=!1,n(this,Gt).style.zIndex=parseInt(n(this,Gt).style.zIndex)+1e3)},Pf=function(){n(this,Gt).classList.remove("focused"),!(n(this,vi)||!this.isVisible)&&(n(this,Gt).hidden=!0,n(this,Gt).style.zIndex=parseInt(n(this,Gt).style.zIndex)-1e3)};class mm extends Ht{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=st.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const s=document.createElement("span");s.textContent=t,e.append(s)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var uc;class Ky extends Ht{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});y(this,uc,null)}render(){this.container.classList.add("lineAnnotation");const{data:t,width:s,height:i}=this,r=this.svgFactory.create(s,i,!0),a=g(this,uc,this.svgFactory.createElement("svg:line"));return a.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),a.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),a.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),a.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return n(this,uc)}addHighlightArea(){this.container.classList.add("highlightArea")}}uc=new WeakMap;var fc;class Jy extends Ht{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});y(this,fc,null)}render(){this.container.classList.add("squareAnnotation");const{data:t,width:s,height:i}=this,r=this.svgFactory.create(s,i,!0),a=t.borderStyle.width,o=g(this,fc,this.svgFactory.createElement("svg:rect"));return o.setAttribute("x",a/2),o.setAttribute("y",a/2),o.setAttribute("width",s-a),o.setAttribute("height",i-a),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return n(this,fc)}addHighlightArea(){this.container.classList.add("highlightArea")}}fc=new WeakMap;var pc;class Qy extends Ht{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});y(this,pc,null)}render(){this.container.classList.add("circleAnnotation");const{data:t,width:s,height:i}=this,r=this.svgFactory.create(s,i,!0),a=t.borderStyle.width,o=g(this,pc,this.svgFactory.createElement("svg:ellipse"));return o.setAttribute("cx",s/2),o.setAttribute("cy",i/2),o.setAttribute("rx",s/2-a/2),o.setAttribute("ry",i/2-a/2),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return n(this,pc)}addHighlightArea(){this.container.classList.add("highlightArea")}}pc=new WeakMap;var gc;class vm extends Ht{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});y(this,gc,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:s,borderStyle:i,popupRef:r},width:a,height:o}=this;if(!s)return this.container;const l=this.svgFactory.create(a,o,!0);let h=[];for(let u=0,f=s.length;u<f;u+=2){const p=s[u]-t[0],v=t[3]-s[u+1];h.push(`${p},${v}`)}h=h.join(" ");const c=g(this,gc,this.svgFactory.createElement(this.svgElementName));return c.setAttribute("points",h),c.setAttribute("stroke-width",i.width||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),l.append(c),this.container.append(l),!r&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return n(this,gc)}addHighlightArea(){this.container.classList.add("highlightArea")}}gc=new WeakMap;class Zy extends vm{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class qy extends Ht{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var mc,fa,vc,If;class fp extends Ht{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});y(this,vc);y(this,mc,null);y(this,fa,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?st.HIGHLIGHT:st.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:s,inkLists:i,borderStyle:r,popupRef:a}}=this,{transform:o,width:l,height:h}=A(this,vc,If).call(this,s,t),c=this.svgFactory.create(l,h,!0),u=g(this,mc,this.svgFactory.createElement("svg:g"));c.append(u),u.setAttribute("stroke-width",r.width||1),u.setAttribute("stroke-linecap","round"),u.setAttribute("stroke-linejoin","round"),u.setAttribute("stroke-miterlimit",10),u.setAttribute("stroke","transparent"),u.setAttribute("fill","transparent"),u.setAttribute("transform",o);for(let f=0,p=i.length;f<p;f++){const v=this.svgFactory.createElement(this.svgElementName);n(this,fa).push(v),v.setAttribute("points",i[f].join(",")),u.append(v)}return!a&&this.hasPopupData&&this._createPopup(),this.container.append(c),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:s,points:i,rect:r}=t,a=n(this,mc);if(s>=0&&a.setAttribute("stroke-width",s||1),i)for(let o=0,l=n(this,fa).length;o<l;o++)n(this,fa)[o].setAttribute("points",i[o].join(","));if(r){const{transform:o,width:l,height:h}=A(this,vc,If).call(this,this.data.rotation,r);a.parentElement.setAttribute("viewBox",`0 0 ${l} ${h}`),a.setAttribute("transform",o)}}getElementsToTriggerPopup(){return n(this,fa)}addHighlightArea(){this.container.classList.add("highlightArea")}}mc=new WeakMap,fa=new WeakMap,vc=new WeakSet,If=function(t,s){switch(t){case 90:return{transform:`rotate(90) translate(${-s[0]},${s[1]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};case 180:return{transform:`rotate(180) translate(${-s[2]},${s[1]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]};case 270:return{transform:`rotate(270) translate(${-s[2]},${s[3]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};default:return{transform:`translate(${-s[0]},${s[3]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]}}};class ym extends Ht{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=st.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const s=document.createElement("mark");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class tb extends Ht{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),e){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class eb extends Ht{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),e){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class sb extends Ht{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),e){const s=document.createElement("s");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class bm extends Ht{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=st.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var yc,bc,Df;class ib extends Ht{constructor(t){var i;super(t,{isRenderable:!0});y(this,bc);y(this,yc,null);const{file:s}=this.data;this.filename=s.filename,this.content=s.content,(i=this.linkService.eventBus)==null||i.dispatch("fileattachmentannotation",{source:this,...s})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:s}=this;let i;s.hasAppearance||s.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(s.name)?"paperclip":"pushpin"}.svg`,s.fillAlpha&&s.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(s.fillAlpha*100)}%);`)),i.addEventListener("dblclick",A(this,bc,Df).bind(this)),g(this,yc,i);const{isMac:r}=Se.platform;return t.addEventListener("keydown",a=>{a.key==="Enter"&&(r?a.metaKey:a.ctrlKey)&&A(this,bc,Df).call(this)}),!s.popupRef&&this.hasPopupData?this._createPopup():i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return n(this,yc)}addHighlightArea(){this.container.classList.add("highlightArea")}}yc=new WeakMap,bc=new WeakSet,Df=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var al,pa,ol,qn,Ac,ga,vr,Of,Lf;const wp=class wp{constructor({div:e,accessibilityManager:t,annotationCanvasMap:s,annotationEditorUIManager:i,page:r,viewport:a,structTreeLayer:o,commentManager:l,linkService:h,annotationStorage:c}){y(this,vr);y(this,al,null);y(this,pa,null);y(this,ol,null);y(this,qn,new Map);y(this,Ac,null);y(this,ga,null);this.div=e,g(this,al,t),g(this,pa,s),g(this,Ac,o||null),g(this,ga,h||null),g(this,ol,c||new hp),this.page=r,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=i,this._commentManager=l||null}hasEditableAnnotations(){return n(this,qn).size>0}async render(e){var a,o,l;const{annotations:t}=e,s=this.div;Na(s,this.viewport);const i=new Map,r={data:null,layer:s,linkService:n(this,ga),downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new Vd,annotationStorage:n(this,ol),enableComment:e.enableComment===!0,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const h of t){if(h.noHTML)continue;const c=h.annotationType===Qt.POPUP;if(c){const p=i.get(h.id);if(!p)continue;r.elements=p}else if(h.rect[2]===h.rect[0]||h.rect[3]===h.rect[1])continue;r.data=h;const u=Jp.create(r);if(!u.isRenderable)continue;if(!c&&h.popupRef){const p=i.get(h.popupRef);p?p.push(u):i.set(h.popupRef,[u])}const f=u.render();h.hidden&&(f.style.visibility="hidden"),await A(this,vr,Of).call(this,f,h.id,r.elements),(o=(a=u.extraPopupElement)==null?void 0:a.popup)==null||o.renderCommentButton(),u._isEditable&&(n(this,qn).set(u.data.id,u),(l=this._annotationEditorUIManager)==null||l.renderAnnotationElement(u))}A(this,vr,Lf).call(this)}async addLinkAnnotations(e){const t={data:null,layer:this.div,linkService:n(this,ga),svgFactory:new Vd,parent:this};for(const s of e){s.borderStyle||(s.borderStyle=wp._defaultBorderStyle),t.data=s;const i=Jp.create(t);if(!i.isRenderable)continue;const r=i.render();await A(this,vr,Of).call(this,r,s.id,null)}}update({viewport:e}){const t=this.div;this.viewport=e,Na(t,{rotation:e.rotation}),A(this,vr,Lf).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(n(this,qn).values())}getEditableAnnotation(e){return n(this,qn).get(e)}addFakeAnnotation(e){var o;const{div:t}=this,{id:s,rotation:i}=e,r=new $y({data:{id:s,rect:e.getPDFRect(),rotation:i},editor:e,layer:t,parent:this,enableComment:!!this._commentManager,linkService:n(this,ga),annotationStorage:n(this,ol)}),a=r.render();return t.append(a),(o=n(this,al))==null||o.moveElementInDOM(t,a,a,!1),r.createOrUpdatePopup(),r}static get _defaultBorderStyle(){return lt(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:za.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};al=new WeakMap,pa=new WeakMap,ol=new WeakMap,qn=new WeakMap,Ac=new WeakMap,ga=new WeakMap,vr=new WeakSet,Of=async function(e,t,s){var o,l;const i=e.firstChild||e,r=i.id=`${ap}${t}`,a=await((o=n(this,Ac))==null?void 0:o.getAriaAttributes(r));if(a)for(const[h,c]of a)i.setAttribute(h,c);s?s.at(-1).container.after(e):(this.div.append(e),(l=n(this,al))==null||l.moveElementInDOM(this.div,e,i,!1))},Lf=function(){var t;if(!n(this,pa))return;const e=this.div;for(const[s,i]of n(this,pa)){const r=e.querySelector(`[data-annotation-id="${s}"]`);if(!r)continue;i.className="annotationContent";const{firstChild:a}=r;a?a.nodeName==="CANVAS"?a.replaceWith(i):a.classList.contains("annotationContent")?a.after(i):a.before(i):r.append(i);const o=n(this,qn).get(s);o&&(o._hasNoCanvas?((t=this._annotationEditorUIManager)==null||t.setMissingCanvas(s,r.id,i),o._hasNoCanvas=!1):o.canvas=i)}n(this,pa).clear()};let Mf=wp;const ed=/\r\n?|\n/g;var as,wc,ma,os,qt,Am,wm,Em,wd,gn,Ed,Sd,Sm,kf,xm;const Ft=class Ft extends Ot{constructor(t){super({...t,name:"freeTextEditor"});y(this,qt);y(this,as,"");y(this,wc,`${this.id}-editor`);y(this,ma,null);y(this,os);k(this,"_colorPicker",null);this.color=t.color||Ft._defaultColor||Ot._defaultLineColor,g(this,os,t.fontSize||Ft._defaultFontSize),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static get _keyboardManager(){const t=Ft.prototype,s=a=>a.isEmpty(),i=Ba.TRANSLATE_SMALL,r=Ba.TRANSLATE_BIG;return lt(this,"_keyboardManager",new zc([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:s}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:s}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:s}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:s}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:s}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:s}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:s}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:s}]]))}static initialize(t,s){Ot.initialize(t,s);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,s){switch(t){case ct.FREETEXT_SIZE:Ft._defaultFontSize=s;break;case ct.FREETEXT_COLOR:Ft._defaultColor=s;break}}updateParams(t,s){switch(t){case ct.FREETEXT_SIZE:A(this,qt,Am).call(this,s);break;case ct.FREETEXT_COLOR:A(this,qt,wm).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[ct.FREETEXT_SIZE,Ft._defaultFontSize],[ct.FREETEXT_COLOR,Ft._defaultColor||Ot._defaultLineColor]]}get propertiesToUpdate(){return[[ct.FREETEXT_SIZE,n(this,os)],[ct.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new Gd(this)),[["colorPicker",this._colorPicker]]}get colorType(){return ct.FREETEXT_COLOR}onUpdatedColor(){var t;this.editorDiv.style.color=this.color,(t=this._colorPicker)==null||t.update(this.color),super.onUpdatedColor()}_translateEmpty(t,s){this._uiManager.translateSelectedEditors(t,s,!0)}getInitialTranslation(){const t=this.parentScale;return[-Ft._internalPadding*t,-(Ft._internalPadding+n(this,os))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),g(this,ma,new AbortController);const t=this._uiManager.combinedSignal(n(this,ma));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){var t;return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",n(this,wc)),this._isDraggable=!0,(t=n(this,ma))==null||t.abort(),g(this,ma,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var s;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(s=this._initialOptions)!=null&&s.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=n(this,as),s=g(this,as,A(this,qt,Em).call(this).trimEnd());if(t===s)return;const i=r=>{if(g(this,as,r),!r){this.remove();return}A(this,qt,Sd).call(this),this._uiManager.rebuild(this),A(this,qt,wd).call(this)};this.addCommands({cmd:()=>{i(s)},undo:()=>{i(t)},mustExec:!1}),A(this,qt,wd).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Ft._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,s;(this._isCopy||this.annotationElementId)&&(t=this.x,s=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",n(this,wc)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${n(this,os)}px * var(--total-scale-factor))`,i.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[r,a]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[l,h]=this.getInitialTranslation();[l,h]=this.pageTranslationToScreen(l,h);const[c,u]=this.pageDimensions,[f,p]=this.pageTranslation;let v,m;switch(this.rotation){case 0:v=t+(o[0]-f)/c,m=s+this.height-(o[1]-p)/u;break;case 90:v=t+(o[0]-f)/c,m=s-(o[1]-p)/u,[l,h]=[h,-l];break;case 180:v=t-this.width+(o[0]-f)/c,m=s-(o[1]-p)/u,[l,h]=[-l,-h];break;case 270:v=t+(o[0]-f-this.height*u)/c,m=s+(o[1]-p-this.width*c)/u,[l,h]=[-h,l];break}this.setAt(v*r,m*a,l,h)}else this._moveAfterPaste(t,s);A(this,qt,Sd).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var v,m,w;const s=t.clipboardData||window.clipboardData,{types:i}=s;if(i.length===1&&i[0]==="text/plain")return;t.preventDefault();const r=A(v=Ft,gn,kf).call(v,s.getData("text")||"").replaceAll(ed,`
`);if(!r)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const o=a.getRangeAt(0);if(!r.includes(`
`)){o.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:l,startOffset:h}=o,c=[],u=[];if(l.nodeType===Node.TEXT_NODE){const b=l.parentElement;if(u.push(l.nodeValue.slice(h).replaceAll(ed,"")),b!==this.editorDiv){let S=c;for(const E of this.editorDiv.childNodes){if(E===b){S=u;continue}S.push(A(m=Ft,gn,Ed).call(m,E))}}c.push(l.nodeValue.slice(0,h).replaceAll(ed,""))}else if(l===this.editorDiv){let b=c,S=0;for(const E of this.editorDiv.childNodes)S++===h&&(b=u),b.push(A(w=Ft,gn,Ed).call(w,E))}g(this,as,`${c.join(`
`)}${r}${u.join(`
`)}`),A(this,qt,Sd).call(this);const f=new Range;let p=Math.sumPrecise(c.map(b=>b.length));for(const{firstChild:b}of this.editorDiv.childNodes)if(b.nodeType===Node.TEXT_NODE){const S=b.nodeValue.length;if(p<=S){f.setStart(b,p),f.setEnd(b,p);break}p-=S}a.removeAllRanges(),a.addRange(f)}get contentDiv(){return this.editorDiv}getPDFRect(){const t=Ft._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,s,i){var o;let r=null;if(t instanceof mm){const{data:{defaultAppearanceData:{fontSize:l,fontColor:h},rect:c,rotation:u,id:f,popupRef:p,richText:v,contentsObj:m,creationDate:w,modificationDate:b},textContent:S,textPosition:E,parent:{page:{pageNumber:T}}}=t;if(!S||S.length===0)return null;r=t={annotationType:st.FREETEXT,color:Array.from(h),fontSize:l,value:S.join(`
`),position:E,pageIndex:T-1,rect:c.slice(0),rotation:u,annotationElementId:f,id:f,deleted:!1,popupRef:p,comment:(m==null?void 0:m.str)||null,richText:v,creationDate:w,modificationDate:b}}const a=await super.deserialize(t,s,i);return g(a,os,t.fontSize),a.color=G.makeHexColor(...t.color),g(a,as,A(o=Ft,gn,kf).call(o,t.value)),a._initialData=r,t.comment&&a.setCommentData(t),a}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=Ot._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),i=Object.assign(super.serialize(t),{color:s,fontSize:n(this,os),value:A(this,qt,Sm).call(this)});return this.addComment(i),t?(i.isCopy=!0,i):this.annotationElementId&&!A(this,qt,xm).call(this,i)?null:(i.id=this.annotationElementId,i)}renderAnnotationElement(t){const s=super.renderAnnotationElement(t);if(!s)return null;const{style:i}=s;i.fontSize=`calc(${n(this,os)}px * var(--total-scale-factor))`,i.color=this.color,s.replaceChildren();for(const r of n(this,as).split(`
`)){const a=document.createElement("div");a.append(r?document.createTextNode(r):document.createElement("br")),s.append(a)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:n(this,as)}}),s}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};as=new WeakMap,wc=new WeakMap,ma=new WeakMap,os=new WeakMap,qt=new WeakSet,Am=function(t){const s=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--total-scale-factor))`,this.translate(0,-(r-n(this,os))*this.parentScale),g(this,os,r),A(this,qt,wd).call(this)},i=n(this,os);this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ct.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},wm=function(t){const s=r=>{this.color=r,this.onUpdatedColor()},i=this.color;this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ct.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Em=function(){var i;const t=[];this.editorDiv.normalize();let s=null;for(const r of this.editorDiv.childNodes)(s==null?void 0:s.nodeType)===Node.TEXT_NODE&&r.nodeName==="BR"||(t.push(A(i=Ft,gn,Ed).call(i,r)),s=r);return t.join(`
`)},wd=function(){const[t,s]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:r,div:a}=this,o=a.style.display,l=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",r.div.append(this.div),i=a.getBoundingClientRect(),a.remove(),a.style.display=o,a.classList.toggle("hidden",l)}this.rotation%180===this.parentRotation%180?(this.width=i.width/t,this.height=i.height/s):(this.width=i.height/t,this.height=i.width/s),this.fixAndSetPosition()},gn=new WeakSet,Ed=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(ed,"")},Sd=function(){if(this.editorDiv.replaceChildren(),!!n(this,as))for(const t of n(this,as).split(`
`)){const s=document.createElement("div");s.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(s)}},Sm=function(){return n(this,as).replaceAll(" "," ")},kf=function(t){return t.replaceAll(" "," ")},xm=function(t){const{value:s,fontSize:i,color:r,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==s||t.fontSize!==i||t.color.some((o,l)=>o!==r[l])||t.pageIndex!==a},y(Ft,gn),k(Ft,"_freeTextDefaultContent",""),k(Ft,"_internalPadding",0),k(Ft,"_defaultColor",null),k(Ft,"_defaultFontSize",10),k(Ft,"_type","freetext"),k(Ft,"_editorType",st.FREETEXT);let Ff=Ft;class z{toSVGPath(){It("Abstract method `toSVGPath` must be implemented.")}get box(){It("Abstract getter `box` must be implemented.")}serialize(e,t){It("Abstract method `serialize` must be implemented.")}static _rescale(e,t,s,i,r,a){a||(a=new Float32Array(e.length));for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o]*i,a[o+1]=s+e[o+1]*r;return a}static _rescaleAndSwap(e,t,s,i,r,a){a||(a=new Float32Array(e.length));for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o+1]*i,a[o+1]=s+e[o]*r;return a}static _translate(e,t,s,i){i||(i=new Float32Array(e.length));for(let r=0,a=e.length;r<a;r+=2)i[r]=t+e[r],i[r+1]=s+e[r+1];return i}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,s,i,r){switch(r){case 90:return[1-t/s,e/i];case 180:return[1-e/s,1-t/i];case 270:return[t/s,1-e/i];default:return[e/s,t/i]}}static _normalizePagePoint(e,t,s){switch(s){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,s,i,r,a){return[(e+5*s)/6,(t+5*i)/6,(5*s+r)/6,(5*i+a)/6,(s+r)/2,(i+a)/2]}}k(z,"PRECISION",1e-4);var ls,Vs,ll,hl,yi,ht,va,ya,Ec,Sc,cl,dl,tr,xc,hu,cu,re,Kl,Tm,Cm,Rm,Pm,Im,Dm;const Mi=class Mi{constructor({x:e,y:t},s,i,r,a,o=0){y(this,re);y(this,ls);y(this,Vs,[]);y(this,ll);y(this,hl);y(this,yi,[]);y(this,ht,new Float32Array(18));y(this,va);y(this,ya);y(this,Ec);y(this,Sc);y(this,cl);y(this,dl);y(this,tr,[]);g(this,ls,s),g(this,dl,r*i),g(this,hl,a),n(this,ht).set([NaN,NaN,NaN,NaN,e,t],6),g(this,ll,o),g(this,Sc,n(Mi,xc)*i),g(this,Ec,n(Mi,cu)*i),g(this,cl,i),n(this,tr).push(e,t)}isEmpty(){return isNaN(n(this,ht)[8])}add({x:e,y:t}){var P;g(this,va,e),g(this,ya,t);const[s,i,r,a]=n(this,ls);let[o,l,h,c]=n(this,ht).subarray(8,12);const u=e-h,f=t-c,p=Math.hypot(u,f);if(p<n(this,Ec))return!1;const v=p-n(this,Sc),m=v/p,w=m*u,b=m*f;let S=o,E=l;o=h,l=c,h+=w,c+=b,(P=n(this,tr))==null||P.push(e,t);const T=-b/v,x=w/v,C=T*n(this,dl),R=x*n(this,dl);return n(this,ht).set(n(this,ht).subarray(2,8),0),n(this,ht).set([h+C,c+R],4),n(this,ht).set(n(this,ht).subarray(14,18),12),n(this,ht).set([h-C,c-R],16),isNaN(n(this,ht)[6])?(n(this,yi).length===0&&(n(this,ht).set([o+C,l+R],2),n(this,yi).push(NaN,NaN,NaN,NaN,(o+C-s)/r,(l+R-i)/a),n(this,ht).set([o-C,l-R],14),n(this,Vs).push(NaN,NaN,NaN,NaN,(o-C-s)/r,(l-R-i)/a)),n(this,ht).set([S,E,o,l,h,c],6),!this.isEmpty()):(n(this,ht).set([S,E,o,l,h,c],6),Math.abs(Math.atan2(E-l,S-o)-Math.atan2(b,w))<Math.PI/2?([o,l,h,c]=n(this,ht).subarray(2,6),n(this,yi).push(NaN,NaN,NaN,NaN,((o+h)/2-s)/r,((l+c)/2-i)/a),[o,l,S,E]=n(this,ht).subarray(14,18),n(this,Vs).push(NaN,NaN,NaN,NaN,((S+o)/2-s)/r,((E+l)/2-i)/a),!0):([S,E,o,l,h,c]=n(this,ht).subarray(0,6),n(this,yi).push(((S+5*o)/6-s)/r,((E+5*l)/6-i)/a,((5*o+h)/6-s)/r,((5*l+c)/6-i)/a,((o+h)/2-s)/r,((l+c)/2-i)/a),[h,c,o,l,S,E]=n(this,ht).subarray(12,18),n(this,Vs).push(((S+5*o)/6-s)/r,((E+5*l)/6-i)/a,((5*o+h)/6-s)/r,((5*l+c)/6-i)/a,((o+h)/2-s)/r,((l+c)/2-i)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const e=n(this,yi),t=n(this,Vs);if(isNaN(n(this,ht)[6])&&!this.isEmpty())return A(this,re,Tm).call(this);const s=[];s.push(`M${e[4]} ${e[5]}`);for(let i=6;i<e.length;i+=6)isNaN(e[i])?s.push(`L${e[i+4]} ${e[i+5]}`):s.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);A(this,re,Rm).call(this,s);for(let i=t.length-6;i>=6;i-=6)isNaN(t[i])?s.push(`L${t[i+4]} ${t[i+5]}`):s.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);return A(this,re,Cm).call(this,s),s.join(" ")}newFreeDrawOutline(e,t,s,i,r,a){return new Mm(e,t,s,i,r,a)}getOutlines(){var u;const e=n(this,yi),t=n(this,Vs),s=n(this,ht),[i,r,a,o]=n(this,ls),l=new Float32Array((((u=n(this,tr))==null?void 0:u.length)??0)+2);for(let f=0,p=l.length-2;f<p;f+=2)l[f]=(n(this,tr)[f]-i)/a,l[f+1]=(n(this,tr)[f+1]-r)/o;if(l[l.length-2]=(n(this,va)-i)/a,l[l.length-1]=(n(this,ya)-r)/o,isNaN(s[6])&&!this.isEmpty())return A(this,re,Pm).call(this,l);const h=new Float32Array(n(this,yi).length+24+n(this,Vs).length);let c=e.length;for(let f=0;f<c;f+=2){if(isNaN(e[f])){h[f]=h[f+1]=NaN;continue}h[f]=e[f],h[f+1]=e[f+1]}c=A(this,re,Dm).call(this,h,c);for(let f=t.length-6;f>=6;f-=6)for(let p=0;p<6;p+=2){if(isNaN(t[f+p])){h[c]=h[c+1]=NaN,c+=2;continue}h[c]=t[f+p],h[c+1]=t[f+p+1],c+=2}return A(this,re,Im).call(this,h,c),this.newFreeDrawOutline(h,l,n(this,ls),n(this,cl),n(this,ll),n(this,hl))}};ls=new WeakMap,Vs=new WeakMap,ll=new WeakMap,hl=new WeakMap,yi=new WeakMap,ht=new WeakMap,va=new WeakMap,ya=new WeakMap,Ec=new WeakMap,Sc=new WeakMap,cl=new WeakMap,dl=new WeakMap,tr=new WeakMap,xc=new WeakMap,hu=new WeakMap,cu=new WeakMap,re=new WeakSet,Kl=function(){const e=n(this,ht).subarray(4,6),t=n(this,ht).subarray(16,18),[s,i,r,a]=n(this,ls);return[(n(this,va)+(e[0]-t[0])/2-s)/r,(n(this,ya)+(e[1]-t[1])/2-i)/a,(n(this,va)+(t[0]-e[0])/2-s)/r,(n(this,ya)+(t[1]-e[1])/2-i)/a]},Tm=function(){const[e,t,s,i]=n(this,ls),[r,a,o,l]=A(this,re,Kl).call(this);return`M${(n(this,ht)[2]-e)/s} ${(n(this,ht)[3]-t)/i} L${(n(this,ht)[4]-e)/s} ${(n(this,ht)[5]-t)/i} L${r} ${a} L${o} ${l} L${(n(this,ht)[16]-e)/s} ${(n(this,ht)[17]-t)/i} L${(n(this,ht)[14]-e)/s} ${(n(this,ht)[15]-t)/i} Z`},Cm=function(e){const t=n(this,Vs);e.push(`L${t[4]} ${t[5]} Z`)},Rm=function(e){const[t,s,i,r]=n(this,ls),a=n(this,ht).subarray(4,6),o=n(this,ht).subarray(16,18),[l,h,c,u]=A(this,re,Kl).call(this);e.push(`L${(a[0]-t)/i} ${(a[1]-s)/r} L${l} ${h} L${c} ${u} L${(o[0]-t)/i} ${(o[1]-s)/r}`)},Pm=function(e){const t=n(this,ht),[s,i,r,a]=n(this,ls),[o,l,h,c]=A(this,re,Kl).call(this),u=new Float32Array(36);return u.set([NaN,NaN,NaN,NaN,(t[2]-s)/r,(t[3]-i)/a,NaN,NaN,NaN,NaN,(t[4]-s)/r,(t[5]-i)/a,NaN,NaN,NaN,NaN,o,l,NaN,NaN,NaN,NaN,h,c,NaN,NaN,NaN,NaN,(t[16]-s)/r,(t[17]-i)/a,NaN,NaN,NaN,NaN,(t[14]-s)/r,(t[15]-i)/a],0),this.newFreeDrawOutline(u,e,n(this,ls),n(this,cl),n(this,ll),n(this,hl))},Im=function(e,t){const s=n(this,Vs);return e.set([NaN,NaN,NaN,NaN,s[4],s[5]],t),t+=6},Dm=function(e,t){const s=n(this,ht).subarray(4,6),i=n(this,ht).subarray(16,18),[r,a,o,l]=n(this,ls),[h,c,u,f]=A(this,re,Kl).call(this);return e.set([NaN,NaN,NaN,NaN,(s[0]-r)/o,(s[1]-a)/l,NaN,NaN,NaN,NaN,h,c,NaN,NaN,NaN,NaN,u,f,NaN,NaN,NaN,NaN,(i[0]-r)/o,(i[1]-a)/l],t),t+=24},y(Mi,xc,8),y(Mi,hu,2),y(Mi,cu,n(Mi,xc)+n(Mi,hu));let Wd=Mi;var ul,ba,an,Tc,hs,Cc,Yt,du,Om;class Mm extends z{constructor(t,s,i,r,a,o){super();y(this,du);y(this,ul);y(this,ba,new Float32Array(4));y(this,an);y(this,Tc);y(this,hs);y(this,Cc);y(this,Yt);g(this,Yt,t),g(this,hs,s),g(this,ul,i),g(this,Cc,r),g(this,an,a),g(this,Tc,o),this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],A(this,du,Om).call(this,o);const[l,h,c,u]=n(this,ba);for(let f=0,p=t.length;f<p;f+=2)t[f]=(t[f]-l)/c,t[f+1]=(t[f+1]-h)/u;for(let f=0,p=s.length;f<p;f+=2)s[f]=(s[f]-l)/c,s[f+1]=(s[f+1]-h)/u}toSVGPath(){const t=[`M${n(this,Yt)[4]} ${n(this,Yt)[5]}`];for(let s=6,i=n(this,Yt).length;s<i;s+=6){if(isNaN(n(this,Yt)[s])){t.push(`L${n(this,Yt)[s+4]} ${n(this,Yt)[s+5]}`);continue}t.push(`C${n(this,Yt)[s]} ${n(this,Yt)[s+1]} ${n(this,Yt)[s+2]} ${n(this,Yt)[s+3]} ${n(this,Yt)[s+4]} ${n(this,Yt)[s+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,s,i,r],a){const o=i-t,l=r-s;let h,c;switch(a){case 0:h=z._rescale(n(this,Yt),t,r,o,-l),c=z._rescale(n(this,hs),t,r,o,-l);break;case 90:h=z._rescaleAndSwap(n(this,Yt),t,s,o,l),c=z._rescaleAndSwap(n(this,hs),t,s,o,l);break;case 180:h=z._rescale(n(this,Yt),i,s,-o,l),c=z._rescale(n(this,hs),i,s,-o,l);break;case 270:h=z._rescaleAndSwap(n(this,Yt),i,r,-o,-l),c=z._rescaleAndSwap(n(this,hs),i,r,-o,-l);break}return{outline:Array.from(h),points:[Array.from(c)]}}get box(){return n(this,ba)}newOutliner(t,s,i,r,a,o=0){return new Wd(t,s,i,r,a,o)}getNewOutline(t,s){const[i,r,a,o]=n(this,ba),[l,h,c,u]=n(this,ul),f=a*c,p=o*u,v=i*c+l,m=r*u+h,w=this.newOutliner({x:n(this,hs)[0]*f+v,y:n(this,hs)[1]*p+m},n(this,ul),n(this,Cc),t,n(this,Tc),s??n(this,an));for(let b=2;b<n(this,hs).length;b+=2)w.add({x:n(this,hs)[b]*f+v,y:n(this,hs)[b+1]*p+m});return w.getOutlines()}}ul=new WeakMap,ba=new WeakMap,an=new WeakMap,Tc=new WeakMap,hs=new WeakMap,Cc=new WeakMap,Yt=new WeakMap,du=new WeakSet,Om=function(t){const s=n(this,Yt);let i=s[4],r=s[5];const a=[i,r,i,r];let o=i,l=r,h=i,c=r;const u=t?Math.max:Math.min,f=new Float32Array(4);for(let v=6,m=s.length;v<m;v+=6){const w=s[v+4],b=s[v+5];isNaN(s[v])?(G.pointBoundingBox(w,b,a),l>b?(o=w,l=b):l===b&&(o=u(o,w)),c<b?(h=w,c=b):c===b&&(h=u(h,w))):(f[0]=f[1]=1/0,f[2]=f[3]=-1/0,G.bezierBoundingBox(i,r,...s.slice(v,v+6),f),G.rectBoundingBox(f[0],f[1],f[2],f[3],a),l>f[1]?(o=f[0],l=f[1]):l===f[1]&&(o=u(o,f[0])),c<f[3]?(h=f[2],c=f[3]):c===f[3]&&(h=u(h,f[2]))),i=w,r=b}const p=n(this,ba);p[0]=a[0]-n(this,an),p[1]=a[1]-n(this,an),p[2]=a[2]-a[0]+2*n(this,an),p[3]=a[3]-a[1]+2*n(this,an),this.firstPoint=[o,l],this.lastPoint=[h,c]};var Rc,Pc,Ic,er,Ws,He,Lm,xd,Fm,km,Bf;class Nf{constructor(e,t=0,s=0,i=!0){y(this,He);y(this,Rc);y(this,Pc);y(this,Ic);y(this,er,[]);y(this,Ws,[]);const r=[1/0,1/0,-1/0,-1/0],a=10**-4;for(const{x:m,y:w,width:b,height:S}of e){const E=Math.floor((m-t)/a)*a,T=Math.ceil((m+b+t)/a)*a,x=Math.floor((w-t)/a)*a,C=Math.ceil((w+S+t)/a)*a,R=[E,x,C,!0],I=[T,x,C,!1];n(this,er).push(R,I),G.rectBoundingBox(E,x,T,C,r)}const o=r[2]-r[0]+2*s,l=r[3]-r[1]+2*s,h=r[0]-s,c=r[1]-s;let u=i?-1/0:1/0,f=1/0;const p=n(this,er).at(i?-1:-2),v=[p[0],p[2]];for(const m of n(this,er)){const[w,b,S,E]=m;!E&&i?b<f?(f=b,u=w):b===f&&(u=Math.max(u,w)):E&&!i&&(b<f?(f=b,u=w):b===f&&(u=Math.min(u,w))),m[0]=(w-h)/o,m[1]=(b-c)/l,m[2]=(S-c)/l}g(this,Rc,new Float32Array([h,c,o,l])),g(this,Pc,[u,f]),g(this,Ic,v)}getOutlines(){n(this,er).sort((t,s)=>t[0]-s[0]||t[1]-s[1]||t[2]-s[2]);const e=[];for(const t of n(this,er))t[3]?(e.push(...A(this,He,Bf).call(this,t)),A(this,He,Fm).call(this,t)):(A(this,He,km).call(this,t),e.push(...A(this,He,Bf).call(this,t)));return A(this,He,Lm).call(this,e)}}Rc=new WeakMap,Pc=new WeakMap,Ic=new WeakMap,er=new WeakMap,Ws=new WeakMap,He=new WeakSet,Lm=function(e){const t=[],s=new Set;for(const a of e){const[o,l,h]=a;t.push([o,l,a],[o,h,a])}t.sort((a,o)=>a[1]-o[1]||a[0]-o[0]);for(let a=0,o=t.length;a<o;a+=2){const l=t[a][2],h=t[a+1][2];l.push(h),h.push(l),s.add(l),s.add(h)}const i=[];let r;for(;s.size>0;){const a=s.values().next().value;let[o,l,h,c,u]=a;s.delete(a);let f=o,p=l;for(r=[o,h],i.push(r);;){let v;if(s.has(c))v=c;else if(s.has(u))v=u;else break;s.delete(v),[o,l,h,c,u]=v,f!==o&&(r.push(f,p,o,p===l?l:h),f=o),p=p===l?h:l}r.push(f,p)}return new nb(i,n(this,Rc),n(this,Pc),n(this,Ic))},xd=function(e){const t=n(this,Ws);let s=0,i=t.length-1;for(;s<=i;){const r=s+i>>1,a=t[r][0];if(a===e)return r;a<e?s=r+1:i=r-1}return i+1},Fm=function([,e,t]){const s=A(this,He,xd).call(this,e);n(this,Ws).splice(s,0,[e,t])},km=function([,e,t]){const s=A(this,He,xd).call(this,e);for(let i=s;i<n(this,Ws).length;i++){const[r,a]=n(this,Ws)[i];if(r!==e)break;if(r===e&&a===t){n(this,Ws).splice(i,1);return}}for(let i=s-1;i>=0;i--){const[r,a]=n(this,Ws)[i];if(r!==e)break;if(r===e&&a===t){n(this,Ws).splice(i,1);return}}},Bf=function(e){const[t,s,i]=e,r=[[t,s,i]],a=A(this,He,xd).call(this,i);for(let o=0;o<a;o++){const[l,h]=n(this,Ws)[o];for(let c=0,u=r.length;c<u;c++){const[,f,p]=r[c];if(!(h<=f||p<=l)){if(f>=l){if(p>h)r[c][1]=h;else{if(u===1)return[];r.splice(c,1),c--,u--}continue}r[c][2]=l,p>h&&r.push([t,h,p])}}}return r};var Dc,fl;class nb extends z{constructor(t,s,i,r){super();y(this,Dc);y(this,fl);g(this,fl,t),g(this,Dc,s),this.firstPoint=i,this.lastPoint=r}toSVGPath(){const t=[];for(const s of n(this,fl)){let[i,r]=s;t.push(`M${i} ${r}`);for(let a=2;a<s.length;a+=2){const o=s[a],l=s[a+1];o===i?(t.push(`V${l}`),r=l):l===r&&(t.push(`H${o}`),i=o)}t.push("Z")}return t.join(" ")}serialize([t,s,i,r],a){const o=[],l=i-t,h=r-s;for(const c of n(this,fl)){const u=new Array(c.length);for(let f=0;f<c.length;f+=2)u[f]=t+c[f]*l,u[f+1]=r-c[f+1]*h;o.push(u)}return o}get box(){return n(this,Dc)}get classNamesForOutlining(){return["highlightOutline"]}}Dc=new WeakMap,fl=new WeakMap;class _f extends Wd{newFreeDrawOutline(e,t,s,i,r,a){return new rb(e,t,s,i,r,a)}}class rb extends Mm{newOutliner(e,t,s,i,r,a=0){return new _f(e,t,s,i,r,a)}}var pl,Mc,on,Aa,Oc,Ye,Lc,Fc,wa,cs,ds,ye,gl,ml,De,vl,Ms,kc,rt,Uf,Td,Nm,Bm,_m,Hf,Ar,Ls,Ka,Um,Cd,Rd,Hm,$m,jm,zm,Gm;const mt=class mt extends Ot{constructor(t){super({...t,name:"highlightEditor"});y(this,rt);y(this,pl,null);y(this,Mc,0);y(this,on);y(this,Aa,null);y(this,Oc,null);y(this,Ye,null);y(this,Lc,null);y(this,Fc,0);y(this,wa,null);y(this,cs,null);y(this,ds,null);y(this,ye,!1);y(this,gl,null);y(this,ml,null);y(this,De,null);y(this,vl,"");y(this,Ms);y(this,kc,"");this.color=t.color||mt._defaultColor,g(this,Ms,t.thickness||mt._defaultThickness),this.opacity=t.opacity||mt._defaultOpacity,g(this,on,t.boxes||null),g(this,kc,t.methodOfCreation||""),g(this,vl,t.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(g(this,ye,!0),A(this,rt,Td).call(this,t),A(this,rt,Ar).call(this)):n(this,on)&&(g(this,pl,t.anchorNode),g(this,Mc,t.anchorOffset),g(this,Lc,t.focusNode),g(this,Fc,t.focusOffset),A(this,rt,Uf).call(this),A(this,rt,Ar).call(this),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}static get _keyboardManager(){const t=mt.prototype;return lt(this,"_keyboardManager",new zc([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:n(this,ye)?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:n(this,Ms),methodOfCreation:n(this,kc)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,s){var i;Ot.initialize(t,s),mt._defaultColor||(mt._defaultColor=((i=s.highlightColors)==null?void 0:i.values().next().value)||"#fff066")}static updateDefaultParams(t,s){switch(t){case ct.HIGHLIGHT_COLOR:mt._defaultColor=s;break;case ct.HIGHLIGHT_THICKNESS:mt._defaultThickness=s;break}}translateInPage(t,s){}get toolbarPosition(){return n(this,ml)}get commentButtonPosition(){return n(this,gl)}updateParams(t,s){switch(t){case ct.HIGHLIGHT_COLOR:A(this,rt,Nm).call(this,s);break;case ct.HIGHLIGHT_THICKNESS:A(this,rt,Bm).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[ct.HIGHLIGHT_COLOR,mt._defaultColor],[ct.HIGHLIGHT_THICKNESS,mt._defaultThickness]]}get propertiesToUpdate(){return[[ct.HIGHLIGHT_COLOR,this.color||mt._defaultColor],[ct.HIGHLIGHT_THICKNESS,n(this,Ms)||mt._defaultThickness],[ct.HIGHLIGHT_FREE,n(this,ye)]]}onUpdatedColor(){var t,s;(t=this.parent)==null||t.drawLayer.updateProperties(n(this,ds),{root:{fill:this.color,"fill-opacity":this.opacity}}),(s=n(this,Oc))==null||s.updateColor(this.color),super.onUpdatedColor()}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",g(this,Oc,new zd({editor:this}))]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(A(this,rt,Rd).call(this))}getBaseTranslation(){return[0,0]}getRect(t,s){return super.getRect(t,s,A(this,rt,Rd).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){A(this,rt,Hf).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(A(this,rt,Ar).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let s=!1;this.parent&&!t?A(this,rt,Hf).call(this):t&&(A(this,rt,Ar).call(this,t),s=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),s&&this.select()}rotate(t){var r,a,o;const{drawLayer:s}=this.parent;let i;n(this,ye)?(t=(t-this.rotation+360)%360,i=A(r=mt,Ls,Ka).call(r,n(this,cs).box,t)):i=A(a=mt,Ls,Ka).call(a,[this.x,this.y,this.width,this.height],t),s.updateProperties(n(this,ds),{bbox:i,root:{"data-main-rotation":t}}),s.updateProperties(n(this,De),{bbox:A(o=mt,Ls,Ka).call(o,n(this,Ye).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();n(this,vl)&&(t.setAttribute("aria-label",n(this,vl)),t.setAttribute("role","mark")),n(this,ye)?t.classList.add("free"):this.div.addEventListener("keydown",A(this,rt,Um).bind(this),{signal:this._uiManager._signal});const s=g(this,wa,document.createElement("div"));return t.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",s.style.clipPath=n(this,Aa),this.setDims(this.width,this.height),dg(this,n(this,wa),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(n(this,De),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(n(this,De),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:A(this,rt,Cd).call(this,!0);break;case 1:case 3:A(this,rt,Cd).call(this,!1);break}}select(){var t;super.select(),n(this,De)&&((t=this.parent)==null||t.drawLayer.updateProperties(n(this,De),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),n(this,De)&&((t=this.parent)==null||t.drawLayer.updateProperties(n(this,De),{rootClass:{selected:!1}}),n(this,ye)||A(this,rt,Cd).call(this,!1))}get _mustFixPosition(){return!n(this,ye)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(n(this,ds),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(n(this,De),{rootClass:{hidden:!t}}))}static startHighlighting(t,s,{target:i,x:r,y:a}){const{x:o,y:l,width:h,height:c}=i.getBoundingClientRect(),u=new AbortController,f=t.combinedSignal(u),p=v=>{u.abort(),A(this,Ls,zm).call(this,t,v)};window.addEventListener("blur",p,{signal:f}),window.addEventListener("pointerup",p,{signal:f}),window.addEventListener("pointerdown",Wt,{capture:!0,passive:!1,signal:f}),window.addEventListener("contextmenu",ks,{signal:f}),i.addEventListener("pointermove",A(this,Ls,jm).bind(this,t),{signal:f}),this._freeHighlight=new _f({x:r,y:a},[o,l,h,c],t.scale,this._defaultThickness/2,s,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,s,i){var m,w,b,S;let r=null;if(t instanceof ym){const{data:{quadPoints:E,rect:T,rotation:x,id:C,color:R,opacity:I,popupRef:P,richText:M,contentsObj:D,creationDate:O,modificationDate:N},parent:{page:{pageNumber:B}}}=t;r=t={annotationType:st.HIGHLIGHT,color:Array.from(R),opacity:I,quadPoints:E,boxes:null,pageIndex:B-1,rect:T.slice(0),rotation:x,annotationElementId:C,id:C,deleted:!1,popupRef:P,richText:M,comment:(D==null?void 0:D.str)||null,creationDate:O,modificationDate:N}}else if(t instanceof fp){const{data:{inkLists:E,rect:T,rotation:x,id:C,color:R,borderStyle:{rawWidth:I},popupRef:P,richText:M,contentsObj:D,creationDate:O,modificationDate:N},parent:{page:{pageNumber:B}}}=t;r=t={annotationType:st.HIGHLIGHT,color:Array.from(R),thickness:I,inkLists:E,boxes:null,pageIndex:B-1,rect:T.slice(0),rotation:x,annotationElementId:C,id:C,deleted:!1,popupRef:P,richText:M,comment:(D==null?void 0:D.str)||null,creationDate:O,modificationDate:N}}const{color:a,quadPoints:o,inkLists:l,opacity:h}=t,c=await super.deserialize(t,s,i);c.color=G.makeHexColor(...a),c.opacity=h||1,l&&g(c,Ms,t.thickness),c._initialData=r,t.comment&&c.setCommentData(t);const[u,f]=c.pageDimensions,[p,v]=c.pageTranslation;if(o){const E=g(c,on,[]);for(let T=0;T<o.length;T+=8)E.push({x:(o[T]-p)/u,y:1-(o[T+1]-v)/f,width:(o[T+2]-o[T])/u,height:(o[T+1]-o[T+5])/f});A(m=c,rt,Uf).call(m),A(w=c,rt,Ar).call(w),c.rotate(c.rotation)}else if(l){g(c,ye,!0);const E=l[0],T={x:E[0]-p,y:f-(E[1]-v)},x=new _f(T,[0,0,u,f],1,n(c,Ms)/2,!0,.001);for(let I=0,P=E.length;I<P;I+=2)T.x=E[I]-p,T.y=f-(E[I+1]-v),x.add(T);const{id:C,clipPathId:R}=s.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:c.color,"fill-opacity":c._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:x.toSVGPath()}},!0,!0);A(b=c,rt,Td).call(b,{highlightOutlines:x.getOutlines(),highlightId:C,clipPathId:R}),A(S=c,rt,Ar).call(S),c.rotate(c.parentRotation)}return c}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const s=Ot._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),i=super.serialize(t);return Object.assign(i,{color:s,opacity:this.opacity,thickness:n(this,Ms),quadPoints:A(this,rt,Hm).call(this),outlines:A(this,rt,$m).call(this,i.rect)}),this.addComment(i),this.annotationElementId&&!A(this,rt,Gm).call(this,i)?null:(i.id=this.annotationElementId,i)}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}};pl=new WeakMap,Mc=new WeakMap,on=new WeakMap,Aa=new WeakMap,Oc=new WeakMap,Ye=new WeakMap,Lc=new WeakMap,Fc=new WeakMap,wa=new WeakMap,cs=new WeakMap,ds=new WeakMap,ye=new WeakMap,gl=new WeakMap,ml=new WeakMap,De=new WeakMap,vl=new WeakMap,Ms=new WeakMap,kc=new WeakMap,rt=new WeakSet,Uf=function(){const t=new Nf(n(this,on),.001);g(this,cs,t.getOutlines()),[this.x,this.y,this.width,this.height]=n(this,cs).box;const s=new Nf(n(this,on),.0025,.001,this._uiManager.direction==="ltr");g(this,Ye,s.getOutlines());const{firstPoint:i}=n(this,cs);g(this,gl,[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height]);const{lastPoint:r}=n(this,Ye);g(this,ml,[(r[0]-this.x)/this.width,(r[1]-this.y)/this.height])},Td=function({highlightOutlines:t,highlightId:s,clipPathId:i}){var f,p;if(g(this,cs,t),g(this,Ye,t.getNewOutline(n(this,Ms)/2+1.5,.0025)),s>=0)g(this,ds,s),g(this,Aa,i),this.parent.drawLayer.finalizeDraw(s,{bbox:t.box,path:{d:t.toSVGPath()}}),g(this,De,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:n(this,Ye).box,path:{d:n(this,Ye).toSVGPath()}},!0));else if(this.parent){const v=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(n(this,ds),{bbox:A(f=mt,Ls,Ka).call(f,n(this,cs).box,(v-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(n(this,De),{bbox:A(p=mt,Ls,Ka).call(p,n(this,Ye).box,v),path:{d:n(this,Ye).toSVGPath()}})}const[a,o,l,h]=t.box;switch(this.rotation){case 0:this.x=a,this.y=o,this.width=l,this.height=h;break;case 90:{const[v,m]=this.parentDimensions;this.x=o,this.y=1-a,this.width=l*m/v,this.height=h*v/m;break}case 180:this.x=1-a,this.y=1-o,this.width=l,this.height=h;break;case 270:{const[v,m]=this.parentDimensions;this.x=1-o,this.y=a,this.width=l*m/v,this.height=h*v/m;break}}const{firstPoint:c}=t;g(this,gl,[(c[0]-a)/l,(c[1]-o)/h]);const{lastPoint:u}=n(this,Ye);g(this,ml,[(u[0]-a)/l,(u[1]-o)/h])},Nm=function(t){const s=(a,o)=>{this.color=a,this.opacity=o,this.onUpdatedColor()},i=this.color,r=this.opacity;this.addCommands({cmd:s.bind(this,t,mt._defaultOpacity),undo:s.bind(this,i,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ct.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)},Bm=function(t){const s=n(this,Ms),i=r=>{g(this,Ms,r),A(this,rt,_m).call(this,r)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ct.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},_m=function(t){n(this,ye)&&(A(this,rt,Td).call(this,{highlightOutlines:n(this,cs).getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims(this.width,this.height))},Hf=function(){n(this,ds)===null||!this.parent||(this.parent.drawLayer.remove(n(this,ds)),g(this,ds,null),this.parent.drawLayer.remove(n(this,De)),g(this,De,null))},Ar=function(t=this.parent){n(this,ds)===null&&({id:te(this,ds)._,clipPathId:te(this,Aa)._}=t.drawLayer.draw({bbox:n(this,cs).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:n(this,ye)},path:{d:n(this,cs).toSVGPath()}},!1,!0),g(this,De,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:n(this,ye)},bbox:n(this,Ye).box,path:{d:n(this,Ye).toSVGPath()}},n(this,ye))),n(this,wa)&&(n(this,wa).style.clipPath=n(this,Aa)))},Ls=new WeakSet,Ka=function([t,s,i,r],a){switch(a){case 90:return[1-s-r,t,r,i];case 180:return[1-t-i,1-s-r,i,r];case 270:return[s,1-t-i,r,i]}return[t,s,i,r]},Um=function(t){mt._keyboardManager.exec(this,t)},Cd=function(t){if(!n(this,pl))return;const s=window.getSelection();t?s.setPosition(n(this,pl),n(this,Mc)):s.setPosition(n(this,Lc),n(this,Fc))},Rd=function(){return n(this,ye)?this.rotation:0},Hm=function(){if(n(this,ye))return null;const[t,s]=this.pageDimensions,[i,r]=this.pageTranslation,a=n(this,on),o=new Float32Array(a.length*8);let l=0;for(const{x:h,y:c,width:u,height:f}of a){const p=h*t+i,v=(1-c)*s+r;o[l]=o[l+4]=p,o[l+1]=o[l+3]=v,o[l+2]=o[l+6]=p+u*t,o[l+5]=o[l+7]=v-f*s,l+=8}return o},$m=function(t){return n(this,cs).serialize(t,A(this,rt,Rd).call(this))},jm=function(t,s){this._freeHighlight.add(s)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},zm=function(t,s){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(s,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},Gm=function(t){const{color:s}=this._initialData;return this.hasEditedComment||t.color.some((i,r)=>i!==s[r])},y(mt,Ls),k(mt,"_defaultColor",null),k(mt,"_defaultOpacity",1),k(mt,"_defaultThickness",12),k(mt,"_type","highlight"),k(mt,"_editorType",st.HIGHLIGHT),k(mt,"_freeHighlightId",-1),k(mt,"_freeHighlight",null),k(mt,"_freeHighlightClipId","");let Xd=mt;var Ea;class Vm{constructor(){y(this,Ea,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,s]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,s)}updateSVGProperty(e,t){n(this,Ea)[e]=t}toSVGProperties(){const e=n(this,Ea);return g(this,Ea,Object.create(null)),{root:e}}reset(){g(this,Ea,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){It("Not implemented")}}Ea=new WeakMap;var us,yl,he,Sa,xa,sr,ir,nr,Ta,ut,$f,jf,zf,Jl,Wm,Pd,Ql,Ja;const V=class V extends Ot{constructor(t){super(t);y(this,ut);y(this,us,null);y(this,yl);k(this,"_colorPicker",null);k(this,"_drawId",null);g(this,yl,t.mustBeCommitted||!1),this._addOutlines(t)}onUpdatedColor(){var t;(t=this._colorPicker)==null||t.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(A(this,ut,$f).call(this,t),A(this,ut,Jl).call(this))}static _mergeSVGProperties(t,s){const i=new Set(Object.keys(t));for(const[r,a]of Object.entries(s))i.has(r)?Object.assign(t[r],a):t[r]=a;return t}static getDefaultDrawingOptions(t){It("Not implemented")}static get typesMap(){It("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,s){const i=this.typesMap.get(t);i&&this._defaultDrawingOptions.updateProperty(i,s),this._currentParent&&(n(V,he).updateProperty(i,s),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,s){const i=this.constructor.typesMap.get(t);i&&this._updateProperty(t,i,s)}static get defaultPropertiesToUpdate(){const t=[],s=this._defaultDrawingOptions;for(const[i,r]of this.typesMap)t.push([i,s[r]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:s}=this;for(const[i,r]of this.constructor.typesMap)t.push([i,s[r]]);return t}_updateProperty(t,s,i){const r=this._drawingOptions,a=r[s],o=l=>{var c;r.updateProperty(s,l);const h=n(this,us).updateProperty(s,l);h&&A(this,ut,Ql).call(this,h),(c=this.parent)==null||c.drawLayer.updateProperties(this._drawId,r.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:o.bind(this,i),undo:o.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,V._mergeSVGProperties(n(this,us).getPathResizingSVGProperties(A(this,ut,Pd).call(this)),{bbox:A(this,ut,Ja).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,V._mergeSVGProperties(n(this,us).getPathResizedSVGProperties(A(this,ut,Pd).call(this)),{bbox:A(this,ut,Ja).call(this)}))}_onTranslating(t,s){var i;(i=this.parent)==null||i.drawLayer.updateProperties(this._drawId,{bbox:A(this,ut,Ja).call(this)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,V._mergeSVGProperties(n(this,us).getPathTranslatedSVGProperties(A(this,ut,Pd).call(this),this.parentDimensions),{bbox:A(this,ut,Ja).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,n(this,yl)&&(g(this,yl,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){A(this,ut,zf).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(A(this,ut,Jl).call(this),A(this,ut,Ql).call(this,n(this,us).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let s=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),A(this,ut,zf).call(this)):t&&(this._uiManager.addShouldRescale(this),A(this,ut,Jl).call(this,t),s=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),s&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,V._mergeSVGProperties({bbox:A(this,ut,Ja).call(this)},n(this,us).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&A(this,ut,Ql).call(this,n(this,us).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,s;this._isCopy&&(t=this.x,s=this.y);const i=super.render();i.classList.add("draw");const r=document.createElement("div");return i.append(r),r.setAttribute("aria-hidden","true"),r.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,s),i}static createDrawerInstance(t,s,i,r,a){It("Not implemented")}static startDrawing(t,s,i,r){var w;const{target:a,offsetX:o,offsetY:l,pointerId:h,pointerType:c}=r;if(n(V,ir)&&n(V,ir)!==c)return;const{viewport:{rotation:u}}=t,{width:f,height:p}=a.getBoundingClientRect(),v=g(V,Sa,new AbortController),m=t.combinedSignal(v);if(n(V,sr)||g(V,sr,h),n(V,ir)??g(V,ir,c),window.addEventListener("pointerup",b=>{var S;n(V,sr)===b.pointerId?this._endDraw(b):(S=n(V,nr))==null||S.delete(b.pointerId)},{signal:m}),window.addEventListener("pointercancel",b=>{var S;n(V,sr)===b.pointerId?this._currentParent.endDrawingSession():(S=n(V,nr))==null||S.delete(b.pointerId)},{signal:m}),window.addEventListener("pointerdown",b=>{n(V,ir)===b.pointerType&&((n(V,nr)||g(V,nr,new Set)).add(b.pointerId),n(V,he).isCancellable()&&(n(V,he).removeLastElement(),n(V,he).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:m}),window.addEventListener("contextmenu",ks,{signal:m}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:m}),a.addEventListener("touchmove",b=>{b.timeStamp===n(V,Ta)&&Wt(b)},{signal:m}),t.toggleDrawing(),(w=s._editorUndoBar)==null||w.hide(),n(V,he)){t.drawLayer.updateProperties(this._currentDrawId,n(V,he).startNew(o,l,f,p,u));return}s.updateUIForDefaultProperties(this),g(V,he,this.createDrawerInstance(o,l,f,p,u)),g(V,xa,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(n(V,xa).toSVGProperties(),n(V,he).defaultSVGProperties),!0,!1)}static _drawMove(t){var a;if(g(V,Ta,-1),!n(V,he))return;const{offsetX:s,offsetY:i,pointerId:r}=t;if(n(V,sr)===r){if(((a=n(V,nr))==null?void 0:a.size)>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,n(V,he).add(s,i)),g(V,Ta,t.timeStamp),Wt(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,g(V,he,null),g(V,xa,null),g(V,ir,null),g(V,Ta,NaN)),n(V,Sa)&&(n(V,Sa).abort(),g(V,Sa,null),g(V,sr,NaN),g(V,nr,null))}static _endDraw(t){const s=this._currentParent;if(s){if(s.toggleDrawing(!0),this._cleanup(!1),(t==null?void 0:t.target)===s.div&&s.drawLayer.updateProperties(this._currentDrawId,n(V,he).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const i=n(V,he),r=this._currentDrawId,a=i.getLastElement();s.addCommands({cmd:()=>{s.drawLayer.updateProperties(r,i.setLastElement(a))},undo:()=>{s.drawLayer.updateProperties(r,i.removeLastElement())},mustExec:!1,type:ct.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const s=this._currentParent;if(!s)return null;if(s.toggleDrawing(!0),s.cleanUndoStack(ct.DRAW_STEP),!n(V,he).isEmpty()){const{pageDimensions:[i,r],scale:a}=s,o=s.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:n(V,he).getOutlines(i*a,r*a,a,this._INNER_MARGIN),drawingOptions:n(V,xa),mustBeCommitted:!t});return this._cleanup(!0),o}return s.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,s,i,r,a,o){It("Not implemented")}static async deserialize(t,s,i){var u,f;const{rawDims:{pageWidth:r,pageHeight:a,pageX:o,pageY:l}}=s.viewport,h=this.deserializeDraw(o,l,r,a,this._INNER_MARGIN,t),c=await super.deserialize(t,s,i);return c.createDrawingOptions(t),A(u=c,ut,$f).call(u,{drawOutlines:h}),A(f=c,ut,Jl).call(f),c.onScaleChanging(),c.rotate(),c}serializeDraw(t){const[s,i]=this.pageTranslation,[r,a]=this.pageDimensions;return n(this,us).serialize([s,i,r,a],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}};us=new WeakMap,yl=new WeakMap,he=new WeakMap,Sa=new WeakMap,xa=new WeakMap,sr=new WeakMap,ir=new WeakMap,nr=new WeakMap,Ta=new WeakMap,ut=new WeakSet,$f=function({drawOutlines:t,drawId:s,drawingOptions:i}){g(this,us,t),this._drawingOptions||(this._drawingOptions=i),this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),s>=0?(this._drawId=s,this.parent.drawLayer.finalizeDraw(s,t.defaultProperties)):this._drawId=A(this,ut,jf).call(this,t,this.parent),A(this,ut,Ql).call(this,t.box)},jf=function(t,s){const{id:i}=s.drawLayer.draw(V._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return i},zf=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},Jl=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=A(this,ut,jf).call(this,n(this,us),t)}},Wm=function([t,s,i,r]){const{parentDimensions:[a,o],rotation:l}=this;switch(l){case 90:return[s,1-t,i*(o/a),r*(a/o)];case 180:return[1-t,1-s,i,r];case 270:return[1-s,t,i*(o/a),r*(a/o)];default:return[t,s,i,r]}},Pd=function(){const{x:t,y:s,width:i,height:r,parentDimensions:[a,o],rotation:l}=this;switch(l){case 90:return[1-s,t,i*(a/o),r*(o/a)];case 180:return[1-t,1-s,i,r];case 270:return[s,1-t,i*(a/o),r*(o/a)];default:return[t,s,i,r]}},Ql=function(t){[this.x,this.y,this.width,this.height]=A(this,ut,Wm).call(this,t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()},Ja=function(){const{x:t,y:s,width:i,height:r,rotation:a,parentRotation:o,parentDimensions:[l,h]}=this;switch((a*4+o)/90){case 1:return[1-s-r,t,r,i];case 2:return[1-t-i,1-s-r,i,r];case 3:return[s,1-t-i,r,i];case 4:return[t,s-i*(l/h),r*(h/l),i*(l/h)];case 5:return[1-s,t,i*(l/h),r*(h/l)];case 6:return[1-t-r*(h/l),1-s,r*(h/l),i*(l/h)];case 7:return[s-i*(l/h),1-t-r*(h/l),i*(l/h),r*(h/l)];case 8:return[t-i,s-r,i,r];case 9:return[1-s,t-i,r,i];case 10:return[1-t,1-s,i,r];case 11:return[s-r,1-t,r,i];case 12:return[t-r*(h/l),s,r*(h/l),i*(l/h)];case 13:return[1-s-i*(l/h),t-r*(h/l),i*(l/h),r*(h/l)];case 14:return[1-t,1-s-i*(l/h),r*(h/l),i*(l/h)];case 15:return[s,1-t,i*(l/h),r*(h/l)];default:return[t,s,i,r]}},k(V,"_currentDrawId",-1),k(V,"_currentParent",null),y(V,he,null),y(V,Sa,null),y(V,xa,null),y(V,sr,NaN),y(V,ir,null),y(V,nr,null),y(V,Ta,NaN),k(V,"_INNER_MARGIN",3);let Yd=V;var bi,ce,de,Ca,bl,Fe,be,Os,Ra,Pa,Ia,Al,Id;class ab{constructor(e,t,s,i,r,a){y(this,Al);y(this,bi,new Float64Array(6));y(this,ce);y(this,de);y(this,Ca);y(this,bl);y(this,Fe);y(this,be,"");y(this,Os,0);y(this,Ra,new Vc);y(this,Pa);y(this,Ia);g(this,Pa,s),g(this,Ia,i),g(this,Ca,r),g(this,bl,a),[e,t]=A(this,Al,Id).call(this,e,t);const o=g(this,ce,[NaN,NaN,NaN,NaN,e,t]);g(this,Fe,[e,t]),g(this,de,[{line:o,points:n(this,Fe)}]),n(this,bi).set(o,0)}updateProperty(e,t){e==="stroke-width"&&g(this,bl,t)}isEmpty(){return!n(this,de)||n(this,de).length===0}isCancellable(){return n(this,Fe).length<=10}add(e,t){[e,t]=A(this,Al,Id).call(this,e,t);const[s,i,r,a]=n(this,bi).subarray(2,6),o=e-r,l=t-a;return Math.hypot(n(this,Pa)*o,n(this,Ia)*l)<=2?null:(n(this,Fe).push(e,t),isNaN(s)?(n(this,bi).set([r,a,e,t],2),n(this,ce).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(n(this,bi)[0])&&n(this,ce).splice(6,6),n(this,bi).set([s,i,r,a,e,t],0),n(this,ce).push(...z.createBezierPoints(s,i,r,a,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const s=this.add(e,t);return s||(n(this,Fe).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,s,i,r){g(this,Pa,s),g(this,Ia,i),g(this,Ca,r),[e,t]=A(this,Al,Id).call(this,e,t);const a=g(this,ce,[NaN,NaN,NaN,NaN,e,t]);g(this,Fe,[e,t]);const o=n(this,de).at(-1);return o&&(o.line=new Float32Array(o.line),o.points=new Float32Array(o.points)),n(this,de).push({line:a,points:n(this,Fe)}),n(this,bi).set(a,0),g(this,Os,0),this.toSVGPath(),null}getLastElement(){return n(this,de).at(-1)}setLastElement(e){return n(this,de)?(n(this,de).push(e),g(this,ce,e.line),g(this,Fe,e.points),g(this,Os,0),{path:{d:this.toSVGPath()}}):n(this,Ra).setLastElement(e)}removeLastElement(){if(!n(this,de))return n(this,Ra).removeLastElement();n(this,de).pop(),g(this,be,"");for(let e=0,t=n(this,de).length;e<t;e++){const{line:s,points:i}=n(this,de)[e];g(this,ce,s),g(this,Fe,i),g(this,Os,0),this.toSVGPath()}return{path:{d:n(this,be)}}}toSVGPath(){const e=z.svgRound(n(this,ce)[4]),t=z.svgRound(n(this,ce)[5]);if(n(this,Fe).length===2)return g(this,be,`${n(this,be)} M ${e} ${t} Z`),n(this,be);if(n(this,Fe).length<=6){const i=n(this,be).lastIndexOf("M");g(this,be,`${n(this,be).slice(0,i)} M ${e} ${t}`),g(this,Os,6)}if(n(this,Fe).length===4){const i=z.svgRound(n(this,ce)[10]),r=z.svgRound(n(this,ce)[11]);return g(this,be,`${n(this,be)} L ${i} ${r}`),g(this,Os,12),n(this,be)}const s=[];n(this,Os)===0&&(s.push(`M ${e} ${t}`),g(this,Os,6));for(let i=n(this,Os),r=n(this,ce).length;i<r;i+=6){const[a,o,l,h,c,u]=n(this,ce).slice(i,i+6).map(z.svgRound);s.push(`C${a} ${o} ${l} ${h} ${c} ${u}`)}return g(this,be,n(this,be)+s.join(" ")),g(this,Os,n(this,ce).length),n(this,be)}getOutlines(e,t,s,i){const r=n(this,de).at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),n(this,Ra).build(n(this,de),e,t,s,n(this,Ca),n(this,bl),i),g(this,bi,null),g(this,ce,null),g(this,de,null),g(this,be,null),n(this,Ra)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}bi=new WeakMap,ce=new WeakMap,de=new WeakMap,Ca=new WeakMap,bl=new WeakMap,Fe=new WeakMap,be=new WeakMap,Os=new WeakMap,Ra=new WeakMap,Pa=new WeakMap,Ia=new WeakMap,Al=new WeakSet,Id=function(e,t){return z._normalizePoint(e,t,n(this,Pa),n(this,Ia),n(this,Ca))};var ke,Nc,Bc,fs,Ai,wi,wl,El,Da,we,Ii,Xm,Ym,Km;class Vc extends z{constructor(){super(...arguments);y(this,we);y(this,ke);y(this,Nc,0);y(this,Bc);y(this,fs);y(this,Ai);y(this,wi);y(this,wl);y(this,El);y(this,Da)}build(t,s,i,r,a,o,l){g(this,Ai,s),g(this,wi,i),g(this,wl,r),g(this,El,a),g(this,Da,o),g(this,Bc,l??0),g(this,fs,t),A(this,we,Ym).call(this)}get thickness(){return n(this,Da)}setLastElement(t){return n(this,fs).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return n(this,fs).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:s}of n(this,fs)){if(t.push(`M${z.svgRound(s[4])} ${z.svgRound(s[5])}`),s.length===6){t.push("Z");continue}if(s.length===12&&isNaN(s[6])){t.push(`L${z.svgRound(s[10])} ${z.svgRound(s[11])}`);continue}for(let i=6,r=s.length;i<r;i+=6){const[a,o,l,h,c,u]=s.subarray(i,i+6).map(z.svgRound);t.push(`C${a} ${o} ${l} ${h} ${c} ${u}`)}}return t.join("")}serialize([t,s,i,r],a){const o=[],l=[],[h,c,u,f]=A(this,we,Xm).call(this);let p,v,m,w,b,S,E,T,x;switch(n(this,El)){case 0:x=z._rescale,p=t,v=s+r,m=i,w=-r,b=t+h*i,S=s+(1-c-f)*r,E=t+(h+u)*i,T=s+(1-c)*r;break;case 90:x=z._rescaleAndSwap,p=t,v=s,m=i,w=r,b=t+c*i,S=s+h*r,E=t+(c+f)*i,T=s+(h+u)*r;break;case 180:x=z._rescale,p=t+i,v=s,m=-i,w=r,b=t+(1-h-u)*i,S=s+c*r,E=t+(1-h)*i,T=s+(c+f)*r;break;case 270:x=z._rescaleAndSwap,p=t+i,v=s+r,m=-i,w=-r,b=t+(1-c-f)*i,S=s+(1-h-u)*r,E=t+(1-c)*i,T=s+(1-h)*r;break}for(const{line:C,points:R}of n(this,fs))o.push(x(C,p,v,m,w,a?new Array(C.length):null)),l.push(x(R,p,v,m,w,a?new Array(R.length):null));return{lines:o,points:l,rect:[b,S,E,T]}}static deserialize(t,s,i,r,a,{paths:{lines:o,points:l},rotation:h,thickness:c}){const u=[];let f,p,v,m,w;switch(h){case 0:w=z._rescale,f=-t/i,p=s/r+1,v=1/i,m=-1/r;break;case 90:w=z._rescaleAndSwap,f=-s/r,p=-t/i,v=1/r,m=1/i;break;case 180:w=z._rescale,f=t/i+1,p=-s/r,v=-1/i,m=1/r;break;case 270:w=z._rescaleAndSwap,f=s/r+1,p=t/i+1,v=-1/r,m=-1/i;break}if(!o){o=[];for(const S of l){const E=S.length;if(E===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,S[0],S[1]]));continue}if(E===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,S[0],S[1],NaN,NaN,NaN,NaN,S[2],S[3]]));continue}const T=new Float32Array(3*(E-2));o.push(T);let[x,C,R,I]=S.subarray(0,4);T.set([NaN,NaN,NaN,NaN,x,C],0);for(let P=4;P<E;P+=2){const M=S[P],D=S[P+1];T.set(z.createBezierPoints(x,C,R,I,M,D),(P-2)*3),[x,C,R,I]=[R,I,M,D]}}}for(let S=0,E=o.length;S<E;S++)u.push({line:w(o[S].map(T=>T??NaN),f,p,v,m),points:w(l[S].map(T=>T??NaN),f,p,v,m)});const b=new this.prototype.constructor;return b.build(u,i,r,1,h,c,a),b}get box(){return n(this,ke)}updateProperty(t,s){return t==="stroke-width"?A(this,we,Km).call(this,s):null}updateParentDimensions([t,s],i){const[r,a]=A(this,we,Ii).call(this);g(this,Ai,t),g(this,wi,s),g(this,wl,i);const[o,l]=A(this,we,Ii).call(this),h=o-r,c=l-a,u=n(this,ke);return u[0]-=h,u[1]-=c,u[2]+=2*h,u[3]+=2*c,u}updateRotation(t){return g(this,Nc,t),{path:{transform:this.rotationTransform}}}get viewBox(){return n(this,ke).map(z.svgRound).join(" ")}get defaultProperties(){const[t,s]=n(this,ke);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${z.svgRound(t)} ${z.svgRound(s)}`}}}get rotationTransform(){const[,,t,s]=n(this,ke);let i=0,r=0,a=0,o=0,l=0,h=0;switch(n(this,Nc)){case 90:r=s/t,a=-t/s,l=t;break;case 180:i=-1,o=-1,l=t,h=s;break;case 270:r=-s/t,a=t/s,h=s;break;default:return""}return`matrix(${i} ${r} ${a} ${o} ${z.svgRound(l)} ${z.svgRound(h)})`}getPathResizingSVGProperties([t,s,i,r]){const[a,o]=A(this,we,Ii).call(this),[l,h,c,u]=n(this,ke);if(Math.abs(c-a)<=z.PRECISION||Math.abs(u-o)<=z.PRECISION){const w=t+i/2-(l+c/2),b=s+r/2-(h+u/2);return{path:{"transform-origin":`${z.svgRound(t)} ${z.svgRound(s)}`,transform:`${this.rotationTransform} translate(${w} ${b})`}}}const f=(i-2*a)/(c-2*a),p=(r-2*o)/(u-2*o),v=c/i,m=u/r;return{path:{"transform-origin":`${z.svgRound(l)} ${z.svgRound(h)}`,transform:`${this.rotationTransform} scale(${v} ${m}) translate(${z.svgRound(a)} ${z.svgRound(o)}) scale(${f} ${p}) translate(${z.svgRound(-a)} ${z.svgRound(-o)})`}}}getPathResizedSVGProperties([t,s,i,r]){const[a,o]=A(this,we,Ii).call(this),l=n(this,ke),[h,c,u,f]=l;if(l[0]=t,l[1]=s,l[2]=i,l[3]=r,Math.abs(u-a)<=z.PRECISION||Math.abs(f-o)<=z.PRECISION){const b=t+i/2-(h+u/2),S=s+r/2-(c+f/2);for(const{line:E,points:T}of n(this,fs))z._translate(E,b,S,E),z._translate(T,b,S,T);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${z.svgRound(t)} ${z.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const p=(i-2*a)/(u-2*a),v=(r-2*o)/(f-2*o),m=-p*(h+a)+t+a,w=-v*(c+o)+s+o;if(p!==1||v!==1||m!==0||w!==0)for(const{line:b,points:S}of n(this,fs))z._rescale(b,m,w,p,v,b),z._rescale(S,m,w,p,v,S);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${z.svgRound(t)} ${z.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,s],i){const[r,a]=i,o=n(this,ke),l=t-o[0],h=s-o[1];if(n(this,Ai)===r&&n(this,wi)===a)for(const{line:c,points:u}of n(this,fs))z._translate(c,l,h,c),z._translate(u,l,h,u);else{const c=n(this,Ai)/r,u=n(this,wi)/a;g(this,Ai,r),g(this,wi,a);for(const{line:f,points:p}of n(this,fs))z._rescale(f,l,h,c,u,f),z._rescale(p,l,h,c,u,p);o[2]*=c,o[3]*=u}return o[0]=t,o[1]=s,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${z.svgRound(t)} ${z.svgRound(s)}`}}}get defaultSVGProperties(){const t=n(this,ke);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${z.svgRound(t[0])} ${z.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}ke=new WeakMap,Nc=new WeakMap,Bc=new WeakMap,fs=new WeakMap,Ai=new WeakMap,wi=new WeakMap,wl=new WeakMap,El=new WeakMap,Da=new WeakMap,we=new WeakSet,Ii=function(t=n(this,Da)){const s=n(this,Bc)+t/2*n(this,wl);return n(this,El)%180===0?[s/n(this,Ai),s/n(this,wi)]:[s/n(this,wi),s/n(this,Ai)]},Xm=function(){const[t,s,i,r]=n(this,ke),[a,o]=A(this,we,Ii).call(this,0);return[t+a,s+o,i-2*a,r-2*o]},Ym=function(){const t=g(this,ke,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:r}of n(this,fs)){if(r.length<=12){for(let l=4,h=r.length;l<h;l+=6)G.pointBoundingBox(r[l],r[l+1],t);continue}let a=r[4],o=r[5];for(let l=6,h=r.length;l<h;l+=6){const[c,u,f,p,v,m]=r.subarray(l,l+6);G.bezierBoundingBox(a,o,c,u,f,p,v,m,t),a=v,o=m}}const[s,i]=A(this,we,Ii).call(this);t[0]=_e(t[0]-s,0,1),t[1]=_e(t[1]-i,0,1),t[2]=_e(t[2]+s,0,1),t[3]=_e(t[3]+i,0,1),t[2]-=t[0],t[3]-=t[1]},Km=function(t){const[s,i]=A(this,we,Ii).call(this);g(this,Da,t);const[r,a]=A(this,we,Ii).call(this),[o,l]=[r-s,a-i],h=n(this,ke);return h[0]-=o,h[1]-=l,h[2]+=2*o,h[3]+=2*l,h};class bu extends Vm{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:Ot._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??(t=this["stroke-width"]),t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new bu(this._viewParameters);return e.updateAll(this),e}}var uu,Jm;const eo=class eo extends Yd{constructor(t){super({...t,name:"inkEditor"});y(this,uu);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,s){Ot.initialize(t,s),this._defaultDrawingOptions=new bu(s.viewParameters)}static getDefaultDrawingOptions(t){const s=this._defaultDrawingOptions.clone();return s.updateProperties(t),s}static get supportMultipleDrawings(){return!0}static get typesMap(){return lt(this,"typesMap",new Map([[ct.INK_THICKNESS,"stroke-width"],[ct.INK_COLOR,"stroke"],[ct.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,s,i,r,a){return new ab(t,s,i,r,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,s,i,r,a,o){return Vc.deserialize(t,s,i,r,a,o)}static async deserialize(t,s,i){let r=null;if(t instanceof fp){const{data:{inkLists:o,rect:l,rotation:h,id:c,color:u,opacity:f,borderStyle:{rawWidth:p},popupRef:v,richText:m,contentsObj:w,creationDate:b,modificationDate:S},parent:{page:{pageNumber:E}}}=t;r=t={annotationType:st.INK,color:Array.from(u),thickness:p,opacity:f,paths:{points:o},boxes:null,pageIndex:E-1,rect:l.slice(0),rotation:h,annotationElementId:c,id:c,deleted:!1,popupRef:v,richText:m,comment:(w==null?void 0:w.str)||null,creationDate:b,modificationDate:S}}const a=await super.deserialize(t,s,i);return a._initialData=r,t.comment&&a.setCommentData(t),a}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new Gd(this)),[["colorPicker",this._colorPicker]]}get colorType(){return ct.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:s,parent:i}=this;s.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(t,s.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:s,opacity:i}){this._drawingOptions=eo.getDefaultDrawingOptions({stroke:G.makeHexColor(...t),"stroke-width":s,"stroke-opacity":i})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:s,points:i}=this.serializeDraw(t),{_drawingOptions:{stroke:r,"stroke-opacity":a,"stroke-width":o}}=this,l=Object.assign(super.serialize(t),{color:Ot._colorManager.convert(r),opacity:a,thickness:o,paths:{lines:s,points:i}});return this.addComment(l),t?(l.isCopy=!0,l):this.annotationElementId&&!A(this,uu,Jm).call(this,l)?null:(l.id=this.annotationElementId,l)}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:s,rect:i}=this.serializeDraw(!1);return t.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:s,popup:this.comment}),null}};uu=new WeakSet,Jm=function(t){const{color:s,thickness:i,opacity:r,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((o,l)=>o!==s[l])||t.thickness!==i||t.opacity!==r||t.pageIndex!==a},k(eo,"_type","ink"),k(eo,"_editorType",st.INK),k(eo,"_defaultDrawingOptions",null);let Gf=eo;class Vf extends Vc{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const sd=8,Ol=3;var Ma,vt,Wf,Xs,Qm,Zm,Xf,Dd,qm,tv,ev,Yf,Kf,sv;class fn{static extractContoursFromText(e,{fontFamily:t,fontStyle:s,fontWeight:i},r,a,o,l){let h=new OffscreenCanvas(1,1),c=h.getContext("2d",{alpha:!1});const u=200,f=c.font=`${s} ${i} ${u}px ${t}`,{actualBoundingBoxLeft:p,actualBoundingBoxRight:v,actualBoundingBoxAscent:m,actualBoundingBoxDescent:w,fontBoundingBoxAscent:b,fontBoundingBoxDescent:S,width:E}=c.measureText(e),T=1.5,x=Math.ceil(Math.max(Math.abs(p)+Math.abs(v)||0,E)*T),C=Math.ceil(Math.max(Math.abs(m)+Math.abs(w)||u,Math.abs(b)+Math.abs(S)||u)*T);h=new OffscreenCanvas(x,C),c=h.getContext("2d",{alpha:!0,willReadFrequently:!0}),c.font=f,c.filter="grayscale(1)",c.fillStyle="white",c.fillRect(0,0,x,C),c.fillStyle="black",c.fillText(e,x*(T-1)/2,C*(3-T)/2);const R=A(this,vt,Yf).call(this,c.getImageData(0,0,x,C).data),I=A(this,vt,ev).call(this,R),P=A(this,vt,Kf).call(this,I),M=A(this,vt,Xf).call(this,R,x,C,P);return this.processDrawnLines({lines:{curves:M,width:x,height:C},pageWidth:r,pageHeight:a,rotation:o,innerMargin:l,mustSmooth:!0,areContours:!0})}static process(e,t,s,i,r){const[a,o,l]=A(this,vt,sv).call(this,e),[h,c]=A(this,vt,tv).call(this,a,o,l,Math.hypot(o,l)*n(this,Ma).sigmaSFactor,n(this,Ma).sigmaR,n(this,Ma).kernelSize),u=A(this,vt,Kf).call(this,c),f=A(this,vt,Xf).call(this,h,o,l,u);return this.processDrawnLines({lines:{curves:f,width:o,height:l},pageWidth:t,pageHeight:s,rotation:i,innerMargin:r,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:s,rotation:i,innerMargin:r,mustSmooth:a,areContours:o}){i%180!==0&&([t,s]=[s,t]);const{curves:l,width:h,height:c}=e,u=e.thickness??0,f=[],p=Math.min(t/h,s/c),v=p/t,m=p/s,w=[];for(const{points:S}of l){const E=a?A(this,vt,qm).call(this,S):S;if(!E)continue;w.push(E);const T=E.length,x=new Float32Array(T),C=new Float32Array(3*(T===2?2:T-2));if(f.push({line:C,points:x}),T===2){x[0]=E[0]*v,x[1]=E[1]*m,C.set([NaN,NaN,NaN,NaN,x[0],x[1]],0);continue}let[R,I,P,M]=E;R*=v,I*=m,P*=v,M*=m,x.set([R,I,P,M],0),C.set([NaN,NaN,NaN,NaN,R,I],0);for(let D=4;D<T;D+=2){const O=x[D]=E[D]*v,N=x[D+1]=E[D+1]*m;C.set(z.createBezierPoints(R,I,P,M,O,N),(D-2)*3),[R,I,P,M]=[P,M,O,N]}}if(f.length===0)return null;const b=o?new Vf:new Vc;return b.build(f,t,s,1,i,o?0:u,r),{outline:b,newCurves:w,areContours:o,thickness:u,width:h,height:c}}static async compressSignature({outlines:e,areContours:t,thickness:s,width:i,height:r}){let a=1/0,o=-1/0,l=0;for(const E of e){l+=E.length;for(let T=2,x=E.length;T<x;T++){const C=E[T]-E[T-2];a=Math.min(a,C),o=Math.max(o,C)}}let h;a>=-128&&o<=127?h=Int8Array:a>=-32768&&o<=32767?h=Int16Array:h=Int32Array;const c=e.length,u=sd+Ol*c,f=new Uint32Array(u);let p=0;f[p++]=u*Uint32Array.BYTES_PER_ELEMENT+(l-2*c)*h.BYTES_PER_ELEMENT,f[p++]=0,f[p++]=i,f[p++]=r,f[p++]=t?0:1,f[p++]=Math.max(0,Math.floor(s??0)),f[p++]=c,f[p++]=h.BYTES_PER_ELEMENT;for(const E of e)f[p++]=E.length-2,f[p++]=E[0],f[p++]=E[1];const v=new CompressionStream("deflate-raw"),m=v.writable.getWriter();await m.ready,m.write(f);const w=h.prototype.constructor;for(const E of e){const T=new w(E.length-2);for(let x=2,C=E.length;x<C;x++)T[x-2]=E[x]-E[x-2];m.write(T)}m.close();const b=await new Response(v.readable).arrayBuffer(),S=new Uint8Array(b);return ig(S)}static async decompressSignature(e){try{const t=Ev(e),{readable:s,writable:i}=new DecompressionStream("deflate-raw"),r=i.getWriter();await r.ready,r.write(t).then(async()=>{await r.ready,await r.close()}).catch(()=>{});let a=null,o=0;for await(const E of s)a||(a=new Uint8Array(new Uint32Array(E.buffer,0,4)[0])),a.set(E,o),o+=E.length;const l=new Uint32Array(a.buffer,0,a.length>>2),h=l[1];if(h!==0)throw new Error(`Invalid version: ${h}`);const c=l[2],u=l[3],f=l[4]===0,p=l[5],v=l[6],m=l[7],w=[],b=(sd+Ol*v)*Uint32Array.BYTES_PER_ELEMENT;let S;switch(m){case Int8Array.BYTES_PER_ELEMENT:S=new Int8Array(a.buffer,b);break;case Int16Array.BYTES_PER_ELEMENT:S=new Int16Array(a.buffer,b);break;case Int32Array.BYTES_PER_ELEMENT:S=new Int32Array(a.buffer,b);break}o=0;for(let E=0;E<v;E++){const T=l[Ol*E+sd],x=new Float32Array(T+2);w.push(x);for(let C=0;C<Ol-1;C++)x[C]=l[Ol*E+sd+C+1];for(let C=0;C<T;C++)x[C+2]=x[C]+S[o++]}return{areContours:f,thickness:p,outlines:w,width:c,height:u}}catch(t){return Q(`decompressSignature: ${t}`),null}}}Ma=new WeakMap,vt=new WeakSet,Wf=function(e,t,s,i){return s-=e,i-=t,s===0?i>0?0:4:s===1?i+6:2-i},Xs=new WeakMap,Qm=function(e,t,s,i,r,a,o){const l=A(this,vt,Wf).call(this,s,i,r,a);for(let h=0;h<8;h++){const c=(-h+l-o+16)%8,u=n(this,Xs)[2*c],f=n(this,Xs)[2*c+1];if(e[(s+u)*t+(i+f)]!==0)return c}return-1},Zm=function(e,t,s,i,r,a,o){const l=A(this,vt,Wf).call(this,s,i,r,a);for(let h=0;h<8;h++){const c=(h+l+o+16)%8,u=n(this,Xs)[2*c],f=n(this,Xs)[2*c+1];if(e[(s+u)*t+(i+f)]!==0)return c}return-1},Xf=function(e,t,s,i){const r=e.length,a=new Int32Array(r);for(let c=0;c<r;c++)a[c]=e[c]<=i?1:0;for(let c=1;c<s-1;c++)a[c*t]=a[c*t+t-1]=0;for(let c=0;c<t;c++)a[c]=a[t*s-1-c]=0;let o=1,l;const h=[];for(let c=1;c<s-1;c++){l=1;for(let u=1;u<t-1;u++){const f=c*t+u,p=a[f];if(p===0)continue;let v=c,m=u;if(p===1&&a[f-1]===0)o+=1,m-=1;else if(p>=1&&a[f+1]===0)o+=1,m+=1,p>1&&(l=p);else{p!==1&&(l=Math.abs(p));continue}const w=[u,c],b=m===u+1,S={isHole:b,points:w,id:o,parent:0};h.push(S);let E;for(const D of h)if(D.id===l){E=D;break}E?E.isHole?S.parent=b?E.parent:l:S.parent=b?l:E.parent:S.parent=b?l:0;const T=A(this,vt,Qm).call(this,a,t,c,u,v,m,0);if(T===-1){a[f]=-o,a[f]!==1&&(l=Math.abs(a[f]));continue}let x=n(this,Xs)[2*T],C=n(this,Xs)[2*T+1];const R=c+x,I=u+C;v=R,m=I;let P=c,M=u;for(;;){const D=A(this,vt,Zm).call(this,a,t,P,M,v,m,1);x=n(this,Xs)[2*D],C=n(this,Xs)[2*D+1];const O=P+x,N=M+C;w.push(N,O);const B=P*t+M;if(a[B+1]===0?a[B]=-o:a[B]===1&&(a[B]=o),O===c&&N===u&&P===R&&M===I){a[f]!==1&&(l=Math.abs(a[f]));break}else v=P,m=M,P=O,M=N}}}return h},Dd=function(e,t,s,i){if(s-t<=4){for(let R=t;R<s-2;R+=2)i.push(e[R],e[R+1]);return}const r=e[t],a=e[t+1],o=e[s-4]-r,l=e[s-3]-a,h=Math.hypot(o,l),c=o/h,u=l/h,f=c*a-u*r,p=l/o,v=1/h,m=Math.atan(p),w=Math.cos(m),b=Math.sin(m),S=v*(Math.abs(w)+Math.abs(b)),E=v*(1-S+S**2),T=Math.max(Math.atan(Math.abs(b+w)*E),Math.atan(Math.abs(b-w)*E));let x=0,C=t;for(let R=t+2;R<s-2;R+=2){const I=Math.abs(f-c*e[R+1]+u*e[R]);I>x&&(C=R,x=I)}x>(h*T)**2?(A(this,vt,Dd).call(this,e,t,C+2,i),A(this,vt,Dd).call(this,e,C,s,i)):i.push(r,a)},qm=function(e){const t=[],s=e.length;return A(this,vt,Dd).call(this,e,0,s,t),t.push(e[s-2],e[s-1]),t.length<=4?null:t},tv=function(e,t,s,i,r,a){const o=new Float32Array(a**2),l=-2*i**2,h=a>>1;for(let m=0;m<a;m++){const w=(m-h)**2;for(let b=0;b<a;b++)o[m*a+b]=Math.exp((w+(b-h)**2)/l)}const c=new Float32Array(256),u=-2*r**2;for(let m=0;m<256;m++)c[m]=Math.exp(m**2/u);const f=e.length,p=new Uint8Array(f),v=new Uint32Array(256);for(let m=0;m<s;m++)for(let w=0;w<t;w++){const b=m*t+w,S=e[b];let E=0,T=0;for(let C=0;C<a;C++){const R=m+C-h;if(!(R<0||R>=s))for(let I=0;I<a;I++){const P=w+I-h;if(P<0||P>=t)continue;const M=e[R*t+P],D=o[C*a+I]*c[Math.abs(M-S)];E+=M*D,T+=D}}const x=p[b]=Math.round(E/T);v[x]++}return[p,v]},ev=function(e){const t=new Uint32Array(256);for(const s of e)t[s]++;return t},Yf=function(e){const t=e.length,s=new Uint8ClampedArray(t>>2);let i=-1/0,r=1/0;for(let o=0,l=s.length;o<l;o++){const h=s[o]=e[o<<2];i=Math.max(i,h),r=Math.min(r,h)}const a=255/(i-r);for(let o=0,l=s.length;o<l;o++)s[o]=(s[o]-r)*a;return s},Kf=function(e){let t,s=-1/0,i=-1/0;const r=e.findIndex(l=>l!==0);let a=r,o=r;for(t=r;t<256;t++){const l=e[t];l>s&&(t-a>i&&(i=t-a,o=t-1),s=l,a=t)}for(t=o-1;t>=0&&!(e[t]>e[t+1]);t--);return t},sv=function(e){const t=e,{width:s,height:i}=e,{maxDim:r}=n(this,Ma);let a=s,o=i;if(s>r||i>r){let f=s,p=i,v=Math.log2(Math.max(s,i)/r);const m=Math.floor(v);v=v===m?m-1:m;for(let b=0;b<v;b++){a=Math.ceil(f/2),o=Math.ceil(p/2);const S=new OffscreenCanvas(a,o);S.getContext("2d").drawImage(e,0,0,f,p,0,0,a,o),f=a,p=o,e!==t&&e.close(),e=S.transferToImageBitmap()}const w=Math.min(r/a,r/o);a=Math.round(a*w),o=Math.round(o*w)}const h=new OffscreenCanvas(a,o).getContext("2d",{willReadFrequently:!0});h.fillStyle="white",h.fillRect(0,0,a,o),h.filter="grayscale(1)",h.drawImage(e,0,0,e.width,e.height,0,0,a,o);const c=h.getImageData(0,0,a,o).data;return[A(this,vt,Yf).call(this,c),a,o]},y(fn,vt),y(fn,Ma,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),y(fn,Xs,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class pp extends Vm{constructor(){super(),super.updateProperties({fill:Ot._defaultLineColor,"stroke-width":0})}clone(){const e=new pp;return e.updateAll(this),e}}class gp extends bu{constructor(e){super(e),super.updateProperties({stroke:Ot._defaultLineColor,"stroke-width":1})}clone(){const e=new gp(this._viewParameters);return e.updateAll(this),e}}var rr,Ei,ar,Oa;const Qe=class Qe extends Yd{constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"});y(this,rr,!1);y(this,Ei,null);y(this,ar,null);y(this,Oa,null);this._willKeepAspectRatio=!0,g(this,ar,t.signatureData||null),g(this,Ei,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,s){Ot.initialize(t,s),this._defaultDrawingOptions=new pp,this._defaultDrawnSignatureOptions=new gp(s.viewParameters)}static getDefaultDrawingOptions(t){const s=this._defaultDrawingOptions.clone();return s.updateProperties(t),s}static get supportMultipleDrawings(){return!1}static get typesMap(){return lt(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!n(this,Ei)}}static computeTelemetryFinalData(t){const s=t.get("hasDescription");return{hasAltText:s.get(!0)??0,hasNoAltText:s.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,s;const{_isCopy:i}=this;if(i&&(this._isCopy=!1,t=this.x,s=this.y),super.render(),this._drawId===null)if(n(this,ar)){const{lines:r,mustSmooth:a,areContours:o,description:l,uuid:h,heightInPage:c}=n(this,ar),{rawDims:{pageWidth:u,pageHeight:f},rotation:p}=this.parent.viewport,v=fn.processDrawnLines({lines:r,pageWidth:u,pageHeight:f,rotation:p,innerMargin:Qe._INNER_MARGIN,mustSmooth:a,areContours:o});this.addSignature(v,c,l,h)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:n(this,Ei)||""}));return i&&(this._isCopy=!0,this._moveAfterPaste(t,s)),this.div}setUuid(t){g(this,Oa,t),this.addEditToolbar()}getUuid(){return n(this,Oa)}get description(){return n(this,Ei)}set description(t){g(this,Ei,t),this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(s=>{s==null||s.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:s,thickness:i,width:r,height:a}=n(this,ar),o=Math.max(r,a),l=fn.processDrawnLines({lines:{curves:t.map(h=>({points:h})),thickness:i,width:r,height:a},pageWidth:o,pageHeight:o,rotation:0,innerMargin:0,mustSmooth:!1,areContours:s});return{areContours:s,outline:l.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,s,i,r){const{x:a,y:o}=this,{outline:l}=g(this,ar,t);g(this,rr,l instanceof Vf),this.description=i;let h;n(this,rr)?h=Qe.getDefaultDrawingOptions():(h=Qe._defaultDrawnSignatureOptions.clone(),h.updateProperties({"stroke-width":l.thickness})),this._addOutlines({drawOutlines:l,drawingOptions:h});const[,c]=this.pageDimensions;let u=s/c;u=u>=1?.5:u,this.width*=u/this.height,this.width>=1&&(u*=.9/this.width,this.width=.9),this.height=u,this.setDims(),this.x=a,this.y=o,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(r),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!r,hasDescription:!!i}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:s,pageHeight:i},rotation:r}=this.parent.viewport;return fn.process(t,s,i,r,Qe._INNER_MARGIN)}getFromText(t,s){const{rawDims:{pageWidth:i,pageHeight:r},rotation:a}=this.parent.viewport;return fn.extractContoursFromText(t,s,i,r,a,Qe._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:s,pageHeight:i},rotation:r}=this.parent.viewport;return fn.processDrawnLines({lines:t,pageWidth:s,pageHeight:i,rotation:r,innerMargin:Qe._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:s}){t?this._drawingOptions=Qe.getDefaultDrawingOptions():(this._drawingOptions=Qe._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":s}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:s,points:i}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":r}}=this,a=Object.assign(super.serialize(t),{isSignature:!0,areContours:n(this,rr),color:[0,0,0],thickness:n(this,rr)?0:r});return this.addComment(a),t?(a.paths={lines:s,points:i},a.uuid=n(this,Oa),a.isCopy=!0):a.lines=s,n(this,Ei)&&(a.accessibilityData={type:"Figure",alt:n(this,Ei)}),a}static deserializeDraw(t,s,i,r,a,o){return o.areContours?Vf.deserialize(t,s,i,r,a,o):Vc.deserialize(t,s,i,r,a,o)}static async deserialize(t,s,i){var a;const r=await super.deserialize(t,s,i);return g(r,rr,t.areContours),r.description=((a=t.accessibilityData)==null?void 0:a.alt)||"",g(r,Oa,t.uuid),r}};rr=new WeakMap,Ei=new WeakMap,ar=new WeakMap,Oa=new WeakMap,k(Qe,"_type","signature"),k(Qe,"_editorType",st.SIGNATURE),k(Qe,"_defaultDrawingOptions",null);let Jf=Qe;var Bt,ue,or,ln,lr,Sl,hn,La,Si,ps,xl,ft,Zl,ql,Md,Od,Ld,Zf,Fd,iv;class Qf extends Ot{constructor(t){super({...t,name:"stampEditor"});y(this,ft);y(this,Bt,null);y(this,ue,null);y(this,or,null);y(this,ln,null);y(this,lr,null);y(this,Sl,"");y(this,hn,null);y(this,La,!1);y(this,Si,null);y(this,ps,!1);y(this,xl,!1);g(this,ln,t.bitmapUrl),g(this,lr,t.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,s){Ot.initialize(t,s)}static isHandlingMimeForPasting(t){return Lu.includes(t)}static paste(t,s){s.pasteEditor({mode:st.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const s=t.get("hasAltText");return{hasAltText:s.get(!0)??0,hasNoAltText:s.get(!1)??0}}async mlGuessAltText(t=null,s=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:a,height:o}=t||this.copyCanvas(null,null,!0).imageData,l=await i.guess({name:"altText",request:{data:r,width:a,height:o,channels:r.length/(a*o)}});if(!l)throw new Error("No response from the AI service.");if(l.error)throw new Error("Error from the AI service.");if(l.cancel)return null;if(!l.output)throw new Error("No valid response from the AI service.");const h=l.output;return await this.setGuessedAltText(h),s&&!this.hasAltTextData()&&(this.altTextData={alt:h,decorative:!1}),h}remove(){var t;n(this,ue)&&(g(this,Bt,null),this._uiManager.imageManager.deleteId(n(this,ue)),(t=n(this,hn))==null||t.remove(),g(this,hn,null),n(this,Si)&&(clearTimeout(n(this,Si)),g(this,Si,null))),super.remove()}rebuild(){if(!this.parent){n(this,ue)&&A(this,ft,Md).call(this);return}super.rebuild(),this.div!==null&&(n(this,ue)&&n(this,hn)===null&&A(this,ft,Md).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(n(this,or)||n(this,Bt)||n(this,ln)||n(this,lr)||n(this,ue)||n(this,La))}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,s;return this._isCopy&&(t=this.x,s=this.y),super.render(),this.div.hidden=!0,this.createAltText(),n(this,La)||(n(this,Bt)?A(this,ft,Od).call(this):A(this,ft,Md).call(this)),this._isCopy&&this._moveAfterPaste(t,s),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,s){const{id:i,bitmap:r}=this._uiManager.imageManager.getFromCanvas(t,s);s.remove(),i&&this._uiManager.imageManager.isValidId(i)&&(g(this,ue,i),r&&g(this,Bt,r),g(this,La,!1),A(this,ft,Od).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;n(this,Si)!==null&&clearTimeout(n(this,Si)),g(this,Si,setTimeout(()=>{g(this,Si,null),A(this,ft,Zf).call(this)},200))}copyCanvas(t,s,i=!1){t||(t=224);const{width:r,height:a}=n(this,Bt),o=new Ti;let l=n(this,Bt),h=r,c=a,u=null;if(s){if(r>s||a>s){const R=Math.min(s/r,s/a);h=Math.floor(r*R),c=Math.floor(a*R)}u=document.createElement("canvas");const p=u.width=Math.ceil(h*o.sx),v=u.height=Math.ceil(c*o.sy);n(this,ps)||(l=A(this,ft,Ld).call(this,p,v));const m=u.getContext("2d");m.filter=this._uiManager.hcmFilter;let w="white",b="#cfcfd8";this._uiManager.hcmFilter!=="none"?b="black":Pv.isDarkMode&&(w="#8f8f9d",b="#42414d");const S=15,E=S*o.sx,T=S*o.sy,x=new OffscreenCanvas(E*2,T*2),C=x.getContext("2d");C.fillStyle=w,C.fillRect(0,0,E*2,T*2),C.fillStyle=b,C.fillRect(0,0,E,T),C.fillRect(E,T,E,T),m.fillStyle=m.createPattern(x,"repeat"),m.fillRect(0,0,p,v),m.drawImage(l,0,0,l.width,l.height,0,0,p,v)}let f=null;if(i){let p,v;if(o.symmetric&&l.width<t&&l.height<t)p=l.width,v=l.height;else if(l=n(this,Bt),r>t||a>t){const b=Math.min(t/r,t/a);p=Math.floor(r*b),v=Math.floor(a*b),n(this,ps)||(l=A(this,ft,Ld).call(this,p,v))}const w=new OffscreenCanvas(p,v).getContext("2d",{willReadFrequently:!0});w.drawImage(l,0,0,l.width,l.height,0,0,p,v),f={width:p,height:v,data:w.getImageData(0,0,p,v).data}}return{canvas:u,width:h,height:c,imageData:f}}static async deserialize(t,s,i){var w;let r=null,a=!1;if(t instanceof bm){const{data:{rect:b,rotation:S,id:E,structParent:T,popupRef:x,richText:C,contentsObj:R,creationDate:I,modificationDate:P},container:M,parent:{page:{pageNumber:D}},canvas:O}=t;let N,B;O?(delete t.canvas,{id:N,bitmap:B}=i.imageManager.getFromCanvas(M.id,O),O.remove()):(a=!0,t._hasNoCanvas=!0);const W=((w=await s._structTree.getAriaAttributes(`${ap}${E}`))==null?void 0:w.get("aria-label"))||"";r=t={annotationType:st.STAMP,bitmapId:N,bitmap:B,pageIndex:D-1,rect:b.slice(0),rotation:S,annotationElementId:E,id:E,deleted:!1,accessibilityData:{decorative:!1,altText:W},isSvg:!1,structParent:T,popupRef:x,richText:C,comment:(R==null?void 0:R.str)||null,creationDate:I,modificationDate:P}}const o=await super.deserialize(t,s,i),{rect:l,bitmap:h,bitmapUrl:c,bitmapId:u,isSvg:f,accessibilityData:p}=t;a?(i.addMissingCanvas(t.id,o),g(o,La,!0)):u&&i.imageManager.isValidId(u)?(g(o,ue,u),h&&g(o,Bt,h)):g(o,ln,c),g(o,ps,f);const[v,m]=o.pageDimensions;return o.width=(l[2]-l[0])/v,o.height=(l[3]-l[1])/m,p&&(o.altTextData=p),o._initialData=r,t.comment&&o.setCommentData(t),g(o,xl,!!r),o}serialize(t=!1,s=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=Object.assign(super.serialize(t),{bitmapId:n(this,ue),isSvg:n(this,ps)});if(this.addComment(i),t)return i.bitmapUrl=A(this,ft,Fd).call(this,!0),i.accessibilityData=this.serializeAltText(!0),i.isCopy=!0,i;const{decorative:r,altText:a}=this.serializeAltText(!1);if(!r&&a&&(i.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const l=A(this,ft,iv).call(this,i);return l.isSame?null:(l.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1,i.id=this.annotationElementId,delete i.bitmapId,i)}if(s===null)return i;s.stamps||(s.stamps=new Map);const o=n(this,ps)?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!s.stamps.has(n(this,ue)))s.stamps.set(n(this,ue),{area:o,serialized:i}),i.bitmap=A(this,ft,Fd).call(this,!1);else if(n(this,ps)){const l=s.stamps.get(n(this,ue));o>l.area&&(l.area=o,l.serialized.bitmap.close(),l.serialized.bitmap=A(this,ft,Fd).call(this,!1))}return i}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}Bt=new WeakMap,ue=new WeakMap,or=new WeakMap,ln=new WeakMap,lr=new WeakMap,Sl=new WeakMap,hn=new WeakMap,La=new WeakMap,Si=new WeakMap,ps=new WeakMap,xl=new WeakMap,ft=new WeakSet,Zl=function(t,s=!1){if(!t){this.remove();return}g(this,Bt,t.bitmap),s||(g(this,ue,t.id),g(this,ps,t.isSvg)),t.file&&g(this,Sl,t.file.name),A(this,ft,Od).call(this)},ql=function(){if(g(this,or,null),this._uiManager.enableWaiting(!1),!!n(this,hn)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&n(this,Bt)){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&n(this,Bt)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},Md=function(){if(n(this,ue)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(n(this,ue)).then(i=>A(this,ft,Zl).call(this,i,!0)).finally(()=>A(this,ft,ql).call(this));return}if(n(this,ln)){const i=n(this,ln);g(this,ln,null),this._uiManager.enableWaiting(!0),g(this,or,this._uiManager.imageManager.getFromUrl(i).then(r=>A(this,ft,Zl).call(this,r)).finally(()=>A(this,ft,ql).call(this)));return}if(n(this,lr)){const i=n(this,lr);g(this,lr,null),this._uiManager.enableWaiting(!0),g(this,or,this._uiManager.imageManager.getFromFile(i).then(r=>A(this,ft,Zl).call(this,r)).finally(()=>A(this,ft,ql).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=Lu.join(",");const s=this._uiManager._signal;g(this,or,new Promise(i=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),A(this,ft,Zl).call(this,r)}i()},{signal:s}),t.addEventListener("cancel",()=>{this.remove(),i()},{signal:s})}).finally(()=>A(this,ft,ql).call(this))),t.click()},Od=function(){var h;const{div:t}=this;let{width:s,height:i}=n(this,Bt);const[r,a]=this.pageDimensions,o=.75;if(this.width)s=this.width*r,i=this.height*a;else if(s>o*r||i>o*a){const c=Math.min(o*r/s,o*a/i);s*=c,i*=c}this._uiManager.enableWaiting(!1);const l=g(this,hn,document.createElement("canvas"));l.setAttribute("role","img"),this.addContainer(l),this.width=s/r,this.height=i/a,this.setDims(),(h=this._initialOptions)!=null&&h.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),A(this,ft,Zf).call(this),n(this,xl)||(this.parent.addUndoableEditor(this),g(this,xl,!0)),this._reportTelemetry({action:"inserted_image"}),n(this,Sl)&&this.div.setAttribute("aria-description",n(this,Sl)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")},Ld=function(t,s){const{width:i,height:r}=n(this,Bt);let a=i,o=r,l=n(this,Bt);for(;a>2*t||o>2*s;){const h=a,c=o;a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),o>2*s&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const u=new OffscreenCanvas(a,o);u.getContext("2d").drawImage(l,0,0,h,c,0,0,a,o),l=u.transferToImageBitmap()}return l},Zf=function(){const[t,s]=this.parentDimensions,{width:i,height:r}=this,a=new Ti,o=Math.ceil(i*t*a.sx),l=Math.ceil(r*s*a.sy),h=n(this,hn);if(!h||h.width===o&&h.height===l)return;h.width=o,h.height=l;const c=n(this,ps)?n(this,Bt):A(this,ft,Ld).call(this,o,l),u=h.getContext("2d");u.filter=this._uiManager.hcmFilter,u.drawImage(c,0,0,c.width,c.height,0,0,o,l)},Fd=function(t){if(t){if(n(this,ps)){const r=this._uiManager.imageManager.getSvgUrl(n(this,ue));if(r)return r}const s=document.createElement("canvas");return{width:s.width,height:s.height}=n(this,Bt),s.getContext("2d").drawImage(n(this,Bt),0,0),s.toDataURL()}if(n(this,ps)){const[s,i]=this.pageDimensions,r=Math.round(this.width*s*gr.PDF_TO_CSS_UNITS),a=Math.round(this.height*i*gr.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(r,a);return o.getContext("2d").drawImage(n(this,Bt),0,0,n(this,Bt).width,n(this,Bt).height,0,0,r,a),o.transferToImageBitmap()}return structuredClone(n(this,Bt))},iv=function(t){var o;const{pageIndex:s,accessibilityData:{altText:i}}=this._initialData,r=t.pageIndex===s,a=(((o=t.accessibilityData)==null?void 0:o.alt)||"")===i;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&r&&a,isSameAltText:a}},k(Qf,"_type","stamp"),k(Qf,"_editorType",st.STAMP);var Fa,Tl,hr,cr,cn,Ke,dr,Cl,Rl,Ys,dn,fe,un,ur,Pl,Y,fr,Pt,tp,nv,ti,ep,sp,kd;const Bs=class Bs{constructor({uiManager:e,pageIndex:t,div:s,structTreeLayer:i,accessibilityManager:r,annotationLayer:a,drawLayer:o,textLayer:l,viewport:h,l10n:c}){y(this,Pt);y(this,Fa);y(this,Tl,!1);y(this,hr,null);y(this,cr,null);y(this,cn,null);y(this,Ke,new Map);y(this,dr,!1);y(this,Cl,!1);y(this,Rl,!1);y(this,Ys,null);y(this,dn,null);y(this,fe,null);y(this,un,null);y(this,ur,null);y(this,Pl,-1);y(this,Y);const u=[...n(Bs,fr).values()];if(!Bs._initialized){Bs._initialized=!0;for(const f of u)f.initialize(c,e)}e.registerEditorTypes(u),g(this,Y,e),this.pageIndex=t,this.div=s,g(this,Fa,r),g(this,hr,a),this.viewport=h,g(this,fe,l),this.drawLayer=o,this._structTree=i,n(this,Y).addLayer(this)}get isEmpty(){return n(this,Ke).size===0}get isInvisible(){return this.isEmpty&&n(this,Y).getMode()===st.NONE}updateToolbar(e){n(this,Y).updateToolbar(e)}updateMode(e=n(this,Y).getMode()){switch(A(this,Pt,kd).call(this),e){case st.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case st.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case st.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;if(t.toggle("nonEditing",!1),e===st.POPUP)t.toggle("commentEditing",!0);else{t.toggle("commentEditing",!1);for(const s of n(Bs,fr).values())t.toggle(`${s._type}Editing`,e===s._editorType)}this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=n(this,fe))==null?void 0:t.div)}setEditingState(e){n(this,Y).setEditingState(e)}addCommands(e){n(this,Y).addCommands(e)}cleanUndoStack(e){n(this,Y).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=n(this,hr))==null||t.div.classList.toggle("disabled",!e)}async enable(){var s;g(this,Rl,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),(s=n(this,ur))==null||s.abort(),g(this,ur,null);const e=new Set;for(const i of n(this,Pt,tp))i.enableEditing(),i.show(!0),i.annotationElementId&&(n(this,Y).removeChangedExistingAnnotation(i),e.add(i.annotationElementId));const t=n(this,hr);if(t)for(const i of t.getEditableAnnotations()){if(i.hide(),n(this,Y).isDeletedAnnotationElement(i.data.id)||e.has(i.data.id))continue;const r=await this.deserialize(i);r&&(this.addOrRebuild(r),r.enableEditing())}g(this,Rl,!1),n(this,Y)._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){var s;if(g(this,Cl,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),n(this,fe)&&!n(this,ur)){g(this,ur,new AbortController);const i=n(this,Y).combinedSignal(n(this,ur));n(this,fe).div.addEventListener("pointerdown",r=>{const{clientX:o,clientY:l,timeStamp:h}=r,c=n(this,Pl);if(h-c>500){g(this,Pl,h);return}g(this,Pl,-1);const{classList:u}=this.div;u.toggle("getElements",!0);const f=document.elementsFromPoint(o,l);if(u.toggle("getElements",!1),!this.div.contains(f[0]))return;let p;const v=new RegExp(`^${th}[0-9]+$`);for(const w of f)if(v.test(w.id)){p=w.id;break}if(!p)return;const m=n(this,Ke).get(p);(m==null?void 0:m.annotationElementId)===null&&(r.stopPropagation(),r.preventDefault(),m.dblclick(r))},{signal:i,capture:!0})}const e=n(this,hr);if(e){const i=new Map,r=new Map;for(const o of n(this,Pt,tp)){if(o.disableEditing(),!o.annotationElementId){o.updateFakeAnnotationElement(e);continue}if(o.serialize()!==null){i.set(o.annotationElementId,o);continue}else r.set(o.annotationElementId,o);(s=this.getEditableAnnotation(o.annotationElementId))==null||s.show(),o.remove()}const a=e.getEditableAnnotations();for(const o of a){const{id:l}=o.data;if(n(this,Y).isDeletedAnnotationElement(l)){o.updateEdited({deleted:!0});continue}let h=r.get(l);if(h){h.resetAnnotationElement(o),h.show(!1),o.show();continue}h=i.get(l),h&&(n(this,Y).addChangedExistingAnnotation(h),h.renderAnnotationElement(o)&&h.show(!1)),o.show()}}A(this,Pt,kd).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:t}=this.div;for(const i of n(Bs,fr).values())t.remove(`${i._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),g(this,Cl,!1)}getEditableAnnotation(e){var t;return((t=n(this,hr))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){n(this,Y).getActive()!==e&&n(this,Y).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=n(this,fe))!=null&&e.div&&!n(this,un)){g(this,un,new AbortController);const t=n(this,Y).combinedSignal(n(this,un));n(this,fe).div.addEventListener("pointerdown",A(this,Pt,nv).bind(this),{signal:t}),n(this,fe).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=n(this,fe))!=null&&e.div&&n(this,un)&&(n(this,un).abort(),g(this,un,null),n(this,fe).div.classList.remove("highlighting"))}enableClick(){if(n(this,cr))return;g(this,cr,new AbortController);const e=n(this,Y).combinedSignal(n(this,cr));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=n(this,cr))==null||e.abort(),g(this,cr,null)}attach(e){n(this,Ke).set(e.id,e);const{annotationElementId:t}=e;t&&n(this,Y).isDeletedAnnotationElement(t)&&n(this,Y).removeDeletedAnnotationElement(e)}detach(e){var t;n(this,Ke).delete(e.id),(t=n(this,Fa))==null||t.removePointerInTextLayer(e.contentDiv),!n(this,Cl)&&e.annotationElementId&&n(this,Y).addDeletedAnnotationElement(e)}remove(e){this.detach(e),n(this,Y).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(n(this,Y).addDeletedAnnotationElement(e.annotationElementId),Ot.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),n(this,Y).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!n(this,Rl)),n(this,Y).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var s;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!n(this,cn)&&(e._focusEventsAllowed=!1,g(this,cn,setTimeout(()=>{g(this,cn,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:n(this,Y)._signal}),t.focus())},0))),e._structTreeParentId=(s=n(this,Fa))==null?void 0:s.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),s=()=>{e.remove()};this.addCommands({cmd:t,undo:s,mustExec:!1})}getEditorByUID(e){for(const t of n(this,Ke).values())if(t.uid===e)return t;return null}getNextId(){return n(this,Y).getId()}combinedSignal(e){return n(this,Y).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=n(this,Pt,ti))==null?void 0:e.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await n(this,Y).updateMode(e.mode);const{offsetX:s,offsetY:i}=A(this,Pt,sp).call(this),r=this.getNextId(),a=A(this,Pt,ep).call(this,{parent:this,id:r,x:s,y:i,uiManager:n(this,Y),isCentered:!0,...t});a&&this.add(a)}async deserialize(e){var t;return await((t=n(Bs,fr).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,n(this,Y)))||null}createAndAddNewEditor(e,t,s={}){const i=this.getNextId(),r=A(this,Pt,ep).call(this,{parent:this,id:i,x:e.offsetX,y:e.offsetY,uiManager:n(this,Y),isCentered:t,...s});return r&&this.add(r),r}get boundingClientRect(){return this.div.getBoundingClientRect()}addNewEditor(e={}){this.createAndAddNewEditor(A(this,Pt,sp).call(this),!0,e)}setSelected(e){n(this,Y).setSelected(e)}toggleSelected(e){n(this,Y).toggleSelected(e)}unselect(e){n(this,Y).unselect(e)}pointerup(e){var i;const{isMac:t}=Se.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!n(this,dr)||(g(this,dr,!1),(i=n(this,Pt,ti))!=null&&i.isDrawer&&n(this,Pt,ti).supportMultipleDrawings))return;if(!n(this,Tl)){g(this,Tl,!0);return}const s=n(this,Y).getMode();if(s===st.STAMP||s===st.SIGNATURE){n(this,Y).unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){var i;if(n(this,Y).getMode()===st.HIGHLIGHT&&this.enableTextSelection(),n(this,dr)){g(this,dr,!1);return}const{isMac:t}=Se.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(g(this,dr,!0),(i=n(this,Pt,ti))!=null&&i.isDrawer){this.startDrawingSession(e);return}const s=n(this,Y).getActive();g(this,Tl,!s||s.isEmpty())}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),n(this,Ys)){n(this,Pt,ti).startDrawing(this,n(this,Y),!1,e);return}n(this,Y).setCurrentDrawingSession(this),g(this,Ys,new AbortController);const t=n(this,Y).combinedSignal(n(this,Ys));this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(g(this,dn,null),this.commitOrRemove())},{signal:t}),n(this,Pt,ti).startDrawing(this,n(this,Y),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&g(this,dn,t);return}n(this,dn)&&setTimeout(()=>{var t;(t=n(this,dn))==null||t.focus(),g(this,dn,null)},0)}endDrawingSession(e=!1){return n(this,Ys)?(n(this,Y).setCurrentDrawingSession(null),n(this,Ys).abort(),g(this,Ys,null),g(this,dn,null),n(this,Pt,ti).endDrawing(e)):null}findNewParent(e,t,s){const i=n(this,Y).findParent(t,s);return i===null||i===this?!1:(i.changeParent(e),!0)}commitOrRemove(){return n(this,Ys)?(this.endDrawingSession(),!0):!1}onScaleChanging(){n(this,Ys)&&n(this,Pt,ti).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=n(this,Y).getActive())==null?void 0:e.parent)===this&&(n(this,Y).commitOrRemove(),n(this,Y).setActiveEditor(null)),n(this,cn)&&(clearTimeout(n(this,cn)),g(this,cn,null));for(const s of n(this,Ke).values())(t=n(this,Fa))==null||t.removePointerInTextLayer(s.contentDiv),s.setParent(null),s.isAttachedToDOM=!1,s.div.remove();this.div=null,n(this,Ke).clear(),n(this,Y).removeLayer(this)}render({viewport:e}){this.viewport=e,Na(this.div,e);for(const t of n(this,Y).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){n(this,Y).commitOrRemove(),A(this,Pt,kd).call(this);const t=this.viewport.rotation,s=e.rotation;if(this.viewport=e,Na(this.div,{rotation:s}),t!==s)for(const i of n(this,Ke).values())i.rotate(s)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return n(this,Y).viewParameters.realScale}};Fa=new WeakMap,Tl=new WeakMap,hr=new WeakMap,cr=new WeakMap,cn=new WeakMap,Ke=new WeakMap,dr=new WeakMap,Cl=new WeakMap,Rl=new WeakMap,Ys=new WeakMap,dn=new WeakMap,fe=new WeakMap,un=new WeakMap,ur=new WeakMap,Pl=new WeakMap,Y=new WeakMap,fr=new WeakMap,Pt=new WeakSet,tp=function(){return n(this,Ke).size!==0?n(this,Ke).values():n(this,Y).getEditors(this.pageIndex)},nv=function(e){n(this,Y).unselectAll();const{target:t}=e;if(t===n(this,fe).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&n(this,fe).div.contains(t)){const{isMac:s}=Se.platform;if(e.button!==0||e.ctrlKey&&s)return;n(this,Y).showAllEditors("highlight",!0,!0),n(this,fe).div.classList.add("free"),this.toggleDrawing(),Xd.startHighlighting(this,n(this,Y).direction==="ltr",{target:n(this,fe).div,x:e.x,y:e.y}),n(this,fe).div.addEventListener("pointerup",()=>{n(this,fe).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:n(this,Y)._signal}),e.preventDefault()}},ti=function(){return n(Bs,fr).get(n(this,Y).getMode())},ep=function(e){const t=n(this,Pt,ti);return t?new t.prototype.constructor(e):null},sp=function(){const{x:e,y:t,width:s,height:i}=this.boundingClientRect,r=Math.max(0,e),a=Math.max(0,t),o=Math.min(window.innerWidth,e+s),l=Math.min(window.innerHeight,t+i),h=(r+o)/2-e,c=(a+l)/2-t,[u,f]=this.viewport.rotation%180===0?[h,c]:[c,h];return{offsetX:u,offsetY:f}},kd=function(){for(const e of n(this,Ke).values())e.isEmpty()&&e.remove()},k(Bs,"_initialized",!1),y(Bs,fr,new Map([Ff,Gf,Qf,Xd,Jf].map(e=>[e._editorType,e])));let qf=Bs;var Ks,Ne,ka,_c,fu,rv,Ci,np,av,rp;const se=class se{constructor({pageIndex:e}){y(this,Ci);y(this,Ks,null);y(this,Ne,new Map);y(this,ka,new Map);this.pageIndex=e}setParent(e){if(!n(this,Ks)){g(this,Ks,e);return}if(n(this,Ks)!==e){if(n(this,Ne).size>0)for(const t of n(this,Ne).values())t.remove(),e.append(t);g(this,Ks,e)}}static get _svgFactory(){return lt(this,"_svgFactory",new Vd)}draw(e,t=!1,s=!1){const i=te(se,_c)._++,r=A(this,Ci,np).call(this),a=se._svgFactory.createElement("defs");r.append(a);const o=se._svgFactory.createElement("path");a.append(o);const l=`path_p${this.pageIndex}_${i}`;o.setAttribute("id",l),o.setAttribute("vector-effect","non-scaling-stroke"),t&&n(this,ka).set(i,o);const h=s?A(this,Ci,av).call(this,a,l):null,c=se._svgFactory.createElement("use");return r.append(c),c.setAttribute("href",`#${l}`),this.updateProperties(r,e),n(this,Ne).set(i,r),{id:i,clipPathId:`url(#${h})`}}drawOutline(e,t){const s=te(se,_c)._++,i=A(this,Ci,np).call(this),r=se._svgFactory.createElement("defs");i.append(r);const a=se._svgFactory.createElement("path");r.append(a);const o=`path_p${this.pageIndex}_${s}`;a.setAttribute("id",o),a.setAttribute("vector-effect","non-scaling-stroke");let l;if(t){const u=se._svgFactory.createElement("mask");r.append(u),l=`mask_p${this.pageIndex}_${s}`,u.setAttribute("id",l),u.setAttribute("maskUnits","objectBoundingBox");const f=se._svgFactory.createElement("rect");u.append(f),f.setAttribute("width","1"),f.setAttribute("height","1"),f.setAttribute("fill","white");const p=se._svgFactory.createElement("use");u.append(p),p.setAttribute("href",`#${o}`),p.setAttribute("stroke","none"),p.setAttribute("fill","black"),p.setAttribute("fill-rule","nonzero"),p.classList.add("mask")}const h=se._svgFactory.createElement("use");i.append(h),h.setAttribute("href",`#${o}`),l&&h.setAttribute("mask",`url(#${l})`);const c=h.cloneNode();return i.append(c),h.classList.add("mainOutline"),c.classList.add("secondaryOutline"),this.updateProperties(i,e),n(this,Ne).set(s,i),s}finalizeDraw(e,t){n(this,ka).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var l;if(!t)return;const{root:s,bbox:i,rootClass:r,path:a}=t,o=typeof e=="number"?n(this,Ne).get(e):e;if(o){if(s&&A(this,Ci,rp).call(this,o,s),i&&A(l=se,fu,rv).call(l,o,i),r){const{classList:h}=o;for(const[c,u]of Object.entries(r))h.toggle(c,u)}if(a){const c=o.firstChild.firstChild;A(this,Ci,rp).call(this,c,a)}}}updateParent(e,t){if(t===this)return;const s=n(this,Ne).get(e);s&&(n(t,Ks).append(s),n(this,Ne).delete(e),n(t,Ne).set(e,s))}remove(e){n(this,ka).delete(e),n(this,Ks)!==null&&(n(this,Ne).get(e).remove(),n(this,Ne).delete(e))}destroy(){g(this,Ks,null);for(const e of n(this,Ne).values())e.remove();n(this,Ne).clear(),n(this,ka).clear()}};Ks=new WeakMap,Ne=new WeakMap,ka=new WeakMap,_c=new WeakMap,fu=new WeakSet,rv=function(e,[t,s,i,r]){const{style:a}=e;a.top=`${100*s}%`,a.left=`${100*t}%`,a.width=`${100*i}%`,a.height=`${100*r}%`},Ci=new WeakSet,np=function(){const e=se._svgFactory.create(1,1,!0);return n(this,Ks).append(e),e.setAttribute("aria-hidden",!0),e},av=function(e,t){const s=se._svgFactory.createElement("clipPath");e.append(s);const i=`clip_${t}`;s.setAttribute("id",i),s.setAttribute("clipPathUnits","objectBoundingBox");const r=se._svgFactory.createElement("use");return s.append(r),r.setAttribute("href",`#${t}`),r.classList.add("clip"),i},rp=function(e,t){for(const[s,i]of Object.entries(t))i===null?e.removeAttribute(s):e.setAttribute(s,i)},y(se,fu),y(se,_c,0);let ip=se;globalThis._pdfjsTestingUtils={HighlightOutliner:Nf};globalThis.pdfjsLib={AbortException:pr,AnnotationEditorLayer:qf,AnnotationEditorParamsType:ct,AnnotationEditorType:st,AnnotationEditorUIManager:Ba,AnnotationLayer:Mf,AnnotationMode:bn,AnnotationType:Qt,applyOpacity:Dv,build:By,ColorPicker:zd,createValidAbsoluteUrl:qp,CSSConstants:Iv,DOMSVGFactory:Vd,DrawLayer:ip,FeatureTest:Se,fetchData:Hc,findContrastColor:Mv,getDocument:nm,getFilenameFromUrl:Sv,getPdfFilenameFromUrl:xv,getRGB:jc,getUuid:sg,getXfaPageViewport:Cv,GlobalWorkerOptions:xi,ImageKind:id,InvalidPDFException:Mu,isDataScheme:vu,isPdfFile:lp,isValidExplicitDest:$v,MathClamp:_e,noContextMenu:ks,normalizeUnicode:Av,OPS:eh,OutputScale:Ti,PasswordResponses:dv,PDFDataRangeTransport:rm,PDFDateString:Bd,PDFWorker:nh,PermissionFlag:cv,PixelsPerInch:gr,RenderingCancelledException:op,renderRichText:rg,ResponseException:Nd,setLayerDimensions:Na,shadow:lt,SignatureExtractor:fn,stopEvent:Wt,SupportedImageMimeTypes:Lu,TextLayer:ih,TouchManager:Ud,updateUrlHash:tg,Util:G,VerbosityLevel:pu,version:Ny,XfaLayer:ng};const ob="/bde-evidencija/assets/asset-v5-1760936937048-EEsElJ1r.mjs";xi.workerSrc=ob;async function fb(d){const e=await nm({data:d}).promise;let t="";for(let c=1;c<=e.numPages;c++){const f=await(await e.getPage(c)).getTextContent();t+=f.items.map(p=>p.str).join(`
`)}const s=t.match(/Brutto\s*([\d\.\,]+)/i);let i=0;const r=t.indexOf("Netto");if(r!==-1){const u=t.substring(r+5).match(/-?[\d\.\,]+/g);if(u){const f=u.find(p=>!p.startsWith("-"));f&&(i=parseFloat(f.replace(/\./g,"").replace(",",".")))}}let a=0;const o=t.match(/Gesamtaufwand[\s\S]*?(\d{1,3}(?:\.\d{3})*,\d{2})/i);o&&o[1]&&(a=parseFloat(o[1].replace(/\./g,"").replace(",",".")));const h=s?(c=>c?parseFloat(c.replace(/\./g,"").replace(",",".")):0)(s[1]):0;return{neto:i,bruto:h,ukupni_trosak:a}}export{fb as extractNetoBrutoFromPDF};
